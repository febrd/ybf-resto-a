var iR=e=>{throw TypeError(e)};var nE=(e,t,r)=>t.has(e)||iR("Cannot "+r);var vt=(e,t,r)=>(nE(e,t,"read from private field"),r?r.call(e):t.get(e)),wn=(e,t,r)=>t.has(e)?iR("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Br=(e,t,r,i)=>(nE(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),us=(e,t,r)=>(nE(e,t,"access private method"),r);var V_=(e,t,r,i)=>({set _(a){Br(e,t,a,r)},get _(){return vt(e,t,i)}});function o7(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const u=Object.getOwnPropertyDescriptor(i,a);u&&Object.defineProperty(e,a,u.get?u:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerPolicy&&(u.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?u.credentials="include":a.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(a){if(a.ep)return;a.ep=!0;const u=r(a);fetch(a.href,u)}})();var Gf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xL={exports:{}},vw={},_L={exports:{}},qr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv=Symbol.for("react.element"),a7=Symbol.for("react.portal"),l7=Symbol.for("react.fragment"),c7=Symbol.for("react.strict_mode"),u7=Symbol.for("react.profiler"),d7=Symbol.for("react.provider"),h7=Symbol.for("react.context"),f7=Symbol.for("react.forward_ref"),p7=Symbol.for("react.suspense"),m7=Symbol.for("react.memo"),g7=Symbol.for("react.lazy"),sR=Symbol.iterator;function y7(e){return e===null||typeof e!="object"?null:(e=sR&&e[sR]||e["@@iterator"],typeof e=="function"?e:null)}var wL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bL=Object.assign,SL={};function Jp(e,t,r){this.props=e,this.context=t,this.refs=SL,this.updater=r||wL}Jp.prototype.isReactComponent={};Jp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function EL(){}EL.prototype=Jp.prototype;function AM(e,t,r){this.props=e,this.context=t,this.refs=SL,this.updater=r||wL}var IM=AM.prototype=new EL;IM.constructor=AM;bL(IM,Jp.prototype);IM.isPureReactComponent=!0;var oR=Array.isArray,TL=Object.prototype.hasOwnProperty,DM={current:null},CL={key:!0,ref:!0,__self:!0,__source:!0};function ML(e,t,r){var i,a={},u=null,h=null;if(t!=null)for(i in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(u=""+t.key),t)TL.call(t,i)&&!CL.hasOwnProperty(i)&&(a[i]=t[i]);var g=arguments.length-2;if(g===1)a.children=r;else if(1<g){for(var s=Array(g),_=0;_<g;_++)s[_]=arguments[_+2];a.children=s}if(e&&e.defaultProps)for(i in g=e.defaultProps,g)a[i]===void 0&&(a[i]=g[i]);return{$$typeof:Nv,type:e,key:u,ref:h,props:a,_owner:DM.current}}function v7(e,t){return{$$typeof:Nv,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function RM(e){return typeof e=="object"&&e!==null&&e.$$typeof===Nv}function x7(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var aR=/\/+/g;function iE(e,t){return typeof e=="object"&&e!==null&&e.key!=null?x7(""+e.key):t.toString(36)}function M0(e,t,r,i,a){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(u){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case Nv:case a7:h=!0}}if(h)return h=e,a=a(h),e=i===""?"."+iE(h,0):i,oR(a)?(r="",e!=null&&(r=e.replace(aR,"$&/")+"/"),M0(a,t,r,"",function(_){return _})):a!=null&&(RM(a)&&(a=v7(a,r+(!a.key||h&&h.key===a.key?"":(""+a.key).replace(aR,"$&/")+"/")+e)),t.push(a)),1;if(h=0,i=i===""?".":i+":",oR(e))for(var g=0;g<e.length;g++){u=e[g];var s=i+iE(u,g);h+=M0(u,t,r,s,a)}else if(s=y7(e),typeof s=="function")for(e=s.call(e),g=0;!(u=e.next()).done;)u=u.value,s=i+iE(u,g++),h+=M0(u,t,r,s,a);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function $_(e,t,r){if(e==null)return e;var i=[],a=0;return M0(e,i,"","",function(u){return t.call(r,u,a++)}),i}function _7(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zs={current:null},k0={transition:null},w7={ReactCurrentDispatcher:zs,ReactCurrentBatchConfig:k0,ReactCurrentOwner:DM};function kL(){throw Error("act(...) is not supported in production builds of React.")}qr.Children={map:$_,forEach:function(e,t,r){$_(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $_(e,function(){t++}),t},toArray:function(e){return $_(e,function(t){return t})||[]},only:function(e){if(!RM(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qr.Component=Jp;qr.Fragment=l7;qr.Profiler=u7;qr.PureComponent=AM;qr.StrictMode=c7;qr.Suspense=p7;qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w7;qr.act=kL;qr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=bL({},e.props),a=e.key,u=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,h=DM.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(s in t)TL.call(t,s)&&!CL.hasOwnProperty(s)&&(i[s]=t[s]===void 0&&g!==void 0?g[s]:t[s])}var s=arguments.length-2;if(s===1)i.children=r;else if(1<s){g=Array(s);for(var _=0;_<s;_++)g[_]=arguments[_+2];i.children=g}return{$$typeof:Nv,type:e.type,key:a,ref:u,props:i,_owner:h}};qr.createContext=function(e){return e={$$typeof:h7,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:d7,_context:e},e.Consumer=e};qr.createElement=ML;qr.createFactory=function(e){var t=ML.bind(null,e);return t.type=e,t};qr.createRef=function(){return{current:null}};qr.forwardRef=function(e){return{$$typeof:f7,render:e}};qr.isValidElement=RM;qr.lazy=function(e){return{$$typeof:g7,_payload:{_status:-1,_result:e},_init:_7}};qr.memo=function(e,t){return{$$typeof:m7,type:e,compare:t===void 0?null:t}};qr.startTransition=function(e){var t=k0.transition;k0.transition={};try{e()}finally{k0.transition=t}};qr.unstable_act=kL;qr.useCallback=function(e,t){return zs.current.useCallback(e,t)};qr.useContext=function(e){return zs.current.useContext(e)};qr.useDebugValue=function(){};qr.useDeferredValue=function(e){return zs.current.useDeferredValue(e)};qr.useEffect=function(e,t){return zs.current.useEffect(e,t)};qr.useId=function(){return zs.current.useId()};qr.useImperativeHandle=function(e,t,r){return zs.current.useImperativeHandle(e,t,r)};qr.useInsertionEffect=function(e,t){return zs.current.useInsertionEffect(e,t)};qr.useLayoutEffect=function(e,t){return zs.current.useLayoutEffect(e,t)};qr.useMemo=function(e,t){return zs.current.useMemo(e,t)};qr.useReducer=function(e,t,r){return zs.current.useReducer(e,t,r)};qr.useRef=function(e){return zs.current.useRef(e)};qr.useState=function(e){return zs.current.useState(e)};qr.useSyncExternalStore=function(e,t,r){return zs.current.useSyncExternalStore(e,t,r)};qr.useTransition=function(){return zs.current.useTransition()};qr.version="18.3.1";_L.exports=qr;var A=_L.exports;const lt=PM(A),PL=o7({__proto__:null,default:lt},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b7=A,S7=Symbol.for("react.element"),E7=Symbol.for("react.fragment"),T7=Object.prototype.hasOwnProperty,C7=b7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,M7={key:!0,ref:!0,__self:!0,__source:!0};function AL(e,t,r){var i,a={},u=null,h=null;r!==void 0&&(u=""+r),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(h=t.ref);for(i in t)T7.call(t,i)&&!M7.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)a[i]===void 0&&(a[i]=t[i]);return{$$typeof:S7,type:e,key:u,ref:h,props:a,_owner:C7.current}}vw.Fragment=E7;vw.jsx=AL;vw.jsxs=AL;xL.exports=vw;var m=xL.exports,TT={},IL={exports:{}},jo={},DL={exports:{}},RL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Te,Re){var Tt=Te.length;Te.push(Re);e:for(;0<Tt;){var Ge=Tt-1>>>1,wt=Te[Ge];if(0<a(wt,Re))Te[Ge]=Re,Te[Tt]=wt,Tt=Ge;else break e}}function r(Te){return Te.length===0?null:Te[0]}function i(Te){if(Te.length===0)return null;var Re=Te[0],Tt=Te.pop();if(Tt!==Re){Te[0]=Tt;e:for(var Ge=0,wt=Te.length,ct=wt>>>1;Ge<ct;){var dt=2*(Ge+1)-1,tr=Te[dt],Bt=dt+1,St=Te[Bt];if(0>a(tr,Tt))Bt<wt&&0>a(St,tr)?(Te[Ge]=St,Te[Bt]=Tt,Ge=Bt):(Te[Ge]=tr,Te[dt]=Tt,Ge=dt);else if(Bt<wt&&0>a(St,Tt))Te[Ge]=St,Te[Bt]=Tt,Ge=Bt;else break e}}return Re}function a(Te,Re){var Tt=Te.sortIndex-Re.sortIndex;return Tt!==0?Tt:Te.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var h=Date,g=h.now();e.unstable_now=function(){return h.now()-g}}var s=[],_=[],b=1,C=null,M=3,D=!1,N=!1,j=!1,V=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Te){for(var Re=r(_);Re!==null;){if(Re.callback===null)i(_);else if(Re.startTime<=Te)i(_),Re.sortIndex=Re.expirationTime,t(s,Re);else break;Re=r(_)}}function Z(Te){if(j=!1,U(Te),!N)if(r(s)!==null)N=!0,it(Q);else{var Re=r(_);Re!==null&&Je(Z,Re.startTime-Te)}}function Q(Te,Re){N=!1,j&&(j=!1,B(pe),pe=-1),D=!0;var Tt=M;try{for(U(Re),C=r(s);C!==null&&(!(C.expirationTime>Re)||Te&&!Ke());){var Ge=C.callback;if(typeof Ge=="function"){C.callback=null,M=C.priorityLevel;var wt=Ge(C.expirationTime<=Re);Re=e.unstable_now(),typeof wt=="function"?C.callback=wt:C===r(s)&&i(s),U(Re)}else i(s);C=r(s)}if(C!==null)var ct=!0;else{var dt=r(_);dt!==null&&Je(Z,dt.startTime-Re),ct=!1}return ct}finally{C=null,M=Tt,D=!1}}var re=!1,oe=null,pe=-1,ve=5,he=-1;function Ke(){return!(e.unstable_now()-he<ve)}function qe(){if(oe!==null){var Te=e.unstable_now();he=Te;var Re=!0;try{Re=oe(!0,Te)}finally{Re?Ie():(re=!1,oe=null)}}else re=!1}var Ie;if(typeof z=="function")Ie=function(){z(qe)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,Pt=rt.port2;rt.port1.onmessage=qe,Ie=function(){Pt.postMessage(null)}}else Ie=function(){V(qe,0)};function it(Te){oe=Te,re||(re=!0,Ie())}function Je(Te,Re){pe=V(function(){Te(e.unstable_now())},Re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Te){Te.callback=null},e.unstable_continueExecution=function(){N||D||(N=!0,it(Q))},e.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ve=0<Te?Math.floor(1e3/Te):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return r(s)},e.unstable_next=function(Te){switch(M){case 1:case 2:case 3:var Re=3;break;default:Re=M}var Tt=M;M=Re;try{return Te()}finally{M=Tt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Te,Re){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var Tt=M;M=Te;try{return Re()}finally{M=Tt}},e.unstable_scheduleCallback=function(Te,Re,Tt){var Ge=e.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?Ge+Tt:Ge):Tt=Ge,Te){case 1:var wt=-1;break;case 2:wt=250;break;case 5:wt=1073741823;break;case 4:wt=1e4;break;default:wt=5e3}return wt=Tt+wt,Te={id:b++,callback:Re,priorityLevel:Te,startTime:Tt,expirationTime:wt,sortIndex:-1},Tt>Ge?(Te.sortIndex=Tt,t(_,Te),r(s)===null&&Te===r(_)&&(j?(B(pe),pe=-1):j=!0,Je(Z,Tt-Ge))):(Te.sortIndex=wt,t(s,Te),N||D||(N=!0,it(Q))),Te},e.unstable_shouldYield=Ke,e.unstable_wrapCallback=function(Te){var Re=M;return function(){var Tt=M;M=Re;try{return Te.apply(this,arguments)}finally{M=Tt}}}})(RL);DL.exports=RL;var k7=DL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P7=A,Io=k7;function Dt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NL=new Set,$y={};function Dh(e,t){Ip(e,t),Ip(e+"Capture",t)}function Ip(e,t){for($y[e]=t,e=0;e<t.length;e++)NL.add(t[e])}var pc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),CT=Object.prototype.hasOwnProperty,A7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lR={},cR={};function I7(e){return CT.call(cR,e)?!0:CT.call(lR,e)?!1:A7.test(e)?cR[e]=!0:(lR[e]=!0,!1)}function D7(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function R7(e,t,r,i){if(t===null||typeof t>"u"||D7(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fs(e,t,r,i,a,u,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=h}var ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ts[e]=new Fs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ts[t]=new Fs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ts[e]=new Fs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ts[e]=new Fs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ts[e]=new Fs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ts[e]=new Fs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ts[e]=new Fs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ts[e]=new Fs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ts[e]=new Fs(e,5,!1,e.toLowerCase(),null,!1,!1)});var NM=/[\-:]([a-z])/g;function jM(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(NM,jM);ts[t]=new Fs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(NM,jM);ts[t]=new Fs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(NM,jM);ts[t]=new Fs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ts[e]=new Fs(e,1,!1,e.toLowerCase(),null,!1,!1)});ts.xlinkHref=new Fs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ts[e]=new Fs(e,1,!1,e.toLowerCase(),null,!0,!0)});function LM(e,t,r,i){var a=ts.hasOwnProperty(t)?ts[t]:null;(a!==null?a.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(R7(t,r,a,i)&&(r=null),i||a===null?I7(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,i=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var Ec=P7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,W_=Symbol.for("react.element"),Zf=Symbol.for("react.portal"),Xf=Symbol.for("react.fragment"),OM=Symbol.for("react.strict_mode"),MT=Symbol.for("react.profiler"),jL=Symbol.for("react.provider"),LL=Symbol.for("react.context"),zM=Symbol.for("react.forward_ref"),kT=Symbol.for("react.suspense"),PT=Symbol.for("react.suspense_list"),FM=Symbol.for("react.memo"),uu=Symbol.for("react.lazy"),OL=Symbol.for("react.offscreen"),uR=Symbol.iterator;function Yg(e){return e===null||typeof e!="object"?null:(e=uR&&e[uR]||e["@@iterator"],typeof e=="function"?e:null)}var oi=Object.assign,sE;function my(e){if(sE===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sE=t&&t[1]||""}return`
`+sE+e}var oE=!1;function aE(e,t){if(!e||oE)return"";oE=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(_){var i=_}Reflect.construct(e,[],t)}else{try{t.call()}catch(_){i=_}e.call(t.prototype)}else{try{throw Error()}catch(_){i=_}e()}}catch(_){if(_&&i&&typeof _.stack=="string"){for(var a=_.stack.split(`
`),u=i.stack.split(`
`),h=a.length-1,g=u.length-1;1<=h&&0<=g&&a[h]!==u[g];)g--;for(;1<=h&&0<=g;h--,g--)if(a[h]!==u[g]){if(h!==1||g!==1)do if(h--,g--,0>g||a[h]!==u[g]){var s=`
`+a[h].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}while(1<=h&&0<=g);break}}}finally{oE=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?my(e):""}function N7(e){switch(e.tag){case 5:return my(e.type);case 16:return my("Lazy");case 13:return my("Suspense");case 19:return my("SuspenseList");case 0:case 2:case 15:return e=aE(e.type,!1),e;case 11:return e=aE(e.type.render,!1),e;case 1:return e=aE(e.type,!0),e;default:return""}}function AT(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Xf:return"Fragment";case Zf:return"Portal";case MT:return"Profiler";case OM:return"StrictMode";case kT:return"Suspense";case PT:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case LL:return(e.displayName||"Context")+".Consumer";case jL:return(e._context.displayName||"Context")+".Provider";case zM:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case FM:return t=e.displayName||null,t!==null?t:AT(e.type)||"Memo";case uu:t=e._payload,e=e._init;try{return AT(e(t))}catch{}}return null}function j7(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return AT(t);case 8:return t===OM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ou(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function L7(e){var t=zL(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,u=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(h){i=""+h,u.call(this,h)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(h){i=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function G_(e){e._valueTracker||(e._valueTracker=L7(e))}function FL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=zL(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function Y0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function IT(e,t){var r=t.checked;return oi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function dR(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=Ou(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function BL(e,t){t=t.checked,t!=null&&LM(e,"checked",t,!1)}function DT(e,t){BL(e,t);var r=Ou(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?RT(e,t.type,r):t.hasOwnProperty("defaultValue")&&RT(e,t.type,Ou(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hR(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function RT(e,t,r){(t!=="number"||Y0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var gy=Array.isArray;function dp(e,t,r,i){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&i&&(e[r].defaultSelected=!0)}else{for(r=""+Ou(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,i&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function NT(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Dt(91));return oi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fR(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Dt(92));if(gy(r)){if(1<r.length)throw Error(Dt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ou(r)}}function UL(e,t){var r=Ou(t.value),i=Ou(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function pR(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function VL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jT(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?VL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var H_,$L=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(H_=H_||document.createElement("div"),H_.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=H_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wy(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ty={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},O7=["Webkit","ms","Moz","O"];Object.keys(Ty).forEach(function(e){O7.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ty[t]=Ty[e]})});function WL(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ty.hasOwnProperty(e)&&Ty[e]?(""+t).trim():t+"px"}function GL(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,a=WL(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,a):e[r]=a}}var z7=oi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function LT(e,t){if(t){if(z7[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Dt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Dt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Dt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Dt(62))}}function OT(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zT=null;function BM(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var FT=null,hp=null,fp=null;function mR(e){if(e=Ov(e)){if(typeof FT!="function")throw Error(Dt(280));var t=e.stateNode;t&&(t=Sw(t),FT(e.stateNode,e.type,t))}}function HL(e){hp?fp?fp.push(e):fp=[e]:hp=e}function qL(){if(hp){var e=hp,t=fp;if(fp=hp=null,mR(e),t)for(e=0;e<t.length;e++)mR(t[e])}}function ZL(e,t){return e(t)}function XL(){}var lE=!1;function YL(e,t,r){if(lE)return e(t,r);lE=!0;try{return ZL(e,t,r)}finally{lE=!1,(hp!==null||fp!==null)&&(XL(),qL())}}function Gy(e,t){var r=e.stateNode;if(r===null)return null;var i=Sw(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Dt(231,t,typeof r));return r}var BT=!1;if(pc)try{var Kg={};Object.defineProperty(Kg,"passive",{get:function(){BT=!0}}),window.addEventListener("test",Kg,Kg),window.removeEventListener("test",Kg,Kg)}catch{BT=!1}function F7(e,t,r,i,a,u,h,g,s){var _=Array.prototype.slice.call(arguments,3);try{t.apply(r,_)}catch(b){this.onError(b)}}var Cy=!1,K0=null,Q0=!1,UT=null,B7={onError:function(e){Cy=!0,K0=e}};function U7(e,t,r,i,a,u,h,g,s){Cy=!1,K0=null,F7.apply(B7,arguments)}function V7(e,t,r,i,a,u,h,g,s){if(U7.apply(this,arguments),Cy){if(Cy){var _=K0;Cy=!1,K0=null}else throw Error(Dt(198));Q0||(Q0=!0,UT=_)}}function Rh(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function KL(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gR(e){if(Rh(e)!==e)throw Error(Dt(188))}function $7(e){var t=e.alternate;if(!t){if(t=Rh(e),t===null)throw Error(Dt(188));return t!==e?null:e}for(var r=e,i=t;;){var a=r.return;if(a===null)break;var u=a.alternate;if(u===null){if(i=a.return,i!==null){r=i;continue}break}if(a.child===u.child){for(u=a.child;u;){if(u===r)return gR(a),e;if(u===i)return gR(a),t;u=u.sibling}throw Error(Dt(188))}if(r.return!==i.return)r=a,i=u;else{for(var h=!1,g=a.child;g;){if(g===r){h=!0,r=a,i=u;break}if(g===i){h=!0,i=a,r=u;break}g=g.sibling}if(!h){for(g=u.child;g;){if(g===r){h=!0,r=u,i=a;break}if(g===i){h=!0,i=u,r=a;break}g=g.sibling}if(!h)throw Error(Dt(189))}}if(r.alternate!==i)throw Error(Dt(190))}if(r.tag!==3)throw Error(Dt(188));return r.stateNode.current===r?e:t}function QL(e){return e=$7(e),e!==null?JL(e):null}function JL(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=JL(e);if(t!==null)return t;e=e.sibling}return null}var e4=Io.unstable_scheduleCallback,yR=Io.unstable_cancelCallback,W7=Io.unstable_shouldYield,G7=Io.unstable_requestPaint,pi=Io.unstable_now,H7=Io.unstable_getCurrentPriorityLevel,UM=Io.unstable_ImmediatePriority,t4=Io.unstable_UserBlockingPriority,J0=Io.unstable_NormalPriority,q7=Io.unstable_LowPriority,r4=Io.unstable_IdlePriority,xw=null,_l=null;function Z7(e){if(_l&&typeof _l.onCommitFiberRoot=="function")try{_l.onCommitFiberRoot(xw,e,void 0,(e.current.flags&128)===128)}catch{}}var Ua=Math.clz32?Math.clz32:K7,X7=Math.log,Y7=Math.LN2;function K7(e){return e>>>=0,e===0?32:31-(X7(e)/Y7|0)|0}var q_=64,Z_=4194304;function yy(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function e1(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,a=e.suspendedLanes,u=e.pingedLanes,h=r&268435455;if(h!==0){var g=h&~a;g!==0?i=yy(g):(u&=h,u!==0&&(i=yy(u)))}else h=r&~a,h!==0?i=yy(h):u!==0&&(i=yy(u));if(i===0)return 0;if(t!==0&&t!==i&&!(t&a)&&(a=i&-i,u=t&-t,a>=u||a===16&&(u&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-Ua(t),a=1<<r,i|=e[r],t&=~a;return i}function Q7(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J7(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,u=e.pendingLanes;0<u;){var h=31-Ua(u),g=1<<h,s=a[h];s===-1?(!(g&r)||g&i)&&(a[h]=Q7(g,t)):s<=t&&(e.expiredLanes|=g),u&=~g}}function VT(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function n4(){var e=q_;return q_<<=1,!(q_&4194240)&&(q_=64),e}function cE(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function jv(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ua(t),e[t]=r}function eW(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ua(r),u=1<<a;t[a]=0,i[a]=-1,e[a]=-1,r&=~u}}function VM(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Ua(r),a=1<<i;a&t|e[i]&t&&(e[i]|=t),r&=~a}}var Cn=0;function i4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var s4,$M,o4,a4,l4,$T=!1,X_=[],Cu=null,Mu=null,ku=null,Hy=new Map,qy=new Map,fu=[],tW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vR(e,t){switch(e){case"focusin":case"focusout":Cu=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":ku=null;break;case"pointerover":case"pointerout":Hy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qy.delete(t.pointerId)}}function Qg(e,t,r,i,a,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:u,targetContainers:[a]},t!==null&&(t=Ov(t),t!==null&&$M(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function rW(e,t,r,i,a){switch(t){case"focusin":return Cu=Qg(Cu,e,t,r,i,a),!0;case"dragenter":return Mu=Qg(Mu,e,t,r,i,a),!0;case"mouseover":return ku=Qg(ku,e,t,r,i,a),!0;case"pointerover":var u=a.pointerId;return Hy.set(u,Qg(Hy.get(u)||null,e,t,r,i,a)),!0;case"gotpointercapture":return u=a.pointerId,qy.set(u,Qg(qy.get(u)||null,e,t,r,i,a)),!0}return!1}function c4(e){var t=rh(e.target);if(t!==null){var r=Rh(t);if(r!==null){if(t=r.tag,t===13){if(t=KL(r),t!==null){e.blockedOn=t,l4(e.priority,function(){o4(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function P0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=WT(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);zT=i,r.target.dispatchEvent(i),zT=null}else return t=Ov(r),t!==null&&$M(t),e.blockedOn=r,!1;t.shift()}return!0}function xR(e,t,r){P0(e)&&r.delete(t)}function nW(){$T=!1,Cu!==null&&P0(Cu)&&(Cu=null),Mu!==null&&P0(Mu)&&(Mu=null),ku!==null&&P0(ku)&&(ku=null),Hy.forEach(xR),qy.forEach(xR)}function Jg(e,t){e.blockedOn===t&&(e.blockedOn=null,$T||($T=!0,Io.unstable_scheduleCallback(Io.unstable_NormalPriority,nW)))}function Zy(e){function t(a){return Jg(a,e)}if(0<X_.length){Jg(X_[0],e);for(var r=1;r<X_.length;r++){var i=X_[r];i.blockedOn===e&&(i.blockedOn=null)}}for(Cu!==null&&Jg(Cu,e),Mu!==null&&Jg(Mu,e),ku!==null&&Jg(ku,e),Hy.forEach(t),qy.forEach(t),r=0;r<fu.length;r++)i=fu[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<fu.length&&(r=fu[0],r.blockedOn===null);)c4(r),r.blockedOn===null&&fu.shift()}var pp=Ec.ReactCurrentBatchConfig,t1=!0;function iW(e,t,r,i){var a=Cn,u=pp.transition;pp.transition=null;try{Cn=1,WM(e,t,r,i)}finally{Cn=a,pp.transition=u}}function sW(e,t,r,i){var a=Cn,u=pp.transition;pp.transition=null;try{Cn=4,WM(e,t,r,i)}finally{Cn=a,pp.transition=u}}function WM(e,t,r,i){if(t1){var a=WT(e,t,r,i);if(a===null)xE(e,t,i,r1,r),vR(e,i);else if(rW(a,e,t,r,i))i.stopPropagation();else if(vR(e,i),t&4&&-1<tW.indexOf(e)){for(;a!==null;){var u=Ov(a);if(u!==null&&s4(u),u=WT(e,t,r,i),u===null&&xE(e,t,i,r1,r),u===a)break;a=u}a!==null&&i.stopPropagation()}else xE(e,t,i,null,r)}}var r1=null;function WT(e,t,r,i){if(r1=null,e=BM(i),e=rh(e),e!==null)if(t=Rh(e),t===null)e=null;else if(r=t.tag,r===13){if(e=KL(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return r1=e,null}function u4(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(H7()){case UM:return 1;case t4:return 4;case J0:case q7:return 16;case r4:return 536870912;default:return 16}default:return 16}}var wu=null,GM=null,A0=null;function d4(){if(A0)return A0;var e,t=GM,r=t.length,i,a="value"in wu?wu.value:wu.textContent,u=a.length;for(e=0;e<r&&t[e]===a[e];e++);var h=r-e;for(i=1;i<=h&&t[r-i]===a[u-i];i++);return A0=a.slice(e,1<i?1-i:void 0)}function I0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Y_(){return!0}function _R(){return!1}function Lo(e){function t(r,i,a,u,h){this._reactName=r,this._targetInst=a,this.type=i,this.nativeEvent=u,this.target=h,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(r=e[g],this[g]=r?r(u):u[g]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?Y_:_R,this.isPropagationStopped=_R,this}return oi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Y_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Y_)},persist:function(){},isPersistent:Y_}),t}var em={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},HM=Lo(em),Lv=oi({},em,{view:0,detail:0}),oW=Lo(Lv),uE,dE,ey,_w=oi({},Lv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qM,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ey&&(ey&&e.type==="mousemove"?(uE=e.screenX-ey.screenX,dE=e.screenY-ey.screenY):dE=uE=0,ey=e),uE)},movementY:function(e){return"movementY"in e?e.movementY:dE}}),wR=Lo(_w),aW=oi({},_w,{dataTransfer:0}),lW=Lo(aW),cW=oi({},Lv,{relatedTarget:0}),hE=Lo(cW),uW=oi({},em,{animationName:0,elapsedTime:0,pseudoElement:0}),dW=Lo(uW),hW=oi({},em,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fW=Lo(hW),pW=oi({},em,{data:0}),bR=Lo(pW),mW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vW(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yW[e])?!!t[e]:!1}function qM(){return vW}var xW=oi({},Lv,{key:function(e){if(e.key){var t=mW[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=I0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gW[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qM,charCode:function(e){return e.type==="keypress"?I0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?I0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_W=Lo(xW),wW=oi({},_w,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),SR=Lo(wW),bW=oi({},Lv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qM}),SW=Lo(bW),EW=oi({},em,{propertyName:0,elapsedTime:0,pseudoElement:0}),TW=Lo(EW),CW=oi({},_w,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),MW=Lo(CW),kW=[9,13,27,32],ZM=pc&&"CompositionEvent"in window,My=null;pc&&"documentMode"in document&&(My=document.documentMode);var PW=pc&&"TextEvent"in window&&!My,h4=pc&&(!ZM||My&&8<My&&11>=My),ER=" ",TR=!1;function f4(e,t){switch(e){case"keyup":return kW.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p4(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Yf=!1;function AW(e,t){switch(e){case"compositionend":return p4(t);case"keypress":return t.which!==32?null:(TR=!0,ER);case"textInput":return e=t.data,e===ER&&TR?null:e;default:return null}}function IW(e,t){if(Yf)return e==="compositionend"||!ZM&&f4(e,t)?(e=d4(),A0=GM=wu=null,Yf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return h4&&t.locale!=="ko"?null:t.data;default:return null}}var DW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!DW[e.type]:t==="textarea"}function m4(e,t,r,i){HL(i),t=n1(t,"onChange"),0<t.length&&(r=new HM("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var ky=null,Xy=null;function RW(e){C4(e,0)}function ww(e){var t=Jf(e);if(FL(t))return e}function NW(e,t){if(e==="change")return t}var g4=!1;if(pc){var fE;if(pc){var pE="oninput"in document;if(!pE){var MR=document.createElement("div");MR.setAttribute("oninput","return;"),pE=typeof MR.oninput=="function"}fE=pE}else fE=!1;g4=fE&&(!document.documentMode||9<document.documentMode)}function kR(){ky&&(ky.detachEvent("onpropertychange",y4),Xy=ky=null)}function y4(e){if(e.propertyName==="value"&&ww(Xy)){var t=[];m4(t,Xy,e,BM(e)),YL(RW,t)}}function jW(e,t,r){e==="focusin"?(kR(),ky=t,Xy=r,ky.attachEvent("onpropertychange",y4)):e==="focusout"&&kR()}function LW(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ww(Xy)}function OW(e,t){if(e==="click")return ww(t)}function zW(e,t){if(e==="input"||e==="change")return ww(t)}function FW(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $a=typeof Object.is=="function"?Object.is:FW;function Yy(e,t){if($a(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var a=r[i];if(!CT.call(t,a)||!$a(e[a],t[a]))return!1}return!0}function PR(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function AR(e,t){var r=PR(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=PR(r)}}function v4(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?v4(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function x4(){for(var e=window,t=Y0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Y0(e.document)}return t}function XM(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BW(e){var t=x4(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&v4(r.ownerDocument.documentElement,r)){if(i!==null&&XM(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,u=Math.min(i.start,a);i=i.end===void 0?u:Math.min(i.end,a),!e.extend&&u>i&&(a=i,i=u,u=a),a=AR(r,u);var h=AR(r,i);a&&h&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),u>i?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UW=pc&&"documentMode"in document&&11>=document.documentMode,Kf=null,GT=null,Py=null,HT=!1;function IR(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;HT||Kf==null||Kf!==Y0(i)||(i=Kf,"selectionStart"in i&&XM(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Py&&Yy(Py,i)||(Py=i,i=n1(GT,"onSelect"),0<i.length&&(t=new HM("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Kf)))}function K_(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Qf={animationend:K_("Animation","AnimationEnd"),animationiteration:K_("Animation","AnimationIteration"),animationstart:K_("Animation","AnimationStart"),transitionend:K_("Transition","TransitionEnd")},mE={},_4={};pc&&(_4=document.createElement("div").style,"AnimationEvent"in window||(delete Qf.animationend.animation,delete Qf.animationiteration.animation,delete Qf.animationstart.animation),"TransitionEvent"in window||delete Qf.transitionend.transition);function bw(e){if(mE[e])return mE[e];if(!Qf[e])return e;var t=Qf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in _4)return mE[e]=t[r];return e}var w4=bw("animationend"),b4=bw("animationiteration"),S4=bw("animationstart"),E4=bw("transitionend"),T4=new Map,DR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xu(e,t){T4.set(e,t),Dh(t,[e])}for(var gE=0;gE<DR.length;gE++){var yE=DR[gE],VW=yE.toLowerCase(),$W=yE[0].toUpperCase()+yE.slice(1);Xu(VW,"on"+$W)}Xu(w4,"onAnimationEnd");Xu(b4,"onAnimationIteration");Xu(S4,"onAnimationStart");Xu("dblclick","onDoubleClick");Xu("focusin","onFocus");Xu("focusout","onBlur");Xu(E4,"onTransitionEnd");Ip("onMouseEnter",["mouseout","mouseover"]);Ip("onMouseLeave",["mouseout","mouseover"]);Ip("onPointerEnter",["pointerout","pointerover"]);Ip("onPointerLeave",["pointerout","pointerover"]);Dh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WW=new Set("cancel close invalid load scroll toggle".split(" ").concat(vy));function RR(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,V7(i,t,void 0,e),e.currentTarget=null}function C4(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],a=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var h=i.length-1;0<=h;h--){var g=i[h],s=g.instance,_=g.currentTarget;if(g=g.listener,s!==u&&a.isPropagationStopped())break e;RR(a,g,_),u=s}else for(h=0;h<i.length;h++){if(g=i[h],s=g.instance,_=g.currentTarget,g=g.listener,s!==u&&a.isPropagationStopped())break e;RR(a,g,_),u=s}}}if(Q0)throw e=UT,Q0=!1,UT=null,e}function Un(e,t){var r=t[KT];r===void 0&&(r=t[KT]=new Set);var i=e+"__bubble";r.has(i)||(M4(t,e,2,!1),r.add(i))}function vE(e,t,r){var i=0;t&&(i|=4),M4(r,e,i,t)}var Q_="_reactListening"+Math.random().toString(36).slice(2);function Ky(e){if(!e[Q_]){e[Q_]=!0,NL.forEach(function(r){r!=="selectionchange"&&(WW.has(r)||vE(r,!1,e),vE(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Q_]||(t[Q_]=!0,vE("selectionchange",!1,t))}}function M4(e,t,r,i){switch(u4(t)){case 1:var a=iW;break;case 4:a=sW;break;default:a=WM}r=a.bind(null,t,r,e),a=void 0,!BT||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),i?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function xE(e,t,r,i,a){var u=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var h=i.tag;if(h===3||h===4){var g=i.stateNode.containerInfo;if(g===a||g.nodeType===8&&g.parentNode===a)break;if(h===4)for(h=i.return;h!==null;){var s=h.tag;if((s===3||s===4)&&(s=h.stateNode.containerInfo,s===a||s.nodeType===8&&s.parentNode===a))return;h=h.return}for(;g!==null;){if(h=rh(g),h===null)return;if(s=h.tag,s===5||s===6){i=u=h;continue e}g=g.parentNode}}i=i.return}YL(function(){var _=u,b=BM(r),C=[];e:{var M=T4.get(e);if(M!==void 0){var D=HM,N=e;switch(e){case"keypress":if(I0(r)===0)break e;case"keydown":case"keyup":D=_W;break;case"focusin":N="focus",D=hE;break;case"focusout":N="blur",D=hE;break;case"beforeblur":case"afterblur":D=hE;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=wR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=lW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=SW;break;case w4:case b4:case S4:D=dW;break;case E4:D=TW;break;case"scroll":D=oW;break;case"wheel":D=MW;break;case"copy":case"cut":case"paste":D=fW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=SR}var j=(t&4)!==0,V=!j&&e==="scroll",B=j?M!==null?M+"Capture":null:M;j=[];for(var z=_,U;z!==null;){U=z;var Z=U.stateNode;if(U.tag===5&&Z!==null&&(U=Z,B!==null&&(Z=Gy(z,B),Z!=null&&j.push(Qy(z,Z,U)))),V)break;z=z.return}0<j.length&&(M=new D(M,N,null,r,b),C.push({event:M,listeners:j}))}}if(!(t&7)){e:{if(M=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",M&&r!==zT&&(N=r.relatedTarget||r.fromElement)&&(rh(N)||N[mc]))break e;if((D||M)&&(M=b.window===b?b:(M=b.ownerDocument)?M.defaultView||M.parentWindow:window,D?(N=r.relatedTarget||r.toElement,D=_,N=N?rh(N):null,N!==null&&(V=Rh(N),N!==V||N.tag!==5&&N.tag!==6)&&(N=null)):(D=null,N=_),D!==N)){if(j=wR,Z="onMouseLeave",B="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(j=SR,Z="onPointerLeave",B="onPointerEnter",z="pointer"),V=D==null?M:Jf(D),U=N==null?M:Jf(N),M=new j(Z,z+"leave",D,r,b),M.target=V,M.relatedTarget=U,Z=null,rh(b)===_&&(j=new j(B,z+"enter",N,r,b),j.target=U,j.relatedTarget=V,Z=j),V=Z,D&&N)t:{for(j=D,B=N,z=0,U=j;U;U=Ff(U))z++;for(U=0,Z=B;Z;Z=Ff(Z))U++;for(;0<z-U;)j=Ff(j),z--;for(;0<U-z;)B=Ff(B),U--;for(;z--;){if(j===B||B!==null&&j===B.alternate)break t;j=Ff(j),B=Ff(B)}j=null}else j=null;D!==null&&NR(C,M,D,j,!1),N!==null&&V!==null&&NR(C,V,N,j,!0)}}e:{if(M=_?Jf(_):window,D=M.nodeName&&M.nodeName.toLowerCase(),D==="select"||D==="input"&&M.type==="file")var Q=NW;else if(CR(M))if(g4)Q=zW;else{Q=LW;var re=jW}else(D=M.nodeName)&&D.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(Q=OW);if(Q&&(Q=Q(e,_))){m4(C,Q,r,b);break e}re&&re(e,M,_),e==="focusout"&&(re=M._wrapperState)&&re.controlled&&M.type==="number"&&RT(M,"number",M.value)}switch(re=_?Jf(_):window,e){case"focusin":(CR(re)||re.contentEditable==="true")&&(Kf=re,GT=_,Py=null);break;case"focusout":Py=GT=Kf=null;break;case"mousedown":HT=!0;break;case"contextmenu":case"mouseup":case"dragend":HT=!1,IR(C,r,b);break;case"selectionchange":if(UW)break;case"keydown":case"keyup":IR(C,r,b)}var oe;if(ZM)e:{switch(e){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else Yf?f4(e,r)&&(pe="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(pe="onCompositionStart");pe&&(h4&&r.locale!=="ko"&&(Yf||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&Yf&&(oe=d4()):(wu=b,GM="value"in wu?wu.value:wu.textContent,Yf=!0)),re=n1(_,pe),0<re.length&&(pe=new bR(pe,e,null,r,b),C.push({event:pe,listeners:re}),oe?pe.data=oe:(oe=p4(r),oe!==null&&(pe.data=oe)))),(oe=PW?AW(e,r):IW(e,r))&&(_=n1(_,"onBeforeInput"),0<_.length&&(b=new bR("onBeforeInput","beforeinput",null,r,b),C.push({event:b,listeners:_}),b.data=oe))}C4(C,t)})}function Qy(e,t,r){return{instance:e,listener:t,currentTarget:r}}function n1(e,t){for(var r=t+"Capture",i=[];e!==null;){var a=e,u=a.stateNode;a.tag===5&&u!==null&&(a=u,u=Gy(e,r),u!=null&&i.unshift(Qy(e,u,a)),u=Gy(e,t),u!=null&&i.push(Qy(e,u,a))),e=e.return}return i}function Ff(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function NR(e,t,r,i,a){for(var u=t._reactName,h=[];r!==null&&r!==i;){var g=r,s=g.alternate,_=g.stateNode;if(s!==null&&s===i)break;g.tag===5&&_!==null&&(g=_,a?(s=Gy(r,u),s!=null&&h.unshift(Qy(r,s,g))):a||(s=Gy(r,u),s!=null&&h.push(Qy(r,s,g)))),r=r.return}h.length!==0&&e.push({event:t,listeners:h})}var GW=/\r\n?/g,HW=/\u0000|\uFFFD/g;function jR(e){return(typeof e=="string"?e:""+e).replace(GW,`
`).replace(HW,"")}function J_(e,t,r){if(t=jR(t),jR(e)!==t&&r)throw Error(Dt(425))}function i1(){}var qT=null,ZT=null;function XT(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var YT=typeof setTimeout=="function"?setTimeout:void 0,qW=typeof clearTimeout=="function"?clearTimeout:void 0,LR=typeof Promise=="function"?Promise:void 0,ZW=typeof queueMicrotask=="function"?queueMicrotask:typeof LR<"u"?function(e){return LR.resolve(null).then(e).catch(XW)}:YT;function XW(e){setTimeout(function(){throw e})}function _E(e,t){var r=t,i=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(i===0){e.removeChild(a),Zy(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=a}while(r);Zy(t)}function Pu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function OR(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var tm=Math.random().toString(36).slice(2),gl="__reactFiber$"+tm,Jy="__reactProps$"+tm,mc="__reactContainer$"+tm,KT="__reactEvents$"+tm,YW="__reactListeners$"+tm,KW="__reactHandles$"+tm;function rh(e){var t=e[gl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mc]||r[gl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=OR(e);e!==null;){if(r=e[gl])return r;e=OR(e)}return t}e=r,r=e.parentNode}return null}function Ov(e){return e=e[gl]||e[mc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Dt(33))}function Sw(e){return e[Jy]||null}var QT=[],ep=-1;function Yu(e){return{current:e}}function Vn(e){0>ep||(e.current=QT[ep],QT[ep]=null,ep--)}function Ln(e,t){ep++,QT[ep]=e.current,e.current=t}var zu={},ws=Yu(zu),io=Yu(!1),vh=zu;function Dp(e,t){var r=e.type.contextTypes;if(!r)return zu;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a={},u;for(u in r)a[u]=t[u];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function so(e){return e=e.childContextTypes,e!=null}function s1(){Vn(io),Vn(ws)}function zR(e,t,r){if(ws.current!==zu)throw Error(Dt(168));Ln(ws,t),Ln(io,r)}function k4(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var a in i)if(!(a in t))throw Error(Dt(108,j7(e)||"Unknown",a));return oi({},r,i)}function o1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zu,vh=ws.current,Ln(ws,e),Ln(io,io.current),!0}function FR(e,t,r){var i=e.stateNode;if(!i)throw Error(Dt(169));r?(e=k4(e,t,vh),i.__reactInternalMemoizedMergedChildContext=e,Vn(io),Vn(ws),Ln(ws,e)):Vn(io),Ln(io,r)}var nc=null,Ew=!1,wE=!1;function P4(e){nc===null?nc=[e]:nc.push(e)}function QW(e){Ew=!0,P4(e)}function Ku(){if(!wE&&nc!==null){wE=!0;var e=0,t=Cn;try{var r=nc;for(Cn=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}nc=null,Ew=!1}catch(a){throw nc!==null&&(nc=nc.slice(e+1)),e4(UM,Ku),a}finally{Cn=t,wE=!1}}return null}var tp=[],rp=0,a1=null,l1=0,Jo=[],ea=0,xh=null,ic=1,sc="";function Xd(e,t){tp[rp++]=l1,tp[rp++]=a1,a1=e,l1=t}function A4(e,t,r){Jo[ea++]=ic,Jo[ea++]=sc,Jo[ea++]=xh,xh=e;var i=ic;e=sc;var a=32-Ua(i)-1;i&=~(1<<a),r+=1;var u=32-Ua(t)+a;if(30<u){var h=a-a%5;u=(i&(1<<h)-1).toString(32),i>>=h,a-=h,ic=1<<32-Ua(t)+a|r<<a|i,sc=u+e}else ic=1<<u|r<<a|i,sc=e}function YM(e){e.return!==null&&(Xd(e,1),A4(e,1,0))}function KM(e){for(;e===a1;)a1=tp[--rp],tp[rp]=null,l1=tp[--rp],tp[rp]=null;for(;e===xh;)xh=Jo[--ea],Jo[ea]=null,sc=Jo[--ea],Jo[ea]=null,ic=Jo[--ea],Jo[ea]=null}var Mo=null,To=null,Hn=!1,Fa=null;function I4(e,t){var r=ra(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function BR(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Mo=e,To=Pu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Mo=e,To=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=xh!==null?{id:ic,overflow:sc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ra(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Mo=e,To=null,!0):!1;default:return!1}}function JT(e){return(e.mode&1)!==0&&(e.flags&128)===0}function eC(e){if(Hn){var t=To;if(t){var r=t;if(!BR(e,t)){if(JT(e))throw Error(Dt(418));t=Pu(r.nextSibling);var i=Mo;t&&BR(e,t)?I4(i,r):(e.flags=e.flags&-4097|2,Hn=!1,Mo=e)}}else{if(JT(e))throw Error(Dt(418));e.flags=e.flags&-4097|2,Hn=!1,Mo=e}}}function UR(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Mo=e}function e0(e){if(e!==Mo)return!1;if(!Hn)return UR(e),Hn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!XT(e.type,e.memoizedProps)),t&&(t=To)){if(JT(e))throw D4(),Error(Dt(418));for(;t;)I4(e,t),t=Pu(t.nextSibling)}if(UR(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Dt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){To=Pu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}To=null}}else To=Mo?Pu(e.stateNode.nextSibling):null;return!0}function D4(){for(var e=To;e;)e=Pu(e.nextSibling)}function Rp(){To=Mo=null,Hn=!1}function QM(e){Fa===null?Fa=[e]:Fa.push(e)}var JW=Ec.ReactCurrentBatchConfig;function ty(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Dt(309));var i=r.stateNode}if(!i)throw Error(Dt(147,e));var a=i,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(h){var g=a.refs;h===null?delete g[u]:g[u]=h},t._stringRef=u,t)}if(typeof e!="string")throw Error(Dt(284));if(!r._owner)throw Error(Dt(290,e))}return e}function t0(e,t){throw e=Object.prototype.toString.call(t),Error(Dt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function VR(e){var t=e._init;return t(e._payload)}function R4(e){function t(B,z){if(e){var U=B.deletions;U===null?(B.deletions=[z],B.flags|=16):U.push(z)}}function r(B,z){if(!e)return null;for(;z!==null;)t(B,z),z=z.sibling;return null}function i(B,z){for(B=new Map;z!==null;)z.key!==null?B.set(z.key,z):B.set(z.index,z),z=z.sibling;return B}function a(B,z){return B=Ru(B,z),B.index=0,B.sibling=null,B}function u(B,z,U){return B.index=U,e?(U=B.alternate,U!==null?(U=U.index,U<z?(B.flags|=2,z):U):(B.flags|=2,z)):(B.flags|=1048576,z)}function h(B){return e&&B.alternate===null&&(B.flags|=2),B}function g(B,z,U,Z){return z===null||z.tag!==6?(z=kE(U,B.mode,Z),z.return=B,z):(z=a(z,U),z.return=B,z)}function s(B,z,U,Z){var Q=U.type;return Q===Xf?b(B,z,U.props.children,Z,U.key):z!==null&&(z.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===uu&&VR(Q)===z.type)?(Z=a(z,U.props),Z.ref=ty(B,z,U),Z.return=B,Z):(Z=z0(U.type,U.key,U.props,null,B.mode,Z),Z.ref=ty(B,z,U),Z.return=B,Z)}function _(B,z,U,Z){return z===null||z.tag!==4||z.stateNode.containerInfo!==U.containerInfo||z.stateNode.implementation!==U.implementation?(z=PE(U,B.mode,Z),z.return=B,z):(z=a(z,U.children||[]),z.return=B,z)}function b(B,z,U,Z,Q){return z===null||z.tag!==7?(z=ph(U,B.mode,Z,Q),z.return=B,z):(z=a(z,U),z.return=B,z)}function C(B,z,U){if(typeof z=="string"&&z!==""||typeof z=="number")return z=kE(""+z,B.mode,U),z.return=B,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case W_:return U=z0(z.type,z.key,z.props,null,B.mode,U),U.ref=ty(B,null,z),U.return=B,U;case Zf:return z=PE(z,B.mode,U),z.return=B,z;case uu:var Z=z._init;return C(B,Z(z._payload),U)}if(gy(z)||Yg(z))return z=ph(z,B.mode,U,null),z.return=B,z;t0(B,z)}return null}function M(B,z,U,Z){var Q=z!==null?z.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return Q!==null?null:g(B,z,""+U,Z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case W_:return U.key===Q?s(B,z,U,Z):null;case Zf:return U.key===Q?_(B,z,U,Z):null;case uu:return Q=U._init,M(B,z,Q(U._payload),Z)}if(gy(U)||Yg(U))return Q!==null?null:b(B,z,U,Z,null);t0(B,U)}return null}function D(B,z,U,Z,Q){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return B=B.get(U)||null,g(z,B,""+Z,Q);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case W_:return B=B.get(Z.key===null?U:Z.key)||null,s(z,B,Z,Q);case Zf:return B=B.get(Z.key===null?U:Z.key)||null,_(z,B,Z,Q);case uu:var re=Z._init;return D(B,z,U,re(Z._payload),Q)}if(gy(Z)||Yg(Z))return B=B.get(U)||null,b(z,B,Z,Q,null);t0(z,Z)}return null}function N(B,z,U,Z){for(var Q=null,re=null,oe=z,pe=z=0,ve=null;oe!==null&&pe<U.length;pe++){oe.index>pe?(ve=oe,oe=null):ve=oe.sibling;var he=M(B,oe,U[pe],Z);if(he===null){oe===null&&(oe=ve);break}e&&oe&&he.alternate===null&&t(B,oe),z=u(he,z,pe),re===null?Q=he:re.sibling=he,re=he,oe=ve}if(pe===U.length)return r(B,oe),Hn&&Xd(B,pe),Q;if(oe===null){for(;pe<U.length;pe++)oe=C(B,U[pe],Z),oe!==null&&(z=u(oe,z,pe),re===null?Q=oe:re.sibling=oe,re=oe);return Hn&&Xd(B,pe),Q}for(oe=i(B,oe);pe<U.length;pe++)ve=D(oe,B,pe,U[pe],Z),ve!==null&&(e&&ve.alternate!==null&&oe.delete(ve.key===null?pe:ve.key),z=u(ve,z,pe),re===null?Q=ve:re.sibling=ve,re=ve);return e&&oe.forEach(function(Ke){return t(B,Ke)}),Hn&&Xd(B,pe),Q}function j(B,z,U,Z){var Q=Yg(U);if(typeof Q!="function")throw Error(Dt(150));if(U=Q.call(U),U==null)throw Error(Dt(151));for(var re=Q=null,oe=z,pe=z=0,ve=null,he=U.next();oe!==null&&!he.done;pe++,he=U.next()){oe.index>pe?(ve=oe,oe=null):ve=oe.sibling;var Ke=M(B,oe,he.value,Z);if(Ke===null){oe===null&&(oe=ve);break}e&&oe&&Ke.alternate===null&&t(B,oe),z=u(Ke,z,pe),re===null?Q=Ke:re.sibling=Ke,re=Ke,oe=ve}if(he.done)return r(B,oe),Hn&&Xd(B,pe),Q;if(oe===null){for(;!he.done;pe++,he=U.next())he=C(B,he.value,Z),he!==null&&(z=u(he,z,pe),re===null?Q=he:re.sibling=he,re=he);return Hn&&Xd(B,pe),Q}for(oe=i(B,oe);!he.done;pe++,he=U.next())he=D(oe,B,pe,he.value,Z),he!==null&&(e&&he.alternate!==null&&oe.delete(he.key===null?pe:he.key),z=u(he,z,pe),re===null?Q=he:re.sibling=he,re=he);return e&&oe.forEach(function(qe){return t(B,qe)}),Hn&&Xd(B,pe),Q}function V(B,z,U,Z){if(typeof U=="object"&&U!==null&&U.type===Xf&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case W_:e:{for(var Q=U.key,re=z;re!==null;){if(re.key===Q){if(Q=U.type,Q===Xf){if(re.tag===7){r(B,re.sibling),z=a(re,U.props.children),z.return=B,B=z;break e}}else if(re.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===uu&&VR(Q)===re.type){r(B,re.sibling),z=a(re,U.props),z.ref=ty(B,re,U),z.return=B,B=z;break e}r(B,re);break}else t(B,re);re=re.sibling}U.type===Xf?(z=ph(U.props.children,B.mode,Z,U.key),z.return=B,B=z):(Z=z0(U.type,U.key,U.props,null,B.mode,Z),Z.ref=ty(B,z,U),Z.return=B,B=Z)}return h(B);case Zf:e:{for(re=U.key;z!==null;){if(z.key===re)if(z.tag===4&&z.stateNode.containerInfo===U.containerInfo&&z.stateNode.implementation===U.implementation){r(B,z.sibling),z=a(z,U.children||[]),z.return=B,B=z;break e}else{r(B,z);break}else t(B,z);z=z.sibling}z=PE(U,B.mode,Z),z.return=B,B=z}return h(B);case uu:return re=U._init,V(B,z,re(U._payload),Z)}if(gy(U))return N(B,z,U,Z);if(Yg(U))return j(B,z,U,Z);t0(B,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,z!==null&&z.tag===6?(r(B,z.sibling),z=a(z,U),z.return=B,B=z):(r(B,z),z=kE(U,B.mode,Z),z.return=B,B=z),h(B)):r(B,z)}return V}var Np=R4(!0),N4=R4(!1),c1=Yu(null),u1=null,np=null,JM=null;function ek(){JM=np=u1=null}function tk(e){var t=c1.current;Vn(c1),e._currentValue=t}function tC(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function mp(e,t){u1=e,JM=np=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(eo=!0),e.firstContext=null)}function oa(e){var t=e._currentValue;if(JM!==e)if(e={context:e,memoizedValue:t,next:null},np===null){if(u1===null)throw Error(Dt(308));np=e,u1.dependencies={lanes:0,firstContext:e}}else np=np.next=e;return t}var nh=null;function rk(e){nh===null?nh=[e]:nh.push(e)}function j4(e,t,r,i){var a=t.interleaved;return a===null?(r.next=r,rk(t)):(r.next=a.next,a.next=r),t.interleaved=r,gc(e,i)}function gc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var du=!1;function nk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function L4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function uc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Au(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,tn&2){var a=i.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),i.pending=t,gc(e,r)}return a=i.interleaved,a===null?(t.next=t,rk(i)):(t.next=a.next,a.next=t),i.interleaved=t,gc(e,r)}function D0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,VM(e,r)}}function $R(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var a=null,u=null;if(r=r.firstBaseUpdate,r!==null){do{var h={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};u===null?a=u=h:u=u.next=h,r=r.next}while(r!==null);u===null?a=u=t:u=u.next=t}else a=u=t;r={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:u,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function d1(e,t,r,i){var a=e.updateQueue;du=!1;var u=a.firstBaseUpdate,h=a.lastBaseUpdate,g=a.shared.pending;if(g!==null){a.shared.pending=null;var s=g,_=s.next;s.next=null,h===null?u=_:h.next=_,h=s;var b=e.alternate;b!==null&&(b=b.updateQueue,g=b.lastBaseUpdate,g!==h&&(g===null?b.firstBaseUpdate=_:g.next=_,b.lastBaseUpdate=s))}if(u!==null){var C=a.baseState;h=0,b=_=s=null,g=u;do{var M=g.lane,D=g.eventTime;if((i&M)===M){b!==null&&(b=b.next={eventTime:D,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var N=e,j=g;switch(M=t,D=r,j.tag){case 1:if(N=j.payload,typeof N=="function"){C=N.call(D,C,M);break e}C=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=j.payload,M=typeof N=="function"?N.call(D,C,M):N,M==null)break e;C=oi({},C,M);break e;case 2:du=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,M=a.effects,M===null?a.effects=[g]:M.push(g))}else D={eventTime:D,lane:M,tag:g.tag,payload:g.payload,callback:g.callback,next:null},b===null?(_=b=D,s=C):b=b.next=D,h|=M;if(g=g.next,g===null){if(g=a.shared.pending,g===null)break;M=g,g=M.next,M.next=null,a.lastBaseUpdate=M,a.shared.pending=null}}while(!0);if(b===null&&(s=C),a.baseState=s,a.firstBaseUpdate=_,a.lastBaseUpdate=b,t=a.shared.interleaved,t!==null){a=t;do h|=a.lane,a=a.next;while(a!==t)}else u===null&&(a.shared.lanes=0);wh|=h,e.lanes=h,e.memoizedState=C}}function WR(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(a!==null){if(i.callback=null,i=r,typeof a!="function")throw Error(Dt(191,a));a.call(i)}}}var zv={},wl=Yu(zv),ev=Yu(zv),tv=Yu(zv);function ih(e){if(e===zv)throw Error(Dt(174));return e}function ik(e,t){switch(Ln(tv,t),Ln(ev,e),Ln(wl,zv),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jT(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jT(t,e)}Vn(wl),Ln(wl,t)}function jp(){Vn(wl),Vn(ev),Vn(tv)}function O4(e){ih(tv.current);var t=ih(wl.current),r=jT(t,e.type);t!==r&&(Ln(ev,e),Ln(wl,r))}function sk(e){ev.current===e&&(Vn(wl),Vn(ev))}var ri=Yu(0);function h1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bE=[];function ok(){for(var e=0;e<bE.length;e++)bE[e]._workInProgressVersionPrimary=null;bE.length=0}var R0=Ec.ReactCurrentDispatcher,SE=Ec.ReactCurrentBatchConfig,_h=0,si=null,Di=null,$i=null,f1=!1,Ay=!1,rv=0,eG=0;function ds(){throw Error(Dt(321))}function ak(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!$a(e[r],t[r]))return!1;return!0}function lk(e,t,r,i,a,u){if(_h=u,si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R0.current=e===null||e.memoizedState===null?iG:sG,e=r(i,a),Ay){u=0;do{if(Ay=!1,rv=0,25<=u)throw Error(Dt(301));u+=1,$i=Di=null,t.updateQueue=null,R0.current=oG,e=r(i,a)}while(Ay)}if(R0.current=p1,t=Di!==null&&Di.next!==null,_h=0,$i=Di=si=null,f1=!1,t)throw Error(Dt(300));return e}function ck(){var e=rv!==0;return rv=0,e}function hl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $i===null?si.memoizedState=$i=e:$i=$i.next=e,$i}function aa(){if(Di===null){var e=si.alternate;e=e!==null?e.memoizedState:null}else e=Di.next;var t=$i===null?si.memoizedState:$i.next;if(t!==null)$i=t,Di=e;else{if(e===null)throw Error(Dt(310));Di=e,e={memoizedState:Di.memoizedState,baseState:Di.baseState,baseQueue:Di.baseQueue,queue:Di.queue,next:null},$i===null?si.memoizedState=$i=e:$i=$i.next=e}return $i}function nv(e,t){return typeof t=="function"?t(e):t}function EE(e){var t=aa(),r=t.queue;if(r===null)throw Error(Dt(311));r.lastRenderedReducer=e;var i=Di,a=i.baseQueue,u=r.pending;if(u!==null){if(a!==null){var h=a.next;a.next=u.next,u.next=h}i.baseQueue=a=u,r.pending=null}if(a!==null){u=a.next,i=i.baseState;var g=h=null,s=null,_=u;do{var b=_.lane;if((_h&b)===b)s!==null&&(s=s.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),i=_.hasEagerState?_.eagerState:e(i,_.action);else{var C={lane:b,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};s===null?(g=s=C,h=i):s=s.next=C,si.lanes|=b,wh|=b}_=_.next}while(_!==null&&_!==u);s===null?h=i:s.next=g,$a(i,t.memoizedState)||(eo=!0),t.memoizedState=i,t.baseState=h,t.baseQueue=s,r.lastRenderedState=i}if(e=r.interleaved,e!==null){a=e;do u=a.lane,si.lanes|=u,wh|=u,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function TE(e){var t=aa(),r=t.queue;if(r===null)throw Error(Dt(311));r.lastRenderedReducer=e;var i=r.dispatch,a=r.pending,u=t.memoizedState;if(a!==null){r.pending=null;var h=a=a.next;do u=e(u,h.action),h=h.next;while(h!==a);$a(u,t.memoizedState)||(eo=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),r.lastRenderedState=u}return[u,i]}function z4(){}function F4(e,t){var r=si,i=aa(),a=t(),u=!$a(i.memoizedState,a);if(u&&(i.memoizedState=a,eo=!0),i=i.queue,uk(V4.bind(null,r,i,e),[e]),i.getSnapshot!==t||u||$i!==null&&$i.memoizedState.tag&1){if(r.flags|=2048,iv(9,U4.bind(null,r,i,a,t),void 0,null),Gi===null)throw Error(Dt(349));_h&30||B4(r,t,a)}return a}function B4(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=si.updateQueue,t===null?(t={lastEffect:null,stores:null},si.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function U4(e,t,r,i){t.value=r,t.getSnapshot=i,$4(t)&&W4(e)}function V4(e,t,r){return r(function(){$4(t)&&W4(e)})}function $4(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!$a(e,r)}catch{return!0}}function W4(e){var t=gc(e,1);t!==null&&Va(t,e,1,-1)}function GR(e){var t=hl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nv,lastRenderedState:e},t.queue=e,e=e.dispatch=nG.bind(null,si,e),[t.memoizedState,e]}function iv(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=si.updateQueue,t===null?(t={lastEffect:null,stores:null},si.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function G4(){return aa().memoizedState}function N0(e,t,r,i){var a=hl();si.flags|=e,a.memoizedState=iv(1|t,r,void 0,i===void 0?null:i)}function Tw(e,t,r,i){var a=aa();i=i===void 0?null:i;var u=void 0;if(Di!==null){var h=Di.memoizedState;if(u=h.destroy,i!==null&&ak(i,h.deps)){a.memoizedState=iv(t,r,u,i);return}}si.flags|=e,a.memoizedState=iv(1|t,r,u,i)}function HR(e,t){return N0(8390656,8,e,t)}function uk(e,t){return Tw(2048,8,e,t)}function H4(e,t){return Tw(4,2,e,t)}function q4(e,t){return Tw(4,4,e,t)}function Z4(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function X4(e,t,r){return r=r!=null?r.concat([e]):null,Tw(4,4,Z4.bind(null,t,e),r)}function dk(){}function Y4(e,t){var r=aa();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&ak(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function K4(e,t){var r=aa();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&ak(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function Q4(e,t,r){return _h&21?($a(r,t)||(r=n4(),si.lanes|=r,wh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,eo=!0),e.memoizedState=r)}function tG(e,t){var r=Cn;Cn=r!==0&&4>r?r:4,e(!0);var i=SE.transition;SE.transition={};try{e(!1),t()}finally{Cn=r,SE.transition=i}}function J4(){return aa().memoizedState}function rG(e,t,r){var i=Du(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},eO(e))tO(t,r);else if(r=j4(e,t,r,i),r!==null){var a=js();Va(r,e,i,a),rO(r,t,i)}}function nG(e,t,r){var i=Du(e),a={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(eO(e))tO(t,a);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var h=t.lastRenderedState,g=u(h,r);if(a.hasEagerState=!0,a.eagerState=g,$a(g,h)){var s=t.interleaved;s===null?(a.next=a,rk(t)):(a.next=s.next,s.next=a),t.interleaved=a;return}}catch{}finally{}r=j4(e,t,a,i),r!==null&&(a=js(),Va(r,e,i,a),rO(r,t,i))}}function eO(e){var t=e.alternate;return e===si||t!==null&&t===si}function tO(e,t){Ay=f1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function rO(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,VM(e,r)}}var p1={readContext:oa,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useInsertionEffect:ds,useLayoutEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useMutableSource:ds,useSyncExternalStore:ds,useId:ds,unstable_isNewReconciler:!1},iG={readContext:oa,useCallback:function(e,t){return hl().memoizedState=[e,t===void 0?null:t],e},useContext:oa,useEffect:HR,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,N0(4194308,4,Z4.bind(null,t,e),r)},useLayoutEffect:function(e,t){return N0(4194308,4,e,t)},useInsertionEffect:function(e,t){return N0(4,2,e,t)},useMemo:function(e,t){var r=hl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=hl();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=rG.bind(null,si,e),[i.memoizedState,e]},useRef:function(e){var t=hl();return e={current:e},t.memoizedState=e},useState:GR,useDebugValue:dk,useDeferredValue:function(e){return hl().memoizedState=e},useTransition:function(){var e=GR(!1),t=e[0];return e=tG.bind(null,e[1]),hl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=si,a=hl();if(Hn){if(r===void 0)throw Error(Dt(407));r=r()}else{if(r=t(),Gi===null)throw Error(Dt(349));_h&30||B4(i,t,r)}a.memoizedState=r;var u={value:r,getSnapshot:t};return a.queue=u,HR(V4.bind(null,i,u,e),[e]),i.flags|=2048,iv(9,U4.bind(null,i,u,r,t),void 0,null),r},useId:function(){var e=hl(),t=Gi.identifierPrefix;if(Hn){var r=sc,i=ic;r=(i&~(1<<32-Ua(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=rv++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=eG++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sG={readContext:oa,useCallback:Y4,useContext:oa,useEffect:uk,useImperativeHandle:X4,useInsertionEffect:H4,useLayoutEffect:q4,useMemo:K4,useReducer:EE,useRef:G4,useState:function(){return EE(nv)},useDebugValue:dk,useDeferredValue:function(e){var t=aa();return Q4(t,Di.memoizedState,e)},useTransition:function(){var e=EE(nv)[0],t=aa().memoizedState;return[e,t]},useMutableSource:z4,useSyncExternalStore:F4,useId:J4,unstable_isNewReconciler:!1},oG={readContext:oa,useCallback:Y4,useContext:oa,useEffect:uk,useImperativeHandle:X4,useInsertionEffect:H4,useLayoutEffect:q4,useMemo:K4,useReducer:TE,useRef:G4,useState:function(){return TE(nv)},useDebugValue:dk,useDeferredValue:function(e){var t=aa();return Di===null?t.memoizedState=e:Q4(t,Di.memoizedState,e)},useTransition:function(){var e=TE(nv)[0],t=aa().memoizedState;return[e,t]},useMutableSource:z4,useSyncExternalStore:F4,useId:J4,unstable_isNewReconciler:!1};function ja(e,t){if(e&&e.defaultProps){t=oi({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function rC(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:oi({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Cw={isMounted:function(e){return(e=e._reactInternals)?Rh(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=js(),a=Du(e),u=uc(i,a);u.payload=t,r!=null&&(u.callback=r),t=Au(e,u,a),t!==null&&(Va(t,e,a,i),D0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=js(),a=Du(e),u=uc(i,a);u.tag=1,u.payload=t,r!=null&&(u.callback=r),t=Au(e,u,a),t!==null&&(Va(t,e,a,i),D0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=js(),i=Du(e),a=uc(r,i);a.tag=2,t!=null&&(a.callback=t),t=Au(e,a,i),t!==null&&(Va(t,e,i,r),D0(t,e,i))}};function qR(e,t,r,i,a,u,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,h):t.prototype&&t.prototype.isPureReactComponent?!Yy(r,i)||!Yy(a,u):!0}function nO(e,t,r){var i=!1,a=zu,u=t.contextType;return typeof u=="object"&&u!==null?u=oa(u):(a=so(t)?vh:ws.current,i=t.contextTypes,u=(i=i!=null)?Dp(e,a):zu),t=new t(r,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cw,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=u),t}function ZR(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&Cw.enqueueReplaceState(t,t.state,null)}function nC(e,t,r,i){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},nk(e);var u=t.contextType;typeof u=="object"&&u!==null?a.context=oa(u):(u=so(t)?vh:ws.current,a.context=Dp(e,u)),a.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(rC(e,t,u,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Cw.enqueueReplaceState(a,a.state,null),d1(e,r,a,i),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Lp(e,t){try{var r="",i=t;do r+=N7(i),i=i.return;while(i);var a=r}catch(u){a=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:a,digest:null}}function CE(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function iC(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var aG=typeof WeakMap=="function"?WeakMap:Map;function iO(e,t,r){r=uc(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){g1||(g1=!0,pC=i),iC(e,t)},r}function sO(e,t,r){r=uc(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var a=t.value;r.payload=function(){return i(a)},r.callback=function(){iC(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(r.callback=function(){iC(e,t),typeof i!="function"&&(Iu===null?Iu=new Set([this]):Iu.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),r}function XR(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new aG;var a=new Set;i.set(t,a)}else a=i.get(t),a===void 0&&(a=new Set,i.set(t,a));a.has(r)||(a.add(r),e=wG.bind(null,e,t,r),t.then(e,e))}function YR(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function KR(e,t,r,i,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=uc(-1,1),t.tag=2,Au(r,t,1))),r.lanes|=1),e)}var lG=Ec.ReactCurrentOwner,eo=!1;function ks(e,t,r,i){t.child=e===null?N4(t,null,r,i):Np(t,e.child,r,i)}function QR(e,t,r,i,a){r=r.render;var u=t.ref;return mp(t,a),i=lk(e,t,r,i,u,a),r=ck(),e!==null&&!eo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,yc(e,t,a)):(Hn&&r&&YM(t),t.flags|=1,ks(e,t,i,a),t.child)}function JR(e,t,r,i,a){if(e===null){var u=r.type;return typeof u=="function"&&!xk(u)&&u.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=u,oO(e,t,u,i,a)):(e=z0(r.type,null,i,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&a)){var h=u.memoizedProps;if(r=r.compare,r=r!==null?r:Yy,r(h,i)&&e.ref===t.ref)return yc(e,t,a)}return t.flags|=1,e=Ru(u,i),e.ref=t.ref,e.return=t,t.child=e}function oO(e,t,r,i,a){if(e!==null){var u=e.memoizedProps;if(Yy(u,i)&&e.ref===t.ref)if(eo=!1,t.pendingProps=i=u,(e.lanes&a)!==0)e.flags&131072&&(eo=!0);else return t.lanes=e.lanes,yc(e,t,a)}return sC(e,t,r,i,a)}function aO(e,t,r){var i=t.pendingProps,a=i.children,u=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ln(sp,So),So|=r;else{if(!(r&1073741824))return e=u!==null?u.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ln(sp,So),So|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=u!==null?u.baseLanes:r,Ln(sp,So),So|=i}else u!==null?(i=u.baseLanes|r,t.memoizedState=null):i=r,Ln(sp,So),So|=i;return ks(e,t,a,r),t.child}function lO(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sC(e,t,r,i,a){var u=so(r)?vh:ws.current;return u=Dp(t,u),mp(t,a),r=lk(e,t,r,i,u,a),i=ck(),e!==null&&!eo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,yc(e,t,a)):(Hn&&i&&YM(t),t.flags|=1,ks(e,t,r,a),t.child)}function eN(e,t,r,i,a){if(so(r)){var u=!0;o1(t)}else u=!1;if(mp(t,a),t.stateNode===null)j0(e,t),nO(t,r,i),nC(t,r,i,a),i=!0;else if(e===null){var h=t.stateNode,g=t.memoizedProps;h.props=g;var s=h.context,_=r.contextType;typeof _=="object"&&_!==null?_=oa(_):(_=so(r)?vh:ws.current,_=Dp(t,_));var b=r.getDerivedStateFromProps,C=typeof b=="function"||typeof h.getSnapshotBeforeUpdate=="function";C||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==i||s!==_)&&ZR(t,h,i,_),du=!1;var M=t.memoizedState;h.state=M,d1(t,i,h,a),s=t.memoizedState,g!==i||M!==s||io.current||du?(typeof b=="function"&&(rC(t,r,b,i),s=t.memoizedState),(g=du||qR(t,r,g,i,M,s,_))?(C||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=s),h.props=i,h.state=s,h.context=_,i=g):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,L4(e,t),g=t.memoizedProps,_=t.type===t.elementType?g:ja(t.type,g),h.props=_,C=t.pendingProps,M=h.context,s=r.contextType,typeof s=="object"&&s!==null?s=oa(s):(s=so(r)?vh:ws.current,s=Dp(t,s));var D=r.getDerivedStateFromProps;(b=typeof D=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==C||M!==s)&&ZR(t,h,i,s),du=!1,M=t.memoizedState,h.state=M,d1(t,i,h,a);var N=t.memoizedState;g!==C||M!==N||io.current||du?(typeof D=="function"&&(rC(t,r,D,i),N=t.memoizedState),(_=du||qR(t,r,_,i,M,N,s)||!1)?(b||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,N,s),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,N,s)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||g===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=N),h.props=i,h.state=N,h.context=s,i=_):(typeof h.componentDidUpdate!="function"||g===e.memoizedProps&&M===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&M===e.memoizedState||(t.flags|=1024),i=!1)}return oC(e,t,r,i,u,a)}function oC(e,t,r,i,a,u){lO(e,t);var h=(t.flags&128)!==0;if(!i&&!h)return a&&FR(t,r,!1),yc(e,t,u);i=t.stateNode,lG.current=t;var g=h&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&h?(t.child=Np(t,e.child,null,u),t.child=Np(t,null,g,u)):ks(e,t,g,u),t.memoizedState=i.state,a&&FR(t,r,!0),t.child}function cO(e){var t=e.stateNode;t.pendingContext?zR(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zR(e,t.context,!1),ik(e,t.containerInfo)}function tN(e,t,r,i,a){return Rp(),QM(a),t.flags|=256,ks(e,t,r,i),t.child}var aC={dehydrated:null,treeContext:null,retryLane:0};function lC(e){return{baseLanes:e,cachePool:null,transitions:null}}function uO(e,t,r){var i=t.pendingProps,a=ri.current,u=!1,h=(t.flags&128)!==0,g;if((g=h)||(g=e!==null&&e.memoizedState===null?!1:(a&2)!==0),g?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ln(ri,a&1),e===null)return eC(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=i.children,e=i.fallback,u?(i=t.mode,u=t.child,h={mode:"hidden",children:h},!(i&1)&&u!==null?(u.childLanes=0,u.pendingProps=h):u=Pw(h,i,0,null),e=ph(e,i,r,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=lC(r),t.memoizedState=aC,e):hk(t,h));if(a=e.memoizedState,a!==null&&(g=a.dehydrated,g!==null))return cG(e,t,h,i,g,a,r);if(u){u=i.fallback,h=t.mode,a=e.child,g=a.sibling;var s={mode:"hidden",children:i.children};return!(h&1)&&t.child!==a?(i=t.child,i.childLanes=0,i.pendingProps=s,t.deletions=null):(i=Ru(a,s),i.subtreeFlags=a.subtreeFlags&14680064),g!==null?u=Ru(g,u):(u=ph(u,h,r,null),u.flags|=2),u.return=t,i.return=t,i.sibling=u,t.child=i,i=u,u=t.child,h=e.child.memoizedState,h=h===null?lC(r):{baseLanes:h.baseLanes|r,cachePool:null,transitions:h.transitions},u.memoizedState=h,u.childLanes=e.childLanes&~r,t.memoizedState=aC,i}return u=e.child,e=u.sibling,i=Ru(u,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function hk(e,t){return t=Pw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function r0(e,t,r,i){return i!==null&&QM(i),Np(t,e.child,null,r),e=hk(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cG(e,t,r,i,a,u,h){if(r)return t.flags&256?(t.flags&=-257,i=CE(Error(Dt(422))),r0(e,t,h,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=i.fallback,a=t.mode,i=Pw({mode:"visible",children:i.children},a,0,null),u=ph(u,a,h,null),u.flags|=2,i.return=t,u.return=t,i.sibling=u,t.child=i,t.mode&1&&Np(t,e.child,null,h),t.child.memoizedState=lC(h),t.memoizedState=aC,u);if(!(t.mode&1))return r0(e,t,h,null);if(a.data==="$!"){if(i=a.nextSibling&&a.nextSibling.dataset,i)var g=i.dgst;return i=g,u=Error(Dt(419)),i=CE(u,i,void 0),r0(e,t,h,i)}if(g=(h&e.childLanes)!==0,eo||g){if(i=Gi,i!==null){switch(h&-h){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(i.suspendedLanes|h)?0:a,a!==0&&a!==u.retryLane&&(u.retryLane=a,gc(e,a),Va(i,e,a,-1))}return vk(),i=CE(Error(Dt(421))),r0(e,t,h,i)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=bG.bind(null,e),a._reactRetry=t,null):(e=u.treeContext,To=Pu(a.nextSibling),Mo=t,Hn=!0,Fa=null,e!==null&&(Jo[ea++]=ic,Jo[ea++]=sc,Jo[ea++]=xh,ic=e.id,sc=e.overflow,xh=t),t=hk(t,i.children),t.flags|=4096,t)}function rN(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),tC(e.return,t,r)}function ME(e,t,r,i,a){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:a}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=i,u.tail=r,u.tailMode=a)}function dO(e,t,r){var i=t.pendingProps,a=i.revealOrder,u=i.tail;if(ks(e,t,i.children,r),i=ri.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rN(e,r,t);else if(e.tag===19)rN(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Ln(ri,i),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&h1(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ME(t,!1,a,r,u);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&h1(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ME(t,!0,r,null,u);break;case"together":ME(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function j0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function yc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),wh|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Dt(153));if(t.child!==null){for(e=t.child,r=Ru(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ru(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function uG(e,t,r){switch(t.tag){case 3:cO(t),Rp();break;case 5:O4(t);break;case 1:so(t.type)&&o1(t);break;case 4:ik(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;Ln(c1,i._currentValue),i._currentValue=a;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Ln(ri,ri.current&1),t.flags|=128,null):r&t.child.childLanes?uO(e,t,r):(Ln(ri,ri.current&1),e=yc(e,t,r),e!==null?e.sibling:null);Ln(ri,ri.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return dO(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ln(ri,ri.current),i)break;return null;case 22:case 23:return t.lanes=0,aO(e,t,r)}return yc(e,t,r)}var hO,cC,fO,pO;hO=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cC=function(){};fO=function(e,t,r,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,ih(wl.current);var u=null;switch(r){case"input":a=IT(e,a),i=IT(e,i),u=[];break;case"select":a=oi({},a,{value:void 0}),i=oi({},i,{value:void 0}),u=[];break;case"textarea":a=NT(e,a),i=NT(e,i),u=[];break;default:typeof a.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=i1)}LT(r,i);var h;r=null;for(_ in a)if(!i.hasOwnProperty(_)&&a.hasOwnProperty(_)&&a[_]!=null)if(_==="style"){var g=a[_];for(h in g)g.hasOwnProperty(h)&&(r||(r={}),r[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&($y.hasOwnProperty(_)?u||(u=[]):(u=u||[]).push(_,null));for(_ in i){var s=i[_];if(g=a!=null?a[_]:void 0,i.hasOwnProperty(_)&&s!==g&&(s!=null||g!=null))if(_==="style")if(g){for(h in g)!g.hasOwnProperty(h)||s&&s.hasOwnProperty(h)||(r||(r={}),r[h]="");for(h in s)s.hasOwnProperty(h)&&g[h]!==s[h]&&(r||(r={}),r[h]=s[h])}else r||(u||(u=[]),u.push(_,r)),r=s;else _==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,g=g?g.__html:void 0,s!=null&&g!==s&&(u=u||[]).push(_,s)):_==="children"?typeof s!="string"&&typeof s!="number"||(u=u||[]).push(_,""+s):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&($y.hasOwnProperty(_)?(s!=null&&_==="onScroll"&&Un("scroll",e),u||g===s||(u=[])):(u=u||[]).push(_,s))}r&&(u=u||[]).push("style",r);var _=u;(t.updateQueue=_)&&(t.flags|=4)}};pO=function(e,t,r,i){r!==i&&(t.flags|=4)};function ry(e,t){if(!Hn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function hs(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,i|=a.subtreeFlags&14680064,i|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function dG(e,t,r){var i=t.pendingProps;switch(KM(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(t),null;case 1:return so(t.type)&&s1(),hs(t),null;case 3:return i=t.stateNode,jp(),Vn(io),Vn(ws),ok(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(e0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Fa!==null&&(yC(Fa),Fa=null))),cC(e,t),hs(t),null;case 5:sk(t);var a=ih(tv.current);if(r=t.type,e!==null&&t.stateNode!=null)fO(e,t,r,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Dt(166));return hs(t),null}if(e=ih(wl.current),e0(t)){i=t.stateNode,r=t.type;var u=t.memoizedProps;switch(i[gl]=t,i[Jy]=u,e=(t.mode&1)!==0,r){case"dialog":Un("cancel",i),Un("close",i);break;case"iframe":case"object":case"embed":Un("load",i);break;case"video":case"audio":for(a=0;a<vy.length;a++)Un(vy[a],i);break;case"source":Un("error",i);break;case"img":case"image":case"link":Un("error",i),Un("load",i);break;case"details":Un("toggle",i);break;case"input":dR(i,u),Un("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!u.multiple},Un("invalid",i);break;case"textarea":fR(i,u),Un("invalid",i)}LT(r,u),a=null;for(var h in u)if(u.hasOwnProperty(h)){var g=u[h];h==="children"?typeof g=="string"?i.textContent!==g&&(u.suppressHydrationWarning!==!0&&J_(i.textContent,g,e),a=["children",g]):typeof g=="number"&&i.textContent!==""+g&&(u.suppressHydrationWarning!==!0&&J_(i.textContent,g,e),a=["children",""+g]):$y.hasOwnProperty(h)&&g!=null&&h==="onScroll"&&Un("scroll",i)}switch(r){case"input":G_(i),hR(i,u,!0);break;case"textarea":G_(i),pR(i);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(i.onclick=i1)}i=a,t.updateQueue=i,i!==null&&(t.flags|=4)}else{h=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=VL(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=h.createElement(r,{is:i.is}):(e=h.createElement(r),r==="select"&&(h=e,i.multiple?h.multiple=!0:i.size&&(h.size=i.size))):e=h.createElementNS(e,r),e[gl]=t,e[Jy]=i,hO(e,t,!1,!1),t.stateNode=e;e:{switch(h=OT(r,i),r){case"dialog":Un("cancel",e),Un("close",e),a=i;break;case"iframe":case"object":case"embed":Un("load",e),a=i;break;case"video":case"audio":for(a=0;a<vy.length;a++)Un(vy[a],e);a=i;break;case"source":Un("error",e),a=i;break;case"img":case"image":case"link":Un("error",e),Un("load",e),a=i;break;case"details":Un("toggle",e),a=i;break;case"input":dR(e,i),a=IT(e,i),Un("invalid",e);break;case"option":a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=oi({},i,{value:void 0}),Un("invalid",e);break;case"textarea":fR(e,i),a=NT(e,i),Un("invalid",e);break;default:a=i}LT(r,a),g=a;for(u in g)if(g.hasOwnProperty(u)){var s=g[u];u==="style"?GL(e,s):u==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&$L(e,s)):u==="children"?typeof s=="string"?(r!=="textarea"||s!=="")&&Wy(e,s):typeof s=="number"&&Wy(e,""+s):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($y.hasOwnProperty(u)?s!=null&&u==="onScroll"&&Un("scroll",e):s!=null&&LM(e,u,s,h))}switch(r){case"input":G_(e),hR(e,i,!1);break;case"textarea":G_(e),pR(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Ou(i.value));break;case"select":e.multiple=!!i.multiple,u=i.value,u!=null?dp(e,!!i.multiple,u,!1):i.defaultValue!=null&&dp(e,!!i.multiple,i.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=i1)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return hs(t),null;case 6:if(e&&t.stateNode!=null)pO(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Dt(166));if(r=ih(tv.current),ih(wl.current),e0(t)){if(i=t.stateNode,r=t.memoizedProps,i[gl]=t,(u=i.nodeValue!==r)&&(e=Mo,e!==null))switch(e.tag){case 3:J_(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&J_(i.nodeValue,r,(e.mode&1)!==0)}u&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[gl]=t,t.stateNode=i}return hs(t),null;case 13:if(Vn(ri),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Hn&&To!==null&&t.mode&1&&!(t.flags&128))D4(),Rp(),t.flags|=98560,u=!1;else if(u=e0(t),i!==null&&i.dehydrated!==null){if(e===null){if(!u)throw Error(Dt(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(Dt(317));u[gl]=t}else Rp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;hs(t),u=!1}else Fa!==null&&(yC(Fa),Fa=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||ri.current&1?Ri===0&&(Ri=3):vk())),t.updateQueue!==null&&(t.flags|=4),hs(t),null);case 4:return jp(),cC(e,t),e===null&&Ky(t.stateNode.containerInfo),hs(t),null;case 10:return tk(t.type._context),hs(t),null;case 17:return so(t.type)&&s1(),hs(t),null;case 19:if(Vn(ri),u=t.memoizedState,u===null)return hs(t),null;if(i=(t.flags&128)!==0,h=u.rendering,h===null)if(i)ry(u,!1);else{if(Ri!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=h1(e),h!==null){for(t.flags|=128,ry(u,!1),i=h.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)u=r,e=i,u.flags&=14680066,h=u.alternate,h===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=h.childLanes,u.lanes=h.lanes,u.child=h.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=h.memoizedProps,u.memoizedState=h.memoizedState,u.updateQueue=h.updateQueue,u.type=h.type,e=h.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ln(ri,ri.current&1|2),t.child}e=e.sibling}u.tail!==null&&pi()>Op&&(t.flags|=128,i=!0,ry(u,!1),t.lanes=4194304)}else{if(!i)if(e=h1(h),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ry(u,!0),u.tail===null&&u.tailMode==="hidden"&&!h.alternate&&!Hn)return hs(t),null}else 2*pi()-u.renderingStartTime>Op&&r!==1073741824&&(t.flags|=128,i=!0,ry(u,!1),t.lanes=4194304);u.isBackwards?(h.sibling=t.child,t.child=h):(r=u.last,r!==null?r.sibling=h:t.child=h,u.last=h)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=pi(),t.sibling=null,r=ri.current,Ln(ri,i?r&1|2:r&1),t):(hs(t),null);case 22:case 23:return yk(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?So&1073741824&&(hs(t),t.subtreeFlags&6&&(t.flags|=8192)):hs(t),null;case 24:return null;case 25:return null}throw Error(Dt(156,t.tag))}function hG(e,t){switch(KM(t),t.tag){case 1:return so(t.type)&&s1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jp(),Vn(io),Vn(ws),ok(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return sk(t),null;case 13:if(Vn(ri),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Dt(340));Rp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Vn(ri),null;case 4:return jp(),null;case 10:return tk(t.type._context),null;case 22:case 23:return yk(),null;case 24:return null;default:return null}}var n0=!1,ms=!1,fG=typeof WeakSet=="function"?WeakSet:Set,er=null;function ip(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){di(e,t,i)}else r.current=null}function uC(e,t,r){try{r()}catch(i){di(e,t,i)}}var nN=!1;function pG(e,t){if(qT=t1,e=x4(),XM(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var a=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{r.nodeType,u.nodeType}catch{r=null;break e}var h=0,g=-1,s=-1,_=0,b=0,C=e,M=null;t:for(;;){for(var D;C!==r||a!==0&&C.nodeType!==3||(g=h+a),C!==u||i!==0&&C.nodeType!==3||(s=h+i),C.nodeType===3&&(h+=C.nodeValue.length),(D=C.firstChild)!==null;)M=C,C=D;for(;;){if(C===e)break t;if(M===r&&++_===a&&(g=h),M===u&&++b===i&&(s=h),(D=C.nextSibling)!==null)break;C=M,M=C.parentNode}C=D}r=g===-1||s===-1?null:{start:g,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(ZT={focusedElem:e,selectionRange:r},t1=!1,er=t;er!==null;)if(t=er,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,er=e;else for(;er!==null;){t=er;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var j=N.memoizedProps,V=N.memoizedState,B=t.stateNode,z=B.getSnapshotBeforeUpdate(t.elementType===t.type?j:ja(t.type,j),V);B.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var U=t.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Dt(163))}}catch(Z){di(t,t.return,Z)}if(e=t.sibling,e!==null){e.return=t.return,er=e;break}er=t.return}return N=nN,nN=!1,N}function Iy(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var u=a.destroy;a.destroy=void 0,u!==void 0&&uC(t,r,u)}a=a.next}while(a!==i)}}function Mw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function dC(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function mO(e){var t=e.alternate;t!==null&&(e.alternate=null,mO(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gl],delete t[Jy],delete t[KT],delete t[YW],delete t[KW])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gO(e){return e.tag===5||e.tag===3||e.tag===4}function iN(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||gO(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hC(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=i1));else if(i!==4&&(e=e.child,e!==null))for(hC(e,t,r),e=e.sibling;e!==null;)hC(e,t,r),e=e.sibling}function fC(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(fC(e,t,r),e=e.sibling;e!==null;)fC(e,t,r),e=e.sibling}var Ki=null,za=!1;function nu(e,t,r){for(r=r.child;r!==null;)yO(e,t,r),r=r.sibling}function yO(e,t,r){if(_l&&typeof _l.onCommitFiberUnmount=="function")try{_l.onCommitFiberUnmount(xw,r)}catch{}switch(r.tag){case 5:ms||ip(r,t);case 6:var i=Ki,a=za;Ki=null,nu(e,t,r),Ki=i,za=a,Ki!==null&&(za?(e=Ki,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ki.removeChild(r.stateNode));break;case 18:Ki!==null&&(za?(e=Ki,r=r.stateNode,e.nodeType===8?_E(e.parentNode,r):e.nodeType===1&&_E(e,r),Zy(e)):_E(Ki,r.stateNode));break;case 4:i=Ki,a=za,Ki=r.stateNode.containerInfo,za=!0,nu(e,t,r),Ki=i,za=a;break;case 0:case 11:case 14:case 15:if(!ms&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){a=i=i.next;do{var u=a,h=u.destroy;u=u.tag,h!==void 0&&(u&2||u&4)&&uC(r,t,h),a=a.next}while(a!==i)}nu(e,t,r);break;case 1:if(!ms&&(ip(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(g){di(r,t,g)}nu(e,t,r);break;case 21:nu(e,t,r);break;case 22:r.mode&1?(ms=(i=ms)||r.memoizedState!==null,nu(e,t,r),ms=i):nu(e,t,r);break;default:nu(e,t,r)}}function sN(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new fG),t.forEach(function(i){var a=SG.bind(null,e,i);r.has(i)||(r.add(i),i.then(a,a))})}}function Ra(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var a=r[i];try{var u=e,h=t,g=h;e:for(;g!==null;){switch(g.tag){case 5:Ki=g.stateNode,za=!1;break e;case 3:Ki=g.stateNode.containerInfo,za=!0;break e;case 4:Ki=g.stateNode.containerInfo,za=!0;break e}g=g.return}if(Ki===null)throw Error(Dt(160));yO(u,h,a),Ki=null,za=!1;var s=a.alternate;s!==null&&(s.return=null),a.return=null}catch(_){di(a,t,_)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vO(t,e),t=t.sibling}function vO(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ra(t,e),cl(e),i&4){try{Iy(3,e,e.return),Mw(3,e)}catch(j){di(e,e.return,j)}try{Iy(5,e,e.return)}catch(j){di(e,e.return,j)}}break;case 1:Ra(t,e),cl(e),i&512&&r!==null&&ip(r,r.return);break;case 5:if(Ra(t,e),cl(e),i&512&&r!==null&&ip(r,r.return),e.flags&32){var a=e.stateNode;try{Wy(a,"")}catch(j){di(e,e.return,j)}}if(i&4&&(a=e.stateNode,a!=null)){var u=e.memoizedProps,h=r!==null?r.memoizedProps:u,g=e.type,s=e.updateQueue;if(e.updateQueue=null,s!==null)try{g==="input"&&u.type==="radio"&&u.name!=null&&BL(a,u),OT(g,h);var _=OT(g,u);for(h=0;h<s.length;h+=2){var b=s[h],C=s[h+1];b==="style"?GL(a,C):b==="dangerouslySetInnerHTML"?$L(a,C):b==="children"?Wy(a,C):LM(a,b,C,_)}switch(g){case"input":DT(a,u);break;case"textarea":UL(a,u);break;case"select":var M=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!u.multiple;var D=u.value;D!=null?dp(a,!!u.multiple,D,!1):M!==!!u.multiple&&(u.defaultValue!=null?dp(a,!!u.multiple,u.defaultValue,!0):dp(a,!!u.multiple,u.multiple?[]:"",!1))}a[Jy]=u}catch(j){di(e,e.return,j)}}break;case 6:if(Ra(t,e),cl(e),i&4){if(e.stateNode===null)throw Error(Dt(162));a=e.stateNode,u=e.memoizedProps;try{a.nodeValue=u}catch(j){di(e,e.return,j)}}break;case 3:if(Ra(t,e),cl(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{Zy(t.containerInfo)}catch(j){di(e,e.return,j)}break;case 4:Ra(t,e),cl(e);break;case 13:Ra(t,e),cl(e),a=e.child,a.flags&8192&&(u=a.memoizedState!==null,a.stateNode.isHidden=u,!u||a.alternate!==null&&a.alternate.memoizedState!==null||(mk=pi())),i&4&&sN(e);break;case 22:if(b=r!==null&&r.memoizedState!==null,e.mode&1?(ms=(_=ms)||b,Ra(t,e),ms=_):Ra(t,e),cl(e),i&8192){if(_=e.memoizedState!==null,(e.stateNode.isHidden=_)&&!b&&e.mode&1)for(er=e,b=e.child;b!==null;){for(C=er=b;er!==null;){switch(M=er,D=M.child,M.tag){case 0:case 11:case 14:case 15:Iy(4,M,M.return);break;case 1:ip(M,M.return);var N=M.stateNode;if(typeof N.componentWillUnmount=="function"){i=M,r=M.return;try{t=i,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(j){di(i,r,j)}}break;case 5:ip(M,M.return);break;case 22:if(M.memoizedState!==null){aN(C);continue}}D!==null?(D.return=M,er=D):aN(C)}b=b.sibling}e:for(b=null,C=e;;){if(C.tag===5){if(b===null){b=C;try{a=C.stateNode,_?(u=a.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(g=C.stateNode,s=C.memoizedProps.style,h=s!=null&&s.hasOwnProperty("display")?s.display:null,g.style.display=WL("display",h))}catch(j){di(e,e.return,j)}}}else if(C.tag===6){if(b===null)try{C.stateNode.nodeValue=_?"":C.memoizedProps}catch(j){di(e,e.return,j)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;b===C&&(b=null),C=C.return}b===C&&(b=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:Ra(t,e),cl(e),i&4&&sN(e);break;case 21:break;default:Ra(t,e),cl(e)}}function cl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(gO(r)){var i=r;break e}r=r.return}throw Error(Dt(160))}switch(i.tag){case 5:var a=i.stateNode;i.flags&32&&(Wy(a,""),i.flags&=-33);var u=iN(e);fC(e,u,a);break;case 3:case 4:var h=i.stateNode.containerInfo,g=iN(e);hC(e,g,h);break;default:throw Error(Dt(161))}}catch(s){di(e,e.return,s)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mG(e,t,r){er=e,xO(e)}function xO(e,t,r){for(var i=(e.mode&1)!==0;er!==null;){var a=er,u=a.child;if(a.tag===22&&i){var h=a.memoizedState!==null||n0;if(!h){var g=a.alternate,s=g!==null&&g.memoizedState!==null||ms;g=n0;var _=ms;if(n0=h,(ms=s)&&!_)for(er=a;er!==null;)h=er,s=h.child,h.tag===22&&h.memoizedState!==null?lN(a):s!==null?(s.return=h,er=s):lN(a);for(;u!==null;)er=u,xO(u),u=u.sibling;er=a,n0=g,ms=_}oN(e)}else a.subtreeFlags&8772&&u!==null?(u.return=a,er=u):oN(e)}}function oN(e){for(;er!==null;){var t=er;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ms||Mw(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!ms)if(r===null)i.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ja(t.type,r.memoizedProps);i.componentDidUpdate(a,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&WR(t,u,i);break;case 3:var h=t.updateQueue;if(h!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}WR(t,h,r)}break;case 5:var g=t.stateNode;if(r===null&&t.flags&4){r=g;var s=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var _=t.alternate;if(_!==null){var b=_.memoizedState;if(b!==null){var C=b.dehydrated;C!==null&&Zy(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Dt(163))}ms||t.flags&512&&dC(t)}catch(M){di(t,t.return,M)}}if(t===e){er=null;break}if(r=t.sibling,r!==null){r.return=t.return,er=r;break}er=t.return}}function aN(e){for(;er!==null;){var t=er;if(t===e){er=null;break}var r=t.sibling;if(r!==null){r.return=t.return,er=r;break}er=t.return}}function lN(e){for(;er!==null;){var t=er;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Mw(4,t)}catch(s){di(t,r,s)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var a=t.return;try{i.componentDidMount()}catch(s){di(t,a,s)}}var u=t.return;try{dC(t)}catch(s){di(t,u,s)}break;case 5:var h=t.return;try{dC(t)}catch(s){di(t,h,s)}}}catch(s){di(t,t.return,s)}if(t===e){er=null;break}var g=t.sibling;if(g!==null){g.return=t.return,er=g;break}er=t.return}}var gG=Math.ceil,m1=Ec.ReactCurrentDispatcher,fk=Ec.ReactCurrentOwner,na=Ec.ReactCurrentBatchConfig,tn=0,Gi=null,Ci=null,Ji=0,So=0,sp=Yu(0),Ri=0,sv=null,wh=0,kw=0,pk=0,Dy=null,Js=null,mk=0,Op=1/0,rc=null,g1=!1,pC=null,Iu=null,i0=!1,bu=null,y1=0,Ry=0,mC=null,L0=-1,O0=0;function js(){return tn&6?pi():L0!==-1?L0:L0=pi()}function Du(e){return e.mode&1?tn&2&&Ji!==0?Ji&-Ji:JW.transition!==null?(O0===0&&(O0=n4()),O0):(e=Cn,e!==0||(e=window.event,e=e===void 0?16:u4(e.type)),e):1}function Va(e,t,r,i){if(50<Ry)throw Ry=0,mC=null,Error(Dt(185));jv(e,r,i),(!(tn&2)||e!==Gi)&&(e===Gi&&(!(tn&2)&&(kw|=r),Ri===4&&pu(e,Ji)),oo(e,i),r===1&&tn===0&&!(t.mode&1)&&(Op=pi()+500,Ew&&Ku()))}function oo(e,t){var r=e.callbackNode;J7(e,t);var i=e1(e,e===Gi?Ji:0);if(i===0)r!==null&&yR(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&yR(r),t===1)e.tag===0?QW(cN.bind(null,e)):P4(cN.bind(null,e)),ZW(function(){!(tn&6)&&Ku()}),r=null;else{switch(i4(i)){case 1:r=UM;break;case 4:r=t4;break;case 16:r=J0;break;case 536870912:r=r4;break;default:r=J0}r=MO(r,_O.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function _O(e,t){if(L0=-1,O0=0,tn&6)throw Error(Dt(327));var r=e.callbackNode;if(gp()&&e.callbackNode!==r)return null;var i=e1(e,e===Gi?Ji:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=v1(e,i);else{t=i;var a=tn;tn|=2;var u=bO();(Gi!==e||Ji!==t)&&(rc=null,Op=pi()+500,fh(e,t));do try{xG();break}catch(g){wO(e,g)}while(!0);ek(),m1.current=u,tn=a,Ci!==null?t=0:(Gi=null,Ji=0,t=Ri)}if(t!==0){if(t===2&&(a=VT(e),a!==0&&(i=a,t=gC(e,a))),t===1)throw r=sv,fh(e,0),pu(e,i),oo(e,pi()),r;if(t===6)pu(e,i);else{if(a=e.current.alternate,!(i&30)&&!yG(a)&&(t=v1(e,i),t===2&&(u=VT(e),u!==0&&(i=u,t=gC(e,u))),t===1))throw r=sv,fh(e,0),pu(e,i),oo(e,pi()),r;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(Dt(345));case 2:Yd(e,Js,rc);break;case 3:if(pu(e,i),(i&130023424)===i&&(t=mk+500-pi(),10<t)){if(e1(e,0)!==0)break;if(a=e.suspendedLanes,(a&i)!==i){js(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=YT(Yd.bind(null,e,Js,rc),t);break}Yd(e,Js,rc);break;case 4:if(pu(e,i),(i&4194240)===i)break;for(t=e.eventTimes,a=-1;0<i;){var h=31-Ua(i);u=1<<h,h=t[h],h>a&&(a=h),i&=~u}if(i=a,i=pi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*gG(i/1960))-i,10<i){e.timeoutHandle=YT(Yd.bind(null,e,Js,rc),i);break}Yd(e,Js,rc);break;case 5:Yd(e,Js,rc);break;default:throw Error(Dt(329))}}}return oo(e,pi()),e.callbackNode===r?_O.bind(null,e):null}function gC(e,t){var r=Dy;return e.current.memoizedState.isDehydrated&&(fh(e,t).flags|=256),e=v1(e,t),e!==2&&(t=Js,Js=r,t!==null&&yC(t)),e}function yC(e){Js===null?Js=e:Js.push.apply(Js,e)}function yG(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var a=r[i],u=a.getSnapshot;a=a.value;try{if(!$a(u(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function pu(e,t){for(t&=~pk,t&=~kw,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ua(t),i=1<<r;e[r]=-1,t&=~i}}function cN(e){if(tn&6)throw Error(Dt(327));gp();var t=e1(e,0);if(!(t&1))return oo(e,pi()),null;var r=v1(e,t);if(e.tag!==0&&r===2){var i=VT(e);i!==0&&(t=i,r=gC(e,i))}if(r===1)throw r=sv,fh(e,0),pu(e,t),oo(e,pi()),r;if(r===6)throw Error(Dt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Yd(e,Js,rc),oo(e,pi()),null}function gk(e,t){var r=tn;tn|=1;try{return e(t)}finally{tn=r,tn===0&&(Op=pi()+500,Ew&&Ku())}}function bh(e){bu!==null&&bu.tag===0&&!(tn&6)&&gp();var t=tn;tn|=1;var r=na.transition,i=Cn;try{if(na.transition=null,Cn=1,e)return e()}finally{Cn=i,na.transition=r,tn=t,!(tn&6)&&Ku()}}function yk(){So=sp.current,Vn(sp)}function fh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,qW(r)),Ci!==null)for(r=Ci.return;r!==null;){var i=r;switch(KM(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&s1();break;case 3:jp(),Vn(io),Vn(ws),ok();break;case 5:sk(i);break;case 4:jp();break;case 13:Vn(ri);break;case 19:Vn(ri);break;case 10:tk(i.type._context);break;case 22:case 23:yk()}r=r.return}if(Gi=e,Ci=e=Ru(e.current,null),Ji=So=t,Ri=0,sv=null,pk=kw=wh=0,Js=Dy=null,nh!==null){for(t=0;t<nh.length;t++)if(r=nh[t],i=r.interleaved,i!==null){r.interleaved=null;var a=i.next,u=r.pending;if(u!==null){var h=u.next;u.next=a,i.next=h}r.pending=i}nh=null}return e}function wO(e,t){do{var r=Ci;try{if(ek(),R0.current=p1,f1){for(var i=si.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}f1=!1}if(_h=0,$i=Di=si=null,Ay=!1,rv=0,fk.current=null,r===null||r.return===null){Ri=1,sv=t,Ci=null;break}e:{var u=e,h=r.return,g=r,s=t;if(t=Ji,g.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var _=s,b=g,C=b.tag;if(!(b.mode&1)&&(C===0||C===11||C===15)){var M=b.alternate;M?(b.updateQueue=M.updateQueue,b.memoizedState=M.memoizedState,b.lanes=M.lanes):(b.updateQueue=null,b.memoizedState=null)}var D=YR(h);if(D!==null){D.flags&=-257,KR(D,h,g,u,t),D.mode&1&&XR(u,_,t),t=D,s=_;var N=t.updateQueue;if(N===null){var j=new Set;j.add(s),t.updateQueue=j}else N.add(s);break e}else{if(!(t&1)){XR(u,_,t),vk();break e}s=Error(Dt(426))}}else if(Hn&&g.mode&1){var V=YR(h);if(V!==null){!(V.flags&65536)&&(V.flags|=256),KR(V,h,g,u,t),QM(Lp(s,g));break e}}u=s=Lp(s,g),Ri!==4&&(Ri=2),Dy===null?Dy=[u]:Dy.push(u),u=h;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var B=iO(u,s,t);$R(u,B);break e;case 1:g=s;var z=u.type,U=u.stateNode;if(!(u.flags&128)&&(typeof z.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(Iu===null||!Iu.has(U)))){u.flags|=65536,t&=-t,u.lanes|=t;var Z=sO(u,g,t);$R(u,Z);break e}}u=u.return}while(u!==null)}EO(r)}catch(Q){t=Q,Ci===r&&r!==null&&(Ci=r=r.return);continue}break}while(!0)}function bO(){var e=m1.current;return m1.current=p1,e===null?p1:e}function vk(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),Gi===null||!(wh&268435455)&&!(kw&268435455)||pu(Gi,Ji)}function v1(e,t){var r=tn;tn|=2;var i=bO();(Gi!==e||Ji!==t)&&(rc=null,fh(e,t));do try{vG();break}catch(a){wO(e,a)}while(!0);if(ek(),tn=r,m1.current=i,Ci!==null)throw Error(Dt(261));return Gi=null,Ji=0,Ri}function vG(){for(;Ci!==null;)SO(Ci)}function xG(){for(;Ci!==null&&!W7();)SO(Ci)}function SO(e){var t=CO(e.alternate,e,So);e.memoizedProps=e.pendingProps,t===null?EO(e):Ci=t,fk.current=null}function EO(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hG(r,t),r!==null){r.flags&=32767,Ci=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ri=6,Ci=null;return}}else if(r=dG(r,t,So),r!==null){Ci=r;return}if(t=t.sibling,t!==null){Ci=t;return}Ci=t=e}while(t!==null);Ri===0&&(Ri=5)}function Yd(e,t,r){var i=Cn,a=na.transition;try{na.transition=null,Cn=1,_G(e,t,r,i)}finally{na.transition=a,Cn=i}return null}function _G(e,t,r,i){do gp();while(bu!==null);if(tn&6)throw Error(Dt(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Dt(177));e.callbackNode=null,e.callbackPriority=0;var u=r.lanes|r.childLanes;if(eW(e,u),e===Gi&&(Ci=Gi=null,Ji=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||i0||(i0=!0,MO(J0,function(){return gp(),null})),u=(r.flags&15990)!==0,r.subtreeFlags&15990||u){u=na.transition,na.transition=null;var h=Cn;Cn=1;var g=tn;tn|=4,fk.current=null,pG(e,r),vO(r,e),BW(ZT),t1=!!qT,ZT=qT=null,e.current=r,mG(r),G7(),tn=g,Cn=h,na.transition=u}else e.current=r;if(i0&&(i0=!1,bu=e,y1=a),u=e.pendingLanes,u===0&&(Iu=null),Z7(r.stateNode),oo(e,pi()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],i(a.value,{componentStack:a.stack,digest:a.digest});if(g1)throw g1=!1,e=pC,pC=null,e;return y1&1&&e.tag!==0&&gp(),u=e.pendingLanes,u&1?e===mC?Ry++:(Ry=0,mC=e):Ry=0,Ku(),null}function gp(){if(bu!==null){var e=i4(y1),t=na.transition,r=Cn;try{if(na.transition=null,Cn=16>e?16:e,bu===null)var i=!1;else{if(e=bu,bu=null,y1=0,tn&6)throw Error(Dt(331));var a=tn;for(tn|=4,er=e.current;er!==null;){var u=er,h=u.child;if(er.flags&16){var g=u.deletions;if(g!==null){for(var s=0;s<g.length;s++){var _=g[s];for(er=_;er!==null;){var b=er;switch(b.tag){case 0:case 11:case 15:Iy(8,b,u)}var C=b.child;if(C!==null)C.return=b,er=C;else for(;er!==null;){b=er;var M=b.sibling,D=b.return;if(mO(b),b===_){er=null;break}if(M!==null){M.return=D,er=M;break}er=D}}}var N=u.alternate;if(N!==null){var j=N.child;if(j!==null){N.child=null;do{var V=j.sibling;j.sibling=null,j=V}while(j!==null)}}er=u}}if(u.subtreeFlags&2064&&h!==null)h.return=u,er=h;else e:for(;er!==null;){if(u=er,u.flags&2048)switch(u.tag){case 0:case 11:case 15:Iy(9,u,u.return)}var B=u.sibling;if(B!==null){B.return=u.return,er=B;break e}er=u.return}}var z=e.current;for(er=z;er!==null;){h=er;var U=h.child;if(h.subtreeFlags&2064&&U!==null)U.return=h,er=U;else e:for(h=z;er!==null;){if(g=er,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Mw(9,g)}}catch(Q){di(g,g.return,Q)}if(g===h){er=null;break e}var Z=g.sibling;if(Z!==null){Z.return=g.return,er=Z;break e}er=g.return}}if(tn=a,Ku(),_l&&typeof _l.onPostCommitFiberRoot=="function")try{_l.onPostCommitFiberRoot(xw,e)}catch{}i=!0}return i}finally{Cn=r,na.transition=t}}return!1}function uN(e,t,r){t=Lp(r,t),t=iO(e,t,1),e=Au(e,t,1),t=js(),e!==null&&(jv(e,1,t),oo(e,t))}function di(e,t,r){if(e.tag===3)uN(e,e,r);else for(;t!==null;){if(t.tag===3){uN(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Iu===null||!Iu.has(i))){e=Lp(r,e),e=sO(t,e,1),t=Au(t,e,1),e=js(),t!==null&&(jv(t,1,e),oo(t,e));break}}t=t.return}}function wG(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=js(),e.pingedLanes|=e.suspendedLanes&r,Gi===e&&(Ji&r)===r&&(Ri===4||Ri===3&&(Ji&130023424)===Ji&&500>pi()-mk?fh(e,0):pk|=r),oo(e,t)}function TO(e,t){t===0&&(e.mode&1?(t=Z_,Z_<<=1,!(Z_&130023424)&&(Z_=4194304)):t=1);var r=js();e=gc(e,t),e!==null&&(jv(e,t,r),oo(e,r))}function bG(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),TO(e,r)}function SG(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Dt(314))}i!==null&&i.delete(t),TO(e,r)}var CO;CO=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||io.current)eo=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return eo=!1,uG(e,t,r);eo=!!(e.flags&131072)}else eo=!1,Hn&&t.flags&1048576&&A4(t,l1,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;j0(e,t),e=t.pendingProps;var a=Dp(t,ws.current);mp(t,r),a=lk(null,t,i,e,a,r);var u=ck();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,so(i)?(u=!0,o1(t)):u=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,nk(t),a.updater=Cw,t.stateNode=a,a._reactInternals=t,nC(t,i,e,r),t=oC(null,t,i,!0,u,r)):(t.tag=0,Hn&&u&&YM(t),ks(null,t,a,r),t=t.child),t;case 16:i=t.elementType;e:{switch(j0(e,t),e=t.pendingProps,a=i._init,i=a(i._payload),t.type=i,a=t.tag=TG(i),e=ja(i,e),a){case 0:t=sC(null,t,i,e,r);break e;case 1:t=eN(null,t,i,e,r);break e;case 11:t=QR(null,t,i,e,r);break e;case 14:t=JR(null,t,i,ja(i.type,e),r);break e}throw Error(Dt(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:ja(i,a),sC(e,t,i,a,r);case 1:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:ja(i,a),eN(e,t,i,a,r);case 3:e:{if(cO(t),e===null)throw Error(Dt(387));i=t.pendingProps,u=t.memoizedState,a=u.element,L4(e,t),d1(t,i,null,r);var h=t.memoizedState;if(i=h.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){a=Lp(Error(Dt(423)),t),t=tN(e,t,i,r,a);break e}else if(i!==a){a=Lp(Error(Dt(424)),t),t=tN(e,t,i,r,a);break e}else for(To=Pu(t.stateNode.containerInfo.firstChild),Mo=t,Hn=!0,Fa=null,r=N4(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Rp(),i===a){t=yc(e,t,r);break e}ks(e,t,i,r)}t=t.child}return t;case 5:return O4(t),e===null&&eC(t),i=t.type,a=t.pendingProps,u=e!==null?e.memoizedProps:null,h=a.children,XT(i,a)?h=null:u!==null&&XT(i,u)&&(t.flags|=32),lO(e,t),ks(e,t,h,r),t.child;case 6:return e===null&&eC(t),null;case 13:return uO(e,t,r);case 4:return ik(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Np(t,null,i,r):ks(e,t,i,r),t.child;case 11:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:ja(i,a),QR(e,t,i,a,r);case 7:return ks(e,t,t.pendingProps,r),t.child;case 8:return ks(e,t,t.pendingProps.children,r),t.child;case 12:return ks(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,u=t.memoizedProps,h=a.value,Ln(c1,i._currentValue),i._currentValue=h,u!==null)if($a(u.value,h)){if(u.children===a.children&&!io.current){t=yc(e,t,r);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var g=u.dependencies;if(g!==null){h=u.child;for(var s=g.firstContext;s!==null;){if(s.context===i){if(u.tag===1){s=uc(-1,r&-r),s.tag=2;var _=u.updateQueue;if(_!==null){_=_.shared;var b=_.pending;b===null?s.next=s:(s.next=b.next,b.next=s),_.pending=s}}u.lanes|=r,s=u.alternate,s!==null&&(s.lanes|=r),tC(u.return,r,t),g.lanes|=r;break}s=s.next}}else if(u.tag===10)h=u.type===t.type?null:u.child;else if(u.tag===18){if(h=u.return,h===null)throw Error(Dt(341));h.lanes|=r,g=h.alternate,g!==null&&(g.lanes|=r),tC(h,r,t),h=u.sibling}else h=u.child;if(h!==null)h.return=u;else for(h=u;h!==null;){if(h===t){h=null;break}if(u=h.sibling,u!==null){u.return=h.return,h=u;break}h=h.return}u=h}ks(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,mp(t,r),a=oa(a),i=i(a),t.flags|=1,ks(e,t,i,r),t.child;case 14:return i=t.type,a=ja(i,t.pendingProps),a=ja(i.type,a),JR(e,t,i,a,r);case 15:return oO(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:ja(i,a),j0(e,t),t.tag=1,so(i)?(e=!0,o1(t)):e=!1,mp(t,r),nO(t,i,a),nC(t,i,a,r),oC(null,t,i,!0,e,r);case 19:return dO(e,t,r);case 22:return aO(e,t,r)}throw Error(Dt(156,t.tag))};function MO(e,t){return e4(e,t)}function EG(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(e,t,r,i){return new EG(e,t,r,i)}function xk(e){return e=e.prototype,!(!e||!e.isReactComponent)}function TG(e){if(typeof e=="function")return xk(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zM)return 11;if(e===FM)return 14}return 2}function Ru(e,t){var r=e.alternate;return r===null?(r=ra(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function z0(e,t,r,i,a,u){var h=2;if(i=e,typeof e=="function")xk(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case Xf:return ph(r.children,a,u,t);case OM:h=8,a|=8;break;case MT:return e=ra(12,r,t,a|2),e.elementType=MT,e.lanes=u,e;case kT:return e=ra(13,r,t,a),e.elementType=kT,e.lanes=u,e;case PT:return e=ra(19,r,t,a),e.elementType=PT,e.lanes=u,e;case OL:return Pw(r,a,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jL:h=10;break e;case LL:h=9;break e;case zM:h=11;break e;case FM:h=14;break e;case uu:h=16,i=null;break e}throw Error(Dt(130,e==null?e:typeof e,""))}return t=ra(h,r,t,a),t.elementType=e,t.type=i,t.lanes=u,t}function ph(e,t,r,i){return e=ra(7,e,i,t),e.lanes=r,e}function Pw(e,t,r,i){return e=ra(22,e,i,t),e.elementType=OL,e.lanes=r,e.stateNode={isHidden:!1},e}function kE(e,t,r){return e=ra(6,e,null,t),e.lanes=r,e}function PE(e,t,r){return t=ra(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function CG(e,t,r,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cE(0),this.expirationTimes=cE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cE(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function _k(e,t,r,i,a,u,h,g,s){return e=new CG(e,t,r,g,s),t===1?(t=1,u===!0&&(t|=8)):t=0,u=ra(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},nk(u),e}function MG(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zf,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function kO(e){if(!e)return zu;e=e._reactInternals;e:{if(Rh(e)!==e||e.tag!==1)throw Error(Dt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(so(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Dt(171))}if(e.tag===1){var r=e.type;if(so(r))return k4(e,r,t)}return t}function PO(e,t,r,i,a,u,h,g,s){return e=_k(r,i,!0,e,a,u,h,g,s),e.context=kO(null),r=e.current,i=js(),a=Du(r),u=uc(i,a),u.callback=t??null,Au(r,u,a),e.current.lanes=a,jv(e,a,i),oo(e,i),e}function Aw(e,t,r,i){var a=t.current,u=js(),h=Du(a);return r=kO(r),t.context===null?t.context=r:t.pendingContext=r,t=uc(u,h),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Au(a,t,h),e!==null&&(Va(e,a,h,u),D0(e,a,h)),h}function x1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function dN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function wk(e,t){dN(e,t),(e=e.alternate)&&dN(e,t)}function kG(){return null}var AO=typeof reportError=="function"?reportError:function(e){console.error(e)};function bk(e){this._internalRoot=e}Iw.prototype.render=bk.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Dt(409));Aw(e,t,null,null)};Iw.prototype.unmount=bk.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;bh(function(){Aw(null,e,null,null)}),t[mc]=null}};function Iw(e){this._internalRoot=e}Iw.prototype.unstable_scheduleHydration=function(e){if(e){var t=a4();e={blockedOn:null,target:e,priority:t};for(var r=0;r<fu.length&&t!==0&&t<fu[r].priority;r++);fu.splice(r,0,e),r===0&&c4(e)}};function Sk(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hN(){}function PG(e,t,r,i,a){if(a){if(typeof i=="function"){var u=i;i=function(){var _=x1(h);u.call(_)}}var h=PO(t,i,e,0,null,!1,!1,"",hN);return e._reactRootContainer=h,e[mc]=h.current,Ky(e.nodeType===8?e.parentNode:e),bh(),h}for(;a=e.lastChild;)e.removeChild(a);if(typeof i=="function"){var g=i;i=function(){var _=x1(s);g.call(_)}}var s=_k(e,0,!1,null,null,!1,!1,"",hN);return e._reactRootContainer=s,e[mc]=s.current,Ky(e.nodeType===8?e.parentNode:e),bh(function(){Aw(t,s,r,i)}),s}function Rw(e,t,r,i,a){var u=r._reactRootContainer;if(u){var h=u;if(typeof a=="function"){var g=a;a=function(){var s=x1(h);g.call(s)}}Aw(t,h,e,a)}else h=PG(r,t,e,a,i);return x1(h)}s4=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=yy(t.pendingLanes);r!==0&&(VM(t,r|1),oo(t,pi()),!(tn&6)&&(Op=pi()+500,Ku()))}break;case 13:bh(function(){var i=gc(e,1);if(i!==null){var a=js();Va(i,e,1,a)}}),wk(e,1)}};$M=function(e){if(e.tag===13){var t=gc(e,134217728);if(t!==null){var r=js();Va(t,e,134217728,r)}wk(e,134217728)}};o4=function(e){if(e.tag===13){var t=Du(e),r=gc(e,t);if(r!==null){var i=js();Va(r,e,t,i)}wk(e,t)}};a4=function(){return Cn};l4=function(e,t){var r=Cn;try{return Cn=e,t()}finally{Cn=r}};FT=function(e,t,r){switch(t){case"input":if(DT(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var a=Sw(i);if(!a)throw Error(Dt(90));FL(i),DT(i,a)}}}break;case"textarea":UL(e,r);break;case"select":t=r.value,t!=null&&dp(e,!!r.multiple,t,!1)}};ZL=gk;XL=bh;var AG={usingClientEntryPoint:!1,Events:[Ov,Jf,Sw,HL,qL,gk]},ny={findFiberByHostInstance:rh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IG={bundleType:ny.bundleType,version:ny.version,rendererPackageName:ny.rendererPackageName,rendererConfig:ny.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ec.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=QL(e),e===null?null:e.stateNode},findFiberByHostInstance:ny.findFiberByHostInstance||kG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var s0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!s0.isDisabled&&s0.supportsFiber)try{xw=s0.inject(IG),_l=s0}catch{}}jo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AG;jo.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sk(t))throw Error(Dt(200));return MG(e,t,null,r)};jo.createRoot=function(e,t){if(!Sk(e))throw Error(Dt(299));var r=!1,i="",a=AO;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=_k(e,1,!1,null,null,r,!1,i,a),e[mc]=t.current,Ky(e.nodeType===8?e.parentNode:e),new bk(t)};jo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Dt(188)):(e=Object.keys(e).join(","),Error(Dt(268,e)));return e=QL(t),e=e===null?null:e.stateNode,e};jo.flushSync=function(e){return bh(e)};jo.hydrate=function(e,t,r){if(!Dw(t))throw Error(Dt(200));return Rw(null,e,t,!0,r)};jo.hydrateRoot=function(e,t,r){if(!Sk(e))throw Error(Dt(405));var i=r!=null&&r.hydratedSources||null,a=!1,u="",h=AO;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),t=PO(t,null,e,1,r??null,a,!1,u,h),e[mc]=t.current,Ky(e),i)for(e=0;e<i.length;e++)r=i[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Iw(t)};jo.render=function(e,t,r){if(!Dw(t))throw Error(Dt(200));return Rw(null,e,t,!1,r)};jo.unmountComponentAtNode=function(e){if(!Dw(e))throw Error(Dt(40));return e._reactRootContainer?(bh(function(){Rw(null,null,e,!1,function(){e._reactRootContainer=null,e[mc]=null})}),!0):!1};jo.unstable_batchedUpdates=gk;jo.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Dw(r))throw Error(Dt(200));if(e==null||e._reactInternals===void 0)throw Error(Dt(38));return Rw(e,t,r,!1,i)};jo.version="18.3.1-next-f1338f8080-20240426";function IO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IO)}catch(e){console.error(e)}}IO(),IL.exports=jo;var rm=IL.exports;const Ek=PM(rm);var fN=rm;TT.createRoot=fN.createRoot,TT.hydrateRoot=fN.hydrateRoot;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ov(){return ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},ov.apply(this,arguments)}var Su;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Su||(Su={}));const pN="popstate";function DG(e){e===void 0&&(e={});function t(i,a){let{pathname:u,search:h,hash:g}=i.location;return vC("",{pathname:u,search:h,hash:g},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(i,a){return typeof a=="string"?a:_1(a)}return NG(t,r,null,e)}function gi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function DO(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function RG(){return Math.random().toString(36).substr(2,8)}function mN(e,t){return{usr:e.state,key:e.key,idx:t}}function vC(e,t,r,i){return r===void 0&&(r=null),ov({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?nm(t):t,{state:r,key:t&&t.key||i||RG()})}function _1(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function nm(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function NG(e,t,r,i){i===void 0&&(i={});let{window:a=document.defaultView,v5Compat:u=!1}=i,h=a.history,g=Su.Pop,s=null,_=b();_==null&&(_=0,h.replaceState(ov({},h.state,{idx:_}),""));function b(){return(h.state||{idx:null}).idx}function C(){g=Su.Pop;let V=b(),B=V==null?null:V-_;_=V,s&&s({action:g,location:j.location,delta:B})}function M(V,B){g=Su.Push;let z=vC(j.location,V,B);_=b()+1;let U=mN(z,_),Z=j.createHref(z);try{h.pushState(U,"",Z)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;a.location.assign(Z)}u&&s&&s({action:g,location:j.location,delta:1})}function D(V,B){g=Su.Replace;let z=vC(j.location,V,B);_=b();let U=mN(z,_),Z=j.createHref(z);h.replaceState(U,"",Z),u&&s&&s({action:g,location:j.location,delta:0})}function N(V){let B=a.location.origin!=="null"?a.location.origin:a.location.href,z=typeof V=="string"?V:_1(V);return z=z.replace(/ $/,"%20"),gi(B,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,B)}let j={get action(){return g},get location(){return e(a,h)},listen(V){if(s)throw new Error("A history only accepts one active listener");return a.addEventListener(pN,C),s=V,()=>{a.removeEventListener(pN,C),s=null}},createHref(V){return t(a,V)},createURL:N,encodeLocation(V){let B=N(V);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:M,replace:D,go(V){return h.go(V)}};return j}var gN;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(gN||(gN={}));function jG(e,t,r){return r===void 0&&(r="/"),LG(e,t,r,!1)}function LG(e,t,r,i){let a=typeof t=="string"?nm(t):t,u=Tk(a.pathname||"/",r);if(u==null)return null;let h=RO(e);OG(h);let g=null;for(let s=0;g==null&&s<h.length;++s){let _=ZG(u);g=HG(h[s],_,i)}return g}function RO(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let a=(u,h,g)=>{let s={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};s.relativePath.startsWith("/")&&(gi(s.relativePath.startsWith(i),'Absolute route path "'+s.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),s.relativePath=s.relativePath.slice(i.length));let _=Nu([i,s.relativePath]),b=r.concat(s);u.children&&u.children.length>0&&(gi(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),RO(u.children,t,b,_)),!(u.path==null&&!u.index)&&t.push({path:_,score:WG(_,u.index),routesMeta:b})};return e.forEach((u,h)=>{var g;if(u.path===""||!((g=u.path)!=null&&g.includes("?")))a(u,h);else for(let s of NO(u.path))a(u,h,s)}),t}function NO(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,a=r.endsWith("?"),u=r.replace(/\?$/,"");if(i.length===0)return a?[u,""]:[u];let h=NO(i.join("/")),g=[];return g.push(...h.map(s=>s===""?u:[u,s].join("/"))),a&&g.push(...h),g.map(s=>e.startsWith("/")&&s===""?"/":s)}function OG(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:GG(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const zG=/^:[\w-]+$/,FG=3,BG=2,UG=1,VG=10,$G=-2,yN=e=>e==="*";function WG(e,t){let r=e.split("/"),i=r.length;return r.some(yN)&&(i+=$G),t&&(i+=BG),r.filter(a=>!yN(a)).reduce((a,u)=>a+(zG.test(u)?FG:u===""?UG:VG),i)}function GG(e,t){return e.length===t.length&&e.slice(0,-1).every((i,a)=>i===t[a])?e[e.length-1]-t[t.length-1]:0}function HG(e,t,r){let{routesMeta:i}=e,a={},u="/",h=[];for(let g=0;g<i.length;++g){let s=i[g],_=g===i.length-1,b=u==="/"?t:t.slice(u.length)||"/",C=vN({path:s.relativePath,caseSensitive:s.caseSensitive,end:_},b),M=s.route;if(!C&&_&&r&&!i[i.length-1].route.index&&(C=vN({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},b)),!C)return null;Object.assign(a,C.params),h.push({params:a,pathname:Nu([u,C.pathname]),pathnameBase:QG(Nu([u,C.pathnameBase])),route:M}),C.pathnameBase!=="/"&&(u=Nu([u,C.pathnameBase]))}return h}function vN(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=qG(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let u=a[0],h=u.replace(/(.)\/+$/,"$1"),g=a.slice(1);return{params:i.reduce((_,b,C)=>{let{paramName:M,isOptional:D}=b;if(M==="*"){let j=g[C]||"";h=u.slice(0,u.length-j.length).replace(/(.)\/+$/,"$1")}const N=g[C];return D&&!N?_[M]=void 0:_[M]=(N||"").replace(/%2F/g,"/"),_},{}),pathname:u,pathnameBase:h,pattern:e}}function qG(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),DO(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,g,s)=>(i.push({paramName:g,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function ZG(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return DO(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Tk(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function XG(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:a=""}=typeof e=="string"?nm(e):e;return{pathname:r?r.startsWith("/")?r:YG(r,t):t,search:JG(i),hash:eH(a)}}function YG(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function AE(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function KG(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Ck(e,t){let r=KG(e);return t?r.map((i,a)=>a===r.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function Mk(e,t,r,i){i===void 0&&(i=!1);let a;typeof e=="string"?a=nm(e):(a=ov({},e),gi(!a.pathname||!a.pathname.includes("?"),AE("?","pathname","search",a)),gi(!a.pathname||!a.pathname.includes("#"),AE("#","pathname","hash",a)),gi(!a.search||!a.search.includes("#"),AE("#","search","hash",a)));let u=e===""||a.pathname==="",h=u?"/":a.pathname,g;if(h==null)g=r;else{let C=t.length-1;if(!i&&h.startsWith("..")){let M=h.split("/");for(;M[0]==="..";)M.shift(),C-=1;a.pathname=M.join("/")}g=C>=0?t[C]:"/"}let s=XG(a,g),_=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&r.endsWith("/");return!s.pathname.endsWith("/")&&(_||b)&&(s.pathname+="/"),s}const Nu=e=>e.join("/").replace(/\/\/+/g,"/"),QG=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),JG=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eH=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tH(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const jO=["post","put","patch","delete"];new Set(jO);const rH=["get",...jO];new Set(rH);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},av.apply(this,arguments)}const kk=A.createContext(null),nH=A.createContext(null),Qu=A.createContext(null),Nw=A.createContext(null),Ju=A.createContext({outlet:null,matches:[],isDataRoute:!1}),LO=A.createContext(null);function iH(e,t){let{relative:r}=t===void 0?{}:t;im()||gi(!1);let{basename:i,navigator:a}=A.useContext(Qu),{hash:u,pathname:h,search:g}=zO(e,{relative:r}),s=h;return i!=="/"&&(s=h==="/"?i:Nu([i,h])),a.createHref({pathname:s,search:g,hash:u})}function im(){return A.useContext(Nw)!=null}function la(){return im()||gi(!1),A.useContext(Nw).location}function OO(e){A.useContext(Qu).static||A.useLayoutEffect(e)}function Tc(){let{isDataRoute:e}=A.useContext(Ju);return e?yH():sH()}function sH(){im()||gi(!1);let e=A.useContext(kk),{basename:t,future:r,navigator:i}=A.useContext(Qu),{matches:a}=A.useContext(Ju),{pathname:u}=la(),h=JSON.stringify(Ck(a,r.v7_relativeSplatPath)),g=A.useRef(!1);return OO(()=>{g.current=!0}),A.useCallback(function(_,b){if(b===void 0&&(b={}),!g.current)return;if(typeof _=="number"){i.go(_);return}let C=Mk(_,JSON.parse(h),u,b.relative==="path");e==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Nu([t,C.pathname])),(b.replace?i.replace:i.push)(C,b.state,b)},[t,i,h,u,e])}function zO(e,t){let{relative:r}=t===void 0?{}:t,{future:i}=A.useContext(Qu),{matches:a}=A.useContext(Ju),{pathname:u}=la(),h=JSON.stringify(Ck(a,i.v7_relativeSplatPath));return A.useMemo(()=>Mk(e,JSON.parse(h),u,r==="path"),[e,h,u,r])}function oH(e,t){return aH(e,t)}function aH(e,t,r,i){im()||gi(!1);let{navigator:a}=A.useContext(Qu),{matches:u}=A.useContext(Ju),h=u[u.length-1],g=h?h.params:{};h&&h.pathname;let s=h?h.pathnameBase:"/";h&&h.route;let _=la(),b;if(t){var C;let V=typeof t=="string"?nm(t):t;s==="/"||(C=V.pathname)!=null&&C.startsWith(s)||gi(!1),b=V}else b=_;let M=b.pathname||"/",D=M;if(s!=="/"){let V=s.replace(/^\//,"").split("/");D="/"+M.replace(/^\//,"").split("/").slice(V.length).join("/")}let N=jG(e,{pathname:D}),j=hH(N&&N.map(V=>Object.assign({},V,{params:Object.assign({},g,V.params),pathname:Nu([s,a.encodeLocation?a.encodeLocation(V.pathname).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?s:Nu([s,a.encodeLocation?a.encodeLocation(V.pathnameBase).pathname:V.pathnameBase])})),u,r,i);return t&&j?A.createElement(Nw.Provider,{value:{location:av({pathname:"/",search:"",hash:"",state:null,key:"default"},b),navigationType:Su.Pop}},j):j}function lH(){let e=gH(),t=tH(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),r?A.createElement("pre",{style:a},r):null,null)}const cH=A.createElement(lH,null);class uH extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?A.createElement(Ju.Provider,{value:this.props.routeContext},A.createElement(LO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dH(e){let{routeContext:t,match:r,children:i}=e,a=A.useContext(kk);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),A.createElement(Ju.Provider,{value:t},i)}function hH(e,t,r,i){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),i===void 0&&(i=null),e==null){var u;if(!r)return null;if(r.errors)e=r.matches;else if((u=i)!=null&&u.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let h=e,g=(a=r)==null?void 0:a.errors;if(g!=null){let b=h.findIndex(C=>C.route.id&&(g==null?void 0:g[C.route.id])!==void 0);b>=0||gi(!1),h=h.slice(0,Math.min(h.length,b+1))}let s=!1,_=-1;if(r&&i&&i.v7_partialHydration)for(let b=0;b<h.length;b++){let C=h[b];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(_=b),C.route.id){let{loaderData:M,errors:D}=r,N=C.route.loader&&M[C.route.id]===void 0&&(!D||D[C.route.id]===void 0);if(C.route.lazy||N){s=!0,_>=0?h=h.slice(0,_+1):h=[h[0]];break}}}return h.reduceRight((b,C,M)=>{let D,N=!1,j=null,V=null;r&&(D=g&&C.route.id?g[C.route.id]:void 0,j=C.route.errorElement||cH,s&&(_<0&&M===0?(N=!0,V=null):_===M&&(N=!0,V=C.route.hydrateFallbackElement||null)));let B=t.concat(h.slice(0,M+1)),z=()=>{let U;return D?U=j:N?U=V:C.route.Component?U=A.createElement(C.route.Component,null):C.route.element?U=C.route.element:U=b,A.createElement(dH,{match:C,routeContext:{outlet:b,matches:B,isDataRoute:r!=null},children:U})};return r&&(C.route.ErrorBoundary||C.route.errorElement||M===0)?A.createElement(uH,{location:r.location,revalidation:r.revalidation,component:j,error:D,children:z(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):z()},null)}var FO=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(FO||{}),w1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(w1||{});function fH(e){let t=A.useContext(kk);return t||gi(!1),t}function pH(e){let t=A.useContext(nH);return t||gi(!1),t}function mH(e){let t=A.useContext(Ju);return t||gi(!1),t}function BO(e){let t=mH(),r=t.matches[t.matches.length-1];return r.route.id||gi(!1),r.route.id}function gH(){var e;let t=A.useContext(LO),r=pH(w1.UseRouteError),i=BO(w1.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[i]}function yH(){let{router:e}=fH(FO.UseNavigateStable),t=BO(w1.UseNavigateStable),r=A.useRef(!1);return OO(()=>{r.current=!0}),A.useCallback(function(a,u){u===void 0&&(u={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,av({fromRouteId:t},u)))},[e,t])}function IE(e){let{to:t,replace:r,state:i,relative:a}=e;im()||gi(!1);let{future:u,static:h}=A.useContext(Qu),{matches:g}=A.useContext(Ju),{pathname:s}=la(),_=Tc(),b=Mk(t,Ck(g,u.v7_relativeSplatPath),s,a==="path"),C=JSON.stringify(b);return A.useEffect(()=>_(JSON.parse(C),{replace:r,state:i,relative:a}),[_,C,a,r,i]),null}function Jl(e){gi(!1)}function vH(e){let{basename:t="/",children:r=null,location:i,navigationType:a=Su.Pop,navigator:u,static:h=!1,future:g}=e;im()&&gi(!1);let s=t.replace(/^\/*/,"/"),_=A.useMemo(()=>({basename:s,navigator:u,static:h,future:av({v7_relativeSplatPath:!1},g)}),[s,g,u,h]);typeof i=="string"&&(i=nm(i));let{pathname:b="/",search:C="",hash:M="",state:D=null,key:N="default"}=i,j=A.useMemo(()=>{let V=Tk(b,s);return V==null?null:{location:{pathname:V,search:C,hash:M,state:D,key:N},navigationType:a}},[s,b,C,M,D,N,a]);return j==null?null:A.createElement(Qu.Provider,{value:_},A.createElement(Nw.Provider,{children:r,value:j}))}function xH(e){let{children:t,location:r}=e;return oH(xC(t),r)}new Promise(()=>{});function xC(e,t){t===void 0&&(t=[]);let r=[];return A.Children.forEach(e,(i,a)=>{if(!A.isValidElement(i))return;let u=[...t,a];if(i.type===A.Fragment){r.push.apply(r,xC(i.props.children,u));return}i.type!==Jl&&gi(!1),!i.props.index||!i.props.children||gi(!1);let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=xC(i.props.children,u)),r.push(h)}),r}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _C(){return _C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_C.apply(this,arguments)}function _H(e,t){if(e==null)return{};var r={},i=Object.keys(e),a,u;for(u=0;u<i.length;u++)a=i[u],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function wH(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bH(e,t){return e.button===0&&(!t||t==="_self")&&!wH(e)}const SH=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],EH="6";try{window.__reactRouterVersion=EH}catch{}const TH="startTransition",xN=PL[TH];function CH(e){let{basename:t,children:r,future:i,window:a}=e,u=A.useRef();u.current==null&&(u.current=DG({window:a,v5Compat:!0}));let h=u.current,[g,s]=A.useState({action:h.action,location:h.location}),{v7_startTransition:_}=i||{},b=A.useCallback(C=>{_&&xN?xN(()=>s(C)):s(C)},[s,_]);return A.useLayoutEffect(()=>h.listen(b),[h,b]),A.createElement(vH,{basename:t,children:r,location:g.location,navigationType:g.action,navigator:h,future:i})}const MH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ta=A.forwardRef(function(t,r){let{onClick:i,relative:a,reloadDocument:u,replace:h,state:g,target:s,to:_,preventScrollReset:b,viewTransition:C}=t,M=_H(t,SH),{basename:D}=A.useContext(Qu),N,j=!1;if(typeof _=="string"&&kH.test(_)&&(N=_,MH))try{let U=new URL(window.location.href),Z=_.startsWith("//")?new URL(U.protocol+_):new URL(_),Q=Tk(Z.pathname,D);Z.origin===U.origin&&Q!=null?_=Q+Z.search+Z.hash:j=!0}catch{}let V=iH(_,{relative:a}),B=PH(_,{replace:h,state:g,target:s,preventScrollReset:b,relative:a,viewTransition:C});function z(U){i&&i(U),U.defaultPrevented||B(U)}return A.createElement("a",_C({},M,{href:N||V,onClick:j||u?i:z,ref:r,target:s}))});var _N;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_N||(_N={}));var wN;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(wN||(wN={}));function PH(e,t){let{target:r,replace:i,state:a,preventScrollReset:u,relative:h,viewTransition:g}=t===void 0?{}:t,s=Tc(),_=la(),b=zO(e,{relative:h});return A.useCallback(C=>{if(bH(C,r)){C.preventDefault();let M=i!==void 0?i:_1(_)===_1(b);s(e,{replace:M,state:a,preventScrollReset:u,relative:h,viewTransition:g})}},[_,s,b,i,a,r,e,u,h,g])}var jw=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Lw=typeof window>"u"||"Deno"in globalThis;function La(){}function AH(e,t){return typeof e=="function"?e(t):e}function IH(e){return typeof e=="number"&&e>=0&&e!==1/0}function DH(e,t){return Math.max(e+(t||0)-Date.now(),0)}function bN(e,t){return typeof e=="function"?e(t):e}function RH(e,t){return typeof e=="function"?e(t):e}function SN(e,t){const{type:r="all",exact:i,fetchStatus:a,predicate:u,queryKey:h,stale:g}=e;if(h){if(i){if(t.queryHash!==Pk(h,t.options))return!1}else if(!cv(t.queryKey,h))return!1}if(r!=="all"){const s=t.isActive();if(r==="active"&&!s||r==="inactive"&&s)return!1}return!(typeof g=="boolean"&&t.isStale()!==g||a&&a!==t.state.fetchStatus||u&&!u(t))}function EN(e,t){const{exact:r,status:i,predicate:a,mutationKey:u}=e;if(u){if(!t.options.mutationKey)return!1;if(r){if(lv(t.options.mutationKey)!==lv(u))return!1}else if(!cv(t.options.mutationKey,u))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function Pk(e,t){return((t==null?void 0:t.queryKeyHashFn)||lv)(e)}function lv(e){return JSON.stringify(e,(t,r)=>wC(r)?Object.keys(r).sort().reduce((i,a)=>(i[a]=r[a],i),{}):r)}function cv(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!cv(e[r],t[r])):!1}function UO(e,t){if(e===t)return e;const r=TN(e)&&TN(t);if(r||wC(e)&&wC(t)){const i=r?e:Object.keys(e),a=i.length,u=r?t:Object.keys(t),h=u.length,g=r?[]:{};let s=0;for(let _=0;_<h;_++){const b=r?_:u[_];(!r&&i.includes(b)||r)&&e[b]===void 0&&t[b]===void 0?(g[b]=void 0,s++):(g[b]=UO(e[b],t[b]),g[b]===e[b]&&e[b]!==void 0&&s++)}return a===h&&s===a?e:g}return t}function TN(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function wC(e){if(!CN(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!CN(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function CN(e){return Object.prototype.toString.call(e)==="[object Object]"}function NH(e){return new Promise(t=>{setTimeout(t,e)})}function jH(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?UO(e,t):t}function LH(e,t,r=0){const i=[...e,t];return r&&i.length>r?i.slice(1):i}function OH(e,t,r=0){const i=[t,...e];return r&&i.length>r?i.slice(0,-1):i}var Ak=Symbol();function VO(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Ak?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ch,gu,bp,dL,zH=(dL=class extends jw{constructor(){super();wn(this,ch);wn(this,gu);wn(this,bp);Br(this,bp,t=>{if(!Lw&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){vt(this,gu)||this.setEventListener(vt(this,bp))}onUnsubscribe(){var t;this.hasListeners()||((t=vt(this,gu))==null||t.call(this),Br(this,gu,void 0))}setEventListener(t){var r;Br(this,bp,t),(r=vt(this,gu))==null||r.call(this),Br(this,gu,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){vt(this,ch)!==t&&(Br(this,ch,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof vt(this,ch)=="boolean"?vt(this,ch):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ch=new WeakMap,gu=new WeakMap,bp=new WeakMap,dL),$O=new zH,Sp,yu,Ep,hL,FH=(hL=class extends jw{constructor(){super();wn(this,Sp,!0);wn(this,yu);wn(this,Ep);Br(this,Ep,t=>{if(!Lw&&window.addEventListener){const r=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",i)}}})}onSubscribe(){vt(this,yu)||this.setEventListener(vt(this,Ep))}onUnsubscribe(){var t;this.hasListeners()||((t=vt(this,yu))==null||t.call(this),Br(this,yu,void 0))}setEventListener(t){var r;Br(this,Ep,t),(r=vt(this,yu))==null||r.call(this),Br(this,yu,t(this.setOnline.bind(this)))}setOnline(t){vt(this,Sp)!==t&&(Br(this,Sp,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return vt(this,Sp)}},Sp=new WeakMap,yu=new WeakMap,Ep=new WeakMap,hL),b1=new FH;function BH(){let e,t;const r=new Promise((a,u)=>{e=a,t=u});r.status="pending",r.catch(()=>{});function i(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{i({status:"fulfilled",value:a}),e(a)},r.reject=a=>{i({status:"rejected",reason:a}),t(a)},r}function UH(e){return Math.min(1e3*2**e,3e4)}function WO(e){return(e??"online")==="online"?b1.isOnline():!0}var GO=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function DE(e){return e instanceof GO}function HO(e){let t=!1,r=0,i=!1,a;const u=BH(),h=j=>{var V;i||(M(new GO(j)),(V=e.abort)==null||V.call(e))},g=()=>{t=!0},s=()=>{t=!1},_=()=>$O.isFocused()&&(e.networkMode==="always"||b1.isOnline())&&e.canRun(),b=()=>WO(e.networkMode)&&e.canRun(),C=j=>{var V;i||(i=!0,(V=e.onSuccess)==null||V.call(e,j),a==null||a(),u.resolve(j))},M=j=>{var V;i||(i=!0,(V=e.onError)==null||V.call(e,j),a==null||a(),u.reject(j))},D=()=>new Promise(j=>{var V;a=B=>{(i||_())&&j(B)},(V=e.onPause)==null||V.call(e)}).then(()=>{var j;a=void 0,i||(j=e.onContinue)==null||j.call(e)}),N=()=>{if(i)return;let j;const V=r===0?e.initialPromise:void 0;try{j=V??e.fn()}catch(B){j=Promise.reject(B)}Promise.resolve(j).then(C).catch(B=>{var re;if(i)return;const z=e.retry??(Lw?0:3),U=e.retryDelay??UH,Z=typeof U=="function"?U(r,B):U,Q=z===!0||typeof z=="number"&&r<z||typeof z=="function"&&z(r,B);if(t||!Q){M(B);return}r++,(re=e.onFail)==null||re.call(e,r,B),NH(Z).then(()=>_()?void 0:D()).then(()=>{t?M(B):N()})})};return{promise:u,cancel:h,continue:()=>(a==null||a(),u),cancelRetry:g,continueRetry:s,canStart:b,start:()=>(b()?N():D().then(N),u)}}function VH(){let e=[],t=0,r=g=>{g()},i=g=>{g()},a=g=>setTimeout(g,0);const u=g=>{t?e.push(g):a(()=>{r(g)})},h=()=>{const g=e;e=[],g.length&&a(()=>{i(()=>{g.forEach(s=>{r(s)})})})};return{batch:g=>{let s;t++;try{s=g()}finally{t--,t||h()}return s},batchCalls:g=>(...s)=>{u(()=>{g(...s)})},schedule:u,setNotifyFunction:g=>{r=g},setBatchNotifyFunction:g=>{i=g},setScheduler:g=>{a=g}}}var Is=VH(),uh,fL,qO=(fL=class{constructor(){wn(this,uh)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),IH(this.gcTime)&&Br(this,uh,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Lw?1/0:5*60*1e3))}clearGcTimeout(){vt(this,uh)&&(clearTimeout(vt(this,uh)),Br(this,uh,void 0))}},uh=new WeakMap,fL),Tp,Cp,Ko,fs,Dv,dh,Oa,ec,pL,$H=(pL=class extends qO{constructor(t){super();wn(this,Oa);wn(this,Tp);wn(this,Cp);wn(this,Ko);wn(this,fs);wn(this,Dv);wn(this,dh);Br(this,dh,!1),Br(this,Dv,t.defaultOptions),this.setOptions(t.options),this.observers=[],Br(this,Ko,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Br(this,Tp,GH(this.options)),this.state=t.state??vt(this,Tp),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=vt(this,fs))==null?void 0:t.promise}setOptions(t){this.options={...vt(this,Dv),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&vt(this,Ko).remove(this)}setData(t,r){const i=jH(this.state.data,t,this.options);return us(this,Oa,ec).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(t,r){us(this,Oa,ec).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var i,a;const r=(i=vt(this,fs))==null?void 0:i.promise;return(a=vt(this,fs))==null||a.cancel(t),r?r.then(La).catch(La):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(vt(this,Tp))}isActive(){return this.observers.some(t=>RH(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ak||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!DH(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=vt(this,fs))==null||r.continue()}onOnline(){var r;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=vt(this,fs))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),vt(this,Ko).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(vt(this,fs)&&(vt(this,dh)?vt(this,fs).cancel({revert:!0}):vt(this,fs).cancelRetry()),this.scheduleGc()),vt(this,Ko).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||us(this,Oa,ec).call(this,{type:"invalidate"})}fetch(t,r){var s,_,b;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(vt(this,fs))return vt(this,fs).continueRetry(),vt(this,fs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const C=this.observers.find(M=>M.options.queryFn);C&&this.setOptions(C.options)}const i=new AbortController,a=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(Br(this,dh,!0),i.signal)})},u=()=>{const C=VO(this.options,r),M={queryKey:this.queryKey,meta:this.meta};return a(M),Br(this,dh,!1),this.options.persister?this.options.persister(C,M,this):C(M)},h={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:u};a(h),(s=this.options.behavior)==null||s.onFetch(h,this),Br(this,Cp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((_=h.fetchOptions)==null?void 0:_.meta))&&us(this,Oa,ec).call(this,{type:"fetch",meta:(b=h.fetchOptions)==null?void 0:b.meta});const g=C=>{var M,D,N,j;DE(C)&&C.silent||us(this,Oa,ec).call(this,{type:"error",error:C}),DE(C)||((D=(M=vt(this,Ko).config).onError)==null||D.call(M,C,this),(j=(N=vt(this,Ko).config).onSettled)==null||j.call(N,this.state.data,C,this)),this.scheduleGc()};return Br(this,fs,HO({initialPromise:r==null?void 0:r.initialPromise,fn:h.fetchFn,abort:i.abort.bind(i),onSuccess:C=>{var M,D,N,j;if(C===void 0){g(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(C)}catch(V){g(V);return}(D=(M=vt(this,Ko).config).onSuccess)==null||D.call(M,C,this),(j=(N=vt(this,Ko).config).onSettled)==null||j.call(N,C,this.state.error,this),this.scheduleGc()},onError:g,onFail:(C,M)=>{us(this,Oa,ec).call(this,{type:"failed",failureCount:C,error:M})},onPause:()=>{us(this,Oa,ec).call(this,{type:"pause"})},onContinue:()=>{us(this,Oa,ec).call(this,{type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0})),vt(this,fs).start()}},Tp=new WeakMap,Cp=new WeakMap,Ko=new WeakMap,fs=new WeakMap,Dv=new WeakMap,dh=new WeakMap,Oa=new WeakSet,ec=function(t){const r=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...WH(i.data,this.options),fetchMeta:t.meta??null};case"success":return{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return DE(a)&&a.revert&&vt(this,Cp)?{...vt(this,Cp),fetchStatus:"idle"}:{...i,error:a,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=r(this.state),Is.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),vt(this,Ko).notify({query:this,type:"updated",action:t})})},pL);function WH(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:WO(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function GH(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,i=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var fl,mL,HH=(mL=class extends jw{constructor(t={}){super();wn(this,fl);this.config=t,Br(this,fl,new Map)}build(t,r,i){const a=r.queryKey,u=r.queryHash??Pk(a,r);let h=this.get(u);return h||(h=new $H({cache:this,queryKey:a,queryHash:u,options:t.defaultQueryOptions(r),state:i,defaultOptions:t.getQueryDefaults(a)}),this.add(h)),h}add(t){vt(this,fl).has(t.queryHash)||(vt(this,fl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=vt(this,fl).get(t.queryHash);r&&(t.destroy(),r===t&&vt(this,fl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Is.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return vt(this,fl).get(t)}getAll(){return[...vt(this,fl).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(i=>SN(r,i))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(i=>SN(t,i)):r}notify(t){Is.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Is.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Is.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fl=new WeakMap,mL),pl,Cs,hh,ml,au,gL,qH=(gL=class extends qO{constructor(t){super();wn(this,ml);wn(this,pl);wn(this,Cs);wn(this,hh);this.mutationId=t.mutationId,Br(this,Cs,t.mutationCache),Br(this,pl,[]),this.state=t.state||ZH(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){vt(this,pl).includes(t)||(vt(this,pl).push(t),this.clearGcTimeout(),vt(this,Cs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Br(this,pl,vt(this,pl).filter(r=>r!==t)),this.scheduleGc(),vt(this,Cs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){vt(this,pl).length||(this.state.status==="pending"?this.scheduleGc():vt(this,Cs).remove(this))}continue(){var t;return((t=vt(this,hh))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,u,h,g,s,_,b,C,M,D,N,j,V,B,z,U,Z,Q,re,oe;Br(this,hh,HO({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(pe,ve)=>{us(this,ml,au).call(this,{type:"failed",failureCount:pe,error:ve})},onPause:()=>{us(this,ml,au).call(this,{type:"pause"})},onContinue:()=>{us(this,ml,au).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>vt(this,Cs).canRun(this)}));const r=this.state.status==="pending",i=!vt(this,hh).canStart();try{if(!r){us(this,ml,au).call(this,{type:"pending",variables:t,isPaused:i}),await((u=(a=vt(this,Cs).config).onMutate)==null?void 0:u.call(a,t,this));const ve=await((g=(h=this.options).onMutate)==null?void 0:g.call(h,t));ve!==this.state.context&&us(this,ml,au).call(this,{type:"pending",context:ve,variables:t,isPaused:i})}const pe=await vt(this,hh).start();return await((_=(s=vt(this,Cs).config).onSuccess)==null?void 0:_.call(s,pe,t,this.state.context,this)),await((C=(b=this.options).onSuccess)==null?void 0:C.call(b,pe,t,this.state.context)),await((D=(M=vt(this,Cs).config).onSettled)==null?void 0:D.call(M,pe,null,this.state.variables,this.state.context,this)),await((j=(N=this.options).onSettled)==null?void 0:j.call(N,pe,null,t,this.state.context)),us(this,ml,au).call(this,{type:"success",data:pe}),pe}catch(pe){try{throw await((B=(V=vt(this,Cs).config).onError)==null?void 0:B.call(V,pe,t,this.state.context,this)),await((U=(z=this.options).onError)==null?void 0:U.call(z,pe,t,this.state.context)),await((Q=(Z=vt(this,Cs).config).onSettled)==null?void 0:Q.call(Z,void 0,pe,this.state.variables,this.state.context,this)),await((oe=(re=this.options).onSettled)==null?void 0:oe.call(re,void 0,pe,t,this.state.context)),pe}finally{us(this,ml,au).call(this,{type:"error",error:pe})}}finally{vt(this,Cs).runNext(this)}}},pl=new WeakMap,Cs=new WeakMap,hh=new WeakMap,ml=new WeakSet,au=function(t){const r=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Is.batch(()=>{vt(this,pl).forEach(i=>{i.onMutationUpdate(t)}),vt(this,Cs).notify({mutation:this,type:"updated",action:t})})},gL);function ZH(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var wo,Rv,yL,XH=(yL=class extends jw{constructor(t={}){super();wn(this,wo);wn(this,Rv);this.config=t,Br(this,wo,new Map),Br(this,Rv,Date.now())}build(t,r,i){const a=new qH({mutationCache:this,mutationId:++V_(this,Rv)._,options:t.defaultMutationOptions(r),state:i});return this.add(a),a}add(t){const r=o0(t),i=vt(this,wo).get(r)??[];i.push(t),vt(this,wo).set(r,i),this.notify({type:"added",mutation:t})}remove(t){var i;const r=o0(t);if(vt(this,wo).has(r)){const a=(i=vt(this,wo).get(r))==null?void 0:i.filter(u=>u!==t);a&&(a.length===0?vt(this,wo).delete(r):vt(this,wo).set(r,a))}this.notify({type:"removed",mutation:t})}canRun(t){var i;const r=(i=vt(this,wo).get(o0(t)))==null?void 0:i.find(a=>a.state.status==="pending");return!r||r===t}runNext(t){var i;const r=(i=vt(this,wo).get(o0(t)))==null?void 0:i.find(a=>a!==t&&a.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){Is.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...vt(this,wo).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(i=>EN(r,i))}findAll(t={}){return this.getAll().filter(r=>EN(t,r))}notify(t){Is.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Is.batch(()=>Promise.all(t.map(r=>r.continue().catch(La))))}},wo=new WeakMap,Rv=new WeakMap,yL);function o0(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function MN(e){return{onFetch:(t,r)=>{var b,C,M,D,N;const i=t.options,a=(M=(C=(b=t.fetchOptions)==null?void 0:b.meta)==null?void 0:C.fetchMore)==null?void 0:M.direction,u=((D=t.state.data)==null?void 0:D.pages)||[],h=((N=t.state.data)==null?void 0:N.pageParams)||[];let g={pages:[],pageParams:[]},s=0;const _=async()=>{let j=!1;const V=U=>{Object.defineProperty(U,"signal",{enumerable:!0,get:()=>(t.signal.aborted?j=!0:t.signal.addEventListener("abort",()=>{j=!0}),t.signal)})},B=VO(t.options,t.fetchOptions),z=async(U,Z,Q)=>{if(j)return Promise.reject();if(Z==null&&U.pages.length)return Promise.resolve(U);const re={queryKey:t.queryKey,pageParam:Z,direction:Q?"backward":"forward",meta:t.options.meta};V(re);const oe=await B(re),{maxPages:pe}=t.options,ve=Q?OH:LH;return{pages:ve(U.pages,oe,pe),pageParams:ve(U.pageParams,Z,pe)}};if(a&&u.length){const U=a==="backward",Z=U?YH:kN,Q={pages:u,pageParams:h},re=Z(i,Q);g=await z(Q,re,U)}else{const U=e??u.length;do{const Z=s===0?h[0]??i.initialPageParam:kN(i,g);if(s>0&&Z==null)break;g=await z(g,Z),s++}while(s<U)}return g};t.options.persister?t.fetchFn=()=>{var j,V;return(V=(j=t.options).persister)==null?void 0:V.call(j,_,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=_}}}function kN(e,{pages:t,pageParams:r}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,r[i],r):void 0}function YH(e,{pages:t,pageParams:r}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,r[0],r):void 0}var ci,vu,xu,Mp,kp,_u,Pp,Ap,vL,KH=(vL=class{constructor(e={}){wn(this,ci);wn(this,vu);wn(this,xu);wn(this,Mp);wn(this,kp);wn(this,_u);wn(this,Pp);wn(this,Ap);Br(this,ci,e.queryCache||new HH),Br(this,vu,e.mutationCache||new XH),Br(this,xu,e.defaultOptions||{}),Br(this,Mp,new Map),Br(this,kp,new Map),Br(this,_u,0)}mount(){V_(this,_u)._++,vt(this,_u)===1&&(Br(this,Pp,$O.subscribe(async e=>{e&&(await this.resumePausedMutations(),vt(this,ci).onFocus())})),Br(this,Ap,b1.subscribe(async e=>{e&&(await this.resumePausedMutations(),vt(this,ci).onOnline())})))}unmount(){var e,t;V_(this,_u)._--,vt(this,_u)===0&&((e=vt(this,Pp))==null||e.call(this),Br(this,Pp,void 0),(t=vt(this,Ap))==null||t.call(this),Br(this,Ap,void 0))}isFetching(e){return vt(this,ci).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return vt(this,vu).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=vt(this,ci).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),i=vt(this,ci).build(this,r);return e.revalidateIfStale&&i.isStaleByTime(bN(r.staleTime,i))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return vt(this,ci).findAll(e).map(({queryKey:t,state:r})=>{const i=r.data;return[t,i]})}setQueryData(e,t,r){const i=this.defaultQueryOptions({queryKey:e}),a=vt(this,ci).get(i.queryHash),u=a==null?void 0:a.state.data,h=AH(t,u);if(h!==void 0)return vt(this,ci).build(this,i).setData(h,{...r,manual:!0})}setQueriesData(e,t,r){return Is.batch(()=>vt(this,ci).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=vt(this,ci).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=vt(this,ci);Is.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=vt(this,ci),i={type:"active",...e};return Is.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries(i,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},i=Is.batch(()=>vt(this,ci).findAll(e).map(a=>a.cancel(r)));return Promise.all(i).then(La).catch(La)}invalidateQueries(e={},t={}){return Is.batch(()=>{if(vt(this,ci).findAll(e).forEach(i=>{i.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},i=Is.batch(()=>vt(this,ci).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let u=a.fetch(void 0,r);return r.throwOnError||(u=u.catch(La)),a.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(i).then(La)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=vt(this,ci).build(this,t);return r.isStaleByTime(bN(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(La).catch(La)}fetchInfiniteQuery(e){return e.behavior=MN(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(La).catch(La)}ensureInfiniteQueryData(e){return e.behavior=MN(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return b1.isOnline()?vt(this,vu).resumePausedMutations():Promise.resolve()}getQueryCache(){return vt(this,ci)}getMutationCache(){return vt(this,vu)}getDefaultOptions(){return vt(this,xu)}setDefaultOptions(e){Br(this,xu,e)}setQueryDefaults(e,t){vt(this,Mp).set(lv(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...vt(this,Mp).values()];let r={};return t.forEach(i=>{cv(e,i.queryKey)&&(r={...r,...i.defaultOptions})}),r}setMutationDefaults(e,t){vt(this,kp).set(lv(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...vt(this,kp).values()];let r={};return t.forEach(i=>{cv(e,i.mutationKey)&&(r={...r,...i.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...vt(this,xu).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Pk(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===Ak&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...vt(this,xu).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){vt(this,ci).clear(),vt(this,vu).clear()}},ci=new WeakMap,vu=new WeakMap,xu=new WeakMap,Mp=new WeakMap,kp=new WeakMap,_u=new WeakMap,Pp=new WeakMap,Ap=new WeakMap,vL),QH=A.createContext(void 0),JH=({client:e,children:t})=>(A.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),m.jsx(QH.Provider,{value:e,children:t}));const ZO=A.createContext(void 0);function eq({children:e,defaultTheme:t="dark"}){const[r,i]=A.useState(()=>localStorage.getItem("theme")||t),[a,u]=A.useState("dark");A.useEffect(()=>{localStorage.setItem("theme",r);const g=window.document.documentElement;g.classList.remove("light","dark");let s;if(r==="system"){const b=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";s=b,g.classList.add(b)}else s=r,g.classList.add(r);u(s),document.body.setAttribute("data-theme",s),document.documentElement.style.colorScheme=s;const _=document.querySelector('meta[name="theme-color"]');_&&_.setAttribute("content",s==="dark"?"#000000":"#ffffff")},[r]),A.useEffect(()=>{if(r!=="system")return;const g=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{const _=g.matches?"dark":"light";document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(_),u(_)};return g.addEventListener("change",s),()=>g.removeEventListener("change",s)},[r]);const h={theme:r,setTheme:i,resolvedTheme:a};return m.jsx(ZO.Provider,{value:h,children:e})}const Fv=()=>{const e=A.useContext(ZO);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e};var tq=e=>{switch(e){case"success":return iq;case"info":return oq;case"warning":return sq;case"error":return aq;default:return null}},rq=Array(12).fill(0),nq=({visible:e})=>lt.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},lt.createElement("div",{className:"sonner-spinner"},rq.map((t,r)=>lt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),iq=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),sq=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),oq=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),aq=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),lq=()=>{let[e,t]=lt.useState(document.hidden);return lt.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},bC=1,cq=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...i}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:bC++,u=this.toasts.find(g=>g.id===a),h=e.dismissible===void 0?!0:e.dismissible;return u?this.toasts=this.toasts.map(g=>g.id===a?(this.publish({...g,...e,id:a,title:r}),{...g,...e,id:a,dismissible:h,title:r}):g):this.addToast({title:r,...i,dismissible:h,id:a}),a},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let i=e instanceof Promise?e:e(),a=r!==void 0;return i.then(async u=>{if(dq(u)&&!u.ok){a=!1;let h=typeof t.error=="function"?await t.error(`HTTP error! status: ${u.status}`):t.error,g=typeof t.description=="function"?await t.description(`HTTP error! status: ${u.status}`):t.description;this.create({id:r,type:"error",message:h,description:g})}else if(t.success!==void 0){a=!1;let h=typeof t.success=="function"?await t.success(u):t.success,g=typeof t.description=="function"?await t.description(u):t.description;this.create({id:r,type:"success",message:h,description:g})}}).catch(async u=>{if(t.error!==void 0){a=!1;let h=typeof t.error=="function"?await t.error(u):t.error,g=typeof t.description=="function"?await t.description(u):t.description;this.create({id:r,type:"error",message:h,description:g})}}).finally(()=>{var u;a&&(this.dismiss(r),r=void 0),(u=t.finally)==null||u.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||bC++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},bo=new cq,uq=(e,t)=>{let r=(t==null?void 0:t.id)||bC++;return bo.addToast({title:e,...t,id:r}),r},dq=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",hq=uq,fq=()=>bo.toasts,sh=Object.assign(hq,{success:bo.success,info:bo.info,warning:bo.warning,error:bo.error,custom:bo.custom,message:bo.message,promise:bo.promise,dismiss:bo.dismiss,loading:bo.loading},{getHistory:fq});function pq(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}pq(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function a0(e){return e.label!==void 0}var mq=3,gq="32px",yq=4e3,vq=356,xq=14,_q=20,wq=200;function bq(...e){return e.filter(Boolean).join(" ")}var Sq=e=>{var t,r,i,a,u,h,g,s,_,b;let{invert:C,toast:M,unstyled:D,interacting:N,setHeights:j,visibleToasts:V,heights:B,index:z,toasts:U,expanded:Z,removeToast:Q,defaultRichColors:re,closeButton:oe,style:pe,cancelButtonStyle:ve,actionButtonStyle:he,className:Ke="",descriptionClassName:qe="",duration:Ie,position:rt,gap:Pt,loadingIcon:it,expandByDefault:Je,classNames:Te,icons:Re,closeButtonAriaLabel:Tt="Close toast",pauseWhenPageIsHidden:Ge,cn:wt}=e,[ct,dt]=lt.useState(!1),[tr,Bt]=lt.useState(!1),[St,nr]=lt.useState(!1),[cr,lr]=lt.useState(!1),[dr,Ut]=lt.useState(0),[Kr,Zr]=lt.useState(0),vi=lt.useRef(null),Ir=lt.useRef(null),Rn=z===0,ke=z+1<=V,Oe=M.type,Ze=M.dismissible!==!1,Vt=M.className||"",jt=M.descriptionClassName||"",Ct=lt.useMemo(()=>B.findIndex(vr=>vr.toastId===M.id)||0,[B,M.id]),Qt=lt.useMemo(()=>{var vr;return(vr=M.closeButton)!=null?vr:oe},[M.closeButton,oe]),fr=lt.useMemo(()=>M.duration||Ie||yq,[M.duration,Ie]),mn=lt.useRef(0),At=lt.useRef(0),nn=lt.useRef(0),Mn=lt.useRef(null),[qi,bs]=rt.split("-"),ho=lt.useMemo(()=>B.reduce((vr,sn,me)=>me>=Ct?vr:vr+sn.height,0),[B,Ct]),fo=lq(),po=M.invert||C,Zi=Oe==="loading";At.current=lt.useMemo(()=>Ct*Pt+ho,[Ct,ho]),lt.useEffect(()=>{dt(!0)},[]),lt.useLayoutEffect(()=>{if(!ct)return;let vr=Ir.current,sn=vr.style.height;vr.style.height="auto";let me=vr.getBoundingClientRect().height;vr.style.height=sn,Zr(me),j(J=>J.find(ee=>ee.toastId===M.id)?J.map(ee=>ee.toastId===M.id?{...ee,height:me}:ee):[{toastId:M.id,height:me,position:M.position},...J])},[ct,M.title,M.description,j,M.id]);let Li=lt.useCallback(()=>{Bt(!0),Ut(At.current),j(vr=>vr.filter(sn=>sn.toastId!==M.id)),setTimeout(()=>{Q(M)},wq)},[M,Q,j,At]);lt.useEffect(()=>{if(M.promise&&Oe==="loading"||M.duration===1/0||M.type==="loading")return;let vr,sn=fr;return Z||N||Ge&&fo?(()=>{if(nn.current<mn.current){let me=new Date().getTime()-mn.current;sn=sn-me}nn.current=new Date().getTime()})():sn!==1/0&&(mn.current=new Date().getTime(),vr=setTimeout(()=>{var me;(me=M.onAutoClose)==null||me.call(M,M),Li()},sn)),()=>clearTimeout(vr)},[Z,N,Je,M,fr,Li,M.promise,Oe,Ge,fo]),lt.useEffect(()=>{let vr=Ir.current;if(vr){let sn=vr.getBoundingClientRect().height;return Zr(sn),j(me=>[{toastId:M.id,height:sn,position:M.position},...me]),()=>j(me=>me.filter(J=>J.toastId!==M.id))}},[j,M.id]),lt.useEffect(()=>{M.delete&&Li()},[Li,M.delete]);function ha(){return Re!=null&&Re.loading?lt.createElement("div",{className:"sonner-loader","data-visible":Oe==="loading"},Re.loading):it?lt.createElement("div",{className:"sonner-loader","data-visible":Oe==="loading"},it):lt.createElement(nq,{visible:Oe==="loading"})}return lt.createElement("li",{"aria-live":M.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Ir,className:wt(Ke,Vt,Te==null?void 0:Te.toast,(t=M==null?void 0:M.classNames)==null?void 0:t.toast,Te==null?void 0:Te.default,Te==null?void 0:Te[Oe],(r=M==null?void 0:M.classNames)==null?void 0:r[Oe]),"data-sonner-toast":"","data-rich-colors":(i=M.richColors)!=null?i:re,"data-styled":!(M.jsx||M.unstyled||D),"data-mounted":ct,"data-promise":!!M.promise,"data-removed":tr,"data-visible":ke,"data-y-position":qi,"data-x-position":bs,"data-index":z,"data-front":Rn,"data-swiping":St,"data-dismissible":Ze,"data-type":Oe,"data-invert":po,"data-swipe-out":cr,"data-expanded":!!(Z||Je&&ct),style:{"--index":z,"--toasts-before":z,"--z-index":U.length-z,"--offset":`${tr?dr:At.current}px`,"--initial-height":Je?"auto":`${Kr}px`,...pe,...M.style},onPointerDown:vr=>{Zi||!Ze||(vi.current=new Date,Ut(At.current),vr.target.setPointerCapture(vr.pointerId),vr.target.tagName!=="BUTTON"&&(nr(!0),Mn.current={x:vr.clientX,y:vr.clientY}))},onPointerUp:()=>{var vr,sn,me,J;if(cr||!Ze)return;Mn.current=null;let ee=Number(((vr=Ir.current)==null?void 0:vr.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ye=new Date().getTime()-((sn=vi.current)==null?void 0:sn.getTime()),Se=Math.abs(ee)/ye;if(Math.abs(ee)>=_q||Se>.11){Ut(At.current),(me=M.onDismiss)==null||me.call(M,M),Li(),lr(!0);return}(J=Ir.current)==null||J.style.setProperty("--swipe-amount","0px"),nr(!1)},onPointerMove:vr=>{var sn;if(!Mn.current||!Ze)return;let me=vr.clientY-Mn.current.y,J=vr.clientX-Mn.current.x,ee=(qi==="top"?Math.min:Math.max)(0,me),ye=vr.pointerType==="touch"?10:2;Math.abs(ee)>ye?(sn=Ir.current)==null||sn.style.setProperty("--swipe-amount",`${me}px`):Math.abs(J)>ye&&(Mn.current=null)}},Qt&&!M.jsx?lt.createElement("button",{"aria-label":Tt,"data-disabled":Zi,"data-close-button":!0,onClick:Zi||!Ze?()=>{}:()=>{var vr;Li(),(vr=M.onDismiss)==null||vr.call(M,M)},className:wt(Te==null?void 0:Te.closeButton,(a=M==null?void 0:M.classNames)==null?void 0:a.closeButton)},lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},lt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),lt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,M.jsx||lt.isValidElement(M.title)?M.jsx||M.title:lt.createElement(lt.Fragment,null,Oe||M.icon||M.promise?lt.createElement("div",{"data-icon":"",className:wt(Te==null?void 0:Te.icon,(u=M==null?void 0:M.classNames)==null?void 0:u.icon)},M.promise||M.type==="loading"&&!M.icon?M.icon||ha():null,M.type!=="loading"?M.icon||(Re==null?void 0:Re[Oe])||tq(Oe):null):null,lt.createElement("div",{"data-content":"",className:wt(Te==null?void 0:Te.content,(h=M==null?void 0:M.classNames)==null?void 0:h.content)},lt.createElement("div",{"data-title":"",className:wt(Te==null?void 0:Te.title,(g=M==null?void 0:M.classNames)==null?void 0:g.title)},M.title),M.description?lt.createElement("div",{"data-description":"",className:wt(qe,jt,Te==null?void 0:Te.description,(s=M==null?void 0:M.classNames)==null?void 0:s.description)},M.description):null),lt.isValidElement(M.cancel)?M.cancel:M.cancel&&a0(M.cancel)?lt.createElement("button",{"data-button":!0,"data-cancel":!0,style:M.cancelButtonStyle||ve,onClick:vr=>{var sn,me;a0(M.cancel)&&Ze&&((me=(sn=M.cancel).onClick)==null||me.call(sn,vr),Li())},className:wt(Te==null?void 0:Te.cancelButton,(_=M==null?void 0:M.classNames)==null?void 0:_.cancelButton)},M.cancel.label):null,lt.isValidElement(M.action)?M.action:M.action&&a0(M.action)?lt.createElement("button",{"data-button":!0,"data-action":!0,style:M.actionButtonStyle||he,onClick:vr=>{var sn,me;a0(M.action)&&(vr.defaultPrevented||((me=(sn=M.action).onClick)==null||me.call(sn,vr),Li()))},className:wt(Te==null?void 0:Te.actionButton,(b=M==null?void 0:M.classNames)==null?void 0:b.actionButton)},M.action.label):null))};function PN(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var Eq=e=>{let{invert:t,position:r="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:u,className:h,offset:g,theme:s="light",richColors:_,duration:b,style:C,visibleToasts:M=mq,toastOptions:D,dir:N=PN(),gap:j=xq,loadingIcon:V,icons:B,containerAriaLabel:z="Notifications",pauseWhenPageIsHidden:U,cn:Z=bq}=e,[Q,re]=lt.useState([]),oe=lt.useMemo(()=>Array.from(new Set([r].concat(Q.filter(Ge=>Ge.position).map(Ge=>Ge.position)))),[Q,r]),[pe,ve]=lt.useState([]),[he,Ke]=lt.useState(!1),[qe,Ie]=lt.useState(!1),[rt,Pt]=lt.useState(s!=="system"?s:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),it=lt.useRef(null),Je=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),Te=lt.useRef(null),Re=lt.useRef(!1),Tt=lt.useCallback(Ge=>{var wt;(wt=Q.find(ct=>ct.id===Ge.id))!=null&&wt.delete||bo.dismiss(Ge.id),re(ct=>ct.filter(({id:dt})=>dt!==Ge.id))},[Q]);return lt.useEffect(()=>bo.subscribe(Ge=>{if(Ge.dismiss){re(wt=>wt.map(ct=>ct.id===Ge.id?{...ct,delete:!0}:ct));return}setTimeout(()=>{Ek.flushSync(()=>{re(wt=>{let ct=wt.findIndex(dt=>dt.id===Ge.id);return ct!==-1?[...wt.slice(0,ct),{...wt[ct],...Ge},...wt.slice(ct+1)]:[Ge,...wt]})})})}),[]),lt.useEffect(()=>{if(s!=="system"){Pt(s);return}s==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Pt("dark"):Pt("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:Ge})=>{Pt(Ge?"dark":"light")})},[s]),lt.useEffect(()=>{Q.length<=1&&Ke(!1)},[Q]),lt.useEffect(()=>{let Ge=wt=>{var ct,dt;i.every(tr=>wt[tr]||wt.code===tr)&&(Ke(!0),(ct=it.current)==null||ct.focus()),wt.code==="Escape"&&(document.activeElement===it.current||(dt=it.current)!=null&&dt.contains(document.activeElement))&&Ke(!1)};return document.addEventListener("keydown",Ge),()=>document.removeEventListener("keydown",Ge)},[i]),lt.useEffect(()=>{if(it.current)return()=>{Te.current&&(Te.current.focus({preventScroll:!0}),Te.current=null,Re.current=!1)}},[it.current]),Q.length?lt.createElement("section",{"aria-label":`${z} ${Je}`,tabIndex:-1},oe.map((Ge,wt)=>{var ct;let[dt,tr]=Ge.split("-");return lt.createElement("ol",{key:Ge,dir:N==="auto"?PN():N,tabIndex:-1,ref:it,className:h,"data-sonner-toaster":!0,"data-theme":rt,"data-y-position":dt,"data-x-position":tr,style:{"--front-toast-height":`${((ct=pe[0])==null?void 0:ct.height)||0}px`,"--offset":typeof g=="number"?`${g}px`:g||gq,"--width":`${vq}px`,"--gap":`${j}px`,...C},onBlur:Bt=>{Re.current&&!Bt.currentTarget.contains(Bt.relatedTarget)&&(Re.current=!1,Te.current&&(Te.current.focus({preventScroll:!0}),Te.current=null))},onFocus:Bt=>{Bt.target instanceof HTMLElement&&Bt.target.dataset.dismissible==="false"||Re.current||(Re.current=!0,Te.current=Bt.relatedTarget)},onMouseEnter:()=>Ke(!0),onMouseMove:()=>Ke(!0),onMouseLeave:()=>{qe||Ke(!1)},onPointerDown:Bt=>{Bt.target instanceof HTMLElement&&Bt.target.dataset.dismissible==="false"||Ie(!0)},onPointerUp:()=>Ie(!1)},Q.filter(Bt=>!Bt.position&&wt===0||Bt.position===Ge).map((Bt,St)=>{var nr,cr;return lt.createElement(Sq,{key:Bt.id,icons:B,index:St,toast:Bt,defaultRichColors:_,duration:(nr=D==null?void 0:D.duration)!=null?nr:b,className:D==null?void 0:D.className,descriptionClassName:D==null?void 0:D.descriptionClassName,invert:t,visibleToasts:M,closeButton:(cr=D==null?void 0:D.closeButton)!=null?cr:u,interacting:qe,position:Ge,style:D==null?void 0:D.style,unstyled:D==null?void 0:D.unstyled,classNames:D==null?void 0:D.classNames,cancelButtonStyle:D==null?void 0:D.cancelButtonStyle,actionButtonStyle:D==null?void 0:D.actionButtonStyle,removeToast:Tt,toasts:Q.filter(lr=>lr.position==Bt.position),heights:pe.filter(lr=>lr.position==Bt.position),setHeights:ve,expandByDefault:a,gap:j,loadingIcon:V,expanded:he,pauseWhenPageIsHidden:U,cn:Z})}))})):null};const Hi=()=>{const[e,t]=A.useState([]);return{toast:a=>{const{title:u,description:h,variant:g="default",...s}=a;return g==="destructive"?sh.error(u,{description:h,...s}):sh(u,{description:h,...s})},dismiss:a=>{sh.dismiss(a)},toasts:e}},Tq=()=>"https://srv.ybfresto.id/api",Jr=Tq();async function AN(e,t,r){const i=`${Jr}${t}`,a={method:e,headers:{"Content-Type":"application/json"},...r&&e!=="GET"?{body:JSON.stringify(r)}:{}};return await pn(i,a)}async function pn(e,t){try{const r=localStorage.getItem("authToken"),i={...t==null?void 0:t.headers,...r?{Authorization:`Bearer ${r}`}:{}},a={...t,headers:i},u=await fetch(e,a);if(!u.ok){let g=`API error: ${u.status}`;try{const s=u.headers.get("content-type");if(s&&s.includes("application/json")){const _=await u.json();_.error&&(g=_.error)}}catch{}throw new Error(g)}const h=u.headers.get("content-type");return h&&h.includes("application/json")?await u.json():{success:!0,message:"Operation completed successfully"}}catch(r){throw r}}const l0={getAll:async()=>{try{return await pn(`${Jr}/dishes`)||[]}catch(e){throw console.error("Error fetching dishes:",e),e}},getById:async e=>{try{return await pn(`${Jr}/dishes/${e}`)}catch(t){throw console.error("Error fetching dish by ID:",t),t}},create:async e=>{try{return await pn(`${Jr}/dishes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){throw console.error("Error creating dish:",t),t}},update:async(e,t)=>{try{return await pn(`${Jr}/dishes/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(r){throw console.error("Error updating dish:",r),r}},delete:async e=>{try{if(!e)throw new Error("Invalid dish ID");return await pn(`${Jr}/dishes/${e}`,{method:"DELETE"})||{message:"Dish deleted successfully",id:e}}catch(t){throw console.error("Error in dishesApi.delete:",t),t}}},c0={getAll:async()=>{try{const e=`${Jr}/drinks`;return await pn(e)||[]}catch(e){throw console.error("Error fetching drinks:",e),e}},getById:async e=>{try{const t=`${Jr}/drinks`;return await pn(`${t}/${e}`)}catch(t){throw console.error("Error fetching drink:",t),t}},create:async e=>{try{const t={...e,categoryType:"drink"},r=`${Jr}/drinks`;return await pn(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(t){throw console.error("Error creating drink:",t),t}},update:async(e,t)=>{try{const r={...t,categoryType:"drink"},i=`${Jr}/drinks`;return await pn(`${i}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(r){throw console.error("Error updating drink:",r),r}},delete:async e=>{try{if(!e)throw new Error("Invalid drink ID");const r=`${`${Jr}/drinks`}/${e}`;return await pn(r,{method:"DELETE"})}catch(t){throw console.error("Error deleting drink:",t),t}}},u0={getAll:async()=>await pn(`${Jr}/hero-slides`),create:async e=>await pn(`${Jr}/hero-slides`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),update:async(e,t)=>await pn(`${Jr}/hero-slides/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await pn(`${Jr}/hero-slides/${e}`,{method:"DELETE"})},d0={getAll:async()=>await pn(`${Jr}/vouchers`),create:async e=>await pn(`${Jr}/vouchers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),update:async(e,t)=>await pn(`${Jr}/vouchers/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await pn(`${Jr}/vouchers/${e}`,{method:"DELETE"})},Ik={getAll:async()=>await pn(`${Jr}/qr-codes`),create:async e=>await pn(`${Jr}/qr-codes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),update:async(e,t)=>await pn(`${Jr}/qr-codes/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await pn(`${Jr}/qr-codes/${e}`,{method:"DELETE"})},RE={getAll:async e=>{try{const t=e?`${Jr}/categories?type=${e}`:`${Jr}/categories`;return await pn(t)}catch(t){return console.error("Error fetching categories:",t),[]}},create:async(e,t="dish")=>await pn(`${Jr}/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,type:t})}),delete:async(e,t="dish")=>await pn(`${Jr}/categories/${encodeURIComponent(e)}?type=${t}`,{method:"DELETE"})},Cq={uploadFile:async e=>{const t=new FormData;t.append("file",e);const r=localStorage.getItem("authToken"),i=await fetch(`${Jr}/upload`,{method:"POST",body:t,headers:{...r?{Authorization:`Bearer ${r}`}:{}}});if(!i.ok){console.error(`Upload error: ${i.status}`,i);const u=await i.json().catch(()=>({}));throw new Error(u.error||`Upload error: ${i.status}`)}return(await i.json()).file.url}},IN="/website-settings",h0="ybf-website-settings",SC={getSettings:async()=>{try{const e=await AN("GET",IN);return localStorage.setItem(h0,JSON.stringify(e)),e}catch{const t=localStorage.getItem(h0);return t?JSON.parse(t):{siteName:"Young Brave Fearless",siteTitle:"YBF Resto - Young Brave Fearless Restaurant",logoUrl:"",faviconUrl:"",mission:"To deliver exceptional dining experiences through quality ingredients, innovative recipes, and warm hospitality.",vision:"To be recognized as the premier dining destination that brings people together through a shared love of exceptional food.",address:"123 Culinary Street, Foodie District",mapCoordinates:"",reservationNote:"Reservations recommended for parties of 6 or more",instagramUrl:"https://instagram.com/ybf.id",facebookUrl:"",twitterUrl:"",footerText:` ${new Date().getFullYear()} YBF Restaurant. All rights reserved.`,fullStory:"Our restaurant began as a small family business in 2010. What started as a passion project quickly grew into the beloved establishment you see today. We've always believed that food brings people together, and that philosophy has guided every decision we've made.",heroSliderMobileVertical:!0,openingHours:[{day:"Monday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Tuesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Wednesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Thursday",openTime:"11:00 AM",closeTime:"11:00 PM"},{day:"Friday",openTime:"11:00 AM",closeTime:"12:00 AM"},{day:"Saturday",openTime:"10:00 AM",closeTime:"12:00 AM"},{day:"Sunday",openTime:"10:00 AM",closeTime:"10:00 PM"}]}}},saveSettings:async e=>{try{const t=await AN("PUT",IN,e);return localStorage.setItem(h0,JSON.stringify(t)),t}catch{return localStorage.setItem(h0,JSON.stringify(e)),e}}},Hf={getAll:async()=>await pn(`${Jr}/ads`),getById:async e=>await pn(`${Jr}/ads/${e}`),create:async e=>await pn(`${Jr}/ads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),update:async(e,t)=>await pn(`${Jr}/ads/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await pn(`${Jr}/ads/${e}`,{method:"DELETE"}),toggleActive:async e=>await pn(`${Jr}/ads/${e}/toggle`,{method:"PATCH"})},Mq=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(null),[a,u]=A.useState(!0),[h,g]=A.useState(null),[s,_]=A.useState(null),{toast:b}=Hi(),C=async()=>{u(!0);try{console.log("Fetching dishes from API...");const j=await l0.getAll();console.log("Fetched dishes:",j),t(j),g(null)}catch(j){console.error("Error fetching dishes:",j),g("Failed to fetch dishes"),b({title:"Error",description:"Failed to load dishes. Please try again later.",variant:"destructive"})}finally{u(!1)}};return{dishes:e,selectedDish:r,setSelectedDish:i,loading:a,error:h,isDeleting:s,fetchDishes:C,addDish:async j=>{try{u(!0),console.log("Adding new item:",j);const V=await l0.create(j);return t(B=>[...B,V]),b({title:"Success",description:`${j.name} has been added to the menu.`}),V}catch(V){throw console.error("Error adding item:",V),b({title:"Error",description:"Failed to add item. Please try again.",variant:"destructive"}),V}finally{u(!1)}},updateDish:async(j,V)=>{try{u(!0),console.log("Updating item:",j,V);const B=await l0.update(j,V);return t(z=>z.map(U=>U.id===j?{...U,...B}:U)),b({title:"Success",description:"Item updated successfully."}),B}catch(B){throw console.error("Error updating item:",B),b({title:"Error",description:"Failed to update item. Please try again.",variant:"destructive"}),B}finally{u(!1)}},deleteDish:async j=>{if(!j){b({title:"Error",description:"Invalid dish ID. Cannot delete.",variant:"destructive"});return}try{console.log("Starting deletion process for dish:",j),_(j);const V=await l0.delete(j);console.log("Delete API response:",V),t(B=>B.filter(z=>z.id!==j)),b({title:"Success",description:"Item deleted successfully."}),console.log("Dish deleted successfully and state updated")}catch(V){throw console.error("Error deleting dish:",V),b({title:"Error",description:"Failed to delete item. Please try again.",variant:"destructive"}),V}finally{_(null)}},refreshDishes:C}},kq=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(null),[a,u]=A.useState(!1),[h,g]=A.useState(null),{toast:s}=Hi(),_=async()=>{u(!0);try{console.log("Fetching drinks from API...");const D=await c0.getAll();console.log("Fetched drinks:",D),t(Array.isArray(D)?D:[])}catch(D){console.error("Error fetching drinks:",D),s({title:"Error",description:"Failed to load drinks. Please try again later.",variant:"destructive"}),t([])}finally{u(!1)}};return{drinks:e,selectedDrink:r,setSelectedDrink:i,loading:a,isDeleting:h,fetchDrinks:_,addDrink:async D=>{try{u(!0),console.log("Adding new drink:",D);const N=await c0.create(D);return t(j=>[...j,N]),s({title:"Success",description:`${D.name} has been added to the drinks menu.`}),N}catch(N){throw console.error("Error adding drink:",N),s({title:"Error",description:"Failed to add drink. Please try again.",variant:"destructive"}),N}finally{u(!1)}},updateDrink:async(D,N)=>{try{u(!0),console.log("Updating drink:",D,N);const j=await c0.update(D,N);return t(V=>V.map(B=>B.id===D?{...B,...j}:B)),s({title:"Success",description:"Drink updated successfully."}),j}catch(j){throw console.error("Error updating drink:",j),s({title:"Error",description:"Failed to update drink. Please try again.",variant:"destructive"}),j}finally{u(!1)}},deleteDrink:async D=>{try{console.log("Starting deletion process for drink:",D),g(D),u(!0),console.log("Calling drinksApi.delete with ID:",D);const N=await c0.delete(D);return console.log("Drink deleted successfully, server response:",N),t(j=>j.filter(V=>V.id!==D)),s({title:"Success",description:"Drink deleted successfully"}),N}catch(N){throw console.error("Error deleting drink:",N),s({title:"Error",description:"Failed to delete drink. Please try again.",variant:"destructive"}),N}finally{u(!1),g(null)}},refreshDishes:_,refreshDrinks:_}},Pq=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(!1),{toast:a}=Hi(),u=async()=>{try{i(!0),console.log("Fetching hero slides from API...");const _=await u0.getAll();console.log("Fetched hero slides:",_),t(_)}catch(_){console.error("Error fetching hero slides:",_),a({title:"Error",description:"Failed to load hero slides.",variant:"destructive"})}finally{i(!1)}};return{heroSlides:e,loading:r,fetchHeroSlides:u,addHeroSlide:async _=>{try{i(!0),console.log("Adding new hero slide:",_),await u0.create(_),await u(),a({title:"Success",description:"Hero slide added successfully."})}catch(b){console.error("Error adding hero slide:",b),a({title:"Error",description:"Failed to add hero slide. Please try again.",variant:"destructive"})}finally{i(!1)}},updateHeroSlide:async(_,b)=>{try{i(!0),console.log("Updating hero slide:",_,b),await u0.update(_,b),await u(),a({title:"Success",description:"Hero slide updated successfully."})}catch(C){console.error("Error updating hero slide:",C),a({title:"Error",description:"Failed to update hero slide. Please try again.",variant:"destructive"})}finally{i(!1)}},deleteHeroSlide:async _=>{try{i(!0),console.log("Deleting hero slide:",_),await u0.delete(_),await u(),a({title:"Success",description:"Hero slide deleted successfully."})}catch(b){console.error("Error deleting hero slide:",b),a({title:"Error",description:"Failed to delete hero slide. Please try again.",variant:"destructive"})}finally{i(!1)}},refreshHeroSlides:u}},Aq=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(!1),{toast:a}=Hi(),u=async()=>{try{i(!0),console.log("Fetching vouchers from API...");const _=await d0.getAll();console.log("Fetched vouchers:",_),t(_)}catch(_){console.error("Error fetching vouchers:",_),a({title:"Error",description:"Failed to load vouchers.",variant:"destructive"})}finally{i(!1)}};return{vouchers:e,loading:r,fetchVouchers:u,addVoucher:async _=>{try{i(!0),console.log("Adding new voucher:",_),await d0.create(_),await u(),a({title:"Success",description:"Voucher added successfully."})}catch(b){console.error("Error adding voucher:",b),a({title:"Error",description:"Failed to add voucher. Please try again.",variant:"destructive"})}finally{i(!1)}},updateVoucher:async(_,b)=>{try{i(!0),console.log("Updating voucher:",_,b),await d0.update(_,b),await u(),a({title:"Success",description:"Voucher updated successfully."})}catch(C){console.error("Error updating voucher:",C),a({title:"Error",description:"Failed to update voucher. Please try again.",variant:"destructive"})}finally{i(!1)}},deleteVoucher:async _=>{try{i(!0),console.log("Deleting voucher:",_),await d0.delete(_),await u(),a({title:"Success",description:"Voucher deleted successfully."})}catch(b){console.error("Error deleting voucher:",b),a({title:"Error",description:"Failed to delete voucher. Please try again.",variant:"destructive"})}finally{i(!1)}},refreshVouchers:u}},Iq=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(!1),{toast:a}=Hi(),u=async()=>{try{console.log("Fetching categories from API...");const s=await RE.getAll();console.log("Categories fetched:",s),t(s||[])}catch(s){console.error("Error fetching categories:",s),a({title:"Error",description:"Failed to fetch categories. Please check server connection and try again.",variant:"destructive"})}};return{categories:e,loading:r,fetchCategories:u,addCategory:async(s,_="dish")=>{try{i(!0),console.log(`Adding new category: ${s} (type: ${_})`),(await RE.create(s,_)).success?(await u(),a({title:"Success",description:`Category "${s}" has been added.`})):a({title:"Error",description:"This category already exists.",variant:"destructive"})}catch(b){console.error("Error adding category:",b),a({title:"Error",description:"Failed to add category. Please try again.",variant:"destructive"})}finally{i(!1)}},deleteCategory:async(s,_="dish")=>{try{i(!0),console.log(`Deleting category: ${s} (type: ${_})`),(await RE.delete(s,_)).success?(await u(),a({title:"Success",description:`Category "${s}" has been deleted.`})):a({title:"Error",description:"Failed to delete category. Please try again.",variant:"destructive"})}catch(b){console.error("Error deleting category:",b),a({title:"Error",description:"Failed to delete category. Please try again.",variant:"destructive"})}finally{i(!1)}},refreshCategories:u}},Dq=e=>e.filter(t=>(t.isTopDish||t.featured)&&(t.categoryType==="dish"||!t.categoryType&&!t.category.toLowerCase().includes("drink")&&!t.category.toLowerCase().includes("coffee")&&!t.category.toLowerCase().includes("tea")&&!t.category.toLowerCase().includes("beverage")&&!t.category.toLowerCase().includes("smoothie"))).slice(0,8),Rq=e=>e.filter(t=>(t.isTopDish||t.featured)&&(t.categoryType==="drink"||t.category.toLowerCase().includes("drink")||t.category.toLowerCase().includes("coffee")||t.category.toLowerCase().includes("tea")||t.category.toLowerCase().includes("beverage")||t.category.toLowerCase().includes("smoothie"))).slice(0,8),Nq=(e,t="dish",r)=>!r.some(i=>i.category===e&&(i.categoryType===t||!i.categoryType&&t==="dish")),XO=A.createContext(void 0);function jq({children:e}){const[t,r]=A.useState("All"),i=Mq(),a=kq(),u=Pq(),h=Aq(),g=Iq(),s=i.loading||a.loading||u.loading||h.loading||g.loading,_=["All",...g.categories.filter(N=>N.type==="dish").map(N=>N.name)],b=["All",...g.categories.filter(N=>N.type==="drink").map(N=>N.name)],C=(N,j="dish")=>Nq(N,j,i.dishes),M=()=>Dq(i.dishes),D=()=>Rq(a.drinks);return A.useEffect(()=>{i.fetchDishes(),a.fetchDrinks(),u.fetchHeroSlides(),h.fetchVouchers(),g.fetchCategories()},[]),m.jsx(XO.Provider,{value:{dishes:i.dishes,categories:g.categories,dishCategories:_,drinkCategories:b,activeCategory:t,setActiveCategory:r,loading:s,error:i.error,addDish:i.addDish,updateDish:i.updateDish,deleteDish:i.deleteDish,heroSlides:u.heroSlides,addHeroSlide:u.addHeroSlide,updateHeroSlide:u.updateHeroSlide,deleteHeroSlide:u.deleteHeroSlide,vouchers:h.vouchers,addVoucher:h.addVoucher,updateVoucher:h.updateVoucher,deleteVoucher:h.deleteVoucher,refreshVouchers:h.refreshVouchers,getTopDishes:M,getTopDrinks:D,refreshDishes:i.refreshDishes,refreshHeroSlides:u.refreshHeroSlides,selectedDish:i.selectedDish,setSelectedDish:i.setSelectedDish,addCategory:g.addCategory,deleteCategory:g.deleteCategory,isUnusedCategory:C,refreshCategories:g.refreshCategories,drinks:a.drinks,refreshDrinks:a.refreshDrinks,addDrink:a.addDrink,updateDrink:a.updateDrink,deleteDrink:a.deleteDrink,selectedDrink:a.selectedDrink,setSelectedDrink:a.setSelectedDrink},children:e})}const ca=()=>{const e=A.useContext(XO);if(e===void 0)throw new Error("useRestaurant must be used within a RestaurantProvider");return e};function YO(e,t){return function(){return e.apply(t,arguments)}}const{toString:Lq}=Object.prototype,{getPrototypeOf:Dk}=Object,Ow=(e=>t=>{const r=Lq.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Xa=e=>(e=e.toLowerCase(),t=>Ow(t)===e),zw=e=>t=>typeof t===e,{isArray:sm}=Array,uv=zw("undefined");function Oq(e){return e!==null&&!uv(e)&&e.constructor!==null&&!uv(e.constructor)&&ko(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const KO=Xa("ArrayBuffer");function zq(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&KO(e.buffer),t}const Fq=zw("string"),ko=zw("function"),QO=zw("number"),Fw=e=>e!==null&&typeof e=="object",Bq=e=>e===!0||e===!1,F0=e=>{if(Ow(e)!=="object")return!1;const t=Dk(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Uq=Xa("Date"),Vq=Xa("File"),$q=Xa("Blob"),Wq=Xa("FileList"),Gq=e=>Fw(e)&&ko(e.pipe),Hq=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ko(e.append)&&((t=Ow(e))==="formdata"||t==="object"&&ko(e.toString)&&e.toString()==="[object FormData]"))},qq=Xa("URLSearchParams"),[Zq,Xq,Yq,Kq]=["ReadableStream","Request","Response","Headers"].map(Xa),Qq=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Bv(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,a;if(typeof e!="object"&&(e=[e]),sm(e))for(i=0,a=e.length;i<a;i++)t.call(null,e[i],i,e);else{const u=r?Object.getOwnPropertyNames(e):Object.keys(e),h=u.length;let g;for(i=0;i<h;i++)g=u[i],t.call(null,e[g],g,e)}}function JO(e,t){t=t.toLowerCase();const r=Object.keys(e);let i=r.length,a;for(;i-- >0;)if(a=r[i],t===a.toLowerCase())return a;return null}const oh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ez=e=>!uv(e)&&e!==oh;function EC(){const{caseless:e}=ez(this)&&this||{},t={},r=(i,a)=>{const u=e&&JO(t,a)||a;F0(t[u])&&F0(i)?t[u]=EC(t[u],i):F0(i)?t[u]=EC({},i):sm(i)?t[u]=i.slice():t[u]=i};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&Bv(arguments[i],r);return t}const Jq=(e,t,r,{allOwnKeys:i}={})=>(Bv(t,(a,u)=>{r&&ko(a)?e[u]=YO(a,r):e[u]=a},{allOwnKeys:i}),e),eZ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),tZ=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},rZ=(e,t,r,i)=>{let a,u,h;const g={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),u=a.length;u-- >0;)h=a[u],(!i||i(h,e,t))&&!g[h]&&(t[h]=e[h],g[h]=!0);e=r!==!1&&Dk(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},nZ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},iZ=e=>{if(!e)return null;if(sm(e))return e;let t=e.length;if(!QO(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},sZ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Dk(Uint8Array)),oZ=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=i.next())&&!a.done;){const u=a.value;t.call(e,u[0],u[1])}},aZ=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},lZ=Xa("HTMLFormElement"),cZ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,a){return i.toUpperCase()+a}),DN=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),uZ=Xa("RegExp"),tz=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};Bv(r,(a,u)=>{let h;(h=t(a,u,e))!==!1&&(i[u]=h||a)}),Object.defineProperties(e,i)},dZ=e=>{tz(e,(t,r)=>{if(ko(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(ko(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},hZ=(e,t)=>{const r={},i=a=>{a.forEach(u=>{r[u]=!0})};return sm(e)?i(e):i(String(e).split(t)),r},fZ=()=>{},pZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function mZ(e){return!!(e&&ko(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const gZ=e=>{const t=new Array(10),r=(i,a)=>{if(Fw(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[a]=i;const u=sm(i)?[]:{};return Bv(i,(h,g)=>{const s=r(h,a+1);!uv(s)&&(u[g]=s)}),t[a]=void 0,u}}return i};return r(e,0)},yZ=Xa("AsyncFunction"),vZ=e=>e&&(Fw(e)||ko(e))&&ko(e.then)&&ko(e.catch),rz=((e,t)=>e?setImmediate:t?((r,i)=>(oh.addEventListener("message",({source:a,data:u})=>{a===oh&&u===r&&i.length&&i.shift()()},!1),a=>{i.push(a),oh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ko(oh.postMessage)),xZ=typeof queueMicrotask<"u"?queueMicrotask.bind(oh):typeof process<"u"&&process.nextTick||rz,nt={isArray:sm,isArrayBuffer:KO,isBuffer:Oq,isFormData:Hq,isArrayBufferView:zq,isString:Fq,isNumber:QO,isBoolean:Bq,isObject:Fw,isPlainObject:F0,isReadableStream:Zq,isRequest:Xq,isResponse:Yq,isHeaders:Kq,isUndefined:uv,isDate:Uq,isFile:Vq,isBlob:$q,isRegExp:uZ,isFunction:ko,isStream:Gq,isURLSearchParams:qq,isTypedArray:sZ,isFileList:Wq,forEach:Bv,merge:EC,extend:Jq,trim:Qq,stripBOM:eZ,inherits:tZ,toFlatObject:rZ,kindOf:Ow,kindOfTest:Xa,endsWith:nZ,toArray:iZ,forEachEntry:oZ,matchAll:aZ,isHTMLForm:lZ,hasOwnProperty:DN,hasOwnProp:DN,reduceDescriptors:tz,freezeMethods:dZ,toObjectSet:hZ,toCamelCase:cZ,noop:fZ,toFiniteNumber:pZ,findKey:JO,global:oh,isContextDefined:ez,isSpecCompliantForm:mZ,toJSONObject:gZ,isAsyncFn:yZ,isThenable:vZ,setImmediate:rz,asap:xZ};function Or(e,t,r,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}nt.inherits(Or,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:nt.toJSONObject(this.config),code:this.code,status:this.status}}});const nz=Or.prototype,iz={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{iz[e]={value:e}});Object.defineProperties(Or,iz);Object.defineProperty(nz,"isAxiosError",{value:!0});Or.from=(e,t,r,i,a,u)=>{const h=Object.create(nz);return nt.toFlatObject(e,h,function(s){return s!==Error.prototype},g=>g!=="isAxiosError"),Or.call(h,e.message,t,r,i,a),h.cause=e,h.name=e.name,u&&Object.assign(h,u),h};const _Z=null;function TC(e){return nt.isPlainObject(e)||nt.isArray(e)}function sz(e){return nt.endsWith(e,"[]")?e.slice(0,-2):e}function RN(e,t,r){return e?e.concat(t).map(function(a,u){return a=sz(a),!r&&u?"["+a+"]":a}).join(r?".":""):t}function wZ(e){return nt.isArray(e)&&!e.some(TC)}const bZ=nt.toFlatObject(nt,{},null,function(t){return/^is[A-Z]/.test(t)});function Bw(e,t,r){if(!nt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=nt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,V){return!nt.isUndefined(V[j])});const i=r.metaTokens,a=r.visitor||b,u=r.dots,h=r.indexes,s=(r.Blob||typeof Blob<"u"&&Blob)&&nt.isSpecCompliantForm(t);if(!nt.isFunction(a))throw new TypeError("visitor must be a function");function _(N){if(N===null)return"";if(nt.isDate(N))return N.toISOString();if(!s&&nt.isBlob(N))throw new Or("Blob is not supported. Use a Buffer instead.");return nt.isArrayBuffer(N)||nt.isTypedArray(N)?s&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function b(N,j,V){let B=N;if(N&&!V&&typeof N=="object"){if(nt.endsWith(j,"{}"))j=i?j:j.slice(0,-2),N=JSON.stringify(N);else if(nt.isArray(N)&&wZ(N)||(nt.isFileList(N)||nt.endsWith(j,"[]"))&&(B=nt.toArray(N)))return j=sz(j),B.forEach(function(U,Z){!(nt.isUndefined(U)||U===null)&&t.append(h===!0?RN([j],Z,u):h===null?j:j+"[]",_(U))}),!1}return TC(N)?!0:(t.append(RN(V,j,u),_(N)),!1)}const C=[],M=Object.assign(bZ,{defaultVisitor:b,convertValue:_,isVisitable:TC});function D(N,j){if(!nt.isUndefined(N)){if(C.indexOf(N)!==-1)throw Error("Circular reference detected in "+j.join("."));C.push(N),nt.forEach(N,function(B,z){(!(nt.isUndefined(B)||B===null)&&a.call(t,B,nt.isString(z)?z.trim():z,j,M))===!0&&D(B,j?j.concat(z):[z])}),C.pop()}}if(!nt.isObject(e))throw new TypeError("data must be an object");return D(e),t}function NN(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Rk(e,t){this._pairs=[],e&&Bw(e,this,t)}const oz=Rk.prototype;oz.append=function(t,r){this._pairs.push([t,r])};oz.toString=function(t){const r=t?function(i){return t.call(this,i,NN)}:NN;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function SZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function az(e,t,r){if(!t)return e;const i=r&&r.encode||SZ;nt.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let u;if(a?u=a(t,r):u=nt.isURLSearchParams(t)?t.toString():new Rk(t,r).toString(i),u){const h=e.indexOf("#");h!==-1&&(e=e.slice(0,h)),e+=(e.indexOf("?")===-1?"?":"&")+u}return e}class jN{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){nt.forEach(this.handlers,function(i){i!==null&&t(i)})}}const lz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},EZ=typeof URLSearchParams<"u"?URLSearchParams:Rk,TZ=typeof FormData<"u"?FormData:null,CZ=typeof Blob<"u"?Blob:null,MZ={isBrowser:!0,classes:{URLSearchParams:EZ,FormData:TZ,Blob:CZ},protocols:["http","https","file","blob","url","data"]},Nk=typeof window<"u"&&typeof document<"u",CC=typeof navigator=="object"&&navigator||void 0,kZ=Nk&&(!CC||["ReactNative","NativeScript","NS"].indexOf(CC.product)<0),PZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",AZ=Nk&&window.location.href||"http://localhost",IZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Nk,hasStandardBrowserEnv:kZ,hasStandardBrowserWebWorkerEnv:PZ,navigator:CC,origin:AZ},Symbol.toStringTag,{value:"Module"})),gs={...IZ,...MZ};function DZ(e,t){return Bw(e,new gs.classes.URLSearchParams,Object.assign({visitor:function(r,i,a,u){return gs.isNode&&nt.isBuffer(r)?(this.append(i,r.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},t))}function RZ(e){return nt.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function NZ(e){const t={},r=Object.keys(e);let i;const a=r.length;let u;for(i=0;i<a;i++)u=r[i],t[u]=e[u];return t}function cz(e){function t(r,i,a,u){let h=r[u++];if(h==="__proto__")return!0;const g=Number.isFinite(+h),s=u>=r.length;return h=!h&&nt.isArray(a)?a.length:h,s?(nt.hasOwnProp(a,h)?a[h]=[a[h],i]:a[h]=i,!g):((!a[h]||!nt.isObject(a[h]))&&(a[h]=[]),t(r,i,a[h],u)&&nt.isArray(a[h])&&(a[h]=NZ(a[h])),!g)}if(nt.isFormData(e)&&nt.isFunction(e.entries)){const r={};return nt.forEachEntry(e,(i,a)=>{t(RZ(i),a,r,0)}),r}return null}function jZ(e,t,r){if(nt.isString(e))try{return(t||JSON.parse)(e),nt.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(0,JSON.stringify)(e)}const Uv={transitional:lz,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",a=i.indexOf("application/json")>-1,u=nt.isObject(t);if(u&&nt.isHTMLForm(t)&&(t=new FormData(t)),nt.isFormData(t))return a?JSON.stringify(cz(t)):t;if(nt.isArrayBuffer(t)||nt.isBuffer(t)||nt.isStream(t)||nt.isFile(t)||nt.isBlob(t)||nt.isReadableStream(t))return t;if(nt.isArrayBufferView(t))return t.buffer;if(nt.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let g;if(u){if(i.indexOf("application/x-www-form-urlencoded")>-1)return DZ(t,this.formSerializer).toString();if((g=nt.isFileList(t))||i.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return Bw(g?{"files[]":t}:t,s&&new s,this.formSerializer)}}return u||a?(r.setContentType("application/json",!1),jZ(t)):t}],transformResponse:[function(t){const r=this.transitional||Uv.transitional,i=r&&r.forcedJSONParsing,a=this.responseType==="json";if(nt.isResponse(t)||nt.isReadableStream(t))return t;if(t&&nt.isString(t)&&(i&&!this.responseType||a)){const h=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(g){if(h)throw g.name==="SyntaxError"?Or.from(g,Or.ERR_BAD_RESPONSE,this,null,this.response):g}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:gs.classes.FormData,Blob:gs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};nt.forEach(["delete","get","head","post","put","patch"],e=>{Uv.headers[e]={}});const LZ=nt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),OZ=e=>{const t={};let r,i,a;return e&&e.split(`
`).forEach(function(h){a=h.indexOf(":"),r=h.substring(0,a).trim().toLowerCase(),i=h.substring(a+1).trim(),!(!r||t[r]&&LZ[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},LN=Symbol("internals");function iy(e){return e&&String(e).trim().toLowerCase()}function B0(e){return e===!1||e==null?e:nt.isArray(e)?e.map(B0):String(e)}function zZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const FZ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function NE(e,t,r,i,a){if(nt.isFunction(i))return i.call(this,t,r);if(a&&(t=r),!!nt.isString(t)){if(nt.isString(i))return t.indexOf(i)!==-1;if(nt.isRegExp(i))return i.test(t)}}function BZ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function UZ(e,t){const r=nt.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(a,u,h){return this[i].call(this,t,a,u,h)},configurable:!0})})}class ao{constructor(t){t&&this.set(t)}set(t,r,i){const a=this;function u(g,s,_){const b=iy(s);if(!b)throw new Error("header name must be a non-empty string");const C=nt.findKey(a,b);(!C||a[C]===void 0||_===!0||_===void 0&&a[C]!==!1)&&(a[C||s]=B0(g))}const h=(g,s)=>nt.forEach(g,(_,b)=>u(_,b,s));if(nt.isPlainObject(t)||t instanceof this.constructor)h(t,r);else if(nt.isString(t)&&(t=t.trim())&&!FZ(t))h(OZ(t),r);else if(nt.isHeaders(t))for(const[g,s]of t.entries())u(s,g,i);else t!=null&&u(r,t,i);return this}get(t,r){if(t=iy(t),t){const i=nt.findKey(this,t);if(i){const a=this[i];if(!r)return a;if(r===!0)return zZ(a);if(nt.isFunction(r))return r.call(this,a,i);if(nt.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=iy(t),t){const i=nt.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||NE(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let a=!1;function u(h){if(h=iy(h),h){const g=nt.findKey(i,h);g&&(!r||NE(i,i[g],g,r))&&(delete i[g],a=!0)}}return nt.isArray(t)?t.forEach(u):u(t),a}clear(t){const r=Object.keys(this);let i=r.length,a=!1;for(;i--;){const u=r[i];(!t||NE(this,this[u],u,t,!0))&&(delete this[u],a=!0)}return a}normalize(t){const r=this,i={};return nt.forEach(this,(a,u)=>{const h=nt.findKey(i,u);if(h){r[h]=B0(a),delete r[u];return}const g=t?BZ(u):String(u).trim();g!==u&&delete r[u],r[g]=B0(a),i[g]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return nt.forEach(this,(i,a)=>{i!=null&&i!==!1&&(r[a]=t&&nt.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(a=>i.set(a)),i}static accessor(t){const i=(this[LN]=this[LN]={accessors:{}}).accessors,a=this.prototype;function u(h){const g=iy(h);i[g]||(UZ(a,h),i[g]=!0)}return nt.isArray(t)?t.forEach(u):u(t),this}}ao.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);nt.reduceDescriptors(ao.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});nt.freezeMethods(ao);function jE(e,t){const r=this||Uv,i=t||r,a=ao.from(i.headers);let u=i.data;return nt.forEach(e,function(g){u=g.call(r,u,a.normalize(),t?t.status:void 0)}),a.normalize(),u}function uz(e){return!!(e&&e.__CANCEL__)}function om(e,t,r){Or.call(this,e??"canceled",Or.ERR_CANCELED,t,r),this.name="CanceledError"}nt.inherits(om,Or,{__CANCEL__:!0});function dz(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new Or("Request failed with status code "+r.status,[Or.ERR_BAD_REQUEST,Or.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function VZ(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function $Z(e,t){e=e||10;const r=new Array(e),i=new Array(e);let a=0,u=0,h;return t=t!==void 0?t:1e3,function(s){const _=Date.now(),b=i[u];h||(h=_),r[a]=s,i[a]=_;let C=u,M=0;for(;C!==a;)M+=r[C++],C=C%e;if(a=(a+1)%e,a===u&&(u=(u+1)%e),_-h<t)return;const D=b&&_-b;return D?Math.round(M*1e3/D):void 0}}function WZ(e,t){let r=0,i=1e3/t,a,u;const h=(_,b=Date.now())=>{r=b,a=null,u&&(clearTimeout(u),u=null),e.apply(null,_)};return[(..._)=>{const b=Date.now(),C=b-r;C>=i?h(_,b):(a=_,u||(u=setTimeout(()=>{u=null,h(a)},i-C)))},()=>a&&h(a)]}const S1=(e,t,r=3)=>{let i=0;const a=$Z(50,250);return WZ(u=>{const h=u.loaded,g=u.lengthComputable?u.total:void 0,s=h-i,_=a(s),b=h<=g;i=h;const C={loaded:h,total:g,progress:g?h/g:void 0,bytes:s,rate:_||void 0,estimated:_&&g&&b?(g-h)/_:void 0,event:u,lengthComputable:g!=null,[t?"download":"upload"]:!0};e(C)},r)},ON=(e,t)=>{const r=e!=null;return[i=>t[0]({lengthComputable:r,total:e,loaded:i}),t[1]]},zN=e=>(...t)=>nt.asap(()=>e(...t)),GZ=gs.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,gs.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(gs.origin),gs.navigator&&/(msie|trident)/i.test(gs.navigator.userAgent)):()=>!0,HZ=gs.hasStandardBrowserEnv?{write(e,t,r,i,a,u){const h=[e+"="+encodeURIComponent(t)];nt.isNumber(r)&&h.push("expires="+new Date(r).toGMTString()),nt.isString(i)&&h.push("path="+i),nt.isString(a)&&h.push("domain="+a),u===!0&&h.push("secure"),document.cookie=h.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function qZ(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ZZ(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function hz(e,t,r){let i=!qZ(t);return e&&(i||r==!1)?ZZ(e,t):t}const FN=e=>e instanceof ao?{...e}:e;function Sh(e,t){t=t||{};const r={};function i(_,b,C,M){return nt.isPlainObject(_)&&nt.isPlainObject(b)?nt.merge.call({caseless:M},_,b):nt.isPlainObject(b)?nt.merge({},b):nt.isArray(b)?b.slice():b}function a(_,b,C,M){if(nt.isUndefined(b)){if(!nt.isUndefined(_))return i(void 0,_,C,M)}else return i(_,b,C,M)}function u(_,b){if(!nt.isUndefined(b))return i(void 0,b)}function h(_,b){if(nt.isUndefined(b)){if(!nt.isUndefined(_))return i(void 0,_)}else return i(void 0,b)}function g(_,b,C){if(C in t)return i(_,b);if(C in e)return i(void 0,_)}const s={url:u,method:u,data:u,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:g,headers:(_,b,C)=>a(FN(_),FN(b),C,!0)};return nt.forEach(Object.keys(Object.assign({},e,t)),function(b){const C=s[b]||a,M=C(e[b],t[b],b);nt.isUndefined(M)&&C!==g||(r[b]=M)}),r}const fz=e=>{const t=Sh({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:u,headers:h,auth:g}=t;t.headers=h=ao.from(h),t.url=az(hz(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),g&&h.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):"")));let s;if(nt.isFormData(r)){if(gs.hasStandardBrowserEnv||gs.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if((s=h.getContentType())!==!1){const[_,...b]=s?s.split(";").map(C=>C.trim()).filter(Boolean):[];h.setContentType([_||"multipart/form-data",...b].join("; "))}}if(gs.hasStandardBrowserEnv&&(i&&nt.isFunction(i)&&(i=i(t)),i||i!==!1&&GZ(t.url))){const _=a&&u&&HZ.read(u);_&&h.set(a,_)}return t},XZ=typeof XMLHttpRequest<"u",YZ=XZ&&function(e){return new Promise(function(r,i){const a=fz(e);let u=a.data;const h=ao.from(a.headers).normalize();let{responseType:g,onUploadProgress:s,onDownloadProgress:_}=a,b,C,M,D,N;function j(){D&&D(),N&&N(),a.cancelToken&&a.cancelToken.unsubscribe(b),a.signal&&a.signal.removeEventListener("abort",b)}let V=new XMLHttpRequest;V.open(a.method.toUpperCase(),a.url,!0),V.timeout=a.timeout;function B(){if(!V)return;const U=ao.from("getAllResponseHeaders"in V&&V.getAllResponseHeaders()),Q={data:!g||g==="text"||g==="json"?V.responseText:V.response,status:V.status,statusText:V.statusText,headers:U,config:e,request:V};dz(function(oe){r(oe),j()},function(oe){i(oe),j()},Q),V=null}"onloadend"in V?V.onloadend=B:V.onreadystatechange=function(){!V||V.readyState!==4||V.status===0&&!(V.responseURL&&V.responseURL.indexOf("file:")===0)||setTimeout(B)},V.onabort=function(){V&&(i(new Or("Request aborted",Or.ECONNABORTED,e,V)),V=null)},V.onerror=function(){i(new Or("Network Error",Or.ERR_NETWORK,e,V)),V=null},V.ontimeout=function(){let Z=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const Q=a.transitional||lz;a.timeoutErrorMessage&&(Z=a.timeoutErrorMessage),i(new Or(Z,Q.clarifyTimeoutError?Or.ETIMEDOUT:Or.ECONNABORTED,e,V)),V=null},u===void 0&&h.setContentType(null),"setRequestHeader"in V&&nt.forEach(h.toJSON(),function(Z,Q){V.setRequestHeader(Q,Z)}),nt.isUndefined(a.withCredentials)||(V.withCredentials=!!a.withCredentials),g&&g!=="json"&&(V.responseType=a.responseType),_&&([M,N]=S1(_,!0),V.addEventListener("progress",M)),s&&V.upload&&([C,D]=S1(s),V.upload.addEventListener("progress",C),V.upload.addEventListener("loadend",D)),(a.cancelToken||a.signal)&&(b=U=>{V&&(i(!U||U.type?new om(null,e,V):U),V.abort(),V=null)},a.cancelToken&&a.cancelToken.subscribe(b),a.signal&&(a.signal.aborted?b():a.signal.addEventListener("abort",b)));const z=VZ(a.url);if(z&&gs.protocols.indexOf(z)===-1){i(new Or("Unsupported protocol "+z+":",Or.ERR_BAD_REQUEST,e));return}V.send(u||null)})},KZ=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let i=new AbortController,a;const u=function(_){if(!a){a=!0,g();const b=_ instanceof Error?_:this.reason;i.abort(b instanceof Or?b:new om(b instanceof Error?b.message:b))}};let h=t&&setTimeout(()=>{h=null,u(new Or(`timeout ${t} of ms exceeded`,Or.ETIMEDOUT))},t);const g=()=>{e&&(h&&clearTimeout(h),h=null,e.forEach(_=>{_.unsubscribe?_.unsubscribe(u):_.removeEventListener("abort",u)}),e=null)};e.forEach(_=>_.addEventListener("abort",u));const{signal:s}=i;return s.unsubscribe=()=>nt.asap(g),s}},QZ=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let i=0,a;for(;i<r;)a=i+t,yield e.slice(i,a),i=a},JZ=async function*(e,t){for await(const r of eX(e))yield*QZ(r,t)},eX=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:i}=await t.read();if(r)break;yield i}}finally{await t.cancel()}},BN=(e,t,r,i)=>{const a=JZ(e,t);let u=0,h,g=s=>{h||(h=!0,i&&i(s))};return new ReadableStream({async pull(s){try{const{done:_,value:b}=await a.next();if(_){g(),s.close();return}let C=b.byteLength;if(r){let M=u+=C;r(M)}s.enqueue(new Uint8Array(b))}catch(_){throw g(_),_}},cancel(s){return g(s),a.return()}},{highWaterMark:2})},Uw=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",pz=Uw&&typeof ReadableStream=="function",tX=Uw&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),mz=(e,...t)=>{try{return!!e(...t)}catch{return!1}},rX=pz&&mz(()=>{let e=!1;const t=new Request(gs.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),UN=64*1024,MC=pz&&mz(()=>nt.isReadableStream(new Response("").body)),E1={stream:MC&&(e=>e.body)};Uw&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!E1[t]&&(E1[t]=nt.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new Or(`Response type '${t}' is not supported`,Or.ERR_NOT_SUPPORT,i)})})})(new Response);const nX=async e=>{if(e==null)return 0;if(nt.isBlob(e))return e.size;if(nt.isSpecCompliantForm(e))return(await new Request(gs.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(nt.isArrayBufferView(e)||nt.isArrayBuffer(e))return e.byteLength;if(nt.isURLSearchParams(e)&&(e=e+""),nt.isString(e))return(await tX(e)).byteLength},iX=async(e,t)=>{const r=nt.toFiniteNumber(e.getContentLength());return r??nX(t)},sX=Uw&&(async e=>{let{url:t,method:r,data:i,signal:a,cancelToken:u,timeout:h,onDownloadProgress:g,onUploadProgress:s,responseType:_,headers:b,withCredentials:C="same-origin",fetchOptions:M}=fz(e);_=_?(_+"").toLowerCase():"text";let D=KZ([a,u&&u.toAbortSignal()],h),N;const j=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let V;try{if(s&&rX&&r!=="get"&&r!=="head"&&(V=await iX(b,i))!==0){let Q=new Request(t,{method:"POST",body:i,duplex:"half"}),re;if(nt.isFormData(i)&&(re=Q.headers.get("content-type"))&&b.setContentType(re),Q.body){const[oe,pe]=ON(V,S1(zN(s)));i=BN(Q.body,UN,oe,pe)}}nt.isString(C)||(C=C?"include":"omit");const B="credentials"in Request.prototype;N=new Request(t,{...M,signal:D,method:r.toUpperCase(),headers:b.normalize().toJSON(),body:i,duplex:"half",credentials:B?C:void 0});let z=await fetch(N);const U=MC&&(_==="stream"||_==="response");if(MC&&(g||U&&j)){const Q={};["status","statusText","headers"].forEach(ve=>{Q[ve]=z[ve]});const re=nt.toFiniteNumber(z.headers.get("content-length")),[oe,pe]=g&&ON(re,S1(zN(g),!0))||[];z=new Response(BN(z.body,UN,oe,()=>{pe&&pe(),j&&j()}),Q)}_=_||"text";let Z=await E1[nt.findKey(E1,_)||"text"](z,e);return!U&&j&&j(),await new Promise((Q,re)=>{dz(Q,re,{data:Z,headers:ao.from(z.headers),status:z.status,statusText:z.statusText,config:e,request:N})})}catch(B){throw j&&j(),B&&B.name==="TypeError"&&/fetch/i.test(B.message)?Object.assign(new Or("Network Error",Or.ERR_NETWORK,e,N),{cause:B.cause||B}):Or.from(B,B&&B.code,e,N)}}),kC={http:_Z,xhr:YZ,fetch:sX};nt.forEach(kC,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const VN=e=>`- ${e}`,oX=e=>nt.isFunction(e)||e===null||e===!1,gz={getAdapter:e=>{e=nt.isArray(e)?e:[e];const{length:t}=e;let r,i;const a={};for(let u=0;u<t;u++){r=e[u];let h;if(i=r,!oX(r)&&(i=kC[(h=String(r)).toLowerCase()],i===void 0))throw new Or(`Unknown adapter '${h}'`);if(i)break;a[h||"#"+u]=i}if(!i){const u=Object.entries(a).map(([g,s])=>`adapter ${g} `+(s===!1?"is not supported by the environment":"is not available in the build"));let h=t?u.length>1?`since :
`+u.map(VN).join(`
`):" "+VN(u[0]):"as no adapter specified";throw new Or("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return i},adapters:kC};function LE(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new om(null,e)}function $N(e){return LE(e),e.headers=ao.from(e.headers),e.data=jE.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gz.getAdapter(e.adapter||Uv.adapter)(e).then(function(i){return LE(e),i.data=jE.call(e,e.transformResponse,i),i.headers=ao.from(i.headers),i},function(i){return uz(i)||(LE(e),i&&i.response&&(i.response.data=jE.call(e,e.transformResponse,i.response),i.response.headers=ao.from(i.response.headers))),Promise.reject(i)})}const yz="1.8.4",Vw={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Vw[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const WN={};Vw.transitional=function(t,r,i){function a(u,h){return"[Axios v"+yz+"] Transitional option '"+u+"'"+h+(i?". "+i:"")}return(u,h,g)=>{if(t===!1)throw new Or(a(h," has been removed"+(r?" in "+r:"")),Or.ERR_DEPRECATED);return r&&!WN[h]&&(WN[h]=!0,console.warn(a(h," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(u,h,g):!0}};Vw.spelling=function(t){return(r,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function aX(e,t,r){if(typeof e!="object")throw new Or("options must be an object",Or.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let a=i.length;for(;a-- >0;){const u=i[a],h=t[u];if(h){const g=e[u],s=g===void 0||h(g,u,e);if(s!==!0)throw new Or("option "+u+" must be "+s,Or.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Or("Unknown option "+u,Or.ERR_BAD_OPTION)}}const U0={assertOptions:aX,validators:Vw},ul=U0.validators;class mh{constructor(t){this.defaults=t,this.interceptors={request:new jN,response:new jN}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const u=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?u&&!String(i.stack).endsWith(u.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+u):i.stack=u}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Sh(this.defaults,r);const{transitional:i,paramsSerializer:a,headers:u}=r;i!==void 0&&U0.assertOptions(i,{silentJSONParsing:ul.transitional(ul.boolean),forcedJSONParsing:ul.transitional(ul.boolean),clarifyTimeoutError:ul.transitional(ul.boolean)},!1),a!=null&&(nt.isFunction(a)?r.paramsSerializer={serialize:a}:U0.assertOptions(a,{encode:ul.function,serialize:ul.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),U0.assertOptions(r,{baseUrl:ul.spelling("baseURL"),withXsrfToken:ul.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let h=u&&nt.merge(u.common,u[r.method]);u&&nt.forEach(["delete","get","head","post","put","patch","common"],N=>{delete u[N]}),r.headers=ao.concat(h,u);const g=[];let s=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(r)===!1||(s=s&&j.synchronous,g.unshift(j.fulfilled,j.rejected))});const _=[];this.interceptors.response.forEach(function(j){_.push(j.fulfilled,j.rejected)});let b,C=0,M;if(!s){const N=[$N.bind(this),void 0];for(N.unshift.apply(N,g),N.push.apply(N,_),M=N.length,b=Promise.resolve(r);C<M;)b=b.then(N[C++],N[C++]);return b}M=g.length;let D=r;for(C=0;C<M;){const N=g[C++],j=g[C++];try{D=N(D)}catch(V){j.call(this,V);break}}try{b=$N.call(this,D)}catch(N){return Promise.reject(N)}for(C=0,M=_.length;C<M;)b=b.then(_[C++],_[C++]);return b}getUri(t){t=Sh(this.defaults,t);const r=hz(t.baseURL,t.url,t.allowAbsoluteUrls);return az(r,t.params,t.paramsSerializer)}}nt.forEach(["delete","get","head","options"],function(t){mh.prototype[t]=function(r,i){return this.request(Sh(i||{},{method:t,url:r,data:(i||{}).data}))}});nt.forEach(["post","put","patch"],function(t){function r(i){return function(u,h,g){return this.request(Sh(g||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:u,data:h}))}}mh.prototype[t]=r(),mh.prototype[t+"Form"]=r(!0)});class jk{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(u){r=u});const i=this;this.promise.then(a=>{if(!i._listeners)return;let u=i._listeners.length;for(;u-- >0;)i._listeners[u](a);i._listeners=null}),this.promise.then=a=>{let u;const h=new Promise(g=>{i.subscribe(g),u=g}).then(a);return h.cancel=function(){i.unsubscribe(u)},h},t(function(u,h,g){i.reason||(i.reason=new om(u,h,g),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=i=>{t.abort(i)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new jk(function(a){t=a}),cancel:t}}}function lX(e){return function(r){return e.apply(null,r)}}function cX(e){return nt.isObject(e)&&e.isAxiosError===!0}const PC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(PC).forEach(([e,t])=>{PC[t]=e});function vz(e){const t=new mh(e),r=YO(mh.prototype.request,t);return nt.extend(r,mh.prototype,t,{allOwnKeys:!0}),nt.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return vz(Sh(e,a))},r}const Mi=vz(Uv);Mi.Axios=mh;Mi.CanceledError=om;Mi.CancelToken=jk;Mi.isCancel=uz;Mi.VERSION=yz;Mi.toFormData=Bw;Mi.AxiosError=Or;Mi.Cancel=Mi.CanceledError;Mi.all=function(t){return Promise.all(t)};Mi.spread=lX;Mi.isAxiosError=cX;Mi.mergeConfig=Sh;Mi.AxiosHeaders=ao;Mi.formToJSON=e=>cz(nt.isHTMLForm(e)?new FormData(e):e);Mi.getAdapter=gz.getAdapter;Mi.HttpStatusCode=PC;Mi.default=Mi;const Qs={success:(e,t)=>{sh.success(e,t)},error:(e,t)=>{sh.error(e,t)},info:(e,t)=>{sh.info(e,t)},warning:(e,t)=>{sh.warning(e,t)}},uX=Qs.success,dX=Qs.error,hX=Qs.info;function Kd(e,t={}){uX(e,t)}function Dn(e,t={}){dX(e,t)}function GN(e,t={}){hX(e,t)}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fX=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xz=(...e)=>e.filter((t,r,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mX=A.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:a="",children:u,iconNode:h,...g},s)=>A.createElement("svg",{ref:s,...pX,width:t,height:t,stroke:e,strokeWidth:i?Number(r)*24/Number(t):r,className:xz("lucide",a),...g},[...h.map(([_,b])=>A.createElement(_,b)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=(e,t)=>{const r=A.forwardRef(({className:i,...a},u)=>A.createElement(mX,{ref:u,iconNode:t,className:xz(`lucide-${fX(e)}`,i),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=Xt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=Xt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gX=Xt("Beer",[["path",{d:"M17 11h1a3 3 0 0 1 0 6h-1",key:"1yp76v"}],["path",{d:"M9 12v6",key:"1u1cab"}],["path",{d:"M13 12v6",key:"1sugkk"}],["path",{d:"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z",key:"1510fo"}],["path",{d:"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8",key:"19jb7n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=Xt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=Xt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=Xt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Xt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=Xt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yX=Xt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vX=Xt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xX=Xt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _X=Xt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wX=Xt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=Xt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=Xt("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bX=Xt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SX=Xt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=Xt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EX=Xt("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TX=Xt("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=Xt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CX=Xt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=Xt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MX=Xt("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Xt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kX=Xt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PX=Xt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AX=Xt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IX=Xt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Xt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DX=Xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RX=Xt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NX=Xt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=Xt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jX=Xt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LX=Xt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=Xt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OX=Xt("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zX=Xt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=Xt("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=Xt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=Xt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FX=Xt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BX=Xt("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=Xt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=Xt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=Xt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=Xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UX=Xt("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VX=Xt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $X=Xt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WX=Xt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=Xt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GX=Xt("StarOff",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=Xt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=Xt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Xt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=Xt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=Xt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HX=Xt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qX=Xt("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=Xt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZX=Xt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=Xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XX=Xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=Xt("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YX=Xt("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=Xt("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);function KX(e,t){const r=A.createContext(t),i=u=>{const{children:h,...g}=u,s=A.useMemo(()=>g,Object.values(g));return m.jsx(r.Provider,{value:s,children:h})};i.displayName=e+"Provider";function a(u){const h=A.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${u}\` must be used within \`${e}\``)}return[i,a]}function Ya(e,t=[]){let r=[];function i(u,h){const g=A.createContext(h),s=r.length;r=[...r,h];const _=C=>{var B;const{scope:M,children:D,...N}=C,j=((B=M==null?void 0:M[e])==null?void 0:B[s])||g,V=A.useMemo(()=>N,Object.values(N));return m.jsx(j.Provider,{value:V,children:D})};_.displayName=u+"Provider";function b(C,M){var j;const D=((j=M==null?void 0:M[e])==null?void 0:j[s])||g,N=A.useContext(D);if(N)return N;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${u}\``)}return[_,b]}const a=()=>{const u=r.map(h=>A.createContext(h));return function(g){const s=(g==null?void 0:g[e])||u;return A.useMemo(()=>({[`__scope${e}`]:{...g,[e]:s}}),[g,s])}};return a.scopeName=e,[i,QX(a,...t)]}function QX(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(u){const h=i.reduce((g,{useScope:s,scopeName:_})=>{const C=s(u)[`__scope${_}`];return{...g,...C}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function JX(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Vv(...e){return t=>e.forEach(r=>JX(r,t))}function Cr(...e){return A.useCallback(Vv(...e),e)}function kt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}var Ni=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},eY=PL.useId||(()=>{}),tY=0;function Po(e){const[t,r]=A.useState(eY());return Ni(()=>{e||r(i=>i??String(tY++))},[e]),e||(t?`radix-${t}`:"")}function jn(e){const t=A.useRef(e);return A.useEffect(()=>{t.current=e}),A.useMemo(()=>(...r)=>{var i;return(i=t.current)==null?void 0:i.call(t,...r)},[])}function Wa({prop:e,defaultProp:t,onChange:r=()=>{}}){const[i,a]=rY({defaultProp:t,onChange:r}),u=e!==void 0,h=u?e:i,g=jn(r),s=A.useCallback(_=>{if(u){const C=typeof _=="function"?_(e):_;C!==e&&g(C)}else a(_)},[u,e,a,g]);return[h,s]}function rY({defaultProp:e,onChange:t}){const r=A.useState(e),[i]=r,a=A.useRef(i),u=jn(t);return A.useEffect(()=>{a.current!==i&&(u(i),a.current=i)},[i,a,u]),r}var Tl=A.forwardRef((e,t)=>{const{children:r,...i}=e,a=A.Children.toArray(r),u=a.find(nY);if(u){const h=u.props.children,g=a.map(s=>s===u?A.Children.count(h)>1?A.Children.only(null):A.isValidElement(h)?h.props.children:null:s);return m.jsx(DC,{...i,ref:t,children:A.isValidElement(h)?A.cloneElement(h,void 0,g):null})}return m.jsx(DC,{...i,ref:t,children:r})});Tl.displayName="Slot";var DC=A.forwardRef((e,t)=>{const{children:r,...i}=e;if(A.isValidElement(r)){const a=sY(r);return A.cloneElement(r,{...iY(i,r.props),ref:t?Vv(t,a):a})}return A.Children.count(r)>1?A.Children.only(null):null});DC.displayName="SlotClone";var Az=({children:e})=>m.jsx(m.Fragment,{children:e});function nY(e){return A.isValidElement(e)&&e.type===Az}function iY(e,t){const r={...t};for(const i in t){const a=e[i],u=t[i];/^on[A-Z]/.test(i)?a&&u?r[i]=(...g)=>{u(...g),a(...g)}:a&&(r[i]=a):i==="style"?r[i]={...a,...u}:i==="className"&&(r[i]=[a,u].filter(Boolean).join(" "))}return{...e,...r}}function sY(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var oY=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],sr=oY.reduce((e,t)=>{const r=A.forwardRef((i,a)=>{const{asChild:u,...h}=i,g=u?Tl:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(g,{...h,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function T1(e,t){e&&rm.flushSync(()=>e.dispatchEvent(t))}function aY(e,t=globalThis==null?void 0:globalThis.document){const r=jn(e);A.useEffect(()=>{const i=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[r,t])}var lY="DismissableLayer",RC="dismissableLayer.update",cY="dismissableLayer.pointerDownOutside",uY="dismissableLayer.focusOutside",JN,Iz=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),lm=A.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:u,onInteractOutside:h,onDismiss:g,...s}=e,_=A.useContext(Iz),[b,C]=A.useState(null),M=(b==null?void 0:b.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,D]=A.useState({}),N=Cr(t,oe=>C(oe)),j=Array.from(_.layers),[V]=[..._.layersWithOutsidePointerEventsDisabled].slice(-1),B=j.indexOf(V),z=b?j.indexOf(b):-1,U=_.layersWithOutsidePointerEventsDisabled.size>0,Z=z>=B,Q=fY(oe=>{const pe=oe.target,ve=[..._.branches].some(he=>he.contains(pe));!Z||ve||(a==null||a(oe),h==null||h(oe),oe.defaultPrevented||g==null||g())},M),re=pY(oe=>{const pe=oe.target;[..._.branches].some(he=>he.contains(pe))||(u==null||u(oe),h==null||h(oe),oe.defaultPrevented||g==null||g())},M);return aY(oe=>{z===_.layers.size-1&&(i==null||i(oe),!oe.defaultPrevented&&g&&(oe.preventDefault(),g()))},M),A.useEffect(()=>{if(b)return r&&(_.layersWithOutsidePointerEventsDisabled.size===0&&(JN=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),_.layersWithOutsidePointerEventsDisabled.add(b)),_.layers.add(b),ej(),()=>{r&&_.layersWithOutsidePointerEventsDisabled.size===1&&(M.body.style.pointerEvents=JN)}},[b,M,r,_]),A.useEffect(()=>()=>{b&&(_.layers.delete(b),_.layersWithOutsidePointerEventsDisabled.delete(b),ej())},[b,_]),A.useEffect(()=>{const oe=()=>D({});return document.addEventListener(RC,oe),()=>document.removeEventListener(RC,oe)},[]),m.jsx(sr.div,{...s,ref:N,style:{pointerEvents:U?Z?"auto":"none":void 0,...e.style},onFocusCapture:kt(e.onFocusCapture,re.onFocusCapture),onBlurCapture:kt(e.onBlurCapture,re.onBlurCapture),onPointerDownCapture:kt(e.onPointerDownCapture,Q.onPointerDownCapture)})});lm.displayName=lY;var dY="DismissableLayerBranch",hY=A.forwardRef((e,t)=>{const r=A.useContext(Iz),i=A.useRef(null),a=Cr(t,i);return A.useEffect(()=>{const u=i.current;if(u)return r.branches.add(u),()=>{r.branches.delete(u)}},[r.branches]),m.jsx(sr.div,{...e,ref:a})});hY.displayName=dY;function fY(e,t=globalThis==null?void 0:globalThis.document){const r=jn(e),i=A.useRef(!1),a=A.useRef(()=>{});return A.useEffect(()=>{const u=g=>{if(g.target&&!i.current){let s=function(){Dz(cY,r,_,{discrete:!0})};const _={originalEvent:g};g.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=s,t.addEventListener("click",a.current,{once:!0})):s()}else t.removeEventListener("click",a.current);i.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",u),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>i.current=!0}}function pY(e,t=globalThis==null?void 0:globalThis.document){const r=jn(e),i=A.useRef(!1);return A.useEffect(()=>{const a=u=>{u.target&&!i.current&&Dz(uY,r,{originalEvent:u},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function ej(){const e=new CustomEvent(RC);document.dispatchEvent(e)}function Dz(e,t,r,{discrete:i}){const a=r.originalEvent.target,u=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),i?T1(a,u):a.dispatchEvent(u)}var zE="focusScope.autoFocusOnMount",FE="focusScope.autoFocusOnUnmount",tj={bubbles:!1,cancelable:!0},mY="FocusScope",$v=A.forwardRef((e,t)=>{const{loop:r=!1,trapped:i=!1,onMountAutoFocus:a,onUnmountAutoFocus:u,...h}=e,[g,s]=A.useState(null),_=jn(a),b=jn(u),C=A.useRef(null),M=Cr(t,j=>s(j)),D=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(i){let j=function(U){if(D.paused||!g)return;const Z=U.target;g.contains(Z)?C.current=Z:lu(C.current,{select:!0})},V=function(U){if(D.paused||!g)return;const Z=U.relatedTarget;Z!==null&&(g.contains(Z)||lu(C.current,{select:!0}))},B=function(U){if(document.activeElement===document.body)for(const Q of U)Q.removedNodes.length>0&&lu(g)};document.addEventListener("focusin",j),document.addEventListener("focusout",V);const z=new MutationObserver(B);return g&&z.observe(g,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",j),document.removeEventListener("focusout",V),z.disconnect()}}},[i,g,D.paused]),A.useEffect(()=>{if(g){nj.add(D);const j=document.activeElement;if(!g.contains(j)){const B=new CustomEvent(zE,tj);g.addEventListener(zE,_),g.dispatchEvent(B),B.defaultPrevented||(gY(wY(Rz(g)),{select:!0}),document.activeElement===j&&lu(g))}return()=>{g.removeEventListener(zE,_),setTimeout(()=>{const B=new CustomEvent(FE,tj);g.addEventListener(FE,b),g.dispatchEvent(B),B.defaultPrevented||lu(j??document.body,{select:!0}),g.removeEventListener(FE,b),nj.remove(D)},0)}}},[g,_,b,D]);const N=A.useCallback(j=>{if(!r&&!i||D.paused)return;const V=j.key==="Tab"&&!j.altKey&&!j.ctrlKey&&!j.metaKey,B=document.activeElement;if(V&&B){const z=j.currentTarget,[U,Z]=yY(z);U&&Z?!j.shiftKey&&B===Z?(j.preventDefault(),r&&lu(U,{select:!0})):j.shiftKey&&B===U&&(j.preventDefault(),r&&lu(Z,{select:!0})):B===z&&j.preventDefault()}},[r,i,D.paused]);return m.jsx(sr.div,{tabIndex:-1,...h,ref:M,onKeyDown:N})});$v.displayName=mY;function gY(e,{select:t=!1}={}){const r=document.activeElement;for(const i of e)if(lu(i,{select:t}),document.activeElement!==r)return}function yY(e){const t=Rz(e),r=rj(t,e),i=rj(t.reverse(),e);return[r,i]}function Rz(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function rj(e,t){for(const r of e)if(!vY(r,{upTo:t}))return r}function vY(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function xY(e){return e instanceof HTMLInputElement&&"select"in e}function lu(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&xY(e)&&t&&e.select()}}var nj=_Y();function _Y(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=ij(e,t),e.unshift(t)},remove(t){var r;e=ij(e,t),(r=e[0])==null||r.resume()}}}function ij(e,t){const r=[...e],i=r.indexOf(t);return i!==-1&&r.splice(i,1),r}function wY(e){return e.filter(t=>t.tagName!=="A")}var bY="Portal",Wv=A.forwardRef((e,t)=>{var g;const{container:r,...i}=e,[a,u]=A.useState(!1);Ni(()=>u(!0),[]);const h=r||a&&((g=globalThis==null?void 0:globalThis.document)==null?void 0:g.body);return h?Ek.createPortal(m.jsx(sr.div,{...i,ref:t}),h):null});Wv.displayName=bY;function SY(e,t){return A.useReducer((r,i)=>t[r][i]??r,e)}var ji=e=>{const{present:t,children:r}=e,i=EY(t),a=typeof r=="function"?r({present:i.isPresent}):A.Children.only(r),u=Cr(i.ref,TY(a));return typeof r=="function"||i.isPresent?A.cloneElement(a,{ref:u}):null};ji.displayName="Presence";function EY(e){const[t,r]=A.useState(),i=A.useRef({}),a=A.useRef(e),u=A.useRef("none"),h=e?"mounted":"unmounted",[g,s]=SY(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const _=f0(i.current);u.current=g==="mounted"?_:"none"},[g]),Ni(()=>{const _=i.current,b=a.current;if(b!==e){const M=u.current,D=f0(_);e?s("MOUNT"):D==="none"||(_==null?void 0:_.display)==="none"?s("UNMOUNT"):s(b&&M!==D?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,s]),Ni(()=>{if(t){let _;const b=t.ownerDocument.defaultView??window,C=D=>{const j=f0(i.current).includes(D.animationName);if(D.target===t&&j&&(s("ANIMATION_END"),!a.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",_=b.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},M=D=>{D.target===t&&(u.current=f0(i.current))};return t.addEventListener("animationstart",M),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{b.clearTimeout(_),t.removeEventListener("animationstart",M),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else s("ANIMATION_END")},[t,s]),{isPresent:["mounted","unmountSuspended"].includes(g),ref:A.useCallback(_=>{_&&(i.current=getComputedStyle(_)),r(_)},[])}}function f0(e){return(e==null?void 0:e.animationName)||"none"}function TY(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var BE=0;function $w(){A.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??sj()),document.body.insertAdjacentElement("beforeend",e[1]??sj()),BE++,()=>{BE===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),BE--}},[])}function sj(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var yl=function(){return yl=Object.assign||function(t){for(var r,i=1,a=arguments.length;i<a;i++){r=arguments[i];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},yl.apply(this,arguments)};function Nz(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r}function CY(e,t,r){if(r||arguments.length===2)for(var i=0,a=t.length,u;i<a;i++)(u||!(i in t))&&(u||(u=Array.prototype.slice.call(t,0,i)),u[i]=t[i]);return e.concat(u||Array.prototype.slice.call(t))}var V0="right-scroll-bar-position",$0="width-before-scroll-bar",MY="with-scroll-bars-hidden",kY="--removed-body-scroll-bar-size";function UE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function PY(e,t){var r=A.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(i){var a=r.value;a!==i&&(r.value=i,r.callback(i,a))}}}})[0];return r.callback=t,r.facade}var AY=typeof window<"u"?A.useLayoutEffect:A.useEffect,oj=new WeakMap;function IY(e,t){var r=PY(null,function(i){return e.forEach(function(a){return UE(a,i)})});return AY(function(){var i=oj.get(r);if(i){var a=new Set(i),u=new Set(e),h=r.current;a.forEach(function(g){u.has(g)||UE(g,null)}),u.forEach(function(g){a.has(g)||UE(g,h)})}oj.set(r,e)},[e]),r}function DY(e){return e}function RY(e,t){t===void 0&&(t=DY);var r=[],i=!1,a={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(u){var h=t(u,i);return r.push(h),function(){r=r.filter(function(g){return g!==h})}},assignSyncMedium:function(u){for(i=!0;r.length;){var h=r;r=[],h.forEach(u)}r={push:function(g){return u(g)},filter:function(){return r}}},assignMedium:function(u){i=!0;var h=[];if(r.length){var g=r;r=[],g.forEach(u),h=r}var s=function(){var b=h;h=[],b.forEach(u)},_=function(){return Promise.resolve().then(s)};_(),r={push:function(b){h.push(b),_()},filter:function(b){return h=h.filter(b),r}}}};return a}function NY(e){e===void 0&&(e={});var t=RY(null);return t.options=yl({async:!0,ssr:!1},e),t}var jz=function(e){var t=e.sideCar,r=Nz(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return A.createElement(i,yl({},r))};jz.isSideCarExport=!0;function jY(e,t){return e.useMedium(t),jz}var Lz=NY(),VE=function(){},Ww=A.forwardRef(function(e,t){var r=A.useRef(null),i=A.useState({onScrollCapture:VE,onWheelCapture:VE,onTouchMoveCapture:VE}),a=i[0],u=i[1],h=e.forwardProps,g=e.children,s=e.className,_=e.removeScrollBar,b=e.enabled,C=e.shards,M=e.sideCar,D=e.noIsolation,N=e.inert,j=e.allowPinchZoom,V=e.as,B=V===void 0?"div":V,z=e.gapMode,U=Nz(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Z=M,Q=IY([r,t]),re=yl(yl({},U),a);return A.createElement(A.Fragment,null,b&&A.createElement(Z,{sideCar:Lz,removeScrollBar:_,shards:C,noIsolation:D,inert:N,setCallbacks:u,allowPinchZoom:!!j,lockRef:r,gapMode:z}),h?A.cloneElement(A.Children.only(g),yl(yl({},re),{ref:Q})):A.createElement(B,yl({},re,{className:s,ref:Q}),g))});Ww.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ww.classNames={fullWidth:$0,zeroRight:V0};var LY=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function OY(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=LY();return t&&e.setAttribute("nonce",t),e}function zY(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function FY(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var BY=function(){var e=0,t=null;return{add:function(r){e==0&&(t=OY())&&(zY(t,r),FY(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},UY=function(){var e=BY();return function(t,r){A.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Oz=function(){var e=UY(),t=function(r){var i=r.styles,a=r.dynamic;return e(i,a),null};return t},VY={left:0,top:0,right:0,gap:0},$E=function(e){return parseInt(e||"",10)||0},$Y=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[$E(r),$E(i),$E(a)]},WY=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return VY;var t=$Y(e),r=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-r+t[2]-t[0])}},GY=Oz(),yp="data-scroll-locked",HY=function(e,t,r,i){var a=e.left,u=e.top,h=e.right,g=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(MY,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(g,"px ").concat(i,`;
  }
  body[`).concat(yp,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(u,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(g,"px ").concat(i,`;
    `),r==="padding"&&"padding-right: ".concat(g,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(V0,` {
    right: `).concat(g,"px ").concat(i,`;
  }
  
  .`).concat($0,` {
    margin-right: `).concat(g,"px ").concat(i,`;
  }
  
  .`).concat(V0," .").concat(V0,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat($0," .").concat($0,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(yp,`] {
    `).concat(kY,": ").concat(g,`px;
  }
`)},aj=function(){var e=parseInt(document.body.getAttribute(yp)||"0",10);return isFinite(e)?e:0},qY=function(){A.useEffect(function(){return document.body.setAttribute(yp,(aj()+1).toString()),function(){var e=aj()-1;e<=0?document.body.removeAttribute(yp):document.body.setAttribute(yp,e.toString())}},[])},ZY=function(e){var t=e.noRelative,r=e.noImportant,i=e.gapMode,a=i===void 0?"margin":i;qY();var u=A.useMemo(function(){return WY(a)},[a]);return A.createElement(GY,{styles:HY(u,!t,a,r?"":"!important")})},NC=!1;if(typeof window<"u")try{var p0=Object.defineProperty({},"passive",{get:function(){return NC=!0,!0}});window.addEventListener("test",p0,p0),window.removeEventListener("test",p0,p0)}catch{NC=!1}var Bf=NC?{passive:!1}:!1,XY=function(e){return e.tagName==="TEXTAREA"},zz=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!XY(e)&&r[t]==="visible")},YY=function(e){return zz(e,"overflowY")},KY=function(e){return zz(e,"overflowX")},lj=function(e,t){var r=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var a=Fz(e,i);if(a){var u=Bz(e,i),h=u[1],g=u[2];if(h>g)return!0}i=i.parentNode}while(i&&i!==r.body);return!1},QY=function(e){var t=e.scrollTop,r=e.scrollHeight,i=e.clientHeight;return[t,r,i]},JY=function(e){var t=e.scrollLeft,r=e.scrollWidth,i=e.clientWidth;return[t,r,i]},Fz=function(e,t){return e==="v"?YY(t):KY(t)},Bz=function(e,t){return e==="v"?QY(t):JY(t)},eK=function(e,t){return e==="h"&&t==="rtl"?-1:1},tK=function(e,t,r,i,a){var u=eK(e,window.getComputedStyle(t).direction),h=u*i,g=r.target,s=t.contains(g),_=!1,b=h>0,C=0,M=0;do{var D=Bz(e,g),N=D[0],j=D[1],V=D[2],B=j-V-u*N;(N||B)&&Fz(e,g)&&(C+=B,M+=N),g instanceof ShadowRoot?g=g.host:g=g.parentNode}while(!s&&g!==document.body||s&&(t.contains(g)||t===g));return(b&&(Math.abs(C)<1||!a)||!b&&(Math.abs(M)<1||!a))&&(_=!0),_},m0=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},cj=function(e){return[e.deltaX,e.deltaY]},uj=function(e){return e&&"current"in e?e.current:e},rK=function(e,t){return e[0]===t[0]&&e[1]===t[1]},nK=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},iK=0,Uf=[];function sK(e){var t=A.useRef([]),r=A.useRef([0,0]),i=A.useRef(),a=A.useState(iK++)[0],u=A.useState(Oz)[0],h=A.useRef(e);A.useEffect(function(){h.current=e},[e]),A.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var j=CY([e.lockRef.current],(e.shards||[]).map(uj),!0).filter(Boolean);return j.forEach(function(V){return V.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),j.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var g=A.useCallback(function(j,V){if("touches"in j&&j.touches.length===2||j.type==="wheel"&&j.ctrlKey)return!h.current.allowPinchZoom;var B=m0(j),z=r.current,U="deltaX"in j?j.deltaX:z[0]-B[0],Z="deltaY"in j?j.deltaY:z[1]-B[1],Q,re=j.target,oe=Math.abs(U)>Math.abs(Z)?"h":"v";if("touches"in j&&oe==="h"&&re.type==="range")return!1;var pe=lj(oe,re);if(!pe)return!0;if(pe?Q=oe:(Q=oe==="v"?"h":"v",pe=lj(oe,re)),!pe)return!1;if(!i.current&&"changedTouches"in j&&(U||Z)&&(i.current=Q),!Q)return!0;var ve=i.current||Q;return tK(ve,V,j,ve==="h"?U:Z,!0)},[]),s=A.useCallback(function(j){var V=j;if(!(!Uf.length||Uf[Uf.length-1]!==u)){var B="deltaY"in V?cj(V):m0(V),z=t.current.filter(function(Q){return Q.name===V.type&&(Q.target===V.target||V.target===Q.shadowParent)&&rK(Q.delta,B)})[0];if(z&&z.should){V.cancelable&&V.preventDefault();return}if(!z){var U=(h.current.shards||[]).map(uj).filter(Boolean).filter(function(Q){return Q.contains(V.target)}),Z=U.length>0?g(V,U[0]):!h.current.noIsolation;Z&&V.cancelable&&V.preventDefault()}}},[]),_=A.useCallback(function(j,V,B,z){var U={name:j,delta:V,target:B,should:z,shadowParent:oK(B)};t.current.push(U),setTimeout(function(){t.current=t.current.filter(function(Z){return Z!==U})},1)},[]),b=A.useCallback(function(j){r.current=m0(j),i.current=void 0},[]),C=A.useCallback(function(j){_(j.type,cj(j),j.target,g(j,e.lockRef.current))},[]),M=A.useCallback(function(j){_(j.type,m0(j),j.target,g(j,e.lockRef.current))},[]);A.useEffect(function(){return Uf.push(u),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:M}),document.addEventListener("wheel",s,Bf),document.addEventListener("touchmove",s,Bf),document.addEventListener("touchstart",b,Bf),function(){Uf=Uf.filter(function(j){return j!==u}),document.removeEventListener("wheel",s,Bf),document.removeEventListener("touchmove",s,Bf),document.removeEventListener("touchstart",b,Bf)}},[]);var D=e.removeScrollBar,N=e.inert;return A.createElement(A.Fragment,null,N?A.createElement(u,{styles:nK(a)}):null,D?A.createElement(ZY,{gapMode:e.gapMode}):null)}function oK(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const aK=jY(Lz,sK);var Gv=A.forwardRef(function(e,t){return A.createElement(Ww,yl({},e,{ref:t,sideCar:aK}))});Gv.classNames=Ww.classNames;var lK=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Vf=new WeakMap,g0=new WeakMap,y0={},WE=0,Uz=function(e){return e&&(e.host||Uz(e.parentNode))},cK=function(e,t){return t.map(function(r){if(e.contains(r))return r;var i=Uz(r);return i&&e.contains(i)?i:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},uK=function(e,t,r,i){var a=cK(t,Array.isArray(e)?e:[e]);y0[r]||(y0[r]=new WeakMap);var u=y0[r],h=[],g=new Set,s=new Set(a),_=function(C){!C||g.has(C)||(g.add(C),_(C.parentNode))};a.forEach(_);var b=function(C){!C||s.has(C)||Array.prototype.forEach.call(C.children,function(M){if(g.has(M))b(M);else try{var D=M.getAttribute(i),N=D!==null&&D!=="false",j=(Vf.get(M)||0)+1,V=(u.get(M)||0)+1;Vf.set(M,j),u.set(M,V),h.push(M),j===1&&N&&g0.set(M,!0),V===1&&M.setAttribute(r,"true"),N||M.setAttribute(i,"true")}catch(B){console.error("aria-hidden: cannot operate on ",M,B)}})};return b(t),g.clear(),WE++,function(){h.forEach(function(C){var M=Vf.get(C)-1,D=u.get(C)-1;Vf.set(C,M),u.set(C,D),M||(g0.has(C)||C.removeAttribute(i),g0.delete(C)),D||C.removeAttribute(r)}),WE--,WE||(Vf=new WeakMap,Vf=new WeakMap,g0=new WeakMap,y0={})}},Gw=function(e,t,r){r===void 0&&(r="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),a=lK(e);return a?(i.push.apply(i,Array.from(a.querySelectorAll("[aria-live]"))),uK(i,a,r,"aria-hidden")):function(){return null}},Uk="Dialog",[Vz,$z]=Ya(Uk),[dK,Ka]=Vz(Uk),Wz=e=>{const{__scopeDialog:t,children:r,open:i,defaultOpen:a,onOpenChange:u,modal:h=!0}=e,g=A.useRef(null),s=A.useRef(null),[_=!1,b]=Wa({prop:i,defaultProp:a,onChange:u});return m.jsx(dK,{scope:t,triggerRef:g,contentRef:s,contentId:Po(),titleId:Po(),descriptionId:Po(),open:_,onOpenChange:b,onOpenToggle:A.useCallback(()=>b(C=>!C),[b]),modal:h,children:r})};Wz.displayName=Uk;var Gz="DialogTrigger",Hz=A.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ka(Gz,r),u=Cr(t,a.triggerRef);return m.jsx(sr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Wk(a.open),...i,ref:u,onClick:kt(e.onClick,a.onOpenToggle)})});Hz.displayName=Gz;var Vk="DialogPortal",[hK,qz]=Vz(Vk,{forceMount:void 0}),Zz=e=>{const{__scopeDialog:t,forceMount:r,children:i,container:a}=e,u=Ka(Vk,t);return m.jsx(hK,{scope:t,forceMount:r,children:A.Children.map(i,h=>m.jsx(ji,{present:r||u.open,children:m.jsx(Wv,{asChild:!0,container:a,children:h})}))})};Zz.displayName=Vk;var C1="DialogOverlay",Xz=A.forwardRef((e,t)=>{const r=qz(C1,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,u=Ka(C1,e.__scopeDialog);return u.modal?m.jsx(ji,{present:i||u.open,children:m.jsx(fK,{...a,ref:t})}):null});Xz.displayName=C1;var fK=A.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ka(C1,r);return m.jsx(Gv,{as:Tl,allowPinchZoom:!0,shards:[a.contentRef],children:m.jsx(sr.div,{"data-state":Wk(a.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),Eh="DialogContent",Yz=A.forwardRef((e,t)=>{const r=qz(Eh,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,u=Ka(Eh,e.__scopeDialog);return m.jsx(ji,{present:i||u.open,children:u.modal?m.jsx(pK,{...a,ref:t}):m.jsx(mK,{...a,ref:t})})});Yz.displayName=Eh;var pK=A.forwardRef((e,t)=>{const r=Ka(Eh,e.__scopeDialog),i=A.useRef(null),a=Cr(t,r.contentRef,i);return A.useEffect(()=>{const u=i.current;if(u)return Gw(u)},[]),m.jsx(Kz,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(e.onCloseAutoFocus,u=>{var h;u.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:kt(e.onPointerDownOutside,u=>{const h=u.detail.originalEvent,g=h.button===0&&h.ctrlKey===!0;(h.button===2||g)&&u.preventDefault()}),onFocusOutside:kt(e.onFocusOutside,u=>u.preventDefault())})}),mK=A.forwardRef((e,t)=>{const r=Ka(Eh,e.__scopeDialog),i=A.useRef(!1),a=A.useRef(!1);return m.jsx(Kz,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,g;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(g=r.triggerRef.current)==null||g.focus(),u.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:u=>{var s,_;(s=e.onInteractOutside)==null||s.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=u.target;((_=r.triggerRef.current)==null?void 0:_.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&a.current&&u.preventDefault()}})}),Kz=A.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:u,...h}=e,g=Ka(Eh,r),s=A.useRef(null),_=Cr(t,s);return $w(),m.jsxs(m.Fragment,{children:[m.jsx($v,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:u,children:m.jsx(lm,{role:"dialog",id:g.contentId,"aria-describedby":g.descriptionId,"aria-labelledby":g.titleId,"data-state":Wk(g.open),...h,ref:_,onDismiss:()=>g.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(yK,{titleId:g.titleId}),m.jsx(xK,{contentRef:s,descriptionId:g.descriptionId})]})]})}),$k="DialogTitle",Qz=A.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ka($k,r);return m.jsx(sr.h2,{id:a.titleId,...i,ref:t})});Qz.displayName=$k;var Jz="DialogDescription",eF=A.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ka(Jz,r);return m.jsx(sr.p,{id:a.descriptionId,...i,ref:t})});eF.displayName=Jz;var tF="DialogClose",rF=A.forwardRef((e,t)=>{const{__scopeDialog:r,...i}=e,a=Ka(tF,r);return m.jsx(sr.button,{type:"button",...i,ref:t,onClick:kt(e.onClick,()=>a.onOpenChange(!1))})});rF.displayName=tF;function Wk(e){return e?"open":"closed"}var nF="DialogTitleWarning",[gK,iF]=KX(nF,{contentName:Eh,titleName:$k,docsSlug:"dialog"}),yK=({titleId:e})=>{const t=iF(nF),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return A.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},vK="DialogDescriptionWarning",xK=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${iF(vK).contentName}}.`;return A.useEffect(()=>{var u;const a=(u=e.current)==null?void 0:u.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},Gk=Wz,_K=Hz,Hk=Zz,Hv=Xz,qv=Yz,Zv=Qz,Xv=eF,Yv=rF,sF="AlertDialog",[wK,vfe]=Ya(sF,[$z]),Cc=$z(),oF=e=>{const{__scopeAlertDialog:t,...r}=e,i=Cc(t);return m.jsx(Gk,{...i,...r,modal:!0})};oF.displayName=sF;var bK="AlertDialogTrigger",SK=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Cc(r);return m.jsx(_K,{...a,...i,ref:t})});SK.displayName=bK;var EK="AlertDialogPortal",aF=e=>{const{__scopeAlertDialog:t,...r}=e,i=Cc(t);return m.jsx(Hk,{...i,...r})};aF.displayName=EK;var TK="AlertDialogOverlay",lF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Cc(r);return m.jsx(Hv,{...a,...i,ref:t})});lF.displayName=TK;var vp="AlertDialogContent",[CK,MK]=wK(vp),cF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:i,...a}=e,u=Cc(r),h=A.useRef(null),g=Cr(t,h),s=A.useRef(null);return m.jsx(gK,{contentName:vp,titleName:uF,docsSlug:"alert-dialog",children:m.jsx(CK,{scope:r,cancelRef:s,children:m.jsxs(qv,{role:"alertdialog",...u,...a,ref:g,onOpenAutoFocus:kt(a.onOpenAutoFocus,_=>{var b;_.preventDefault(),(b=s.current)==null||b.focus({preventScroll:!0})}),onPointerDownOutside:_=>_.preventDefault(),onInteractOutside:_=>_.preventDefault(),children:[m.jsx(Az,{children:i}),m.jsx(PK,{contentRef:h})]})})})});cF.displayName=vp;var uF="AlertDialogTitle",dF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Cc(r);return m.jsx(Zv,{...a,...i,ref:t})});dF.displayName=uF;var hF="AlertDialogDescription",fF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Cc(r);return m.jsx(Xv,{...a,...i,ref:t})});fF.displayName=hF;var kK="AlertDialogAction",pF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,a=Cc(r);return m.jsx(Yv,{...a,...i,ref:t})});pF.displayName=kK;var mF="AlertDialogCancel",gF=A.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...i}=e,{cancelRef:a}=MK(mF,r),u=Cc(r),h=Cr(t,a);return m.jsx(Yv,{...u,...i,ref:h})});gF.displayName=mF;var PK=({contentRef:e})=>{const t=`\`${vp}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${vp}\` by passing a \`${hF}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${vp}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return A.useEffect(()=>{var i;document.getElementById((i=e.current)==null?void 0:i.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},AK=oF,IK=aF,yF=lF,vF=cF,xF=pF,_F=gF,wF=dF,bF=fF;function SF(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=SF(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r);return i}function EF(){for(var e,t,r=0,i="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=SF(e))&&(i&&(i+=" "),i+=t);return i}const qk="-",DK=e=>{const t=NK(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:h=>{const g=h.split(qk);return g[0]===""&&g.length!==1&&g.shift(),TF(g,t)||RK(h)},getConflictingClassGroupIds:(h,g)=>{const s=r[h]||[];return g&&i[h]?[...s,...i[h]]:s}}},TF=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],i=t.nextPart.get(r),a=i?TF(e.slice(1),i):void 0;if(a)return a;if(t.validators.length===0)return;const u=e.join(qk);return(h=t.validators.find(({validator:g})=>g(u)))==null?void 0:h.classGroupId},dj=/^\[(.+)\]$/,RK=e=>{if(dj.test(e)){const t=dj.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},NK=e=>{const{theme:t,prefix:r}=e,i={nextPart:new Map,validators:[]};return LK(Object.entries(e.classGroups),r).forEach(([u,h])=>{jC(h,i,u,t)}),i},jC=(e,t,r,i)=>{e.forEach(a=>{if(typeof a=="string"){const u=a===""?t:hj(t,a);u.classGroupId=r;return}if(typeof a=="function"){if(jK(a)){jC(a(i),t,r,i);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([u,h])=>{jC(h,hj(t,u),r,i)})})},hj=(e,t)=>{let r=e;return t.split(qk).forEach(i=>{r.nextPart.has(i)||r.nextPart.set(i,{nextPart:new Map,validators:[]}),r=r.nextPart.get(i)}),r},jK=e=>e.isThemeGetter,LK=(e,t)=>t?e.map(([r,i])=>{const a=i.map(u=>typeof u=="string"?t+u:typeof u=="object"?Object.fromEntries(Object.entries(u).map(([h,g])=>[t+h,g])):u);return[r,a]}):e,OK=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,i=new Map;const a=(u,h)=>{r.set(u,h),t++,t>e&&(t=0,i=r,r=new Map)};return{get(u){let h=r.get(u);if(h!==void 0)return h;if((h=i.get(u))!==void 0)return a(u,h),h},set(u,h){r.has(u)?r.set(u,h):a(u,h)}}},CF="!",zK=e=>{const{separator:t,experimentalParseClassName:r}=e,i=t.length===1,a=t[0],u=t.length,h=g=>{const s=[];let _=0,b=0,C;for(let V=0;V<g.length;V++){let B=g[V];if(_===0){if(B===a&&(i||g.slice(V,V+u)===t)){s.push(g.slice(b,V)),b=V+u;continue}if(B==="/"){C=V;continue}}B==="["?_++:B==="]"&&_--}const M=s.length===0?g:g.substring(b),D=M.startsWith(CF),N=D?M.substring(1):M,j=C&&C>b?C-b:void 0;return{modifiers:s,hasImportantModifier:D,baseClassName:N,maybePostfixModifierPosition:j}};return r?g=>r({className:g,parseClassName:h}):h},FK=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(i=>{i[0]==="["?(t.push(...r.sort(),i),r=[]):r.push(i)}),t.push(...r.sort()),t},BK=e=>({cache:OK(e.cacheSize),parseClassName:zK(e),...DK(e)}),UK=/\s+/,VK=(e,t)=>{const{parseClassName:r,getClassGroupId:i,getConflictingClassGroupIds:a}=t,u=[],h=e.trim().split(UK);let g="";for(let s=h.length-1;s>=0;s-=1){const _=h[s],{modifiers:b,hasImportantModifier:C,baseClassName:M,maybePostfixModifierPosition:D}=r(_);let N=!!D,j=i(N?M.substring(0,D):M);if(!j){if(!N){g=_+(g.length>0?" "+g:g);continue}if(j=i(M),!j){g=_+(g.length>0?" "+g:g);continue}N=!1}const V=FK(b).join(":"),B=C?V+CF:V,z=B+j;if(u.includes(z))continue;u.push(z);const U=a(j,N);for(let Z=0;Z<U.length;++Z){const Q=U[Z];u.push(B+Q)}g=_+(g.length>0?" "+g:g)}return g};function $K(){let e=0,t,r,i="";for(;e<arguments.length;)(t=arguments[e++])&&(r=MF(t))&&(i&&(i+=" "),i+=r);return i}const MF=e=>{if(typeof e=="string")return e;let t,r="";for(let i=0;i<e.length;i++)e[i]&&(t=MF(e[i]))&&(r&&(r+=" "),r+=t);return r};function WK(e,...t){let r,i,a,u=h;function h(s){const _=t.reduce((b,C)=>C(b),e());return r=BK(_),i=r.cache.get,a=r.cache.set,u=g,g(s)}function g(s){const _=i(s);if(_)return _;const b=VK(s,r);return a(s,b),b}return function(){return u($K.apply(null,arguments))}}const Bn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},kF=/^\[(?:([a-z-]+):)?(.+)\]$/i,GK=/^\d+\/\d+$/,HK=new Set(["px","full","screen"]),qK=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ZK=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,XK=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,YK=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,KK=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yl=e=>xp(e)||HK.has(e)||GK.test(e),iu=e=>cm(e,"length",sQ),xp=e=>!!e&&!Number.isNaN(Number(e)),GE=e=>cm(e,"number",xp),sy=e=>!!e&&Number.isInteger(Number(e)),QK=e=>e.endsWith("%")&&xp(e.slice(0,-1)),Fr=e=>kF.test(e),su=e=>qK.test(e),JK=new Set(["length","size","percentage"]),eQ=e=>cm(e,JK,PF),tQ=e=>cm(e,"position",PF),rQ=new Set(["image","url"]),nQ=e=>cm(e,rQ,aQ),iQ=e=>cm(e,"",oQ),oy=()=>!0,cm=(e,t,r)=>{const i=kF.exec(e);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):r(i[2]):!1},sQ=e=>ZK.test(e)&&!XK.test(e),PF=()=>!1,oQ=e=>YK.test(e),aQ=e=>KK.test(e),lQ=()=>{const e=Bn("colors"),t=Bn("spacing"),r=Bn("blur"),i=Bn("brightness"),a=Bn("borderColor"),u=Bn("borderRadius"),h=Bn("borderSpacing"),g=Bn("borderWidth"),s=Bn("contrast"),_=Bn("grayscale"),b=Bn("hueRotate"),C=Bn("invert"),M=Bn("gap"),D=Bn("gradientColorStops"),N=Bn("gradientColorStopPositions"),j=Bn("inset"),V=Bn("margin"),B=Bn("opacity"),z=Bn("padding"),U=Bn("saturate"),Z=Bn("scale"),Q=Bn("sepia"),re=Bn("skew"),oe=Bn("space"),pe=Bn("translate"),ve=()=>["auto","contain","none"],he=()=>["auto","hidden","clip","visible","scroll"],Ke=()=>["auto",Fr,t],qe=()=>[Fr,t],Ie=()=>["",Yl,iu],rt=()=>["auto",xp,Fr],Pt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],it=()=>["solid","dashed","dotted","double","none"],Je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Te=()=>["start","end","center","between","around","evenly","stretch"],Re=()=>["","0",Fr],Tt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ge=()=>[xp,Fr];return{cacheSize:500,separator:":",theme:{colors:[oy],spacing:[Yl,iu],blur:["none","",su,Fr],brightness:Ge(),borderColor:[e],borderRadius:["none","","full",su,Fr],borderSpacing:qe(),borderWidth:Ie(),contrast:Ge(),grayscale:Re(),hueRotate:Ge(),invert:Re(),gap:qe(),gradientColorStops:[e],gradientColorStopPositions:[QK,iu],inset:Ke(),margin:Ke(),opacity:Ge(),padding:qe(),saturate:Ge(),scale:Ge(),sepia:Re(),skew:Ge(),space:qe(),translate:qe()},classGroups:{aspect:[{aspect:["auto","square","video",Fr]}],container:["container"],columns:[{columns:[su]}],"break-after":[{"break-after":Tt()}],"break-before":[{"break-before":Tt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Pt(),Fr]}],overflow:[{overflow:he()}],"overflow-x":[{"overflow-x":he()}],"overflow-y":[{"overflow-y":he()}],overscroll:[{overscroll:ve()}],"overscroll-x":[{"overscroll-x":ve()}],"overscroll-y":[{"overscroll-y":ve()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[j]}],"inset-x":[{"inset-x":[j]}],"inset-y":[{"inset-y":[j]}],start:[{start:[j]}],end:[{end:[j]}],top:[{top:[j]}],right:[{right:[j]}],bottom:[{bottom:[j]}],left:[{left:[j]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sy,Fr]}],basis:[{basis:Ke()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Fr]}],grow:[{grow:Re()}],shrink:[{shrink:Re()}],order:[{order:["first","last","none",sy,Fr]}],"grid-cols":[{"grid-cols":[oy]}],"col-start-end":[{col:["auto",{span:["full",sy,Fr]},Fr]}],"col-start":[{"col-start":rt()}],"col-end":[{"col-end":rt()}],"grid-rows":[{"grid-rows":[oy]}],"row-start-end":[{row:["auto",{span:[sy,Fr]},Fr]}],"row-start":[{"row-start":rt()}],"row-end":[{"row-end":rt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Fr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Fr]}],gap:[{gap:[M]}],"gap-x":[{"gap-x":[M]}],"gap-y":[{"gap-y":[M]}],"justify-content":[{justify:["normal",...Te()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Te(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Te(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[z]}],px:[{px:[z]}],py:[{py:[z]}],ps:[{ps:[z]}],pe:[{pe:[z]}],pt:[{pt:[z]}],pr:[{pr:[z]}],pb:[{pb:[z]}],pl:[{pl:[z]}],m:[{m:[V]}],mx:[{mx:[V]}],my:[{my:[V]}],ms:[{ms:[V]}],me:[{me:[V]}],mt:[{mt:[V]}],mr:[{mr:[V]}],mb:[{mb:[V]}],ml:[{ml:[V]}],"space-x":[{"space-x":[oe]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[oe]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Fr,t]}],"min-w":[{"min-w":[Fr,t,"min","max","fit"]}],"max-w":[{"max-w":[Fr,t,"none","full","min","max","fit","prose",{screen:[su]},su]}],h:[{h:[Fr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Fr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Fr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Fr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",su,iu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",GE]}],"font-family":[{font:[oy]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Fr]}],"line-clamp":[{"line-clamp":["none",xp,GE]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Yl,Fr]}],"list-image":[{"list-image":["none",Fr]}],"list-style-type":[{list:["none","disc","decimal",Fr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[B]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[B]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...it(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Yl,iu]}],"underline-offset":[{"underline-offset":["auto",Yl,Fr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:qe()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Fr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Fr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[B]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Pt(),tQ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",eQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},nQ]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[D]}],"gradient-via":[{via:[D]}],"gradient-to":[{to:[D]}],rounded:[{rounded:[u]}],"rounded-s":[{"rounded-s":[u]}],"rounded-e":[{"rounded-e":[u]}],"rounded-t":[{"rounded-t":[u]}],"rounded-r":[{"rounded-r":[u]}],"rounded-b":[{"rounded-b":[u]}],"rounded-l":[{"rounded-l":[u]}],"rounded-ss":[{"rounded-ss":[u]}],"rounded-se":[{"rounded-se":[u]}],"rounded-ee":[{"rounded-ee":[u]}],"rounded-es":[{"rounded-es":[u]}],"rounded-tl":[{"rounded-tl":[u]}],"rounded-tr":[{"rounded-tr":[u]}],"rounded-br":[{"rounded-br":[u]}],"rounded-bl":[{"rounded-bl":[u]}],"border-w":[{border:[g]}],"border-w-x":[{"border-x":[g]}],"border-w-y":[{"border-y":[g]}],"border-w-s":[{"border-s":[g]}],"border-w-e":[{"border-e":[g]}],"border-w-t":[{"border-t":[g]}],"border-w-r":[{"border-r":[g]}],"border-w-b":[{"border-b":[g]}],"border-w-l":[{"border-l":[g]}],"border-opacity":[{"border-opacity":[B]}],"border-style":[{border:[...it(),"hidden"]}],"divide-x":[{"divide-x":[g]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[g]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[B]}],"divide-style":[{divide:it()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...it()]}],"outline-offset":[{"outline-offset":[Yl,Fr]}],"outline-w":[{outline:[Yl,iu]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ie()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[B]}],"ring-offset-w":[{"ring-offset":[Yl,iu]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",su,iQ]}],"shadow-color":[{shadow:[oy]}],opacity:[{opacity:[B]}],"mix-blend":[{"mix-blend":[...Je(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Je()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[i]}],contrast:[{contrast:[s]}],"drop-shadow":[{"drop-shadow":["","none",su,Fr]}],grayscale:[{grayscale:[_]}],"hue-rotate":[{"hue-rotate":[b]}],invert:[{invert:[C]}],saturate:[{saturate:[U]}],sepia:[{sepia:[Q]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[s]}],"backdrop-grayscale":[{"backdrop-grayscale":[_]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[b]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[B]}],"backdrop-saturate":[{"backdrop-saturate":[U]}],"backdrop-sepia":[{"backdrop-sepia":[Q]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Fr]}],duration:[{duration:Ge()}],ease:[{ease:["linear","in","out","in-out",Fr]}],delay:[{delay:Ge()}],animate:[{animate:["none","spin","ping","pulse","bounce",Fr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[Z]}],"scale-x":[{"scale-x":[Z]}],"scale-y":[{"scale-y":[Z]}],rotate:[{rotate:[sy,Fr]}],"translate-x":[{"translate-x":[pe]}],"translate-y":[{"translate-y":[pe]}],"skew-x":[{"skew-x":[re]}],"skew-y":[{"skew-y":[re]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Fr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Fr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":qe()}],"scroll-mx":[{"scroll-mx":qe()}],"scroll-my":[{"scroll-my":qe()}],"scroll-ms":[{"scroll-ms":qe()}],"scroll-me":[{"scroll-me":qe()}],"scroll-mt":[{"scroll-mt":qe()}],"scroll-mr":[{"scroll-mr":qe()}],"scroll-mb":[{"scroll-mb":qe()}],"scroll-ml":[{"scroll-ml":qe()}],"scroll-p":[{"scroll-p":qe()}],"scroll-px":[{"scroll-px":qe()}],"scroll-py":[{"scroll-py":qe()}],"scroll-ps":[{"scroll-ps":qe()}],"scroll-pe":[{"scroll-pe":qe()}],"scroll-pt":[{"scroll-pt":qe()}],"scroll-pr":[{"scroll-pr":qe()}],"scroll-pb":[{"scroll-pb":qe()}],"scroll-pl":[{"scroll-pl":qe()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Fr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Yl,iu,GE]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},cQ=WK(lQ);function It(...e){return cQ(EF(e))}const fj=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,pj=EF,um=(e,t)=>r=>{var i;if((t==null?void 0:t.variants)==null)return pj(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:u}=t,h=Object.keys(a).map(_=>{const b=r==null?void 0:r[_],C=u==null?void 0:u[_];if(b===null)return null;const M=fj(b)||fj(C);return a[_][M]}),g=r&&Object.entries(r).reduce((_,b)=>{let[C,M]=b;return M===void 0||(_[C]=M),_},{}),s=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((_,b)=>{let{class:C,className:M,...D}=b;return Object.entries(D).every(N=>{let[j,V]=N;return Array.isArray(V)?V.includes({...u,...g}[j]):{...u,...g}[j]===V})?[..._,C,M]:_},[]);return pj(e,h,s,r==null?void 0:r.class,r==null?void 0:r.className)},pv=um("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Et=A.forwardRef(({className:e,variant:t,size:r,asChild:i=!1,...a},u)=>{const h=i?Tl:"button";return m.jsx(h,{className:It(pv({variant:t,size:r,className:e})),ref:u,...a})});Et.displayName="Button";const uQ=AK,dQ=IK,AF=A.forwardRef(({className:e,...t},r)=>m.jsx(yF,{className:It("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));AF.displayName=yF.displayName;const IF=A.forwardRef(({className:e,...t},r)=>m.jsxs(dQ,{children:[m.jsx(AF,{}),m.jsx(vF,{ref:r,className:It("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));IF.displayName=vF.displayName;const DF=({className:e,...t})=>m.jsx("div",{className:It("flex flex-col space-y-2 text-center sm:text-left",e),...t});DF.displayName="AlertDialogHeader";const RF=({className:e,...t})=>m.jsx("div",{className:It("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});RF.displayName="AlertDialogFooter";const NF=A.forwardRef(({className:e,...t},r)=>m.jsx(wF,{ref:r,className:It("text-lg font-semibold",e),...t}));NF.displayName=wF.displayName;const jF=A.forwardRef(({className:e,...t},r)=>m.jsx(bF,{ref:r,className:It("text-sm text-muted-foreground",e),...t}));jF.displayName=bF.displayName;const LF=A.forwardRef(({className:e,...t},r)=>m.jsx(xF,{ref:r,className:It(pv(),e),...t}));LF.displayName=xF.displayName;const OF=A.forwardRef(({className:e,...t},r)=>m.jsx(_F,{ref:r,className:It(pv({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));OF.displayName=_F.displayName;function hQ({open:e,onOpenChange:t,title:r,description:i,cancelText:a="Cancel",confirmText:u="Confirm",onConfirm:h,type:g="info"}){const s=()=>{h(),t(!1)},_={info:m.jsx(kX,{className:"h-6 w-6 text-blue-500"}),success:m.jsx(xX,{className:"h-6 w-6 text-green-500"}),warning:m.jsx(HX,{className:"h-6 w-6 text-amber-500"}),error:m.jsx(_X,{className:"h-6 w-6 text-red-500"})},b={info:"bg-blue-500 hover:bg-blue-600",success:"bg-green-500 hover:bg-green-600",warning:"bg-amber-500 hover:bg-amber-600",error:"bg-destructive hover:bg-destructive/90"},C=_[g];return m.jsx(uQ,{open:e,onOpenChange:t,children:m.jsxs(IF,{className:"max-w-md",children:[m.jsxs(DF,{children:[m.jsxs("div",{className:"flex items-center gap-3",children:[C,m.jsx(NF,{children:r})]}),i&&m.jsx(jF,{children:i})]}),m.jsxs(RF,{children:[m.jsx(OF,{children:a}),m.jsx(LF,{onClick:s,className:b[g],children:u})]})]})})}function Kv(){const[e,t]=A.useState(!1),[r,i]=A.useState(null),[a,u]=A.useState({title:"",onConfirm:()=>{}}),h=A.useCallback(_=>(u(_),t(!0),new Promise(b=>{i(()=>b),u({..._,onConfirm:()=>{_.onConfirm(),b(!0)}})})),[]),g=A.useCallback(_=>{t(_),!_&&r&&r(!1)},[r]),s=A.useCallback(()=>m.jsx(hQ,{open:e,onOpenChange:g,title:a.title,description:a.description,cancelText:a.cancelText,confirmText:a.confirmText,onConfirm:a.onConfirm,type:a.type}),[e,a,g]);return{confirm:h,ConfirmationDialog:s}}const zF=A.createContext(void 0),dl=Mi.create({baseURL:"https://srv.ybfresto.id/api",withCredentials:!0});function fQ({children:e}){const[t,r]=A.useState(null),[i,a]=A.useState(!0),u=Tc();Kv(),A.useEffect(()=>{(async()=>{try{const j=localStorage.getItem("authToken");if(!j){a(!1);return}const V=await dl.get("/auth/me",{headers:{Authorization:`Bearer ${j}`}});V.data.user&&r(V.data.user)}catch(j){console.error("Error checking authentication:",j),localStorage.removeItem("authToken")}finally{a(!1)}})()},[]);const h=async(N,j)=>{try{const V=await dl.post("/auth/login",{email:N,password:j}),B=V.data.user,z=V.data.token;return localStorage.setItem("authToken",z),r(B),Kd(`Welcome back, ${B.name}!`),!0}catch(V){return console.error("Login error:",V),!1}},g=async()=>{try{await dl.post("/auth/logout",{},{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}),localStorage.removeItem("authToken"),localStorage.removeItem("loginBlockedUntil"),r(null),u("/login"),GN("You have been successfully logged out.")}catch(N){console.error("Logout error:",N),localStorage.removeItem("authToken"),r(null),GN("You have been logged out.")}},s=async(N,j,V,B)=>{try{const z=localStorage.getItem("authToken");if(!z)return Dn("You must be logged in to create users"),!1;if(t){if(t.role==="developer"&&B!=="admin")return Dn("Developers can only create admin accounts"),!1;if(t.role==="admin"&&B!=="user")return Dn("Admins can only create user accounts"),!1;if(t.role==="user")return Dn("You do not have permission to create users"),!1}const U=await dl.post("/auth/register",{name:N,email:j,password:V,role:B},{headers:{Authorization:`Bearer ${z}`}});return Kd(`New ${B} account has been created successfully`),!0}catch(z){return console.error("Registration error:",z),Dn("There was an error during registration. Please try again."),!1}},_=async N=>{try{if(!t)return Dn("You must be logged in to update your profile"),!1;const j=localStorage.getItem("authToken"),B=(await dl.put("/auth/profile",N,{headers:{Authorization:`Bearer ${j}`}})).data.user;return r(B),Kd("Your profile has been updated successfully"),!0}catch(j){return console.error("Profile update error:",j),Dn("There was an error updating your profile. Please try again."),!1}},b=async(N,j)=>{try{if(!t)return Dn("You must be logged in to update your password"),!1;const V=localStorage.getItem("authToken");return await dl.put("/auth/password",{currentPassword:N,newPassword:j},{headers:{Authorization:`Bearer ${V}`}}),Kd("Your password has been updated successfully"),!0}catch(V){return console.error("Password update error:",V),Dn("There was an error updating your password. Please try again."),!1}},C=async()=>{try{if(!t||t.role!=="developer"&&t.role!=="admin")return Dn("Only developers and admins can view users"),[];const N=localStorage.getItem("authToken");return(await dl.get("/auth/users",{headers:{Authorization:`Bearer ${N}`}})).data.users}catch(N){return console.error("Get all users error:",N),Dn("Failed to fetch users"),[]}},M=async N=>{var j;try{if(console.log(`Starting delete user process for ID: ${N}`),!t)return console.error("No user logged in"),Dn("You must be logged in to delete users"),!1;if(t.role!=="developer"&&t.role!=="admin")return console.error("Insufficient permissions:",t.role),Dn("You do not have permission to delete users"),!1;const V=localStorage.getItem("authToken");if(!V)return console.error("No auth token found"),Dn("Authentication token not found"),!1;console.log(`Making DELETE request to /auth/users/${N}`);const B=await dl.delete(`/auth/users/${N}`,{headers:{Authorization:`Bearer ${V}`}});return console.log("Delete response:",B.data),B.status===200?(Kd("User has been deleted successfully"),!0):(console.error("Unexpected response status:",B.status),Dn("Failed to delete user"),!1)}catch(V){return console.error("Delete user error:",V),V.response?(console.error("Error response data:",V.response.data),console.error("Error response status:",V.response.status),V.response.status===403?Dn("You do not have permission to delete this user"):V.response.status===404?Dn("User not found"):Dn(((j=V.response.data)==null?void 0:j.error)||"Failed to delete user")):Dn("Network error occurred while deleting user"),!1}},D=async(N,j)=>{try{if(!t)return Dn("You must be logged in to update users"),!1;if(t.role!=="developer"&&t.role!=="admin")return Dn("You do not have permission to update users"),!1;const V=localStorage.getItem("authToken");if(t.role==="admin"){const B=await dl.get(`/auth/users/${N}`,{headers:{Authorization:`Bearer ${V}`}});if(B.data&&B.data.user&&B.data.user.role!=="user")return Dn("Admins can only update regular users"),!1}return await dl.put(`/auth/users/${N}`,j,{headers:{Authorization:`Bearer ${V}`}}),Kd("User information has been updated successfully"),!0}catch(V){return console.error("Update user error:",V),Dn("There was an error updating the user. Please try again."),!1}};return m.jsx(zF.Provider,{value:{user:t,isAuthenticated:!!t,isLoading:i,login:h,logout:g,register:s,updateProfile:_,updatePassword:b,getAllUsers:C,deleteUser:M,updateUser:D},children:e})}const Qv=()=>{const e=A.useContext(zF);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},FF=A.createContext({currentAd:null,loadAd:async()=>{},isLoading:!1}),BF=()=>A.useContext(FF);function pQ({children:e}){const[t,r]=A.useState(null),[i,a]=A.useState(!1),u=A.useCallback(async()=>{a(!0);try{const g=(await Hf.getAll()).filter(s=>s.isActive);g.length>0?(console.log("Setting active ad:",g[0]),r(g[0])):(console.log("No active ads found, clearing current ad"),r(null))}catch(h){console.error("Error loading ad:",h),r(null)}finally{a(!1)}},[]);return A.useEffect(()=>{console.log("AdContext: Initial loading of ads"),u();const h=setInterval(()=>{console.log("AdContext: Reloading ads on interval"),u()},6e4);return()=>{console.log("AdContext: Cleaning up interval"),clearInterval(h)}},[u]),m.jsx(FF.Provider,{value:{currentAd:t,loadAd:u,isLoading:i},children:e})}var mj=["light","dark"],mQ="(prefers-color-scheme: dark)",gQ=A.createContext(void 0),yQ={setTheme:e=>{},themes:[]},vQ=()=>{var e;return(e=A.useContext(gQ))!=null?e:yQ};A.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:i,enableColorScheme:a,defaultTheme:u,value:h,attrs:g,nonce:s})=>{let _=u==="system",b=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${g.map(N=>`'${N}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,C=a?mj.includes(u)&&u?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${u}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",M=(N,j=!1,V=!0)=>{let B=h?h[N]:N,z=j?N+"|| ''":`'${B}'`,U="";return a&&V&&!j&&mj.includes(N)&&(U+=`d.style.colorScheme = '${N}';`),r==="class"?j||B?U+=`c.add(${z})`:U+="null":B&&(U+=`d[s](n,${z})`),U},D=e?`!function(){${b}${M(e)}}()`:i?`!function(){try{${b}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${_})){var t='${mQ}',m=window.matchMedia(t);if(m.media!==t||m.matches){${M("dark")}}else{${M("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${M(h?"x[e]":"e",!0)}}${_?"":"else{"+M(u,!1,!1)+"}"}${C}}catch(e){}}()`:`!function(){try{${b}var e=localStorage.getItem('${t}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${M(h?"x[e]":"e",!0)}}else{${M(u,!1,!1)};}${C}}catch(t){}}();`;return A.createElement("script",{nonce:s,dangerouslySetInnerHTML:{__html:D}})});const UF=({...e})=>{const{theme:t="system"}=vQ();return m.jsx(Eq,{theme:t,className:"toaster group",position:"top-right",expand:!1,closeButton:!0,richColors:!0,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"},duration:4e3},...e})};function xQ(e,t=[]){let r=[];function i(u,h){const g=A.createContext(h),s=r.length;r=[...r,h];function _(C){const{scope:M,children:D,...N}=C,j=(M==null?void 0:M[e][s])||g,V=A.useMemo(()=>N,Object.values(N));return m.jsx(j.Provider,{value:V,children:D})}function b(C,M){const D=(M==null?void 0:M[e][s])||g,N=A.useContext(D);if(N)return N;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${u}\``)}return _.displayName=u+"Provider",[_,b]}const a=()=>{const u=r.map(h=>A.createContext(h));return function(g){const s=(g==null?void 0:g[e])||u;return A.useMemo(()=>({[`__scope${e}`]:{...g,[e]:s}}),[g,s])}};return a.scopeName=e,[i,_Q(a,...t)]}function _Q(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(u){const h=i.reduce((g,{useScope:s,scopeName:_})=>{const C=s(u)[`__scope${_}`];return{...g,...C}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function dm(e){const t=e+"CollectionProvider",[r,i]=xQ(t),[a,u]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=D=>{const{scope:N,children:j}=D,V=lt.useRef(null),B=lt.useRef(new Map).current;return m.jsx(a,{scope:N,itemMap:B,collectionRef:V,children:j})};h.displayName=t;const g=e+"CollectionSlot",s=lt.forwardRef((D,N)=>{const{scope:j,children:V}=D,B=u(g,j),z=Cr(N,B.collectionRef);return m.jsx(Tl,{ref:z,children:V})});s.displayName=g;const _=e+"CollectionItemSlot",b="data-radix-collection-item",C=lt.forwardRef((D,N)=>{const{scope:j,children:V,...B}=D,z=lt.useRef(null),U=Cr(N,z),Z=u(_,j);return lt.useEffect(()=>(Z.itemMap.set(z,{ref:z,...B}),()=>void Z.itemMap.delete(z))),m.jsx(Tl,{[b]:"",ref:U,children:V})});C.displayName=_;function M(D){const N=u(e+"CollectionConsumer",D);return lt.useCallback(()=>{const V=N.collectionRef.current;if(!V)return[];const B=Array.from(V.querySelectorAll(`[${b}]`));return Array.from(N.itemMap.values()).sort((Z,Q)=>B.indexOf(Z.ref.current)-B.indexOf(Q.ref.current))},[N.collectionRef,N.itemMap])}return[{Provider:h,Slot:s,ItemSlot:C},M,i]}var wQ=A.createContext(void 0);function Nh(e){const t=A.useContext(wQ);return e||t||"ltr"}const bQ=["top","right","bottom","left"],Uu=Math.min,Eo=Math.max,M1=Math.round,v0=Math.floor,Vu=e=>({x:e,y:e}),SQ={left:"right",right:"left",bottom:"top",top:"bottom"},EQ={start:"end",end:"start"};function LC(e,t,r){return Eo(e,Uu(t,r))}function vc(e,t){return typeof e=="function"?e(t):e}function xc(e){return e.split("-")[0]}function hm(e){return e.split("-")[1]}function Zk(e){return e==="x"?"y":"x"}function Xk(e){return e==="y"?"height":"width"}function $u(e){return["top","bottom"].includes(xc(e))?"y":"x"}function Yk(e){return Zk($u(e))}function TQ(e,t,r){r===void 0&&(r=!1);const i=hm(e),a=Yk(e),u=Xk(a);let h=a==="x"?i===(r?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[u]>t.floating[u]&&(h=k1(h)),[h,k1(h)]}function CQ(e){const t=k1(e);return[OC(e),t,OC(t)]}function OC(e){return e.replace(/start|end/g,t=>EQ[t])}function MQ(e,t,r){const i=["left","right"],a=["right","left"],u=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:i:t?i:a;case"left":case"right":return t?u:h;default:return[]}}function kQ(e,t,r,i){const a=hm(e);let u=MQ(xc(e),r==="start",i);return a&&(u=u.map(h=>h+"-"+a),t&&(u=u.concat(u.map(OC)))),u}function k1(e){return e.replace(/left|right|bottom|top/g,t=>SQ[t])}function PQ(e){return{top:0,right:0,bottom:0,left:0,...e}}function VF(e){return typeof e!="number"?PQ(e):{top:e,right:e,bottom:e,left:e}}function P1(e){const{x:t,y:r,width:i,height:a}=e;return{width:i,height:a,top:r,left:t,right:t+i,bottom:r+a,x:t,y:r}}function gj(e,t,r){let{reference:i,floating:a}=e;const u=$u(t),h=Yk(t),g=Xk(h),s=xc(t),_=u==="y",b=i.x+i.width/2-a.width/2,C=i.y+i.height/2-a.height/2,M=i[g]/2-a[g]/2;let D;switch(s){case"top":D={x:b,y:i.y-a.height};break;case"bottom":D={x:b,y:i.y+i.height};break;case"right":D={x:i.x+i.width,y:C};break;case"left":D={x:i.x-a.width,y:C};break;default:D={x:i.x,y:i.y}}switch(hm(t)){case"start":D[h]-=M*(r&&_?-1:1);break;case"end":D[h]+=M*(r&&_?-1:1);break}return D}const AQ=async(e,t,r)=>{const{placement:i="bottom",strategy:a="absolute",middleware:u=[],platform:h}=r,g=u.filter(Boolean),s=await(h.isRTL==null?void 0:h.isRTL(t));let _=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:b,y:C}=gj(_,i,s),M=i,D={},N=0;for(let j=0;j<g.length;j++){const{name:V,fn:B}=g[j],{x:z,y:U,data:Z,reset:Q}=await B({x:b,y:C,initialPlacement:i,placement:M,strategy:a,middlewareData:D,rects:_,platform:h,elements:{reference:e,floating:t}});b=z??b,C=U??C,D={...D,[V]:{...D[V],...Z}},Q&&N<=50&&(N++,typeof Q=="object"&&(Q.placement&&(M=Q.placement),Q.rects&&(_=Q.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):Q.rects),{x:b,y:C}=gj(_,M,s)),j=-1)}return{x:b,y:C,placement:M,strategy:a,middlewareData:D}};async function mv(e,t){var r;t===void 0&&(t={});const{x:i,y:a,platform:u,rects:h,elements:g,strategy:s}=e,{boundary:_="clippingAncestors",rootBoundary:b="viewport",elementContext:C="floating",altBoundary:M=!1,padding:D=0}=vc(t,e),N=VF(D),V=g[M?C==="floating"?"reference":"floating":C],B=P1(await u.getClippingRect({element:(r=await(u.isElement==null?void 0:u.isElement(V)))==null||r?V:V.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(g.floating)),boundary:_,rootBoundary:b,strategy:s})),z=C==="floating"?{x:i,y:a,width:h.floating.width,height:h.floating.height}:h.reference,U=await(u.getOffsetParent==null?void 0:u.getOffsetParent(g.floating)),Z=await(u.isElement==null?void 0:u.isElement(U))?await(u.getScale==null?void 0:u.getScale(U))||{x:1,y:1}:{x:1,y:1},Q=P1(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:g,rect:z,offsetParent:U,strategy:s}):z);return{top:(B.top-Q.top+N.top)/Z.y,bottom:(Q.bottom-B.bottom+N.bottom)/Z.y,left:(B.left-Q.left+N.left)/Z.x,right:(Q.right-B.right+N.right)/Z.x}}const IQ=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:i,placement:a,rects:u,platform:h,elements:g,middlewareData:s}=t,{element:_,padding:b=0}=vc(e,t)||{};if(_==null)return{};const C=VF(b),M={x:r,y:i},D=Yk(a),N=Xk(D),j=await h.getDimensions(_),V=D==="y",B=V?"top":"left",z=V?"bottom":"right",U=V?"clientHeight":"clientWidth",Z=u.reference[N]+u.reference[D]-M[D]-u.floating[N],Q=M[D]-u.reference[D],re=await(h.getOffsetParent==null?void 0:h.getOffsetParent(_));let oe=re?re[U]:0;(!oe||!await(h.isElement==null?void 0:h.isElement(re)))&&(oe=g.floating[U]||u.floating[N]);const pe=Z/2-Q/2,ve=oe/2-j[N]/2-1,he=Uu(C[B],ve),Ke=Uu(C[z],ve),qe=he,Ie=oe-j[N]-Ke,rt=oe/2-j[N]/2+pe,Pt=LC(qe,rt,Ie),it=!s.arrow&&hm(a)!=null&&rt!==Pt&&u.reference[N]/2-(rt<qe?he:Ke)-j[N]/2<0,Je=it?rt<qe?rt-qe:rt-Ie:0;return{[D]:M[D]+Je,data:{[D]:Pt,centerOffset:rt-Pt-Je,...it&&{alignmentOffset:Je}},reset:it}}}),DQ=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,i;const{placement:a,middlewareData:u,rects:h,initialPlacement:g,platform:s,elements:_}=t,{mainAxis:b=!0,crossAxis:C=!0,fallbackPlacements:M,fallbackStrategy:D="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:j=!0,...V}=vc(e,t);if((r=u.arrow)!=null&&r.alignmentOffset)return{};const B=xc(a),z=$u(g),U=xc(g)===g,Z=await(s.isRTL==null?void 0:s.isRTL(_.floating)),Q=M||(U||!j?[k1(g)]:CQ(g)),re=N!=="none";!M&&re&&Q.push(...kQ(g,j,N,Z));const oe=[g,...Q],pe=await mv(t,V),ve=[];let he=((i=u.flip)==null?void 0:i.overflows)||[];if(b&&ve.push(pe[B]),C){const rt=TQ(a,h,Z);ve.push(pe[rt[0]],pe[rt[1]])}if(he=[...he,{placement:a,overflows:ve}],!ve.every(rt=>rt<=0)){var Ke,qe;const rt=(((Ke=u.flip)==null?void 0:Ke.index)||0)+1,Pt=oe[rt];if(Pt)return{data:{index:rt,overflows:he},reset:{placement:Pt}};let it=(qe=he.filter(Je=>Je.overflows[0]<=0).sort((Je,Te)=>Je.overflows[1]-Te.overflows[1])[0])==null?void 0:qe.placement;if(!it)switch(D){case"bestFit":{var Ie;const Je=(Ie=he.filter(Te=>{if(re){const Re=$u(Te.placement);return Re===z||Re==="y"}return!0}).map(Te=>[Te.placement,Te.overflows.filter(Re=>Re>0).reduce((Re,Tt)=>Re+Tt,0)]).sort((Te,Re)=>Te[1]-Re[1])[0])==null?void 0:Ie[0];Je&&(it=Je);break}case"initialPlacement":it=g;break}if(a!==it)return{reset:{placement:it}}}return{}}}};function yj(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function vj(e){return bQ.some(t=>e[t]>=0)}const RQ=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:i="referenceHidden",...a}=vc(e,t);switch(i){case"referenceHidden":{const u=await mv(t,{...a,elementContext:"reference"}),h=yj(u,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:vj(h)}}}case"escaped":{const u=await mv(t,{...a,altBoundary:!0}),h=yj(u,r.floating);return{data:{escapedOffsets:h,escaped:vj(h)}}}default:return{}}}}};async function NQ(e,t){const{placement:r,platform:i,elements:a}=e,u=await(i.isRTL==null?void 0:i.isRTL(a.floating)),h=xc(r),g=hm(r),s=$u(r)==="y",_=["left","top"].includes(h)?-1:1,b=u&&s?-1:1,C=vc(t,e);let{mainAxis:M,crossAxis:D,alignmentAxis:N}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return g&&typeof N=="number"&&(D=g==="end"?N*-1:N),s?{x:D*b,y:M*_}:{x:M*_,y:D*b}}const jQ=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,i;const{x:a,y:u,placement:h,middlewareData:g}=t,s=await NQ(t,e);return h===((r=g.offset)==null?void 0:r.placement)&&(i=g.arrow)!=null&&i.alignmentOffset?{}:{x:a+s.x,y:u+s.y,data:{...s,placement:h}}}}},LQ=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:i,placement:a}=t,{mainAxis:u=!0,crossAxis:h=!1,limiter:g={fn:V=>{let{x:B,y:z}=V;return{x:B,y:z}}},...s}=vc(e,t),_={x:r,y:i},b=await mv(t,s),C=$u(xc(a)),M=Zk(C);let D=_[M],N=_[C];if(u){const V=M==="y"?"top":"left",B=M==="y"?"bottom":"right",z=D+b[V],U=D-b[B];D=LC(z,D,U)}if(h){const V=C==="y"?"top":"left",B=C==="y"?"bottom":"right",z=N+b[V],U=N-b[B];N=LC(z,N,U)}const j=g.fn({...t,[M]:D,[C]:N});return{...j,data:{x:j.x-r,y:j.y-i,enabled:{[M]:u,[C]:h}}}}}},OQ=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:i,placement:a,rects:u,middlewareData:h}=t,{offset:g=0,mainAxis:s=!0,crossAxis:_=!0}=vc(e,t),b={x:r,y:i},C=$u(a),M=Zk(C);let D=b[M],N=b[C];const j=vc(g,t),V=typeof j=="number"?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(s){const U=M==="y"?"height":"width",Z=u.reference[M]-u.floating[U]+V.mainAxis,Q=u.reference[M]+u.reference[U]-V.mainAxis;D<Z?D=Z:D>Q&&(D=Q)}if(_){var B,z;const U=M==="y"?"width":"height",Z=["top","left"].includes(xc(a)),Q=u.reference[C]-u.floating[U]+(Z&&((B=h.offset)==null?void 0:B[C])||0)+(Z?0:V.crossAxis),re=u.reference[C]+u.reference[U]+(Z?0:((z=h.offset)==null?void 0:z[C])||0)-(Z?V.crossAxis:0);N<Q?N=Q:N>re&&(N=re)}return{[M]:D,[C]:N}}}},zQ=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,i;const{placement:a,rects:u,platform:h,elements:g}=t,{apply:s=()=>{},..._}=vc(e,t),b=await mv(t,_),C=xc(a),M=hm(a),D=$u(a)==="y",{width:N,height:j}=u.floating;let V,B;C==="top"||C==="bottom"?(V=C,B=M===(await(h.isRTL==null?void 0:h.isRTL(g.floating))?"start":"end")?"left":"right"):(B=C,V=M==="end"?"top":"bottom");const z=j-b.top-b.bottom,U=N-b.left-b.right,Z=Uu(j-b[V],z),Q=Uu(N-b[B],U),re=!t.middlewareData.shift;let oe=Z,pe=Q;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(pe=U),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(oe=z),re&&!M){const he=Eo(b.left,0),Ke=Eo(b.right,0),qe=Eo(b.top,0),Ie=Eo(b.bottom,0);D?pe=N-2*(he!==0||Ke!==0?he+Ke:Eo(b.left,b.right)):oe=j-2*(qe!==0||Ie!==0?qe+Ie:Eo(b.top,b.bottom))}await s({...t,availableWidth:pe,availableHeight:oe});const ve=await h.getDimensions(g.floating);return N!==ve.width||j!==ve.height?{reset:{rects:!0}}:{}}}};function Hw(){return typeof window<"u"}function fm(e){return $F(e)?(e.nodeName||"").toLowerCase():"#document"}function Ao(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Pl(e){var t;return(t=($F(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function $F(e){return Hw()?e instanceof Node||e instanceof Ao(e).Node:!1}function Ga(e){return Hw()?e instanceof Element||e instanceof Ao(e).Element:!1}function Cl(e){return Hw()?e instanceof HTMLElement||e instanceof Ao(e).HTMLElement:!1}function xj(e){return!Hw()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ao(e).ShadowRoot}function Jv(e){const{overflow:t,overflowX:r,overflowY:i,display:a}=Ha(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!["inline","contents"].includes(a)}function FQ(e){return["table","td","th"].includes(fm(e))}function qw(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Kk(e){const t=Qk(),r=Ga(e)?Ha(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(r.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(r.contain||"").includes(i))}function BQ(e){let t=Wu(e);for(;Cl(t)&&!zp(t);){if(Kk(t))return t;if(qw(t))return null;t=Wu(t)}return null}function Qk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function zp(e){return["html","body","#document"].includes(fm(e))}function Ha(e){return Ao(e).getComputedStyle(e)}function Zw(e){return Ga(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Wu(e){if(fm(e)==="html")return e;const t=e.assignedSlot||e.parentNode||xj(e)&&e.host||Pl(e);return xj(t)?t.host:t}function WF(e){const t=Wu(e);return zp(t)?e.ownerDocument?e.ownerDocument.body:e.body:Cl(t)&&Jv(t)?t:WF(t)}function gv(e,t,r){var i;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=WF(e),u=a===((i=e.ownerDocument)==null?void 0:i.body),h=Ao(a);if(u){const g=zC(h);return t.concat(h,h.visualViewport||[],Jv(a)?a:[],g&&r?gv(g):[])}return t.concat(a,gv(a,[],r))}function zC(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function GF(e){const t=Ha(e);let r=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const a=Cl(e),u=a?e.offsetWidth:r,h=a?e.offsetHeight:i,g=M1(r)!==u||M1(i)!==h;return g&&(r=u,i=h),{width:r,height:i,$:g}}function Jk(e){return Ga(e)?e:e.contextElement}function _p(e){const t=Jk(e);if(!Cl(t))return Vu(1);const r=t.getBoundingClientRect(),{width:i,height:a,$:u}=GF(t);let h=(u?M1(r.width):r.width)/i,g=(u?M1(r.height):r.height)/a;return(!h||!Number.isFinite(h))&&(h=1),(!g||!Number.isFinite(g))&&(g=1),{x:h,y:g}}const UQ=Vu(0);function HF(e){const t=Ao(e);return!Qk()||!t.visualViewport?UQ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function VQ(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ao(e)?!1:t}function Th(e,t,r,i){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),u=Jk(e);let h=Vu(1);t&&(i?Ga(i)&&(h=_p(i)):h=_p(e));const g=VQ(u,r,i)?HF(u):Vu(0);let s=(a.left+g.x)/h.x,_=(a.top+g.y)/h.y,b=a.width/h.x,C=a.height/h.y;if(u){const M=Ao(u),D=i&&Ga(i)?Ao(i):i;let N=M,j=zC(N);for(;j&&i&&D!==N;){const V=_p(j),B=j.getBoundingClientRect(),z=Ha(j),U=B.left+(j.clientLeft+parseFloat(z.paddingLeft))*V.x,Z=B.top+(j.clientTop+parseFloat(z.paddingTop))*V.y;s*=V.x,_*=V.y,b*=V.x,C*=V.y,s+=U,_+=Z,N=Ao(j),j=zC(N)}}return P1({width:b,height:C,x:s,y:_})}function $Q(e){let{elements:t,rect:r,offsetParent:i,strategy:a}=e;const u=a==="fixed",h=Pl(i),g=t?qw(t.floating):!1;if(i===h||g&&u)return r;let s={scrollLeft:0,scrollTop:0},_=Vu(1);const b=Vu(0),C=Cl(i);if((C||!C&&!u)&&((fm(i)!=="body"||Jv(h))&&(s=Zw(i)),Cl(i))){const M=Th(i);_=_p(i),b.x=M.x+i.clientLeft,b.y=M.y+i.clientTop}return{width:r.width*_.x,height:r.height*_.y,x:r.x*_.x-s.scrollLeft*_.x+b.x,y:r.y*_.y-s.scrollTop*_.y+b.y}}function WQ(e){return Array.from(e.getClientRects())}function FC(e,t){const r=Zw(e).scrollLeft;return t?t.left+r:Th(Pl(e)).left+r}function GQ(e){const t=Pl(e),r=Zw(e),i=e.ownerDocument.body,a=Eo(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),u=Eo(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let h=-r.scrollLeft+FC(e);const g=-r.scrollTop;return Ha(i).direction==="rtl"&&(h+=Eo(t.clientWidth,i.clientWidth)-a),{width:a,height:u,x:h,y:g}}function HQ(e,t){const r=Ao(e),i=Pl(e),a=r.visualViewport;let u=i.clientWidth,h=i.clientHeight,g=0,s=0;if(a){u=a.width,h=a.height;const _=Qk();(!_||_&&t==="fixed")&&(g=a.offsetLeft,s=a.offsetTop)}return{width:u,height:h,x:g,y:s}}function qQ(e,t){const r=Th(e,!0,t==="fixed"),i=r.top+e.clientTop,a=r.left+e.clientLeft,u=Cl(e)?_p(e):Vu(1),h=e.clientWidth*u.x,g=e.clientHeight*u.y,s=a*u.x,_=i*u.y;return{width:h,height:g,x:s,y:_}}function _j(e,t,r){let i;if(t==="viewport")i=HQ(e,r);else if(t==="document")i=GQ(Pl(e));else if(Ga(t))i=qQ(t,r);else{const a=HF(e);i={...t,x:t.x-a.x,y:t.y-a.y}}return P1(i)}function qF(e,t){const r=Wu(e);return r===t||!Ga(r)||zp(r)?!1:Ha(r).position==="fixed"||qF(r,t)}function ZQ(e,t){const r=t.get(e);if(r)return r;let i=gv(e,[],!1).filter(g=>Ga(g)&&fm(g)!=="body"),a=null;const u=Ha(e).position==="fixed";let h=u?Wu(e):e;for(;Ga(h)&&!zp(h);){const g=Ha(h),s=Kk(h);!s&&g.position==="fixed"&&(a=null),(u?!s&&!a:!s&&g.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Jv(h)&&!s&&qF(e,h))?i=i.filter(b=>b!==h):a=g,h=Wu(h)}return t.set(e,i),i}function XQ(e){let{element:t,boundary:r,rootBoundary:i,strategy:a}=e;const h=[...r==="clippingAncestors"?qw(t)?[]:ZQ(t,this._c):[].concat(r),i],g=h[0],s=h.reduce((_,b)=>{const C=_j(t,b,a);return _.top=Eo(C.top,_.top),_.right=Uu(C.right,_.right),_.bottom=Uu(C.bottom,_.bottom),_.left=Eo(C.left,_.left),_},_j(t,g,a));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}}function YQ(e){const{width:t,height:r}=GF(e);return{width:t,height:r}}function KQ(e,t,r){const i=Cl(t),a=Pl(t),u=r==="fixed",h=Th(e,!0,u,t);let g={scrollLeft:0,scrollTop:0};const s=Vu(0);if(i||!i&&!u)if((fm(t)!=="body"||Jv(a))&&(g=Zw(t)),i){const D=Th(t,!0,u,t);s.x=D.x+t.clientLeft,s.y=D.y+t.clientTop}else a&&(s.x=FC(a));let _=0,b=0;if(a&&!i&&!u){const D=a.getBoundingClientRect();b=D.top+g.scrollTop,_=D.left+g.scrollLeft-FC(a,D)}const C=h.left+g.scrollLeft-s.x-_,M=h.top+g.scrollTop-s.y-b;return{x:C,y:M,width:h.width,height:h.height}}function HE(e){return Ha(e).position==="static"}function wj(e,t){if(!Cl(e)||Ha(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Pl(e)===r&&(r=r.ownerDocument.body),r}function ZF(e,t){const r=Ao(e);if(qw(e))return r;if(!Cl(e)){let a=Wu(e);for(;a&&!zp(a);){if(Ga(a)&&!HE(a))return a;a=Wu(a)}return r}let i=wj(e,t);for(;i&&FQ(i)&&HE(i);)i=wj(i,t);return i&&zp(i)&&HE(i)&&!Kk(i)?r:i||BQ(e)||r}const QQ=async function(e){const t=this.getOffsetParent||ZF,r=this.getDimensions,i=await r(e.floating);return{reference:KQ(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function JQ(e){return Ha(e).direction==="rtl"}const eJ={convertOffsetParentRelativeRectToViewportRelativeRect:$Q,getDocumentElement:Pl,getClippingRect:XQ,getOffsetParent:ZF,getElementRects:QQ,getClientRects:WQ,getDimensions:YQ,getScale:_p,isElement:Ga,isRTL:JQ};function tJ(e,t){let r=null,i;const a=Pl(e);function u(){var g;clearTimeout(i),(g=r)==null||g.disconnect(),r=null}function h(g,s){g===void 0&&(g=!1),s===void 0&&(s=1),u();const{left:_,top:b,width:C,height:M}=e.getBoundingClientRect();if(g||t(),!C||!M)return;const D=v0(b),N=v0(a.clientWidth-(_+C)),j=v0(a.clientHeight-(b+M)),V=v0(_),z={rootMargin:-D+"px "+-N+"px "+-j+"px "+-V+"px",threshold:Eo(0,Uu(1,s))||1};let U=!0;function Z(Q){const re=Q[0].intersectionRatio;if(re!==s){if(!U)return h();re?h(!1,re):i=setTimeout(()=>{h(!1,1e-7)},1e3)}U=!1}try{r=new IntersectionObserver(Z,{...z,root:a.ownerDocument})}catch{r=new IntersectionObserver(Z,z)}r.observe(e)}return h(!0),u}function rJ(e,t,r,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:u=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:g=typeof IntersectionObserver=="function",animationFrame:s=!1}=i,_=Jk(e),b=a||u?[..._?gv(_):[],...gv(t)]:[];b.forEach(B=>{a&&B.addEventListener("scroll",r,{passive:!0}),u&&B.addEventListener("resize",r)});const C=_&&g?tJ(_,r):null;let M=-1,D=null;h&&(D=new ResizeObserver(B=>{let[z]=B;z&&z.target===_&&D&&(D.unobserve(t),cancelAnimationFrame(M),M=requestAnimationFrame(()=>{var U;(U=D)==null||U.observe(t)})),r()}),_&&!s&&D.observe(_),D.observe(t));let N,j=s?Th(e):null;s&&V();function V(){const B=Th(e);j&&(B.x!==j.x||B.y!==j.y||B.width!==j.width||B.height!==j.height)&&r(),j=B,N=requestAnimationFrame(V)}return r(),()=>{var B;b.forEach(z=>{a&&z.removeEventListener("scroll",r),u&&z.removeEventListener("resize",r)}),C==null||C(),(B=D)==null||B.disconnect(),D=null,s&&cancelAnimationFrame(N)}}const nJ=jQ,iJ=LQ,sJ=DQ,oJ=zQ,aJ=RQ,bj=IQ,lJ=OQ,cJ=(e,t,r)=>{const i=new Map,a={platform:eJ,...r},u={...a.platform,_c:i};return AQ(e,t,{...a,platform:u})};var W0=typeof document<"u"?A.useLayoutEffect:A.useEffect;function A1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,i,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(i=r;i--!==0;)if(!A1(e[i],t[i]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!{}.hasOwnProperty.call(t,a[i]))return!1;for(i=r;i--!==0;){const u=a[i];if(!(u==="_owner"&&e.$$typeof)&&!A1(e[u],t[u]))return!1}return!0}return e!==e&&t!==t}function XF(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Sj(e,t){const r=XF(e);return Math.round(t*r)/r}function qE(e){const t=A.useRef(e);return W0(()=>{t.current=e}),t}function uJ(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:a,elements:{reference:u,floating:h}={},transform:g=!0,whileElementsMounted:s,open:_}=e,[b,C]=A.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[M,D]=A.useState(i);A1(M,i)||D(i);const[N,j]=A.useState(null),[V,B]=A.useState(null),z=A.useCallback(Te=>{Te!==re.current&&(re.current=Te,j(Te))},[]),U=A.useCallback(Te=>{Te!==oe.current&&(oe.current=Te,B(Te))},[]),Z=u||N,Q=h||V,re=A.useRef(null),oe=A.useRef(null),pe=A.useRef(b),ve=s!=null,he=qE(s),Ke=qE(a),qe=qE(_),Ie=A.useCallback(()=>{if(!re.current||!oe.current)return;const Te={placement:t,strategy:r,middleware:M};Ke.current&&(Te.platform=Ke.current),cJ(re.current,oe.current,Te).then(Re=>{const Tt={...Re,isPositioned:qe.current!==!1};rt.current&&!A1(pe.current,Tt)&&(pe.current=Tt,rm.flushSync(()=>{C(Tt)}))})},[M,t,r,Ke,qe]);W0(()=>{_===!1&&pe.current.isPositioned&&(pe.current.isPositioned=!1,C(Te=>({...Te,isPositioned:!1})))},[_]);const rt=A.useRef(!1);W0(()=>(rt.current=!0,()=>{rt.current=!1}),[]),W0(()=>{if(Z&&(re.current=Z),Q&&(oe.current=Q),Z&&Q){if(he.current)return he.current(Z,Q,Ie);Ie()}},[Z,Q,Ie,he,ve]);const Pt=A.useMemo(()=>({reference:re,floating:oe,setReference:z,setFloating:U}),[z,U]),it=A.useMemo(()=>({reference:Z,floating:Q}),[Z,Q]),Je=A.useMemo(()=>{const Te={position:r,left:0,top:0};if(!it.floating)return Te;const Re=Sj(it.floating,b.x),Tt=Sj(it.floating,b.y);return g?{...Te,transform:"translate("+Re+"px, "+Tt+"px)",...XF(it.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Re,top:Tt}},[r,g,it.floating,b.x,b.y]);return A.useMemo(()=>({...b,update:Ie,refs:Pt,elements:it,floatingStyles:Je}),[b,Ie,Pt,it,Je])}const dJ=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:i,padding:a}=typeof e=="function"?e(r):e;return i&&t(i)?i.current!=null?bj({element:i.current,padding:a}).fn(r):{}:i?bj({element:i,padding:a}).fn(r):{}}}},hJ=(e,t)=>({...nJ(e),options:[e,t]}),fJ=(e,t)=>({...iJ(e),options:[e,t]}),pJ=(e,t)=>({...lJ(e),options:[e,t]}),mJ=(e,t)=>({...sJ(e),options:[e,t]}),gJ=(e,t)=>({...oJ(e),options:[e,t]}),yJ=(e,t)=>({...aJ(e),options:[e,t]}),vJ=(e,t)=>({...dJ(e),options:[e,t]});var xJ="Arrow",YF=A.forwardRef((e,t)=>{const{children:r,width:i=10,height:a=5,...u}=e;return m.jsx(sr.svg,{...u,ref:t,width:i,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:m.jsx("polygon",{points:"0,0 30,0 15,10"})})});YF.displayName=xJ;var _J=YF;function wJ(e,t=[]){let r=[];function i(u,h){const g=A.createContext(h),s=r.length;r=[...r,h];function _(C){const{scope:M,children:D,...N}=C,j=(M==null?void 0:M[e][s])||g,V=A.useMemo(()=>N,Object.values(N));return m.jsx(j.Provider,{value:V,children:D})}function b(C,M){const D=(M==null?void 0:M[e][s])||g,N=A.useContext(D);if(N)return N;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${u}\``)}return _.displayName=u+"Provider",[_,b]}const a=()=>{const u=r.map(h=>A.createContext(h));return function(g){const s=(g==null?void 0:g[e])||u;return A.useMemo(()=>({[`__scope${e}`]:{...g,[e]:s}}),[g,s])}};return a.scopeName=e,[i,bJ(a,...t)]}function bJ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(u){const h=i.reduce((g,{useScope:s,scopeName:_})=>{const C=s(u)[`__scope${_}`];return{...g,...C}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function eP(e){const[t,r]=A.useState(void 0);return Ni(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const u=a[0];let h,g;if("borderBoxSize"in u){const s=u.borderBoxSize,_=Array.isArray(s)?s[0]:s;h=_.inlineSize,g=_.blockSize}else h=e.offsetWidth,g=e.offsetHeight;r({width:h,height:g})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else r(void 0)},[e]),t}var tP="Popper",[KF,pm]=wJ(tP),[SJ,QF]=KF(tP),JF=e=>{const{__scopePopper:t,children:r}=e,[i,a]=A.useState(null);return m.jsx(SJ,{scope:t,anchor:i,onAnchorChange:a,children:r})};JF.displayName=tP;var e5="PopperAnchor",t5=A.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:i,...a}=e,u=QF(e5,r),h=A.useRef(null),g=Cr(t,h);return A.useEffect(()=>{u.onAnchorChange((i==null?void 0:i.current)||h.current)}),i?null:m.jsx(sr.div,{...a,ref:g})});t5.displayName=e5;var rP="PopperContent",[EJ,TJ]=KF(rP),r5=A.forwardRef((e,t)=>{var St,nr,cr,lr,dr,Ut;const{__scopePopper:r,side:i="bottom",sideOffset:a=0,align:u="center",alignOffset:h=0,arrowPadding:g=0,avoidCollisions:s=!0,collisionBoundary:_=[],collisionPadding:b=0,sticky:C="partial",hideWhenDetached:M=!1,updatePositionStrategy:D="optimized",onPlaced:N,...j}=e,V=QF(rP,r),[B,z]=A.useState(null),U=Cr(t,Kr=>z(Kr)),[Z,Q]=A.useState(null),re=eP(Z),oe=(re==null?void 0:re.width)??0,pe=(re==null?void 0:re.height)??0,ve=i+(u!=="center"?"-"+u:""),he=typeof b=="number"?b:{top:0,right:0,bottom:0,left:0,...b},Ke=Array.isArray(_)?_:[_],qe=Ke.length>0,Ie={padding:he,boundary:Ke.filter(MJ),altBoundary:qe},{refs:rt,floatingStyles:Pt,placement:it,isPositioned:Je,middlewareData:Te}=uJ({strategy:"fixed",placement:ve,whileElementsMounted:(...Kr)=>rJ(...Kr,{animationFrame:D==="always"}),elements:{reference:V.anchor},middleware:[hJ({mainAxis:a+pe,alignmentAxis:h}),s&&fJ({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?pJ():void 0,...Ie}),s&&mJ({...Ie}),gJ({...Ie,apply:({elements:Kr,rects:Zr,availableWidth:vi,availableHeight:Ir})=>{const{width:Rn,height:ke}=Zr.reference,Oe=Kr.floating.style;Oe.setProperty("--radix-popper-available-width",`${vi}px`),Oe.setProperty("--radix-popper-available-height",`${Ir}px`),Oe.setProperty("--radix-popper-anchor-width",`${Rn}px`),Oe.setProperty("--radix-popper-anchor-height",`${ke}px`)}}),Z&&vJ({element:Z,padding:g}),kJ({arrowWidth:oe,arrowHeight:pe}),M&&yJ({strategy:"referenceHidden",...Ie})]}),[Re,Tt]=s5(it),Ge=jn(N);Ni(()=>{Je&&(Ge==null||Ge())},[Je,Ge]);const wt=(St=Te.arrow)==null?void 0:St.x,ct=(nr=Te.arrow)==null?void 0:nr.y,dt=((cr=Te.arrow)==null?void 0:cr.centerOffset)!==0,[tr,Bt]=A.useState();return Ni(()=>{B&&Bt(window.getComputedStyle(B).zIndex)},[B]),m.jsx("div",{ref:rt.setFloating,"data-radix-popper-content-wrapper":"",style:{...Pt,transform:Je?Pt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:tr,"--radix-popper-transform-origin":[(lr=Te.transformOrigin)==null?void 0:lr.x,(dr=Te.transformOrigin)==null?void 0:dr.y].join(" "),...((Ut=Te.hide)==null?void 0:Ut.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:m.jsx(EJ,{scope:r,placedSide:Re,onArrowChange:Q,arrowX:wt,arrowY:ct,shouldHideArrow:dt,children:m.jsx(sr.div,{"data-side":Re,"data-align":Tt,...j,ref:U,style:{...j.style,animation:Je?void 0:"none"}})})})});r5.displayName=rP;var n5="PopperArrow",CJ={top:"bottom",right:"left",bottom:"top",left:"right"},i5=A.forwardRef(function(t,r){const{__scopePopper:i,...a}=t,u=TJ(n5,i),h=CJ[u.placedSide];return m.jsx("span",{ref:u.onArrowChange,style:{position:"absolute",left:u.arrowX,top:u.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[u.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[u.placedSide],visibility:u.shouldHideArrow?"hidden":void 0},children:m.jsx(_J,{...a,ref:r,style:{...a.style,display:"block"}})})});i5.displayName=n5;function MJ(e){return e!==null}var kJ=e=>({name:"transformOrigin",options:e,fn(t){var V,B,z;const{placement:r,rects:i,middlewareData:a}=t,h=((V=a.arrow)==null?void 0:V.centerOffset)!==0,g=h?0:e.arrowWidth,s=h?0:e.arrowHeight,[_,b]=s5(r),C={start:"0%",center:"50%",end:"100%"}[b],M=(((B=a.arrow)==null?void 0:B.x)??0)+g/2,D=(((z=a.arrow)==null?void 0:z.y)??0)+s/2;let N="",j="";return _==="bottom"?(N=h?C:`${M}px`,j=`${-s}px`):_==="top"?(N=h?C:`${M}px`,j=`${i.floating.height+s}px`):_==="right"?(N=`${-s}px`,j=h?C:`${D}px`):_==="left"&&(N=`${i.floating.width+s}px`,j=h?C:`${D}px`),{data:{x:N,y:j}}}});function s5(e){const[t,r="center"]=e.split("-");return[t,r]}var nP=JF,Xw=t5,iP=r5,sP=i5;function PJ(e,t=[]){let r=[];function i(u,h){const g=A.createContext(h),s=r.length;r=[...r,h];function _(C){const{scope:M,children:D,...N}=C,j=(M==null?void 0:M[e][s])||g,V=A.useMemo(()=>N,Object.values(N));return m.jsx(j.Provider,{value:V,children:D})}function b(C,M){const D=(M==null?void 0:M[e][s])||g,N=A.useContext(D);if(N)return N;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${u}\``)}return _.displayName=u+"Provider",[_,b]}const a=()=>{const u=r.map(h=>A.createContext(h));return function(g){const s=(g==null?void 0:g[e])||u;return A.useMemo(()=>({[`__scope${e}`]:{...g,[e]:s}}),[g,s])}};return a.scopeName=e,[i,AJ(a,...t)]}function AJ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(u){const h=i.reduce((g,{useScope:s,scopeName:_})=>{const C=s(u)[`__scope${_}`];return{...g,...C}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}var ZE="rovingFocusGroup.onEntryFocus",IJ={bubbles:!1,cancelable:!0},Yw="RovingFocusGroup",[BC,o5,DJ]=dm(Yw),[RJ,Kw]=PJ(Yw,[DJ]),[NJ,jJ]=RJ(Yw),a5=A.forwardRef((e,t)=>m.jsx(BC.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(BC.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(LJ,{...e,ref:t})})}));a5.displayName=Yw;var LJ=A.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:i,loop:a=!1,dir:u,currentTabStopId:h,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:s,onEntryFocus:_,preventScrollOnEntryFocus:b=!1,...C}=e,M=A.useRef(null),D=Cr(t,M),N=Nh(u),[j=null,V]=Wa({prop:h,defaultProp:g,onChange:s}),[B,z]=A.useState(!1),U=jn(_),Z=o5(r),Q=A.useRef(!1),[re,oe]=A.useState(0);return A.useEffect(()=>{const pe=M.current;if(pe)return pe.addEventListener(ZE,U),()=>pe.removeEventListener(ZE,U)},[U]),m.jsx(NJ,{scope:r,orientation:i,dir:N,loop:a,currentTabStopId:j,onItemFocus:A.useCallback(pe=>V(pe),[V]),onItemShiftTab:A.useCallback(()=>z(!0),[]),onFocusableItemAdd:A.useCallback(()=>oe(pe=>pe+1),[]),onFocusableItemRemove:A.useCallback(()=>oe(pe=>pe-1),[]),children:m.jsx(sr.div,{tabIndex:B||re===0?-1:0,"data-orientation":i,...C,ref:D,style:{outline:"none",...e.style},onMouseDown:kt(e.onMouseDown,()=>{Q.current=!0}),onFocus:kt(e.onFocus,pe=>{const ve=!Q.current;if(pe.target===pe.currentTarget&&ve&&!B){const he=new CustomEvent(ZE,IJ);if(pe.currentTarget.dispatchEvent(he),!he.defaultPrevented){const Ke=Z().filter(it=>it.focusable),qe=Ke.find(it=>it.active),Ie=Ke.find(it=>it.id===j),Pt=[qe,Ie,...Ke].filter(Boolean).map(it=>it.ref.current);u5(Pt,b)}}Q.current=!1}),onBlur:kt(e.onBlur,()=>z(!1))})})}),l5="RovingFocusGroupItem",c5=A.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:i=!0,active:a=!1,tabStopId:u,...h}=e,g=Po(),s=u||g,_=jJ(l5,r),b=_.currentTabStopId===s,C=o5(r),{onFocusableItemAdd:M,onFocusableItemRemove:D}=_;return A.useEffect(()=>{if(i)return M(),()=>D()},[i,M,D]),m.jsx(BC.ItemSlot,{scope:r,id:s,focusable:i,active:a,children:m.jsx(sr.span,{tabIndex:b?0:-1,"data-orientation":_.orientation,...h,ref:t,onMouseDown:kt(e.onMouseDown,N=>{i?_.onItemFocus(s):N.preventDefault()}),onFocus:kt(e.onFocus,()=>_.onItemFocus(s)),onKeyDown:kt(e.onKeyDown,N=>{if(N.key==="Tab"&&N.shiftKey){_.onItemShiftTab();return}if(N.target!==N.currentTarget)return;const j=FJ(N,_.orientation,_.dir);if(j!==void 0){if(N.metaKey||N.ctrlKey||N.altKey||N.shiftKey)return;N.preventDefault();let B=C().filter(z=>z.focusable).map(z=>z.ref.current);if(j==="last")B.reverse();else if(j==="prev"||j==="next"){j==="prev"&&B.reverse();const z=B.indexOf(N.currentTarget);B=_.loop?BJ(B,z+1):B.slice(z+1)}setTimeout(()=>u5(B))}})})})});c5.displayName=l5;var OJ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function zJ(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function FJ(e,t,r){const i=zJ(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return OJ[i]}function u5(e,t=!1){const r=document.activeElement;for(const i of e)if(i===r||(i.focus({preventScroll:t}),document.activeElement!==r))return}function BJ(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var d5=a5,h5=c5,UC=["Enter"," "],UJ=["ArrowDown","PageUp","Home"],f5=["ArrowUp","PageDown","End"],VJ=[...UJ,...f5],$J={ltr:[...UC,"ArrowRight"],rtl:[...UC,"ArrowLeft"]},WJ={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ex="Menu",[yv,GJ,HJ]=dm(ex),[jh,p5]=Ya(ex,[HJ,pm,Kw]),Qw=pm(),m5=Kw(),[qJ,Lh]=jh(ex),[ZJ,tx]=jh(ex),g5=e=>{const{__scopeMenu:t,open:r=!1,children:i,dir:a,onOpenChange:u,modal:h=!0}=e,g=Qw(t),[s,_]=A.useState(null),b=A.useRef(!1),C=jn(u),M=Nh(a);return A.useEffect(()=>{const D=()=>{b.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>b.current=!1;return document.addEventListener("keydown",D,{capture:!0}),()=>{document.removeEventListener("keydown",D,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),m.jsx(nP,{...g,children:m.jsx(qJ,{scope:t,open:r,onOpenChange:C,content:s,onContentChange:_,children:m.jsx(ZJ,{scope:t,onClose:A.useCallback(()=>C(!1),[C]),isUsingKeyboardRef:b,dir:M,modal:h,children:i})})})};g5.displayName=ex;var XJ="MenuAnchor",oP=A.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,a=Qw(r);return m.jsx(Xw,{...a,...i,ref:t})});oP.displayName=XJ;var aP="MenuPortal",[YJ,y5]=jh(aP,{forceMount:void 0}),v5=e=>{const{__scopeMenu:t,forceMount:r,children:i,container:a}=e,u=Lh(aP,t);return m.jsx(YJ,{scope:t,forceMount:r,children:m.jsx(ji,{present:r||u.open,children:m.jsx(Wv,{asChild:!0,container:a,children:i})})})};v5.displayName=aP;var ia="MenuContent",[KJ,lP]=jh(ia),x5=A.forwardRef((e,t)=>{const r=y5(ia,e.__scopeMenu),{forceMount:i=r.forceMount,...a}=e,u=Lh(ia,e.__scopeMenu),h=tx(ia,e.__scopeMenu);return m.jsx(yv.Provider,{scope:e.__scopeMenu,children:m.jsx(ji,{present:i||u.open,children:m.jsx(yv.Slot,{scope:e.__scopeMenu,children:h.modal?m.jsx(QJ,{...a,ref:t}):m.jsx(JJ,{...a,ref:t})})})})}),QJ=A.forwardRef((e,t)=>{const r=Lh(ia,e.__scopeMenu),i=A.useRef(null),a=Cr(t,i);return A.useEffect(()=>{const u=i.current;if(u)return Gw(u)},[]),m.jsx(cP,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:kt(e.onFocusOutside,u=>u.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),JJ=A.forwardRef((e,t)=>{const r=Lh(ia,e.__scopeMenu);return m.jsx(cP,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),cP=A.forwardRef((e,t)=>{const{__scopeMenu:r,loop:i=!1,trapFocus:a,onOpenAutoFocus:u,onCloseAutoFocus:h,disableOutsidePointerEvents:g,onEntryFocus:s,onEscapeKeyDown:_,onPointerDownOutside:b,onFocusOutside:C,onInteractOutside:M,onDismiss:D,disableOutsideScroll:N,...j}=e,V=Lh(ia,r),B=tx(ia,r),z=Qw(r),U=m5(r),Z=GJ(r),[Q,re]=A.useState(null),oe=A.useRef(null),pe=Cr(t,oe,V.onContentChange),ve=A.useRef(0),he=A.useRef(""),Ke=A.useRef(0),qe=A.useRef(null),Ie=A.useRef("right"),rt=A.useRef(0),Pt=N?Gv:A.Fragment,it=N?{as:Tl,allowPinchZoom:!0}:void 0,Je=Re=>{var St,nr;const Tt=he.current+Re,Ge=Z().filter(cr=>!cr.disabled),wt=document.activeElement,ct=(St=Ge.find(cr=>cr.ref.current===wt))==null?void 0:St.textValue,dt=Ge.map(cr=>cr.textValue),tr=dee(dt,Tt,ct),Bt=(nr=Ge.find(cr=>cr.textValue===tr))==null?void 0:nr.ref.current;(function cr(lr){he.current=lr,window.clearTimeout(ve.current),lr!==""&&(ve.current=window.setTimeout(()=>cr(""),1e3))})(Tt),Bt&&setTimeout(()=>Bt.focus())};A.useEffect(()=>()=>window.clearTimeout(ve.current),[]),$w();const Te=A.useCallback(Re=>{var Ge,wt;return Ie.current===((Ge=qe.current)==null?void 0:Ge.side)&&fee(Re,(wt=qe.current)==null?void 0:wt.area)},[]);return m.jsx(KJ,{scope:r,searchRef:he,onItemEnter:A.useCallback(Re=>{Te(Re)&&Re.preventDefault()},[Te]),onItemLeave:A.useCallback(Re=>{var Tt;Te(Re)||((Tt=oe.current)==null||Tt.focus(),re(null))},[Te]),onTriggerLeave:A.useCallback(Re=>{Te(Re)&&Re.preventDefault()},[Te]),pointerGraceTimerRef:Ke,onPointerGraceIntentChange:A.useCallback(Re=>{qe.current=Re},[]),children:m.jsx(Pt,{...it,children:m.jsx($v,{asChild:!0,trapped:a,onMountAutoFocus:kt(u,Re=>{var Tt;Re.preventDefault(),(Tt=oe.current)==null||Tt.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:m.jsx(lm,{asChild:!0,disableOutsidePointerEvents:g,onEscapeKeyDown:_,onPointerDownOutside:b,onFocusOutside:C,onInteractOutside:M,onDismiss:D,children:m.jsx(d5,{asChild:!0,...U,dir:B.dir,orientation:"vertical",loop:i,currentTabStopId:Q,onCurrentTabStopIdChange:re,onEntryFocus:kt(s,Re=>{B.isUsingKeyboardRef.current||Re.preventDefault()}),preventScrollOnEntryFocus:!0,children:m.jsx(iP,{role:"menu","aria-orientation":"vertical","data-state":j5(V.open),"data-radix-menu-content":"",dir:B.dir,...z,...j,ref:pe,style:{outline:"none",...j.style},onKeyDown:kt(j.onKeyDown,Re=>{const Ge=Re.target.closest("[data-radix-menu-content]")===Re.currentTarget,wt=Re.ctrlKey||Re.altKey||Re.metaKey,ct=Re.key.length===1;Ge&&(Re.key==="Tab"&&Re.preventDefault(),!wt&&ct&&Je(Re.key));const dt=oe.current;if(Re.target!==dt||!VJ.includes(Re.key))return;Re.preventDefault();const Bt=Z().filter(St=>!St.disabled).map(St=>St.ref.current);f5.includes(Re.key)&&Bt.reverse(),cee(Bt)}),onBlur:kt(e.onBlur,Re=>{Re.currentTarget.contains(Re.target)||(window.clearTimeout(ve.current),he.current="")}),onPointerMove:kt(e.onPointerMove,vv(Re=>{const Tt=Re.target,Ge=rt.current!==Re.clientX;if(Re.currentTarget.contains(Tt)&&Ge){const wt=Re.clientX>rt.current?"right":"left";Ie.current=wt,rt.current=Re.clientX}}))})})})})})})});x5.displayName=ia;var eee="MenuGroup",uP=A.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return m.jsx(sr.div,{role:"group",...i,ref:t})});uP.displayName=eee;var tee="MenuLabel",_5=A.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return m.jsx(sr.div,{...i,ref:t})});_5.displayName=tee;var I1="MenuItem",Ej="menu.itemSelect",Jw=A.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:i,...a}=e,u=A.useRef(null),h=tx(I1,e.__scopeMenu),g=lP(I1,e.__scopeMenu),s=Cr(t,u),_=A.useRef(!1),b=()=>{const C=u.current;if(!r&&C){const M=new CustomEvent(Ej,{bubbles:!0,cancelable:!0});C.addEventListener(Ej,D=>i==null?void 0:i(D),{once:!0}),T1(C,M),M.defaultPrevented?_.current=!1:h.onClose()}};return m.jsx(w5,{...a,ref:s,disabled:r,onClick:kt(e.onClick,b),onPointerDown:C=>{var M;(M=e.onPointerDown)==null||M.call(e,C),_.current=!0},onPointerUp:kt(e.onPointerUp,C=>{var M;_.current||(M=C.currentTarget)==null||M.click()}),onKeyDown:kt(e.onKeyDown,C=>{const M=g.searchRef.current!=="";r||M&&C.key===" "||UC.includes(C.key)&&(C.currentTarget.click(),C.preventDefault())})})});Jw.displayName=I1;var w5=A.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:i=!1,textValue:a,...u}=e,h=lP(I1,r),g=m5(r),s=A.useRef(null),_=Cr(t,s),[b,C]=A.useState(!1),[M,D]=A.useState("");return A.useEffect(()=>{const N=s.current;N&&D((N.textContent??"").trim())},[u.children]),m.jsx(yv.ItemSlot,{scope:r,disabled:i,textValue:a??M,children:m.jsx(h5,{asChild:!0,...g,focusable:!i,children:m.jsx(sr.div,{role:"menuitem","data-highlighted":b?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...u,ref:_,onPointerMove:kt(e.onPointerMove,vv(N=>{i?h.onItemLeave(N):(h.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:kt(e.onPointerLeave,vv(N=>h.onItemLeave(N))),onFocus:kt(e.onFocus,()=>C(!0)),onBlur:kt(e.onBlur,()=>C(!1))})})})}),ree="MenuCheckboxItem",b5=A.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:i,...a}=e;return m.jsx(M5,{scope:e.__scopeMenu,checked:r,children:m.jsx(Jw,{role:"menuitemcheckbox","aria-checked":D1(r)?"mixed":r,...a,ref:t,"data-state":hP(r),onSelect:kt(a.onSelect,()=>i==null?void 0:i(D1(r)?!0:!r),{checkForDefaultPrevented:!1})})})});b5.displayName=ree;var S5="MenuRadioGroup",[nee,iee]=jh(S5,{value:void 0,onValueChange:()=>{}}),E5=A.forwardRef((e,t)=>{const{value:r,onValueChange:i,...a}=e,u=jn(i);return m.jsx(nee,{scope:e.__scopeMenu,value:r,onValueChange:u,children:m.jsx(uP,{...a,ref:t})})});E5.displayName=S5;var T5="MenuRadioItem",C5=A.forwardRef((e,t)=>{const{value:r,...i}=e,a=iee(T5,e.__scopeMenu),u=r===a.value;return m.jsx(M5,{scope:e.__scopeMenu,checked:u,children:m.jsx(Jw,{role:"menuitemradio","aria-checked":u,...i,ref:t,"data-state":hP(u),onSelect:kt(i.onSelect,()=>{var h;return(h=a.onValueChange)==null?void 0:h.call(a,r)},{checkForDefaultPrevented:!1})})})});C5.displayName=T5;var dP="MenuItemIndicator",[M5,see]=jh(dP,{checked:!1}),k5=A.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:i,...a}=e,u=see(dP,r);return m.jsx(ji,{present:i||D1(u.checked)||u.checked===!0,children:m.jsx(sr.span,{...a,ref:t,"data-state":hP(u.checked)})})});k5.displayName=dP;var oee="MenuSeparator",P5=A.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return m.jsx(sr.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});P5.displayName=oee;var aee="MenuArrow",A5=A.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,a=Qw(r);return m.jsx(sP,{...a,...i,ref:t})});A5.displayName=aee;var lee="MenuSub",[xfe,I5]=jh(lee),xy="MenuSubTrigger",D5=A.forwardRef((e,t)=>{const r=Lh(xy,e.__scopeMenu),i=tx(xy,e.__scopeMenu),a=I5(xy,e.__scopeMenu),u=lP(xy,e.__scopeMenu),h=A.useRef(null),{pointerGraceTimerRef:g,onPointerGraceIntentChange:s}=u,_={__scopeMenu:e.__scopeMenu},b=A.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return A.useEffect(()=>b,[b]),A.useEffect(()=>{const C=g.current;return()=>{window.clearTimeout(C),s(null)}},[g,s]),m.jsx(oP,{asChild:!0,..._,children:m.jsx(w5,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":j5(r.open),...e,ref:Vv(t,a.onTriggerChange),onClick:C=>{var M;(M=e.onClick)==null||M.call(e,C),!(e.disabled||C.defaultPrevented)&&(C.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:kt(e.onPointerMove,vv(C=>{u.onItemEnter(C),!C.defaultPrevented&&!e.disabled&&!r.open&&!h.current&&(u.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{r.onOpenChange(!0),b()},100))})),onPointerLeave:kt(e.onPointerLeave,vv(C=>{var D,N;b();const M=(D=r.content)==null?void 0:D.getBoundingClientRect();if(M){const j=(N=r.content)==null?void 0:N.dataset.side,V=j==="right",B=V?-5:5,z=M[V?"left":"right"],U=M[V?"right":"left"];u.onPointerGraceIntentChange({area:[{x:C.clientX+B,y:C.clientY},{x:z,y:M.top},{x:U,y:M.top},{x:U,y:M.bottom},{x:z,y:M.bottom}],side:j}),window.clearTimeout(g.current),g.current=window.setTimeout(()=>u.onPointerGraceIntentChange(null),300)}else{if(u.onTriggerLeave(C),C.defaultPrevented)return;u.onPointerGraceIntentChange(null)}})),onKeyDown:kt(e.onKeyDown,C=>{var D;const M=u.searchRef.current!=="";e.disabled||M&&C.key===" "||$J[i.dir].includes(C.key)&&(r.onOpenChange(!0),(D=r.content)==null||D.focus(),C.preventDefault())})})})});D5.displayName=xy;var R5="MenuSubContent",N5=A.forwardRef((e,t)=>{const r=y5(ia,e.__scopeMenu),{forceMount:i=r.forceMount,...a}=e,u=Lh(ia,e.__scopeMenu),h=tx(ia,e.__scopeMenu),g=I5(R5,e.__scopeMenu),s=A.useRef(null),_=Cr(t,s);return m.jsx(yv.Provider,{scope:e.__scopeMenu,children:m.jsx(ji,{present:i||u.open,children:m.jsx(yv.Slot,{scope:e.__scopeMenu,children:m.jsx(cP,{id:g.contentId,"aria-labelledby":g.triggerId,...a,ref:_,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:b=>{var C;h.isUsingKeyboardRef.current&&((C=s.current)==null||C.focus()),b.preventDefault()},onCloseAutoFocus:b=>b.preventDefault(),onFocusOutside:kt(e.onFocusOutside,b=>{b.target!==g.trigger&&u.onOpenChange(!1)}),onEscapeKeyDown:kt(e.onEscapeKeyDown,b=>{h.onClose(),b.preventDefault()}),onKeyDown:kt(e.onKeyDown,b=>{var D;const C=b.currentTarget.contains(b.target),M=WJ[h.dir].includes(b.key);C&&M&&(u.onOpenChange(!1),(D=g.trigger)==null||D.focus(),b.preventDefault())})})})})})});N5.displayName=R5;function j5(e){return e?"open":"closed"}function D1(e){return e==="indeterminate"}function hP(e){return D1(e)?"indeterminate":e?"checked":"unchecked"}function cee(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function uee(e,t){return e.map((r,i)=>e[(t+i)%e.length])}function dee(e,t,r){const a=t.length>1&&Array.from(t).every(_=>_===t[0])?t[0]:t,u=r?e.indexOf(r):-1;let h=uee(e,Math.max(u,0));a.length===1&&(h=h.filter(_=>_!==r));const s=h.find(_=>_.toLowerCase().startsWith(a.toLowerCase()));return s!==r?s:void 0}function hee(e,t){const{x:r,y:i}=e;let a=!1;for(let u=0,h=t.length-1;u<t.length;h=u++){const g=t[u].x,s=t[u].y,_=t[h].x,b=t[h].y;s>i!=b>i&&r<(_-g)*(i-s)/(b-s)+g&&(a=!a)}return a}function fee(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return hee(r,t)}function vv(e){return t=>t.pointerType==="mouse"?e(t):void 0}var pee=g5,mee=oP,gee=v5,yee=x5,vee=uP,xee=_5,_ee=Jw,wee=b5,bee=E5,See=C5,Eee=k5,Tee=P5,Cee=A5,Mee=D5,kee=N5,fP="DropdownMenu",[Pee,_fe]=Ya(fP,[p5]),Bs=p5(),[Aee,L5]=Pee(fP),O5=e=>{const{__scopeDropdownMenu:t,children:r,dir:i,open:a,defaultOpen:u,onOpenChange:h,modal:g=!0}=e,s=Bs(t),_=A.useRef(null),[b=!1,C]=Wa({prop:a,defaultProp:u,onChange:h});return m.jsx(Aee,{scope:t,triggerId:Po(),triggerRef:_,contentId:Po(),open:b,onOpenChange:C,onOpenToggle:A.useCallback(()=>C(M=>!M),[C]),modal:g,children:m.jsx(pee,{...s,open:b,onOpenChange:C,dir:i,modal:g,children:r})})};O5.displayName=fP;var z5="DropdownMenuTrigger",F5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:i=!1,...a}=e,u=L5(z5,r),h=Bs(r);return m.jsx(mee,{asChild:!0,...h,children:m.jsx(sr.button,{type:"button",id:u.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":u.open?u.contentId:void 0,"data-state":u.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...a,ref:Vv(t,u.triggerRef),onPointerDown:kt(e.onPointerDown,g=>{!i&&g.button===0&&g.ctrlKey===!1&&(u.onOpenToggle(),u.open||g.preventDefault())}),onKeyDown:kt(e.onKeyDown,g=>{i||(["Enter"," "].includes(g.key)&&u.onOpenToggle(),g.key==="ArrowDown"&&u.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(g.key)&&g.preventDefault())})})})});F5.displayName=z5;var Iee="DropdownMenuPortal",B5=e=>{const{__scopeDropdownMenu:t,...r}=e,i=Bs(t);return m.jsx(gee,{...i,...r})};B5.displayName=Iee;var U5="DropdownMenuContent",V5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=L5(U5,r),u=Bs(r),h=A.useRef(!1);return m.jsx(yee,{id:a.contentId,"aria-labelledby":a.triggerId,...u,...i,ref:t,onCloseAutoFocus:kt(e.onCloseAutoFocus,g=>{var s;h.current||(s=a.triggerRef.current)==null||s.focus(),h.current=!1,g.preventDefault()}),onInteractOutside:kt(e.onInteractOutside,g=>{const s=g.detail.originalEvent,_=s.button===0&&s.ctrlKey===!0,b=s.button===2||_;(!a.modal||b)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});V5.displayName=U5;var Dee="DropdownMenuGroup",Ree=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(vee,{...a,...i,ref:t})});Ree.displayName=Dee;var Nee="DropdownMenuLabel",$5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(xee,{...a,...i,ref:t})});$5.displayName=Nee;var jee="DropdownMenuItem",W5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(_ee,{...a,...i,ref:t})});W5.displayName=jee;var Lee="DropdownMenuCheckboxItem",G5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(wee,{...a,...i,ref:t})});G5.displayName=Lee;var Oee="DropdownMenuRadioGroup",zee=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(bee,{...a,...i,ref:t})});zee.displayName=Oee;var Fee="DropdownMenuRadioItem",H5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(See,{...a,...i,ref:t})});H5.displayName=Fee;var Bee="DropdownMenuItemIndicator",q5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(Eee,{...a,...i,ref:t})});q5.displayName=Bee;var Uee="DropdownMenuSeparator",Z5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(Tee,{...a,...i,ref:t})});Z5.displayName=Uee;var Vee="DropdownMenuArrow",$ee=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(Cee,{...a,...i,ref:t})});$ee.displayName=Vee;var Wee="DropdownMenuSubTrigger",X5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(Mee,{...a,...i,ref:t})});X5.displayName=Wee;var Gee="DropdownMenuSubContent",Y5=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,a=Bs(r);return m.jsx(kee,{...a,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Y5.displayName=Gee;var Hee=O5,qee=F5,Zee=B5,K5=V5,Q5=$5,J5=W5,eB=G5,tB=H5,rB=q5,nB=Z5,iB=X5,sB=Y5;const oB=Hee,aB=qee,Xee=A.forwardRef(({className:e,inset:t,children:r,...i},a)=>m.jsxs(iB,{ref:a,className:It("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...i,children:[r,m.jsx(Fu,{className:"ml-auto h-4 w-4"})]}));Xee.displayName=iB.displayName;const Yee=A.forwardRef(({className:e,...t},r)=>m.jsx(sB,{ref:r,className:It("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Yee.displayName=sB.displayName;const pP=A.forwardRef(({className:e,sideOffset:t=4,...r},i)=>m.jsx(Zee,{children:m.jsx(K5,{ref:i,sideOffset:t,className:It("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));pP.displayName=K5.displayName;const Eu=A.forwardRef(({className:e,inset:t,...r},i)=>m.jsx(J5,{ref:i,className:It("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Eu.displayName=J5.displayName;const Kee=A.forwardRef(({className:e,children:t,checked:r,...i},a)=>m.jsxs(eB,{ref:a,className:It("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...i,children:[m.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsx(rB,{children:m.jsx(Lk,{className:"h-4 w-4"})})}),t]}));Kee.displayName=eB.displayName;const Qee=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(tB,{ref:i,className:It("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[m.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsx(rB,{children:m.jsx(wX,{className:"h-2 w-2 fill-current"})})}),t]}));Qee.displayName=tB.displayName;const Jee=A.forwardRef(({className:e,inset:t,...r},i)=>m.jsx(Q5,{ref:i,className:It("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Jee.displayName=Q5.displayName;const lB=A.forwardRef(({className:e,...t},r)=>m.jsx(nB,{ref:r,className:It("-mx-1 my-1 h-px bg-muted",e),...t}));lB.displayName=nB.displayName;function ete(){const{theme:e,setTheme:t,resolvedTheme:r}=Fv();return m.jsxs(oB,{children:[m.jsx(aB,{asChild:!0,children:m.jsxs(Et,{variant:"ghost",size:"icon",className:"w-9 h-9 rounded-full","aria-label":"Select theme",children:[r==="dark"?m.jsx(HN,{className:"h-5 w-5 transition-all"}):m.jsx(YN,{className:"h-5 w-5 transition-all"}),m.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),m.jsxs(pP,{align:"end",children:[m.jsxs(Eu,{onClick:()=>t("light"),className:e==="light"?"bg-accent":"",children:[m.jsx(YN,{className:"h-4 w-4 mr-2"}),m.jsx("span",{children:"Light"})]}),m.jsxs(Eu,{onClick:()=>t("dark"),className:e==="dark"?"bg-accent":"",children:[m.jsx(HN,{className:"h-4 w-4 mr-2"}),m.jsx("span",{children:"Dark"})]}),m.jsxs(Eu,{onClick:()=>t("system"),className:e==="system"?"bg-accent":"",children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[m.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),m.jsx("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),m.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]}),m.jsx("span",{children:"System"})]})]})]})}const XE=768;function mm(){const[e,t]=A.useState(void 0);return A.useEffect(()=>{const r=window.matchMedia(`(max-width: ${XE-1}px)`),i=()=>{t(window.innerWidth<XE)};return r.addEventListener("change",i),t(window.innerWidth<XE),()=>r.removeEventListener("change",i)},[]),!!e}function Oh(){const[e,t]=A.useState(null),[r,i]=A.useState(!0),[a,u]=A.useState(null),h=A.useCallback(async()=>{try{i(!0),u(null);const _=await SC.getSettings();return console.log("Fetched website settings:",_),t({..._,heroSliderMobileVertical:_.heroSliderMobileVertical!==!1}),_}catch(_){return console.error("Failed to fetch website settings:",_),u("Failed to load website settings"),null}finally{i(!1)}},[]),g=A.useCallback(async _=>{try{i(!0),u(null);let b;if(_.openingHours){const D=_.openingHours.map(N=>({day:N.day||"",openTime:N.openTime||"",closeTime:N.closeTime||""}));b={...s(),...e||{},..._,openingHours:D}}else b={...s(),...e||{},..._};b.heroSliderMobileVertical=_.heroSliderMobileVertical===!1?!1:_.heroSliderMobileVertical===!0?!0:(e==null?void 0:e.heroSliderMobileVertical)!==!1,console.log("Saving settings with heroSliderMobileVertical:",b.heroSliderMobileVertical);const C=await SC.saveSettings(b),M={...C,heroSliderMobileVertical:C.heroSliderMobileVertical!==!1};return t(M),M}catch(b){throw console.error("Failed to save website settings:",b),u("Failed to save website settings"),b}finally{i(!1)}},[e]),s=()=>({siteName:"Young Brave Fearless",siteTitle:"YBF Resto - Young Brave Fearless Restaurant",logoUrl:"",faviconUrl:"",mission:"To deliver exceptional dining experiences through quality ingredients, innovative recipes, and warm hospitality.",vision:"To be recognized as the premier dining destination that brings people together through a shared love of exceptional food.",address:"123 Culinary Street, Foodie District",mapCoordinates:"",reservationNote:"Reservations recommended for parties of 6 or more",instagramUrl:"https://instagram.com/ybf.id",facebookUrl:"",twitterUrl:"",footerText:` ${new Date().getFullYear()} YBF Restaurant. All rights reserved.`,whatsappNumber:"6281234567890",whatsappMessage:"Hello! I'm interested in your restaurant.",heroSliderMobileVertical:!0,openingHours:[{day:"Monday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Tuesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Wednesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Thursday",openTime:"11:00 AM",closeTime:"11:00 PM"},{day:"Friday",openTime:"11:00 AM",closeTime:"12:00 AM"},{day:"Saturday",openTime:"10:00 AM",closeTime:"12:00 AM"},{day:"Sunday",openTime:"10:00 AM",closeTime:"10:00 PM"}]});return A.useEffect(()=>{h()},[h]),{settings:e,isLoading:r,error:a,fetchSettings:h,saveSettings:g,getDefaultSettings:s}}const tte=()=>{const[e,t]=A.useState(!1),[r,i]=A.useState(!1),a=la(),u=Tc(),{isAuthenticated:h,user:g,logout:s}=Qv(),{pathname:_}=a,b=mm(),[C,M]=A.useState(!1),{settings:D,fetchSettings:N}=Oh();A.useEffect(()=>{N()},[N]),A.useEffect(()=>{const Q=()=>{t(window.scrollY>10)};return window.addEventListener("scroll",Q),()=>window.removeEventListener("scroll",Q)},[]),A.useEffect(()=>{i(!1)},[a.pathname]),A.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]);const j=(g==null?void 0:g.role)==="admin"||(g==null?void 0:g.role)==="developer",V=[{name:"Home",path:"/"},{name:"Menu",path:"/menu"},{name:"About Us",path:"/#about"},{name:"Vouchers",path:"/vouchers"}],B=()=>{s()},z=(Q,re)=>{if(re==="/#about")if(Q.preventDefault(),_==="/"){const oe=document.getElementById("about");oe&&oe.scrollIntoView({behavior:"smooth"})}else u("/",{state:{scrollToAbout:!0}})},U=(D==null?void 0:D.siteName)||"Young Brave Fearless",Z=(D==null?void 0:D.logoUrl)||null;return m.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 backdrop-blur-md bg-background/80 border-b",children:[m.jsxs("div",{className:"container-custom py-3 md:py-4 flex justify-between items-center",children:[m.jsx(ta,{to:"/",className:"text-xl md:text-2xl font-display font-bold flex items-center",children:Z?m.jsx("img",{src:Z,alt:U,className:"h-8 md:h-10 max-w-[180px] object-contain"}):m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-primary",children:"Young Brave "}),m.jsx("span",{children:" Fearless"})]})}),m.jsx("nav",{className:"hidden md:flex space-x-1",children:V.map(Q=>m.jsx(ta,{to:Q.path,onClick:re=>z(re,Q.path),className:`px-4 py-2 rounded-md transition-colors ${_===Q.path?"bg-primary/10 text-primary":"hover:bg-primary/5"}`,children:Q.name},Q.name))}),m.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[m.jsx(ete,{}),h?m.jsxs(oB,{children:[m.jsx(aB,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"rounded-full w-9 h-9 relative","aria-label":"User menu",children:m.jsx(Pz,{className:"h-5 w-5"})})}),m.jsxs(pP,{align:"end",className:"mt-1 w-56 bg-popover",children:[m.jsxs("div",{className:"p-2 border-b",children:[m.jsx("p",{className:"font-medium",children:(g==null?void 0:g.name)||"User"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:g==null?void 0:g.email})]}),m.jsx(Eu,{asChild:!0,children:m.jsxs(ta,{to:"/profile",className:"cursor-pointer",children:[m.jsx(AC,{className:"mr-2 h-4 w-4"}),"My Profile"]})}),j&&m.jsx(Eu,{asChild:!0,children:m.jsxs(ta,{to:"/admin",className:"cursor-pointer",children:[m.jsx($X,{className:"mr-2 h-4 w-4"}),"Admin Dashboard"]})}),m.jsx(Eu,{asChild:!0,children:m.jsxs(ta,{to:"/vouchers",className:"cursor-pointer",children:[m.jsx(kz,{className:"mr-2 h-4 w-4"}),"Vouchers"]})}),m.jsx(lB,{}),m.jsxs(Eu,{className:"cursor-pointer text-destructive focus:text-destructive",onClick:B,children:[m.jsx(NX,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):m.jsx(Et,{asChild:!0,size:b?"icon":"default",variant:"outline"}),m.jsx(Et,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>M(!C),"aria-label":C?"Close menu":"Open menu",children:C?m.jsx(Ls,{className:"h-6 w-6"}):m.jsx(jX,{className:"h-6 w-6"})})]})]}),C&&m.jsx("div",{className:"md:hidden bg-background border-t",children:m.jsx("nav",{className:"container-custom py-4 flex flex-col space-y-1",children:V.map(Q=>m.jsx(ta,{to:Q.path,onClick:re=>{M(!1),z(re,Q.path)},className:`px-4 py-3 rounded-md transition-colors ${_===Q.path?"bg-primary/10 text-primary":"hover:bg-primary/5"}`,children:Q.name},Q.name))})})]})};function rte(){const e=new Date().getFullYear(),{settings:t}=Oh(),r=t==null?void 0:t.logoUrl,i=(t==null?void 0:t.siteName)||"Young Brave Fearless",a=(t==null?void 0:t.footerText)||` ${e} YBF Restaurant. All rights reserved.`,u=t==null?void 0:t.instagramUrl,h=t==null?void 0:t.facebookUrl,g=t==null?void 0:t.twitterUrl,s=(t==null?void 0:t.openingHours)||[{day:"Monday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Tuesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Wednesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Thursday",openTime:"11:00 AM",closeTime:"11:00 PM"},{day:"Friday",openTime:"11:00 AM",closeTime:"12:00 AM"},{day:"Saturday",openTime:"10:00 AM",closeTime:"12:00 AM"},{day:"Sunday",openTime:"10:00 AM",closeTime:"10:00 PM"}],_=(b,C)=>!b||!C?"":`${b} - ${C}`;return m.jsx("footer",{className:"border-t bg-secondary/50",children:m.jsxs("div",{className:"container-custom py-12 md:py-16",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[m.jsxs("div",{children:[r?m.jsx("img",{src:r,alt:i,className:"h-10 max-w-[180px] object-contain mb-4"}):m.jsx("h3",{className:"text-xl font-semibold mb-4",children:i}),m.jsx("p",{className:"text-muted-foreground mb-4 max-w-md",children:(t==null?void 0:t.mission)||"Experience fine dining with a modern twist. Our restaurant offers a curated menu of exquisite flavors in an elegant atmosphere."}),(u||h||g)&&m.jsxs("div",{className:"flex space-x-3 mt-4",children:[u&&m.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-primary",children:m.jsx(PX,{className:"w-5 h-5"})}),h&&m.jsx("a",{href:h,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-primary",children:m.jsx(EX,{className:"w-5 h-5"})}),g&&m.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-primary",children:m.jsx(qX,{className:"w-5 h-5"})})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-base font-semibold mb-4",children:"Quick Links"}),m.jsxs("ul",{className:"space-y-2",children:[m.jsx("li",{children:m.jsx(ta,{to:"/",className:"text-muted-foreground hover:text-primary transition-colors",children:"Home"})}),m.jsx("li",{children:m.jsx(ta,{to:"/menu",className:"text-muted-foreground hover:text-primary transition-colors",children:"Menu"})}),m.jsx("li",{children:m.jsx(ta,{to:"/vouchers",className:"text-muted-foreground hover:text-primary transition-colors",children:"Vouchers"})})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-base font-semibold mb-4",children:"Hours"}),m.jsx("ul",{className:"space-y-2 text-muted-foreground",children:s.map(({day:b,openTime:C,closeTime:M})=>m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:b}),m.jsx("span",{children:_(C,M)})]},b))})]})]}),m.jsxs("div",{className:"mt-12 pt-6 border-t border-border/50 flex flex-col md:flex-row justify-between items-center",children:[m.jsx("p",{className:"text-sm text-muted-foreground",children:a}),m.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-4",children:[u&&m.jsx("a",{href:u,className:"text-muted-foreground hover:text-primary transition-colors","aria-label":"Instagram",target:"_blank",rel:"noopener noreferrer",children:"Instagram"}),h&&m.jsx("a",{href:h,className:"text-muted-foreground hover:text-primary transition-colors","aria-label":"Facebook",target:"_blank",rel:"noopener noreferrer",children:"Facebook"}),g&&m.jsx("a",{href:g,className:"text-muted-foreground hover:text-primary transition-colors","aria-label":"Twitter",target:"_blank",rel:"noopener noreferrer",children:"Twitter"})]})]})]})})}function nte(){const[e,t]=A.useState(!1),{settings:r}=Oh(),i=(r==null?void 0:r.whatsappNumber)||"6281234567890",a=encodeURIComponent((r==null?void 0:r.whatsappMessage)||"Hello! I'm interested in your restaurant."),u=`https://wa.me/${i}?text=${a}`;return m.jsx("div",{className:"fixed bottom-4 left-4 z-50",children:e?m.jsxs("div",{className:"flex flex-col items-start space-y-3 animate-fadeIn",children:[m.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mb-2 max-w-[250px] border border-border",children:[m.jsx("div",{className:"font-medium text-sm mb-2",children:"Contact us on WhatsApp"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Chat with us for reservations or inquiries"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(Et,{size:"sm",className:"w-full bg-green-500 hover:bg-green-600 text-white",onClick:()=>window.open(u,"_blank"),children:"Start Chat"}),m.jsx(Et,{variant:"outline",size:"sm",onClick:()=>t(!1),children:"Close"})]})]}),m.jsx(Et,{size:"icon",className:"h-12 w-12 rounded-full bg-green-500 hover:bg-green-600 text-white shadow-lg",onClick:()=>t(!e),children:m.jsx(qN,{className:"h-6 w-6"})})]}):m.jsx(Et,{size:"icon",className:"h-12 w-12 rounded-full bg-green-500 hover:bg-green-600 text-white shadow-lg animate-pulse",onClick:()=>t(!0),children:m.jsx(qN,{className:"h-6 w-6"})})})}var ite="AspectRatio",cB=A.forwardRef((e,t)=>{const{ratio:r=1/1,style:i,...a}=e;return m.jsx("div",{style:{position:"relative",width:"100%",paddingBottom:`${100/r}%`},"data-radix-aspect-ratio-wrapper":"",children:m.jsx(sr.div,{...a,ref:t,style:{...i,position:"absolute",top:0,right:0,bottom:0,left:0}})})});cB.displayName=ite;var ste=cB;const _c=A.forwardRef(({className:e,...t},r)=>m.jsx(ste,{ref:r,className:It(e),...t}));_c.displayName="AspectRatio";function ote({slides:e=[],useVerticalMode:t=!0}){const[r,i]=A.useState(0),[a,u]=A.useState(!1),h=A.useRef(null),g=A.useRef(null),s=mm(),_=s&&t?9/16:16/6,b=A.useCallback(()=>Math.floor(Math.random()*7001)+8e3,[]),C=A.useCallback(()=>{a||!e.length||(u(!0),i(V=>V===e.length-1?0:V+1),setTimeout(()=>{u(!1)},500))},[a,e.length]),M=A.useCallback(()=>{a||!e.length||(u(!0),i(V=>V===0?e.length-1:V-1),setTimeout(()=>{u(!1)},500))},[a,e.length]);A.useEffect(()=>{const V=()=>{B(),h.current=setTimeout(()=>{C()},b())},B=()=>{h.current&&clearTimeout(h.current)};return e.length>1&&V(),()=>B()},[r,e.length,C,b]);const D=V=>{g.current=V.touches[0].clientX},N=V=>{if(g.current===null)return;const B=V.changedTouches[0].clientX,z=g.current-B;Math.abs(z)>50&&(z>0?C():M()),g.current=null};if(!e.length)return null;const j=s&&t?"object-top":"object-center";return m.jsx("div",{className:"container-custom mx-auto px-4 sm:px-6 py-4",children:m.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-xl",onTouchStart:D,onTouchEnd:N,children:[m.jsx(_c,{ratio:_,className:"bg-muted",children:m.jsx("div",{className:"relative h-full",children:e.map((V,B)=>m.jsxs("div",{className:`absolute inset-0 transition-opacity duration-1000 ease-in-out ${B===r?"opacity-100":"opacity-0 pointer-events-none"}`,children:[m.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/50 via-black/30 to-black/50 z-10"}),m.jsx("img",{src:V.imageUrl,alt:V.title,className:`w-full h-full object-cover ${j}`}),m.jsx("div",{className:`absolute inset-0 z-20 flex flex-col ${s&&t?"justify-start pt-8":"justify-center md:justify-end"} items-start text-left p-6 md:p-10`,children:m.jsxs("div",{className:"max-w-2xl animate-fadeIn",children:[m.jsx("div",{className:"bg-primary/10 text-primary px-3 py-1 text-xs rounded-full mb-3 backdrop-blur-sm inline-block",children:"Featured"}),m.jsx("h1",{className:"text-white font-display text-2xl sm:text-3xl md:text-4xl font-semibold tracking-tight mb-2 md:mb-3",children:V.title}),m.jsx("p",{className:"text-white/90 text-sm md:text-base mb-4 max-w-md",children:V.description}),V.linkUrl&&m.jsx(ta,{to:V.linkUrl,children:m.jsxs(Et,{size:"sm",className:"bg-primary hover:bg-primary/90 text-secondary group",children:["View More",m.jsx(Fu,{className:"ml-1 h-4 w-4 transition-transform group-hover:translate-x-1"})]})})]})})]},V.id))})}),e.length>1&&m.jsxs(m.Fragment,{children:[m.jsx(Et,{variant:"outline",size:"icon",className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-20 rounded-full h-8 w-8 sm:h-10 sm:w-10 backdrop-blur flex items-center justify-center border border-white/30 bg-black/30 hover:bg-black/50 text-white shadow-lg",onClick:M,disabled:a,"aria-label":"Previous slide",children:m.jsx(am,{className:"h-5 w-5"})}),m.jsx(Et,{variant:"outline",size:"icon",className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-20 rounded-full h-8 w-8 sm:h-10 sm:w-10 backdrop-blur flex items-center justify-center border border-white/30 bg-black/30 hover:bg-black/50 text-white shadow-lg",onClick:C,disabled:a,"aria-label":"Next slide",children:m.jsx(Fu,{className:"h-5 w-5"})})]}),e.length>1&&m.jsx("div",{className:"absolute bottom-2 sm:bottom-4 left-0 right-0 z-20 flex justify-center space-x-1 sm:space-x-2",children:e.map((V,B)=>m.jsx("button",{className:`w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full transition-all shadow-md ${B===r?"bg-white w-4 sm:w-6":"bg-white/50 hover:bg-white/80"}`,onClick:()=>i(B),"aria-label":`Go to slide ${B+1}`},B))})]})})}function xv(e,[t,r]){return Math.min(r,Math.max(t,e))}function eb(e){const t=A.useRef({value:e,previous:e});return A.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var uB=["PageUp","PageDown"],dB=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],hB={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},gm="Slider",[VC,ate,lte]=dm(gm),[fB,wfe]=Ya(gm,[lte]),[cte,tb]=fB(gm),pB=A.forwardRef((e,t)=>{const{name:r,min:i=0,max:a=100,step:u=1,orientation:h="horizontal",disabled:g=!1,minStepsBetweenThumbs:s=0,defaultValue:_=[i],value:b,onValueChange:C=()=>{},onValueCommit:M=()=>{},inverted:D=!1,form:N,...j}=e,V=A.useRef(new Set),B=A.useRef(0),U=h==="horizontal"?ute:dte,[Z=[],Q]=Wa({prop:b,defaultProp:_,onChange:Ke=>{var Ie;(Ie=[...V.current][B.current])==null||Ie.focus(),C(Ke)}}),re=A.useRef(Z);function oe(Ke){const qe=gte(Z,Ke);he(Ke,qe)}function pe(Ke){he(Ke,B.current)}function ve(){const Ke=re.current[B.current];Z[B.current]!==Ke&&M(Z)}function he(Ke,qe,{commit:Ie}={commit:!1}){const rt=_te(u),Pt=wte(Math.round((Ke-i)/u)*u+i,rt),it=xv(Pt,[i,a]);Q((Je=[])=>{const Te=pte(Je,it,qe);if(xte(Te,s*u)){B.current=Te.indexOf(it);const Re=String(Te)!==String(Je);return Re&&Ie&&M(Te),Re?Te:Je}else return Je})}return m.jsx(cte,{scope:e.__scopeSlider,name:r,disabled:g,min:i,max:a,valueIndexToChangeRef:B,thumbs:V.current,values:Z,orientation:h,form:N,children:m.jsx(VC.Provider,{scope:e.__scopeSlider,children:m.jsx(VC.Slot,{scope:e.__scopeSlider,children:m.jsx(U,{"aria-disabled":g,"data-disabled":g?"":void 0,...j,ref:t,onPointerDown:kt(j.onPointerDown,()=>{g||(re.current=Z)}),min:i,max:a,inverted:D,onSlideStart:g?void 0:oe,onSlideMove:g?void 0:pe,onSlideEnd:g?void 0:ve,onHomeKeyDown:()=>!g&&he(i,0,{commit:!0}),onEndKeyDown:()=>!g&&he(a,Z.length-1,{commit:!0}),onStepKeyDown:({event:Ke,direction:qe})=>{if(!g){const Pt=uB.includes(Ke.key)||Ke.shiftKey&&dB.includes(Ke.key)?10:1,it=B.current,Je=Z[it],Te=u*Pt*qe;he(Je+Te,it,{commit:!0})}}})})})})});pB.displayName=gm;var[mB,gB]=fB(gm,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ute=A.forwardRef((e,t)=>{const{min:r,max:i,dir:a,inverted:u,onSlideStart:h,onSlideMove:g,onSlideEnd:s,onStepKeyDown:_,...b}=e,[C,M]=A.useState(null),D=Cr(t,U=>M(U)),N=A.useRef(),j=Nh(a),V=j==="ltr",B=V&&!u||!V&&u;function z(U){const Z=N.current||C.getBoundingClientRect(),Q=[0,Z.width],oe=mP(Q,B?[r,i]:[i,r]);return N.current=Z,oe(U-Z.left)}return m.jsx(mB,{scope:e.__scopeSlider,startEdge:B?"left":"right",endEdge:B?"right":"left",direction:B?1:-1,size:"width",children:m.jsx(yB,{dir:j,"data-orientation":"horizontal",...b,ref:D,style:{...b.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:U=>{const Z=z(U.clientX);h==null||h(Z)},onSlideMove:U=>{const Z=z(U.clientX);g==null||g(Z)},onSlideEnd:()=>{N.current=void 0,s==null||s()},onStepKeyDown:U=>{const Q=hB[B?"from-left":"from-right"].includes(U.key);_==null||_({event:U,direction:Q?-1:1})}})})}),dte=A.forwardRef((e,t)=>{const{min:r,max:i,inverted:a,onSlideStart:u,onSlideMove:h,onSlideEnd:g,onStepKeyDown:s,..._}=e,b=A.useRef(null),C=Cr(t,b),M=A.useRef(),D=!a;function N(j){const V=M.current||b.current.getBoundingClientRect(),B=[0,V.height],U=mP(B,D?[i,r]:[r,i]);return M.current=V,U(j-V.top)}return m.jsx(mB,{scope:e.__scopeSlider,startEdge:D?"bottom":"top",endEdge:D?"top":"bottom",size:"height",direction:D?1:-1,children:m.jsx(yB,{"data-orientation":"vertical",..._,ref:C,style:{..._.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:j=>{const V=N(j.clientY);u==null||u(V)},onSlideMove:j=>{const V=N(j.clientY);h==null||h(V)},onSlideEnd:()=>{M.current=void 0,g==null||g()},onStepKeyDown:j=>{const B=hB[D?"from-bottom":"from-top"].includes(j.key);s==null||s({event:j,direction:B?-1:1})}})})}),yB=A.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:i,onSlideMove:a,onSlideEnd:u,onHomeKeyDown:h,onEndKeyDown:g,onStepKeyDown:s,..._}=e,b=tb(gm,r);return m.jsx(sr.span,{..._,ref:t,onKeyDown:kt(e.onKeyDown,C=>{C.key==="Home"?(h(C),C.preventDefault()):C.key==="End"?(g(C),C.preventDefault()):uB.concat(dB).includes(C.key)&&(s(C),C.preventDefault())}),onPointerDown:kt(e.onPointerDown,C=>{const M=C.target;M.setPointerCapture(C.pointerId),C.preventDefault(),b.thumbs.has(M)?M.focus():i(C)}),onPointerMove:kt(e.onPointerMove,C=>{C.target.hasPointerCapture(C.pointerId)&&a(C)}),onPointerUp:kt(e.onPointerUp,C=>{const M=C.target;M.hasPointerCapture(C.pointerId)&&(M.releasePointerCapture(C.pointerId),u(C))})})}),vB="SliderTrack",xB=A.forwardRef((e,t)=>{const{__scopeSlider:r,...i}=e,a=tb(vB,r);return m.jsx(sr.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...i,ref:t})});xB.displayName=vB;var $C="SliderRange",_B=A.forwardRef((e,t)=>{const{__scopeSlider:r,...i}=e,a=tb($C,r),u=gB($C,r),h=A.useRef(null),g=Cr(t,h),s=a.values.length,_=a.values.map(M=>bB(M,a.min,a.max)),b=s>1?Math.min(..._):0,C=100-Math.max(..._);return m.jsx(sr.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...i,ref:g,style:{...e.style,[u.startEdge]:b+"%",[u.endEdge]:C+"%"}})});_B.displayName=$C;var WC="SliderThumb",wB=A.forwardRef((e,t)=>{const r=ate(e.__scopeSlider),[i,a]=A.useState(null),u=Cr(t,g=>a(g)),h=A.useMemo(()=>i?r().findIndex(g=>g.ref.current===i):-1,[r,i]);return m.jsx(hte,{...e,ref:u,index:h})}),hte=A.forwardRef((e,t)=>{const{__scopeSlider:r,index:i,name:a,...u}=e,h=tb(WC,r),g=gB(WC,r),[s,_]=A.useState(null),b=Cr(t,z=>_(z)),C=s?h.form||!!s.closest("form"):!0,M=eP(s),D=h.values[i],N=D===void 0?0:bB(D,h.min,h.max),j=mte(i,h.values.length),V=M==null?void 0:M[g.size],B=V?yte(V,N,g.direction):0;return A.useEffect(()=>{if(s)return h.thumbs.add(s),()=>{h.thumbs.delete(s)}},[s,h.thumbs]),m.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[g.startEdge]:`calc(${N}% + ${B}px)`},children:[m.jsx(VC.ItemSlot,{scope:e.__scopeSlider,children:m.jsx(sr.span,{role:"slider","aria-label":e["aria-label"]||j,"aria-valuemin":h.min,"aria-valuenow":D,"aria-valuemax":h.max,"aria-orientation":h.orientation,"data-orientation":h.orientation,"data-disabled":h.disabled?"":void 0,tabIndex:h.disabled?void 0:0,...u,ref:b,style:D===void 0?{display:"none"}:e.style,onFocus:kt(e.onFocus,()=>{h.valueIndexToChangeRef.current=i})})}),C&&m.jsx(fte,{name:a??(h.name?h.name+(h.values.length>1?"[]":""):void 0),form:h.form,value:D},i)]})});wB.displayName=WC;var fte=e=>{const{value:t,...r}=e,i=A.useRef(null),a=eb(t);return A.useEffect(()=>{const u=i.current,h=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(h,"value").set;if(a!==t&&s){const _=new Event("input",{bubbles:!0});s.call(u,t),u.dispatchEvent(_)}},[a,t]),m.jsx("input",{style:{display:"none"},...r,ref:i,defaultValue:t})};function pte(e=[],t,r){const i=[...e];return i[r]=t,i.sort((a,u)=>a-u)}function bB(e,t,r){const u=100/(r-t)*(e-t);return xv(u,[0,100])}function mte(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function gte(e,t){if(e.length===1)return 0;const r=e.map(a=>Math.abs(a-t)),i=Math.min(...r);return r.indexOf(i)}function yte(e,t,r){const i=e/2,u=mP([0,50],[0,i]);return(i-u(t)*r)*r}function vte(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function xte(e,t){if(t>0){const r=vte(e);return Math.min(...r)>=t}return!0}function mP(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(r-e[0])}}function _te(e){return(String(e).split(".")[1]||"").length}function wte(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var SB=pB,bte=xB,Ste=_B,Ete=wB;const EB=A.forwardRef(({className:e,...t},r)=>m.jsxs(SB,{ref:r,className:It("relative flex w-full touch-none select-none items-center",e),...t,children:[m.jsx(bte,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-secondary",children:m.jsx(Ste,{className:"absolute h-full bg-primary"})}),m.jsx(Ete,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow-sm ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));EB.displayName=SB.displayName;const Tte=e=>{const t={year:"numeric",month:"short",day:"numeric"};return e.toLocaleDateString("en-US",t)},es=e=>{if(e>=1e12){const t=(e/1e12).toFixed(1);return`IDR ${t.endsWith(".0")?Math.floor(parseFloat(t)):t}T`}else if(e>=1e9){const t=(e/1e9).toFixed(1);return`IDR ${t.endsWith(".0")?Math.floor(parseFloat(t)):t}M`}else if(e>=1e6){const t=(e/1e6).toFixed(1);return`IDR ${t.endsWith(".0")?Math.floor(parseFloat(t)):t}JT`}else if(e>=1e3){const t=(e/1e3).toFixed(1);return`IDR ${t.endsWith(".0")?Math.floor(parseFloat(t)):t}K`}else return`IDR ${e}`},zh=Gk,Cte=Hk,Mte=Yv,TB=A.forwardRef(({className:e,...t},r)=>m.jsx(Hv,{ref:r,className:It("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));TB.displayName=Hv.displayName;const ed=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(Cte,{children:[m.jsx(TB,{}),m.jsxs(qv,{ref:i,className:It("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,m.jsxs(Yv,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsx(Ls,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ed.displayName=qv.displayName;const rx=({className:e,...t})=>m.jsx("div",{className:It("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});rx.displayName="DialogHeader";const rb=({className:e,...t})=>m.jsx("div",{className:It("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});rb.displayName="DialogFooter";const nx=A.forwardRef(({className:e,...t},r)=>m.jsx(Zv,{ref:r,className:It("text-lg font-semibold leading-none tracking-tight",e),...t}));nx.displayName=Zv.displayName;const gP=A.forwardRef(({className:e,...t},r)=>m.jsx(Xv,{ref:r,className:It("text-sm text-muted-foreground",e),...t}));gP.displayName=Xv.displayName;function kte({videoUrl:e,isOpen:t,onClose:r}){const[i,a]=A.useState(!1),[u,h]=A.useState(""),g=A.useRef(null);return A.useEffect(()=>{if(!t&&g.current&&g.current.pause(),e){const s=/(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,_=e.match(s);_&&_[1]?(a(!0),h(`https://www.youtube.com/embed/${_[1]}?autoplay=1&rel=0`)):(a(!1),h(""))}},[e,t]),m.jsx(zh,{open:t,onOpenChange:s=>!s&&r(),children:m.jsx(ed,{className:"sm:max-w-[800px] p-0 bg-background overflow-hidden",children:m.jsxs("div",{className:"relative w-full",children:[m.jsx(Mte,{className:"absolute top-2 right-2 z-10",children:m.jsxs(Et,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full bg-black/40 text-white hover:bg-black/60",children:[m.jsx(Ls,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})}),i?m.jsx("div",{className:"aspect-video w-full",children:m.jsx("iframe",{width:"100%",height:"100%",src:u,title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"aspect-video"})}):m.jsx("video",{ref:g,controls:!0,autoPlay:!0,className:"w-full aspect-video",src:e,children:"Your browser does not support the video tag."})]})})})}function _v({dish:e,detailed:t=!1,className:r}){var V,B;const[i,a]=A.useState(0),[u,h]=A.useState(!1),g=mm(),s=e.images.length>1,{resolvedTheme:_}=Fv(),b=_==="dark",C=()=>{a(z=>z===e.images.length-1?0:z+1)},M=()=>{a(z=>z===0?e.images.length-1:z-1)},D=e.promoEndDate?Tte(new Date(e.promoEndDate)):null,N=((V=e.videoUrl)==null?void 0:V.includes("youtube.com"))||((B=e.videoUrl)==null?void 0:B.includes("youtu.be")),j=t||s;return m.jsxs("div",{className:It("relative rounded-xl overflow-hidden transition-all",t?"bg-gradient-to-br from-background/90 to-background/70 backdrop-blur-md border border-border/30 shadow-lg":"glass-card hover-card-animation",t?g?"flex flex-col":"grid md:grid-cols-2 gap-5":"",r),children:[m.jsx("div",{className:It("relative",t&&"md:rounded-l-xl overflow-hidden"),children:m.jsxs("div",{className:It("relative overflow-hidden group",t?g?"w-full":"h-full":"aspect-[4/3]"),children:[m.jsx(_c,{ratio:t?g?4/3:1/1:4/3,className:"w-full h-full",children:m.jsx("img",{src:e.images[i]||"",alt:e.name,className:"w-full h-full object-cover transition-transform duration-700 hover:scale-105"})}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t&&e.videoUrl&&m.jsx("button",{className:"absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 hover:opacity-100 transition-opacity",onClick:()=>h(!0),"aria-label":"Play video",children:m.jsxs("div",{className:"bg-black/50 text-white rounded-full p-4 flex items-center gap-2 transform transition-transform hover:scale-110",children:[N?m.jsx(QN,{className:"h-6 w-6"}):m.jsx(ZN,{className:"h-6 w-6"}),m.jsx("span",{className:"font-medium",children:"Watch Video"})]})}),!t&&e.promoPrice&&m.jsx("div",{className:"absolute top-3 right-3 bg-primary text-primary-foreground text-sm font-medium px-3 py-1 rounded-full",children:"Featured"}),j&&s&&m.jsxs(m.Fragment,{children:[m.jsx(Et,{variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 text-white bg-black/20 hover:bg-black/40 rounded-full h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",onClick:z=>{z.stopPropagation(),M()},"aria-label":"Previous image",children:m.jsx(am,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 text-white bg-black/20 hover:bg-black/40 rounded-full h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",onClick:z=>{z.stopPropagation(),C()},"aria-label":"Next image",children:m.jsx(Fu,{className:"h-4 w-4"})})]}),j&&s&&m.jsx("div",{className:"absolute bottom-2 left-0 right-0 z-10 flex justify-center space-x-1",children:e.images.map((z,U)=>m.jsx("button",{className:It("w-1.5 h-1.5 rounded-full transition-all",U===i?"bg-white w-4":"bg-white/50 hover:bg-white/80"),onClick:Z=>{Z.stopPropagation(),a(U)},"aria-label":`Go to image ${U+1}`},U))})]})}),m.jsxs("div",{className:It(t?"p-6 flex flex-col h-full":"p-5"),children:[m.jsx("div",{className:"inline-block bg-secondary/70 text-secondary-foreground text-xs font-medium px-2.5 py-1 rounded-full mb-2",children:e.category}),m.jsxs("div",{className:"flex justify-between items-start mb-3",children:[m.jsx("h3",{className:It("font-semibold",t?"text-2xl":"text-xl"),children:e.name}),m.jsx("div",{className:"flex flex-col items-end",children:e.promoPrice?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"line-through text-muted-foreground text-sm",children:es(e.price)}),m.jsx("span",{className:"font-semibold text-primary",children:es(e.promoPrice)})]}):m.jsx("span",{className:"font-semibold",children:es(e.price)})})]}),D&&m.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mb-3",children:[m.jsx(dv,{className:"h-3 w-3 mr-1"}),m.jsxs("span",{children:["Available until ",D]})]}),m.jsx("p",{className:It("text-muted-foreground",t?"text-base":"text-sm line-clamp-2","mb-4"),children:e.description}),t&&e.ingredients.length>0&&m.jsxs("div",{className:"mb-4 animate-fade-in mt-auto",children:[m.jsx("h4",{className:"font-medium mb-2",children:"Ingredients"}),m.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.ingredients.map((z,U)=>m.jsx("span",{className:It("text-xs px-2.5 py-1 rounded-full animate-fade-in ingredient-tag",b?"bg-white/20 text-white":"bg-primary/20 text-primary"),style:{animationDelay:`${U*50}ms`},children:z},U))})]}),t&&e.videoUrl&&m.jsx("div",{className:"mt-4",children:m.jsxs(Et,{variant:"outline",className:"w-full hover:bg-primary hover:text-primary-foreground",onClick:()=>h(!0),children:[N?m.jsx(QN,{className:"h-4 w-4 mr-2"}):m.jsx(ZN,{className:"h-4 w-4 mr-2"}),"Watch Video"]})})]}),e.videoUrl&&m.jsx(kte,{videoUrl:e.videoUrl,isOpen:u,onClose:()=>h(!1)})]})}function fi({className:e,...t}){return m.jsx("div",{className:It("animate-pulse rounded-md bg-muted",e),...t})}const CB=Gk,Pte=Hk,MB=A.forwardRef(({className:e,...t},r)=>m.jsx(Hv,{className:It("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));MB.displayName=Hv.displayName;const Ate=um("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),yP=A.forwardRef(({side:e="right",className:t,children:r,...i},a)=>m.jsxs(Pte,{children:[m.jsx(MB,{}),m.jsxs(qv,{ref:a,className:It(Ate({side:e}),t),...i,children:[r,m.jsxs(Yv,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[m.jsx(Ls,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yP.displayName=qv.displayName;const Ite=A.forwardRef(({className:e,...t},r)=>m.jsx(Zv,{ref:r,className:It("text-lg font-semibold text-foreground",e),...t}));Ite.displayName=Zv.displayName;const Dte=A.forwardRef(({className:e,...t},r)=>m.jsx(Xv,{ref:r,className:It("text-sm text-muted-foreground",e),...t}));Dte.displayName=Xv.displayName;function Rte({dishes:e=[],loading:t=!1}){const r=A.useRef(null),[i,a]=A.useState(0),[u,h]=A.useState(0),[g,s]=A.useState(0),_=mm(),{selectedDish:b,setSelectedDish:C}=ca(),[M,D]=A.useState(!1);A.useEffect(()=>{const Q=()=>{if(r.current){const{scrollWidth:re,clientWidth:oe}=r.current;h(re-oe)}};return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[e]);const N=Q=>{if(!r.current)return;const re=_?r.current.clientWidth*.8:r.current.clientWidth*.6,oe=Q==="left"?Math.max(0,i-re):Math.min(u,i+re);r.current.scrollTo({left:oe,behavior:"smooth"}),a(oe)},j=Q=>{if(!r.current||u===0)return;const re=Q[0]/100*u;s(Q[0]),r.current.scrollTo({left:re,behavior:"smooth"}),a(re)},V=Q=>{const re=Q.currentTarget.scrollLeft;if(a(re),u>0){const oe=re/u*100;s(oe)}},B=Q=>{C(Q),D(!0)},z=()=>{D(!1)},U=i>0,Z=i<u;return t?m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("div",{children:[m.jsx(fi,{className:"h-8 w-64"}),m.jsx(fi,{className:"h-4 w-48 mt-2"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(fi,{className:"h-10 w-10 rounded-full"}),m.jsx(fi,{className:"h-10 w-10 rounded-full"})]})]}),m.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(Q=>m.jsxs("div",{className:"space-y-2",children:[m.jsx(fi,{className:"h-36 w-full rounded-xl"}),m.jsx(fi,{className:"h-4 w-3/4"}),m.jsx(fi,{className:"h-3 w-1/2"}),m.jsx(fi,{className:"h-8 w-full rounded-lg"})]},Q))})]}):e.length?m.jsxs("div",{className:"relative",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("div",{className:"animate-fade-in",children:[m.jsxs("h2",{className:"text-2xl font-display font-semibold flex items-center",children:[m.jsx(IC,{className:"mr-2 h-5 w-5 text-primary animate-pulse"}),"Featured Dishes"]}),m.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Our chef's special selections"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(Et,{variant:"outline",size:"icon",className:It("rounded-full shadow-sm transition-all duration-200 hover:bg-primary hover:text-primary-foreground",!U&&"opacity-50 cursor-not-allowed"),onClick:()=>N("left"),"aria-label":"Scroll left",disabled:!U,children:m.jsx(am,{className:"h-5 w-5"})}),m.jsx(Et,{variant:"outline",size:"icon",className:It("rounded-full shadow-sm transition-all duration-200 hover:bg-primary hover:text-primary-foreground",!Z&&"opacity-50 cursor-not-allowed"),onClick:()=>N("right"),"aria-label":"Scroll right",disabled:!Z,children:m.jsx(Fu,{className:"h-5 w-5"})})]})]}),m.jsx("div",{ref:r,className:"flex overflow-x-auto scrollbar-none pb-6 -mx-4 px-4 scroll-smooth snap-x",onScroll:V,children:m.jsx("div",{className:"grid grid-flow-col auto-cols-max gap-4 md:gap-6",children:e.map((Q,re)=>m.jsxs("div",{className:"w-[180px] sm:w-[220px] md:w-[260px] flex-shrink-0 bg-card backdrop-blur-sm border border-border/50 rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1 cursor-pointer snap-start animate-fade-in",style:{animationDelay:`${re*50}ms`},onClick:()=>B(Q),children:[m.jsxs("div",{className:"relative aspect-square overflow-hidden group",children:[m.jsx("img",{src:Q.images[0],alt:Q.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),m.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs font-medium px-2 py-1 rounded-full",children:"Featured"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),m.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3 translate-y-full group-hover:translate-y-0 transition-transform duration-300",children:m.jsx(Et,{variant:"secondary",size:"sm",className:"w-full text-xs font-medium",children:"View Details"})})]}),m.jsxs("div",{className:"p-3 sm:p-4",children:[m.jsxs("div",{className:"flex flex-col mb-2",children:[m.jsx("h3",{className:"font-medium text-sm sm:text-base line-clamp-1",children:Q.name}),m.jsx("div",{className:"flex items-baseline mt-1",children:Q.promoPrice?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"line-through text-muted-foreground text-xs mr-2",children:es(Q.price)}),m.jsx("span",{className:"font-semibold text-primary text-sm",children:es(Q.promoPrice)})]}):m.jsx("span",{className:"font-semibold text-sm",children:es(Q.price)})})]}),m.jsx("p",{className:"text-muted-foreground text-xs line-clamp-2 mb-3 h-8",children:Q.description})]})]},Q.id))})}),u>0&&m.jsx("div",{className:"mt-0 px-1",children:m.jsx(EB,{value:[g],onValueChange:j,max:100,step:1,className:"h-1"})}),_?m.jsx(CB,{open:M,onOpenChange:D,children:m.jsxs(yP,{side:"bottom",className:"h-[90%] p-0 rounded-t-xl overflow-auto",children:[m.jsx("div",{className:"sticky top-0 z-10 flex justify-end p-2",children:m.jsx(Et,{variant:"ghost",size:"icon",onClick:z,className:"h-8 w-8 rounded-full bg-black/20 text-white hover:bg-black/40",children:m.jsx(Ls,{className:"h-4 w-4"})})}),b&&m.jsx("div",{className:"p-0",children:m.jsx(_v,{dish:b,detailed:!0,className:"border-0 shadow-none"})})]})}):m.jsx(zh,{open:M,onOpenChange:D,children:m.jsx(ed,{className:"sm:max-w-3xl p-0 gap-0 overflow-hidden bg-card/95 backdrop-blur-lg border border-border/50",children:b&&m.jsx(_v,{dish:b,detailed:!0,className:"border-0 shadow-none"})})})]}):null}const Nte=({drinks:e,loading:t=!1})=>{const r=A.useRef(null),[i,a]=A.useState(!1),[u,h]=A.useState(!1),{selectedDrink:g,setSelectedDrink:s,refreshCategories:_}=ca(),[b,C]=A.useState(!1),M=mm();A.useEffect(()=>{_()},[]);const D=()=>{const z=r.current;z&&(a(z.scrollLeft>0),h(z.scrollLeft<z.scrollWidth-z.clientWidth-10))};A.useEffect(()=>(D(),window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)),[e]);const N=z=>{const U=r.current;if(U){const Z=U.clientWidth*.75,Q=z==="left"?U.scrollLeft-Z:U.scrollLeft+Z;U.scrollTo({left:Q,behavior:"smooth"}),setTimeout(D,400)}},j=()=>{D()},V=z=>{s(z),C(!0)},B=()=>{C(!1)};return t?m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("div",{children:[m.jsx(fi,{className:"h-8 w-64"}),m.jsx(fi,{className:"h-4 w-48 mt-2"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(fi,{className:"h-10 w-10 rounded-full"}),m.jsx(fi,{className:"h-10 w-10 rounded-full"})]})]}),m.jsx("div",{className:"flex space-x-4 overflow-hidden",children:[1,2,3,4].map(z=>m.jsxs("div",{className:"flex-none w-[180px] sm:w-[220px] space-y-2",children:[m.jsx(fi,{className:"h-36 w-full rounded-xl"}),m.jsx(fi,{className:"h-4 w-3/4"}),m.jsx(fi,{className:"h-3 w-1/2"}),m.jsx(fi,{className:"h-8 w-full rounded-lg"})]},z))})]}):!e||e.length===0?m.jsxs("div",{className:"text-center py-8",children:[m.jsx(hv,{className:"h-12 w-12 mx-auto mb-2 text-muted-foreground"}),m.jsx("h2",{className:"text-xl md:text-2xl font-display font-semibold mb-2",children:"Drinks Menu Coming Soon"}),m.jsx("p",{className:"text-muted-foreground",children:"We're crafting a delightful selection of beverages for you."})]}):m.jsxs("div",{className:"space-y-4 relative",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("div",{className:"animate-fade-in",children:[m.jsxs("h2",{className:"text-2xl font-display font-semibold flex items-center",children:[m.jsx(hv,{className:"mr-2 h-5 w-5 text-primary"}),"Featured Drinks"]}),m.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Refreshing beverages for any occasion"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(Et,{variant:"outline",size:"icon",onClick:()=>N("left"),disabled:!i,className:It("rounded-full shadow-sm transition-all duration-200 hover:bg-primary hover:text-primary-foreground",!i&&"opacity-50 cursor-not-allowed"),children:m.jsx(am,{className:"h-5 w-5"})}),m.jsx(Et,{variant:"outline",size:"icon",onClick:()=>N("right"),disabled:!u,className:It("rounded-full shadow-sm transition-all duration-200 hover:bg-primary hover:text-primary-foreground",!u&&"opacity-50 cursor-not-allowed"),children:m.jsx(Fu,{className:"h-5 w-5"})})]})]}),m.jsx("div",{ref:r,onScroll:j,className:"flex overflow-x-auto scrollbar-none space-x-4 pb-6 snap-x",children:e.map((z,U)=>m.jsxs("div",{onClick:()=>V(z),className:"flex-none w-[180px] sm:w-[220px] md:w-[260px] bg-card backdrop-blur-sm border border-border/50 rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1 cursor-pointer snap-start animate-fade-in",style:{animationDelay:`${U*50}ms`},children:[m.jsxs("div",{className:"aspect-square relative group",children:[m.jsx("img",{src:z.images[0],alt:z.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),m.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs font-medium px-2 py-1 rounded-full",children:"Featured"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),m.jsxs("div",{className:"absolute bottom-3 left-3 right-3",children:[m.jsx("div",{className:"inline-block bg-primary text-primary-foreground text-xs px-2 py-1 rounded mb-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300 translate-y-2 group-hover:translate-y-0",children:z.category}),m.jsx("h3",{className:"text-white font-medium line-clamp-1 drop-shadow-md",children:z.name})]})]}),m.jsxs("div",{className:"p-3 sm:p-4",children:[m.jsx("p",{className:"text-sm mb-3 line-clamp-2 text-muted-foreground",children:z.description}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("div",{children:z.promoPrice?m.jsxs("div",{className:"flex items-center space-x-1.5",children:[m.jsx("span",{className:"text-primary font-medium",children:es(z.promoPrice)}),m.jsx("span",{className:"text-xs line-through text-muted-foreground",children:es(z.price)})]}):m.jsx("span",{className:"font-medium",children:es(z.price)})}),m.jsx(Et,{variant:"secondary",size:"sm",className:"text-xs",children:"View"})]})]})]},z.id))}),M?m.jsx(CB,{open:b,onOpenChange:C,children:m.jsxs(yP,{side:"bottom",className:"h-[90%] p-0 rounded-t-xl overflow-auto",children:[m.jsx("div",{className:"sticky top-0 z-10 flex justify-end p-2",children:m.jsx(Et,{variant:"ghost",size:"icon",onClick:B,className:"h-8 w-8 rounded-full bg-black/20 text-white hover:bg-black/40",children:m.jsx(Ls,{className:"h-4 w-4"})})}),g&&m.jsx("div",{className:"p-0",children:m.jsx(_v,{dish:g,detailed:!0,className:"border-0 shadow-none"})})]})}):m.jsx(zh,{open:b,onOpenChange:C,children:m.jsx(ed,{className:"sm:max-w-3xl p-0 gap-0 overflow-hidden bg-card/95 backdrop-blur-lg border border-border/50",children:g&&m.jsx(_v,{dish:g,detailed:!0,className:"border-0 shadow-none"})})})]})},Wi=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:It("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Wi.displayName="Card";const ys=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:It("flex flex-col space-y-1.5 p-6",e),...t}));ys.displayName="CardHeader";const vs=A.forwardRef(({className:e,...t},r)=>m.jsx("h3",{ref:r,className:It("text-2xl font-semibold leading-none tracking-tight",e),...t}));vs.displayName="CardTitle";const Co=A.forwardRef(({className:e,...t},r)=>m.jsx("p",{ref:r,className:It("text-sm text-muted-foreground",e),...t}));Co.displayName="CardDescription";const xs=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:It("p-6 pt-0",e),...t}));xs.displayName="CardContent";const ju=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:It("flex items-center p-6 pt-0",e),...t}));ju.displayName="CardFooter";function rn(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Do(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ps(e,t){const r=rn(e);return isNaN(t)?Do(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function qa(e,t){const r=rn(e);if(isNaN(t))return Do(e,NaN);if(!t)return r;const i=r.getDate(),a=Do(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const u=a.getDate();return i>=u?a:(r.setFullYear(a.getFullYear(),a.getMonth(),i),r)}const vP=6048e5,jte=864e5,kB=6e4,PB=36e5;let Lte={};function ix(){return Lte}function Ml(e,t){var g,s,_,b;const r=ix(),i=(t==null?void 0:t.weekStartsOn)??((s=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:s.weekStartsOn)??r.weekStartsOn??((b=(_=r.locale)==null?void 0:_.options)==null?void 0:b.weekStartsOn)??0,a=rn(e),u=a.getDay(),h=(u<i?7:0)+u-i;return a.setDate(a.getDate()-h),a.setHours(0,0,0,0),a}function Ch(e){return Ml(e,{weekStartsOn:1})}function AB(e){const t=rn(e),r=t.getFullYear(),i=Do(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const a=Ch(i),u=Do(e,0);u.setFullYear(r,0,4),u.setHours(0,0,0,0);const h=Ch(u);return t.getTime()>=a.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function Fp(e){const t=rn(e);return t.setHours(0,0,0,0),t}function R1(e){const t=rn(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function vl(e,t){const r=Fp(e),i=Fp(t),a=+r-R1(r),u=+i-R1(i);return Math.round((a-u)/jte)}function Ote(e){const t=AB(e),r=Do(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ch(r)}function GC(e,t){const r=t*7;return Ps(e,r)}function zte(e,t){return qa(e,t*12)}function Fte(e){let t;return e.forEach(function(r){const i=rn(r);(t===void 0||t<i||isNaN(Number(i)))&&(t=i)}),t||new Date(NaN)}function Bte(e){let t;return e.forEach(r=>{const i=rn(r);(!t||t>i||isNaN(+i))&&(t=i)}),t||new Date(NaN)}function to(e,t){const r=Fp(e),i=Fp(t);return+r==+i}function xP(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function IB(e){if(!xP(e)&&typeof e!="number")return!1;const t=rn(e);return!isNaN(Number(t))}function wv(e,t){const r=rn(e),i=rn(t),a=r.getFullYear()-i.getFullYear(),u=r.getMonth()-i.getMonth();return a*12+u}function Ute(e,t,r){const i=Ml(e,r),a=Ml(t,r),u=+i-R1(i),h=+a-R1(a);return Math.round((u-h)/vP)}function _P(e){const t=rn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function lo(e){const t=rn(e);return t.setDate(1),t.setHours(0,0,0,0),t}function DB(e){const t=rn(e),r=Do(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function wP(e,t){var g,s,_,b;const r=ix(),i=(t==null?void 0:t.weekStartsOn)??((s=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:s.weekStartsOn)??r.weekStartsOn??((b=(_=r.locale)==null?void 0:_.options)==null?void 0:b.weekStartsOn)??0,a=rn(e),u=a.getDay(),h=(u<i?-7:0)+6-(u-i);return a.setDate(a.getDate()+h),a.setHours(23,59,59,999),a}function RB(e){return wP(e,{weekStartsOn:1})}const Vte={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$te=(e,t,r)=>{let i;const a=Vte[e];return typeof a=="string"?i=a:t===1?i=a.one:i=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function YE(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Wte={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Gte={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Hte={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qte={date:YE({formats:Wte,defaultWidth:"full"}),time:YE({formats:Gte,defaultWidth:"full"}),dateTime:YE({formats:Hte,defaultWidth:"full"})},Zte={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Xte=(e,t,r,i)=>Zte[e];function ay(e){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let a;if(i==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,g=r!=null&&r.width?String(r.width):h;a=e.formattingValues[g]||e.formattingValues[h]}else{const h=e.defaultWidth,g=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[g]||e.values[h]}const u=e.argumentCallback?e.argumentCallback(t):t;return a[u]}}const Yte={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kte={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Qte={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Jte={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ere={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tre={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rre=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},nre={ordinalNumber:rre,era:ay({values:Yte,defaultWidth:"wide"}),quarter:ay({values:Kte,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ay({values:Qte,defaultWidth:"wide"}),day:ay({values:Jte,defaultWidth:"wide"}),dayPeriod:ay({values:ere,defaultWidth:"wide",formattingValues:tre,defaultFormattingWidth:"wide"})};function ly(e){return(t,r={})=>{const i=r.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],u=t.match(a);if(!u)return null;const h=u[0],g=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],s=Array.isArray(g)?sre(g,C=>C.test(h)):ire(g,C=>C.test(h));let _;_=e.valueCallback?e.valueCallback(s):s,_=r.valueCallback?r.valueCallback(_):_;const b=t.slice(h.length);return{value:_,rest:b}}}function ire(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function sre(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ore(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const a=i[0],u=t.match(e.parsePattern);if(!u)return null;let h=e.valueCallback?e.valueCallback(u[0]):u[0];h=r.valueCallback?r.valueCallback(h):h;const g=t.slice(a.length);return{value:h,rest:g}}}const are=/^(\d+)(th|st|nd|rd)?/i,lre=/\d+/i,cre={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ure={any:[/^b/i,/^(a|c)/i]},dre={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hre={any:[/1/i,/2/i,/3/i,/4/i]},fre={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pre={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mre={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gre={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yre={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vre={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xre={ordinalNumber:ore({matchPattern:are,parsePattern:lre,valueCallback:e=>parseInt(e,10)}),era:ly({matchPatterns:cre,defaultMatchWidth:"wide",parsePatterns:ure,defaultParseWidth:"any"}),quarter:ly({matchPatterns:dre,defaultMatchWidth:"wide",parsePatterns:hre,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ly({matchPatterns:fre,defaultMatchWidth:"wide",parsePatterns:pre,defaultParseWidth:"any"}),day:ly({matchPatterns:mre,defaultMatchWidth:"wide",parsePatterns:gre,defaultParseWidth:"any"}),dayPeriod:ly({matchPatterns:yre,defaultMatchWidth:"any",parsePatterns:vre,defaultParseWidth:"any"})},NB={code:"en-US",formatDistance:$te,formatLong:qte,formatRelative:Xte,localize:nre,match:xre,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _re(e){const t=rn(e);return vl(t,DB(t))+1}function jB(e){const t=rn(e),r=+Ch(t)-+Ote(t);return Math.round(r/vP)+1}function LB(e,t){var b,C,M,D;const r=rn(e),i=r.getFullYear(),a=ix(),u=(t==null?void 0:t.firstWeekContainsDate)??((C=(b=t==null?void 0:t.locale)==null?void 0:b.options)==null?void 0:C.firstWeekContainsDate)??a.firstWeekContainsDate??((D=(M=a.locale)==null?void 0:M.options)==null?void 0:D.firstWeekContainsDate)??1,h=Do(e,0);h.setFullYear(i+1,0,u),h.setHours(0,0,0,0);const g=Ml(h,t),s=Do(e,0);s.setFullYear(i,0,u),s.setHours(0,0,0,0);const _=Ml(s,t);return r.getTime()>=g.getTime()?i+1:r.getTime()>=_.getTime()?i:i-1}function wre(e,t){var g,s,_,b;const r=ix(),i=(t==null?void 0:t.firstWeekContainsDate)??((s=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:s.firstWeekContainsDate)??r.firstWeekContainsDate??((b=(_=r.locale)==null?void 0:_.options)==null?void 0:b.firstWeekContainsDate)??1,a=LB(e,t),u=Do(e,0);return u.setFullYear(a,0,i),u.setHours(0,0,0,0),Ml(u,t)}function OB(e,t){const r=rn(e),i=+Ml(r,t)-+wre(r,t);return Math.round(i/vP)+1}function Tn(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const ou={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return Tn(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Tn(r+1,2)},d(e,t){return Tn(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Tn(e.getHours()%12||12,t.length)},H(e,t){return Tn(e.getHours(),t.length)},m(e,t){return Tn(e.getMinutes(),t.length)},s(e,t){return Tn(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),a=Math.trunc(i*Math.pow(10,r-3));return Tn(a,t.length)}},$f={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Tj={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),a=i>0?i:1-i;return r.ordinalNumber(a,{unit:"year"})}return ou.y(e,t)},Y:function(e,t,r,i){const a=LB(e,i),u=a>0?a:1-a;if(t==="YY"){const h=u%100;return Tn(h,2)}return t==="Yo"?r.ordinalNumber(u,{unit:"year"}):Tn(u,t.length)},R:function(e,t){const r=AB(e);return Tn(r,t.length)},u:function(e,t){const r=e.getFullYear();return Tn(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Tn(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Tn(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return ou.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Tn(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const a=OB(e,i);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Tn(a,t.length)},I:function(e,t,r){const i=jB(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Tn(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ou.d(e,t)},D:function(e,t,r){const i=_re(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Tn(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const a=e.getDay(),u=(a-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(u);case"ee":return Tn(u,2);case"eo":return r.ordinalNumber(u,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const a=e.getDay(),u=(a-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(u);case"cc":return Tn(u,t.length);case"co":return r.ordinalNumber(u,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),a=i===0?7:i;switch(t){case"i":return String(a);case"ii":return Tn(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let a;switch(i===12?a=$f.noon:i===0?a=$f.midnight:a=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let a;switch(i>=17?a=$f.evening:i>=12?a=$f.afternoon:i>=4?a=$f.morning:a=$f.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return ou.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ou.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Tn(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Tn(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ou.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ou.s(e,t)},S:function(e,t){return ou.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return Mj(i);case"XXXX":case"XX":return Qd(i);case"XXXXX":case"XXX":default:return Qd(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return Mj(i);case"xxxx":case"xx":return Qd(i);case"xxxxx":case"xxx":default:return Qd(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Cj(i,":");case"OOOO":default:return"GMT"+Qd(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Cj(i,":");case"zzzz":default:return"GMT"+Qd(i,":")}},t:function(e,t,r){const i=Math.trunc(e.getTime()/1e3);return Tn(i,t.length)},T:function(e,t,r){const i=e.getTime();return Tn(i,t.length)}};function Cj(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),u=i%60;return u===0?r+String(a):r+String(a)+t+Tn(u,2)}function Mj(e,t){return e%60===0?(e>0?"-":"+")+Tn(Math.abs(e)/60,2):Qd(e,t)}function Qd(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),a=Tn(Math.trunc(i/60),2),u=Tn(i%60,2);return r+a+t+u}const kj=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},zB=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},bre=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],a=r[2];if(!a)return kj(e,t);let u;switch(i){case"P":u=t.dateTime({width:"short"});break;case"PP":u=t.dateTime({width:"medium"});break;case"PPP":u=t.dateTime({width:"long"});break;case"PPPP":default:u=t.dateTime({width:"full"});break}return u.replace("{{date}}",kj(i,t)).replace("{{time}}",zB(a,t))},Sre={p:zB,P:bre},Ere=/^D+$/,Tre=/^Y+$/,Cre=["D","DD","YY","YYYY"];function Mre(e){return Ere.test(e)}function kre(e){return Tre.test(e)}function Pre(e,t,r){const i=Are(e,t,r);if(console.warn(i),Cre.includes(e))throw new RangeError(i)}function Are(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ire=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Dre=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Rre=/^'([^]*?)'?$/,Nre=/''/g,jre=/[a-zA-Z]/;function Ro(e,t,r){var b,C,M,D,N,j,V,B;const i=ix(),a=(r==null?void 0:r.locale)??i.locale??NB,u=(r==null?void 0:r.firstWeekContainsDate)??((C=(b=r==null?void 0:r.locale)==null?void 0:b.options)==null?void 0:C.firstWeekContainsDate)??i.firstWeekContainsDate??((D=(M=i.locale)==null?void 0:M.options)==null?void 0:D.firstWeekContainsDate)??1,h=(r==null?void 0:r.weekStartsOn)??((j=(N=r==null?void 0:r.locale)==null?void 0:N.options)==null?void 0:j.weekStartsOn)??i.weekStartsOn??((B=(V=i.locale)==null?void 0:V.options)==null?void 0:B.weekStartsOn)??0,g=rn(e);if(!IB(g))throw new RangeError("Invalid time value");let s=t.match(Dre).map(z=>{const U=z[0];if(U==="p"||U==="P"){const Z=Sre[U];return Z(z,a.formatLong)}return z}).join("").match(Ire).map(z=>{if(z==="''")return{isToken:!1,value:"'"};const U=z[0];if(U==="'")return{isToken:!1,value:Lre(z)};if(Tj[U])return{isToken:!0,value:z};if(U.match(jre))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:z}});a.localize.preprocessor&&(s=a.localize.preprocessor(g,s));const _={firstWeekContainsDate:u,weekStartsOn:h,locale:a};return s.map(z=>{if(!z.isToken)return z.value;const U=z.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&kre(U)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Mre(U))&&Pre(U,t,String(e));const Z=Tj[U[0]];return Z(g,U,a.localize,_)}).join("")}function Lre(e){const t=e.match(Rre);return t?t[1].replace(Nre,"'"):e}function Ore(e){const t=rn(e),r=t.getFullYear(),i=t.getMonth(),a=Do(e,0);return a.setFullYear(r,i+1,0),a.setHours(0,0,0,0),a.getDate()}function zre(e){return Math.trunc(+rn(e)/1e3)}function Fre(e){const t=rn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Bre(e,t){return Ute(Fre(e),lo(e),t)+1}function HC(e,t){const r=rn(e),i=rn(t);return r.getTime()>i.getTime()}function FB(e,t){const r=rn(e),i=rn(t);return+r<+i}function bP(e,t){const r=rn(e),i=rn(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function Ure(e,t){const r=rn(e),i=rn(t);return r.getFullYear()===i.getFullYear()}function KE(e,t){return Ps(e,-t)}function Vre(e,t){const i=Hre(e);let a;if(i.date){const s=qre(i.date,2);a=Zre(s.restDateString,s.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const u=a.getTime();let h=0,g;if(i.time&&(h=Xre(i.time),isNaN(h)))return new Date(NaN);if(i.timezone){if(g=Yre(i.timezone),isNaN(g))return new Date(NaN)}else{const s=new Date(u+h),_=new Date(0);return _.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),_.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),_}return new Date(u+h+g)}const x0={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$re=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Wre=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Gre=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Hre(e){const t={},r=e.split(x0.dateTimeDelimiter);let i;if(r.length>2)return t;if(/:/.test(r[0])?i=r[0]:(t.date=r[0],i=r[1],x0.timeZoneDelimiter.test(t.date)&&(t.date=e.split(x0.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const a=x0.timezone.exec(i);a?(t.time=i.replace(a[1],""),t.timezone=a[1]):t.time=i}return t}function qre(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(r);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,u=i[2]?parseInt(i[2]):null;return{year:u===null?a:u*100,restDateString:e.slice((i[1]||i[2]).length)}}function Zre(e,t){if(t===null)return new Date(NaN);const r=e.match($re);if(!r)return new Date(NaN);const i=!!r[4],a=cy(r[1]),u=cy(r[2])-1,h=cy(r[3]),g=cy(r[4]),s=cy(r[5])-1;if(i)return tne(t,g,s)?Kre(t,g,s):new Date(NaN);{const _=new Date(0);return!Jre(t,u,h)||!ene(t,a)?new Date(NaN):(_.setUTCFullYear(t,u,Math.max(a,h)),_)}}function cy(e){return e?parseInt(e):1}function Xre(e){const t=e.match(Wre);if(!t)return NaN;const r=QE(t[1]),i=QE(t[2]),a=QE(t[3]);return rne(r,i,a)?r*PB+i*kB+a*1e3:NaN}function QE(e){return e&&parseFloat(e.replace(",","."))||0}function Yre(e){if(e==="Z")return 0;const t=e.match(Gre);if(!t)return 0;const r=t[1]==="+"?-1:1,i=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return nne(i,a)?r*(i*PB+a*kB):NaN}function Kre(e,t,r){const i=new Date(0);i.setUTCFullYear(e,0,4);const a=i.getUTCDay()||7,u=(t-1)*7+r+1-a;return i.setUTCDate(i.getUTCDate()+u),i}const Qre=[31,null,31,30,31,30,31,31,30,31,30,31];function BB(e){return e%400===0||e%4===0&&e%100!==0}function Jre(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Qre[t]||(BB(e)?29:28))}function ene(e,t){return t>=1&&t<=(BB(e)?366:365)}function tne(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function rne(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function nne(e,t){return t>=0&&t<=59}function JE(e,t){const r=rn(e),i=r.getFullYear(),a=r.getDate(),u=Do(e,0);u.setFullYear(i,t,15),u.setHours(0,0,0,0);const h=Ore(u);return r.setMonth(t,Math.min(a,h)),r}function Pj(e,t){const r=rn(e);return isNaN(+r)?Do(e,NaN):(r.setFullYear(t),r)}const ine=um("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function sne({className:e,variant:t,...r}){return m.jsx("div",{className:It(ine({variant:t}),e),...r})}function UB({voucher:e,onRedeem:t,isAdmin:r,onEdit:i,onDelete:a,isProcessing:u=!1}){const h=new Date(e.startDate),g=new Date(e.endDate),s=g<new Date,_=h>new Date;return m.jsxs(Wi,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 w-full h-full border border-primary/10",children:[e.imageUrl&&m.jsx("div",{className:"w-full aspect-[5/2] overflow-hidden",children:m.jsx("img",{src:e.imageUrl,alt:e.description,className:"w-full h-full object-cover transform hover:scale-105 transition-transform duration-500"})}),m.jsx(ys,{className:"py-3",children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx(vs,{className:"font-display text-lg md:text-xl",children:e.code}),m.jsx(Co,{className:"mt-1",children:e.description})]}),m.jsx(sne,{className:`
              ${s?"bg-destructive/10 text-destructive hover:bg-destructive/20":""}
              ${_?"bg-blue-500/10 text-blue-500 hover:bg-blue-500/20":""}
              ${!s&&!_?"bg-green-500/10 text-green-500 hover:bg-green-500/20":""}
            `,children:s?"Expired":_?"Coming Soon":"Active"})]})}),m.jsx(xs,{className:"py-2 space-y-3",children:m.jsxs("div",{className:"flex flex-col space-y-1",children:[m.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[m.jsx(Fk,{className:"h-4 w-4 mr-2 text-primary/70"}),m.jsxs("span",{className:"font-medium text-base",children:[e.discount,"% OFF",e.maxDiscount?` (Max ${es(e.maxDiscount)})`:""]})]}),e.minPurchase>0&&m.jsxs("div",{className:"text-xs text-muted-foreground",children:["Min. Purchase: ",es(e.minPurchase)]}),m.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-2",children:[m.jsx(dv,{className:"h-4 w-4 mr-2 text-primary/70"}),m.jsxs("span",{children:[Ro(h,"dd MMM yyyy")," - ",Ro(g,"dd MMM yyyy")]})]})]})}),r&&m.jsxs(ju,{className:"pt-2 pb-4 flex gap-2",children:[i&&m.jsx("button",{className:"py-2 px-4 bg-secondary text-secondary-foreground hover:bg-secondary/80 rounded-md font-medium text-sm flex-1 transition-colors",onClick:i,disabled:u,children:u?m.jsx(_s,{className:"h-4 w-4 animate-spin mx-auto"}):"Edit"}),a&&m.jsx("button",{className:"py-2 px-4 bg-destructive text-destructive-foreground hover:bg-destructive/90 rounded-md font-medium text-sm flex-1 transition-colors",onClick:a,disabled:u,children:u?m.jsx(_s,{className:"h-4 w-4 animate-spin mx-auto"}):"Delete"})]})]})}const VB=A.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),nb=A.createContext({}),SP=A.createContext(null),ib=typeof document<"u",one=ib?A.useLayoutEffect:A.useEffect,$B=A.createContext({strict:!1}),EP=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ane="framerAppearId",WB="data-"+EP(ane);function lne(e,t,r,i){const{visualElement:a}=A.useContext(nb),u=A.useContext($B),h=A.useContext(SP),g=A.useContext(VB).reducedMotion,s=A.useRef();i=i||u.renderer,!s.current&&i&&(s.current=i(e,{visualState:t,parent:a,props:r,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:g}));const _=s.current;A.useInsertionEffect(()=>{_&&_.update(r,h)});const b=A.useRef(!!(r[WB]&&!window.HandoffComplete));return one(()=>{_&&(_.render(),b.current&&_.animationState&&_.animationState.animateChanges())}),A.useEffect(()=>{_&&(_.updateFeatures(),!b.current&&_.animationState&&_.animationState.animateChanges(),b.current&&(b.current=!1,window.HandoffComplete=!0))}),_}function op(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function cne(e,t,r){return A.useCallback(i=>{i&&e.mount&&e.mount(i),t&&(i?t.mount(i):t.unmount()),r&&(typeof r=="function"?r(i):op(r)&&(r.current=i))},[t])}function bv(e){return typeof e=="string"||Array.isArray(e)}function sb(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const TP=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],CP=["initial",...TP];function ob(e){return sb(e.animate)||CP.some(t=>bv(e[t]))}function GB(e){return!!(ob(e)||e.variants)}function une(e,t){if(ob(e)){const{initial:r,animate:i}=e;return{initial:r===!1||bv(r)?r:void 0,animate:bv(i)?i:void 0}}return e.inherit!==!1?t:{}}function dne(e){const{initial:t,animate:r}=une(e,A.useContext(nb));return A.useMemo(()=>({initial:t,animate:r}),[Aj(t),Aj(r)])}function Aj(e){return Array.isArray(e)?e.join(" "):e}const Ij={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Sv={};for(const e in Ij)Sv[e]={isEnabled:t=>Ij[e].some(r=>!!t[r])};function hne(e){for(const t in e)Sv[t]={...Sv[t],...e[t]}}const HB=A.createContext({}),qB=A.createContext({}),fne=Symbol.for("motionComponentSymbol");function pne({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:i,Component:a}){e&&hne(e);function u(g,s){let _;const b={...A.useContext(VB),...g,layoutId:mne(g)},{isStatic:C}=b,M=dne(g),D=i(g,C);if(!C&&ib){M.visualElement=lne(a,D,b,t);const N=A.useContext(qB),j=A.useContext($B).strict;M.visualElement&&(_=M.visualElement.loadFeatures(b,j,e,N))}return A.createElement(nb.Provider,{value:M},_&&M.visualElement?A.createElement(_,{visualElement:M.visualElement,...b}):null,r(a,g,cne(D,M.visualElement,s),D,C,M.visualElement))}const h=A.forwardRef(u);return h[fne]=a,h}function mne({layoutId:e}){const t=A.useContext(HB).id;return t&&e!==void 0?t+"-"+e:e}function gne(e){function t(i,a={}){return pne(e(i,a))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(i,a)=>(r.has(a)||r.set(a,t(a)),r.get(a))})}const yne=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function MP(e){return typeof e!="string"||e.includes("-")?!1:!!(yne.indexOf(e)>-1||/[A-Z]/.test(e))}const N1={};function vne(e){Object.assign(N1,e)}const sx=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Fh=new Set(sx);function ZB(e,{layout:t,layoutId:r}){return Fh.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!N1[e]||e==="opacity")}const co=e=>!!(e&&e.getVelocity),xne={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},_ne=sx.length;function wne(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},i,a){let u="";for(let h=0;h<_ne;h++){const g=sx[h];if(e[g]!==void 0){const s=xne[g]||g;u+=`${s}(${e[g]}) `}}return t&&!e.z&&(u+="translateZ(0)"),u=u.trim(),a?u=a(e,i?"":u):r&&i&&(u="none"),u}const XB=e=>t=>typeof t=="string"&&t.startsWith(e),YB=XB("--"),qC=XB("var(--"),bne=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Sne=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Gu=(e,t,r)=>Math.min(Math.max(r,e),t),Bh={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ny={...Bh,transform:e=>Gu(0,1,e)},_0={...Bh,default:1},jy=e=>Math.round(e*1e5)/1e5,ab=/(-)?([\d]*\.?[\d])+/g,KB=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Ene=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function ox(e){return typeof e=="string"}const ax=e=>({test:t=>ox(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),cu=ax("deg"),bl=ax("%"),Sr=ax("px"),Tne=ax("vh"),Cne=ax("vw"),Dj={...bl,parse:e=>bl.parse(e)/100,transform:e=>bl.transform(e*100)},Rj={...Bh,transform:Math.round},QB={borderWidth:Sr,borderTopWidth:Sr,borderRightWidth:Sr,borderBottomWidth:Sr,borderLeftWidth:Sr,borderRadius:Sr,radius:Sr,borderTopLeftRadius:Sr,borderTopRightRadius:Sr,borderBottomRightRadius:Sr,borderBottomLeftRadius:Sr,width:Sr,maxWidth:Sr,height:Sr,maxHeight:Sr,size:Sr,top:Sr,right:Sr,bottom:Sr,left:Sr,padding:Sr,paddingTop:Sr,paddingRight:Sr,paddingBottom:Sr,paddingLeft:Sr,margin:Sr,marginTop:Sr,marginRight:Sr,marginBottom:Sr,marginLeft:Sr,rotate:cu,rotateX:cu,rotateY:cu,rotateZ:cu,scale:_0,scaleX:_0,scaleY:_0,scaleZ:_0,skew:cu,skewX:cu,skewY:cu,distance:Sr,translateX:Sr,translateY:Sr,translateZ:Sr,x:Sr,y:Sr,z:Sr,perspective:Sr,transformPerspective:Sr,opacity:Ny,originX:Dj,originY:Dj,originZ:Sr,zIndex:Rj,fillOpacity:Ny,strokeOpacity:Ny,numOctaves:Rj};function kP(e,t,r,i){const{style:a,vars:u,transform:h,transformOrigin:g}=e;let s=!1,_=!1,b=!0;for(const C in t){const M=t[C];if(YB(C)){u[C]=M;continue}const D=QB[C],N=Sne(M,D);if(Fh.has(C)){if(s=!0,h[C]=N,!b)continue;M!==(D.default||0)&&(b=!1)}else C.startsWith("origin")?(_=!0,g[C]=N):a[C]=N}if(t.transform||(s||i?a.transform=wne(e.transform,r,b,i):a.transform&&(a.transform="none")),_){const{originX:C="50%",originY:M="50%",originZ:D=0}=g;a.transformOrigin=`${C} ${M} ${D}`}}const PP=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function JB(e,t,r){for(const i in t)!co(t[i])&&!ZB(i,r)&&(e[i]=t[i])}function Mne({transformTemplate:e},t,r){return A.useMemo(()=>{const i=PP();return kP(i,t,{enableHardwareAcceleration:!r},e),Object.assign({},i.vars,i.style)},[t])}function kne(e,t,r){const i=e.style||{},a={};return JB(a,i,e),Object.assign(a,Mne(e,t,r)),e.transformValues?e.transformValues(a):a}function Pne(e,t,r){const i={},a=kne(e,t,r);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=a,i}const Ane=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function j1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Ane.has(e)}let eU=e=>!j1(e);function Ine(e){e&&(eU=t=>t.startsWith("on")?!j1(t):e(t))}try{Ine(require("@emotion/is-prop-valid").default)}catch{}function Dne(e,t,r){const i={};for(const a in e)a==="values"&&typeof e.values=="object"||(eU(a)||r===!0&&j1(a)||!t&&!j1(a)||e.draggable&&a.startsWith("onDrag"))&&(i[a]=e[a]);return i}function Nj(e,t,r){return typeof e=="string"?e:Sr.transform(t+r*e)}function Rne(e,t,r){const i=Nj(t,e.x,e.width),a=Nj(r,e.y,e.height);return`${i} ${a}`}const Nne={offset:"stroke-dashoffset",array:"stroke-dasharray"},jne={offset:"strokeDashoffset",array:"strokeDasharray"};function Lne(e,t,r=1,i=0,a=!0){e.pathLength=1;const u=a?Nne:jne;e[u.offset]=Sr.transform(-i);const h=Sr.transform(t),g=Sr.transform(r);e[u.array]=`${h} ${g}`}function AP(e,{attrX:t,attrY:r,attrScale:i,originX:a,originY:u,pathLength:h,pathSpacing:g=1,pathOffset:s=0,..._},b,C,M){if(kP(e,_,b,M),C){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:D,style:N,dimensions:j}=e;D.transform&&(j&&(N.transform=D.transform),delete D.transform),j&&(a!==void 0||u!==void 0||N.transform)&&(N.transformOrigin=Rne(j,a!==void 0?a:.5,u!==void 0?u:.5)),t!==void 0&&(D.x=t),r!==void 0&&(D.y=r),i!==void 0&&(D.scale=i),h!==void 0&&Lne(D,h,g,s,!1)}const tU=()=>({...PP(),attrs:{}}),IP=e=>typeof e=="string"&&e.toLowerCase()==="svg";function One(e,t,r,i){const a=A.useMemo(()=>{const u=tU();return AP(u,t,{enableHardwareAcceleration:!1},IP(i),e.transformTemplate),{...u.attrs,style:{...u.style}}},[t]);if(e.style){const u={};JB(u,e.style,e),a.style={...u,...a.style}}return a}function zne(e=!1){return(r,i,a,{latestValues:u},h)=>{const s=(MP(r)?One:Pne)(i,u,h,r),b={...Dne(i,typeof r=="string",e),...s,ref:a},{children:C}=i,M=A.useMemo(()=>co(C)?C.get():C,[C]);return A.createElement(r,{...b,children:M})}}function rU(e,{style:t,vars:r},i,a){Object.assign(e.style,t,a&&a.getProjectionStyles(i));for(const u in r)e.style.setProperty(u,r[u])}const nU=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iU(e,t,r,i){rU(e,t,void 0,i);for(const a in t.attrs)e.setAttribute(nU.has(a)?a:EP(a),t.attrs[a])}function DP(e,t){const{style:r}=e,i={};for(const a in r)(co(r[a])||t.style&&co(t.style[a])||ZB(a,e))&&(i[a]=r[a]);return i}function sU(e,t){const r=DP(e,t);for(const i in e)if(co(e[i])||co(t[i])){const a=sx.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[a]=e[i]}return r}function RP(e,t,r,i={},a={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,i,a)),t}function Fne(e){const t=A.useRef(null);return t.current===null&&(t.current=e()),t.current}const L1=e=>Array.isArray(e),Bne=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Une=e=>L1(e)?e[e.length-1]||0:e;function G0(e){const t=co(e)?e.get():e;return Bne(t)?t.toValue():t}function Vne({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},i,a,u){const h={latestValues:$ne(i,a,u,e),renderState:t()};return r&&(h.mount=g=>r(i,g,h)),h}const oU=e=>(t,r)=>{const i=A.useContext(nb),a=A.useContext(SP),u=()=>Vne(e,t,i,a);return r?u():Fne(u)};function $ne(e,t,r,i){const a={},u=i(e,{});for(const M in u)a[M]=G0(u[M]);let{initial:h,animate:g}=e;const s=ob(e),_=GB(e);t&&_&&!s&&e.inherit!==!1&&(h===void 0&&(h=t.initial),g===void 0&&(g=t.animate));let b=r?r.initial===!1:!1;b=b||h===!1;const C=b?g:h;return C&&typeof C!="boolean"&&!sb(C)&&(Array.isArray(C)?C:[C]).forEach(D=>{const N=RP(e,D);if(!N)return;const{transitionEnd:j,transition:V,...B}=N;for(const z in B){let U=B[z];if(Array.isArray(U)){const Z=b?U.length-1:0;U=U[Z]}U!==null&&(a[z]=U)}for(const z in j)a[z]=j[z]}),a}const mi=e=>e;class jj{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Wne(e){let t=new jj,r=new jj,i=0,a=!1,u=!1;const h=new WeakSet,g={schedule:(s,_=!1,b=!1)=>{const C=b&&a,M=C?t:r;return _&&h.add(s),M.add(s)&&C&&a&&(i=t.order.length),s},cancel:s=>{r.remove(s),h.delete(s)},process:s=>{if(a){u=!0;return}if(a=!0,[t,r]=[r,t],r.clear(),i=t.order.length,i)for(let _=0;_<i;_++){const b=t.order[_];b(s),h.has(b)&&(g.schedule(b),e())}a=!1,u&&(u=!1,g.process(s))}};return g}const w0=["prepare","read","update","preRender","render","postRender"],Gne=40;function Hne(e,t){let r=!1,i=!0;const a={delta:0,timestamp:0,isProcessing:!1},u=w0.reduce((C,M)=>(C[M]=Wne(()=>r=!0),C),{}),h=C=>u[C].process(a),g=()=>{const C=performance.now();r=!1,a.delta=i?1e3/60:Math.max(Math.min(C-a.timestamp,Gne),1),a.timestamp=C,a.isProcessing=!0,w0.forEach(h),a.isProcessing=!1,r&&t&&(i=!1,e(g))},s=()=>{r=!0,i=!0,a.isProcessing||e(g)};return{schedule:w0.reduce((C,M)=>{const D=u[M];return C[M]=(N,j=!1,V=!1)=>(r||s(),D.schedule(N,j,V)),C},{}),cancel:C=>w0.forEach(M=>u[M].cancel(C)),state:a,steps:u}}const{schedule:$n,cancel:wc,state:ps,steps:eT}=Hne(typeof requestAnimationFrame<"u"?requestAnimationFrame:mi,!0),qne={useVisualState:oU({scrapeMotionValuesFromProps:sU,createRenderState:tU,onMount:(e,t,{renderState:r,latestValues:i})=>{$n.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),$n.render(()=>{AP(r,i,{enableHardwareAcceleration:!1},IP(t.tagName),e.transformTemplate),iU(t,r)})}})},Zne={useVisualState:oU({scrapeMotionValuesFromProps:DP,createRenderState:PP})};function Xne(e,{forwardMotionProps:t=!1},r,i){return{...MP(e)?qne:Zne,preloadedFeatures:r,useRender:zne(t),createVisualElement:i,Component:e}}function oc(e,t,r,i={passive:!0}){return e.addEventListener(t,r,i),()=>e.removeEventListener(t,r)}const aU=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function lb(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Yne=e=>t=>aU(t)&&e(t,lb(t));function dc(e,t,r,i){return oc(e,t,Yne(r),i)}const Kne=(e,t)=>r=>t(e(r)),Lu=(...e)=>e.reduce(Kne);function lU(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const Lj=lU("dragHorizontal"),Oj=lU("dragVertical");function cU(e){let t=!1;if(e==="y")t=Oj();else if(e==="x")t=Lj();else{const r=Lj(),i=Oj();r&&i?t=()=>{r(),i()}:(r&&r(),i&&i())}return t}function uU(){const e=cU(!0);return e?(e(),!1):!0}class td{constructor(t){this.isMounted=!1,this.node=t}update(){}}function zj(e,t){const r="pointer"+(t?"enter":"leave"),i="onHover"+(t?"Start":"End"),a=(u,h)=>{if(u.pointerType==="touch"||uU())return;const g=e.getProps();e.animationState&&g.whileHover&&e.animationState.setActive("whileHover",t),g[i]&&$n.update(()=>g[i](u,h))};return dc(e.current,r,a,{passive:!e.getProps()[i]})}class Qne extends td{mount(){this.unmount=Lu(zj(this.node,!0),zj(this.node,!1))}unmount(){}}class Jne extends td{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Lu(oc(this.node.current,"focus",()=>this.onFocus()),oc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const dU=(e,t)=>t?e===t?!0:dU(e,t.parentElement):!1;function tT(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,lb(r))}class eie extends td{constructor(){super(...arguments),this.removeStartListeners=mi,this.removeEndListeners=mi,this.removeAccessibleListeners=mi,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const i=this.node.getProps(),u=dc(window,"pointerup",(g,s)=>{if(!this.checkPressEnd())return;const{onTap:_,onTapCancel:b,globalTapTarget:C}=this.node.getProps();$n.update(()=>{!C&&!dU(this.node.current,g.target)?b&&b(g,s):_&&_(g,s)})},{passive:!(i.onTap||i.onPointerUp)}),h=dc(window,"pointercancel",(g,s)=>this.cancelPress(g,s),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=Lu(u,h),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=u=>{if(u.key!=="Enter"||this.isPressing)return;const h=g=>{g.key!=="Enter"||!this.checkPressEnd()||tT("up",(s,_)=>{const{onTap:b}=this.node.getProps();b&&$n.update(()=>b(s,_))})};this.removeEndListeners(),this.removeEndListeners=oc(this.node.current,"keyup",h),tT("down",(g,s)=>{this.startPress(g,s)})},r=oc(this.node.current,"keydown",t),i=()=>{this.isPressing&&tT("cancel",(u,h)=>this.cancelPress(u,h))},a=oc(this.node.current,"blur",i);this.removeAccessibleListeners=Lu(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:i,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&$n.update(()=>i(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!uU()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&$n.update(()=>i(t,r))}mount(){const t=this.node.getProps(),r=dc(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),i=oc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Lu(r,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const ZC=new WeakMap,rT=new WeakMap,tie=e=>{const t=ZC.get(e.target);t&&t(e)},rie=e=>{e.forEach(tie)};function nie({root:e,...t}){const r=e||document;rT.has(r)||rT.set(r,{});const i=rT.get(r),a=JSON.stringify(t);return i[a]||(i[a]=new IntersectionObserver(rie,{root:e,...t})),i[a]}function iie(e,t,r){const i=nie(t);return ZC.set(e,r),i.observe(e),()=>{ZC.delete(e),i.unobserve(e)}}const sie={some:0,all:1};class oie extends td{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:i,amount:a="some",once:u}=t,h={root:r?r.current:void 0,rootMargin:i,threshold:typeof a=="number"?a:sie[a]},g=s=>{const{isIntersecting:_}=s;if(this.isInView===_||(this.isInView=_,u&&!_&&this.hasEnteredView))return;_&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",_);const{onViewportEnter:b,onViewportLeave:C}=this.node.getProps(),M=_?b:C;M&&M(s)};return iie(this.node.current,h,g)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(aie(t,r))&&this.startObserver()}unmount(){}}function aie({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const lie={inView:{Feature:oie},tap:{Feature:eie},focus:{Feature:Jne},hover:{Feature:Qne}};function hU(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}function cie(e){const t={};return e.values.forEach((r,i)=>t[i]=r.get()),t}function uie(e){const t={};return e.values.forEach((r,i)=>t[i]=r.getVelocity()),t}function cb(e,t,r){const i=e.getProps();return RP(i,t,r!==void 0?r:i.custom,cie(e),uie(e))}let O1=mi;const gh=e=>e*1e3,hc=e=>e/1e3,die={current:!1},fU=e=>Array.isArray(e)&&typeof e[0]=="number";function pU(e){return!!(!e||typeof e=="string"&&mU[e]||fU(e)||Array.isArray(e)&&e.every(pU))}const _y=([e,t,r,i])=>`cubic-bezier(${e}, ${t}, ${r}, ${i})`,mU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_y([0,.65,.55,1]),circOut:_y([.55,0,1,.45]),backIn:_y([.31,.01,.66,-.59]),backOut:_y([.33,1.53,.69,.99])};function gU(e){if(e)return fU(e)?_y(e):Array.isArray(e)?e.map(gU):mU[e]}function hie(e,t,r,{delay:i=0,duration:a,repeat:u=0,repeatType:h="loop",ease:g,times:s}={}){const _={[t]:r};s&&(_.offset=s);const b=gU(g);return Array.isArray(b)&&(_.easing=b),e.animate(_,{delay:i,duration:a,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:u+1,direction:h==="reverse"?"alternate":"normal"})}function fie(e,{repeat:t,repeatType:r="loop"}){const i=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[i]}const yU=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,pie=1e-7,mie=12;function gie(e,t,r,i,a){let u,h,g=0;do h=t+(r-t)/2,u=yU(h,i,a)-e,u>0?r=h:t=h;while(Math.abs(u)>pie&&++g<mie);return h}function lx(e,t,r,i){if(e===t&&r===i)return mi;const a=u=>gie(u,0,1,e,r);return u=>u===0||u===1?u:yU(a(u),t,i)}const yie=lx(.42,0,1,1),vie=lx(0,0,.58,1),vU=lx(.42,0,.58,1),xie=e=>Array.isArray(e)&&typeof e[0]!="number",xU=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,_U=e=>t=>1-e(1-t),NP=e=>1-Math.sin(Math.acos(e)),wU=_U(NP),_ie=xU(NP),bU=lx(.33,1.53,.69,.99),jP=_U(bU),wie=xU(jP),bie=e=>(e*=2)<1?.5*jP(e):.5*(2-Math.pow(2,-10*(e-1))),Fj={linear:mi,easeIn:yie,easeInOut:vU,easeOut:vie,circIn:NP,circInOut:_ie,circOut:wU,backIn:jP,backInOut:wie,backOut:bU,anticipate:bie},Bj=e=>{if(Array.isArray(e)){O1(e.length===4);const[t,r,i,a]=e;return lx(t,r,i,a)}else if(typeof e=="string")return O1(Fj[e]!==void 0),Fj[e];return e},LP=(e,t)=>r=>!!(ox(r)&&Ene.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),SU=(e,t,r)=>i=>{if(!ox(i))return i;const[a,u,h,g]=i.match(ab);return{[e]:parseFloat(a),[t]:parseFloat(u),[r]:parseFloat(h),alpha:g!==void 0?parseFloat(g):1}},Sie=e=>Gu(0,255,e),nT={...Bh,transform:e=>Math.round(Sie(e))},ah={test:LP("rgb","red"),parse:SU("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:i=1})=>"rgba("+nT.transform(e)+", "+nT.transform(t)+", "+nT.transform(r)+", "+jy(Ny.transform(i))+")"};function Eie(e){let t="",r="",i="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),i=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),i=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,i+=i,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:a?parseInt(a,16)/255:1}}const XC={test:LP("#"),parse:Eie,transform:ah.transform},ap={test:LP("hsl","hue"),parse:SU("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:i=1})=>"hsla("+Math.round(e)+", "+bl.transform(jy(t))+", "+bl.transform(jy(r))+", "+jy(Ny.transform(i))+")"},Ms={test:e=>ah.test(e)||XC.test(e)||ap.test(e),parse:e=>ah.test(e)?ah.parse(e):ap.test(e)?ap.parse(e):XC.parse(e),transform:e=>ox(e)?e:e.hasOwnProperty("red")?ah.transform(e):ap.transform(e)},ii=(e,t,r)=>-r*e+r*t+e;function iT(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Tie({hue:e,saturation:t,lightness:r,alpha:i}){e/=360,t/=100,r/=100;let a=0,u=0,h=0;if(!t)a=u=h=r;else{const g=r<.5?r*(1+t):r+t-r*t,s=2*r-g;a=iT(s,g,e+1/3),u=iT(s,g,e),h=iT(s,g,e-1/3)}return{red:Math.round(a*255),green:Math.round(u*255),blue:Math.round(h*255),alpha:i}}const sT=(e,t,r)=>{const i=e*e;return Math.sqrt(Math.max(0,r*(t*t-i)+i))},Cie=[XC,ah,ap],Mie=e=>Cie.find(t=>t.test(e));function Uj(e){const t=Mie(e);let r=t.parse(e);return t===ap&&(r=Tie(r)),r}const EU=(e,t)=>{const r=Uj(e),i=Uj(t),a={...r};return u=>(a.red=sT(r.red,i.red,u),a.green=sT(r.green,i.green,u),a.blue=sT(r.blue,i.blue,u),a.alpha=ii(r.alpha,i.alpha,u),ah.transform(a))};function kie(e){var t,r;return isNaN(e)&&ox(e)&&(((t=e.match(ab))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(KB))===null||r===void 0?void 0:r.length)||0)>0}const TU={regex:bne,countKey:"Vars",token:"${v}",parse:mi},CU={regex:KB,countKey:"Colors",token:"${c}",parse:Ms.parse},MU={regex:ab,countKey:"Numbers",token:"${n}",parse:Bh.parse};function oT(e,{regex:t,countKey:r,token:i,parse:a}){const u=e.tokenised.match(t);u&&(e["num"+r]=u.length,e.tokenised=e.tokenised.replace(t,i),e.values.push(...u.map(a)))}function z1(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&oT(r,TU),oT(r,CU),oT(r,MU),r}function kU(e){return z1(e).values}function PU(e){const{values:t,numColors:r,numVars:i,tokenised:a}=z1(e),u=t.length;return h=>{let g=a;for(let s=0;s<u;s++)s<i?g=g.replace(TU.token,h[s]):s<i+r?g=g.replace(CU.token,Ms.transform(h[s])):g=g.replace(MU.token,jy(h[s]));return g}}const Pie=e=>typeof e=="number"?0:e;function Aie(e){const t=kU(e);return PU(e)(t.map(Pie))}const Hu={test:kie,parse:kU,createTransformer:PU,getAnimatableNone:Aie},AU=(e,t)=>r=>`${r>0?t:e}`;function IU(e,t){return typeof e=="number"?r=>ii(e,t,r):Ms.test(e)?EU(e,t):e.startsWith("var(")?AU(e,t):RU(e,t)}const DU=(e,t)=>{const r=[...e],i=r.length,a=e.map((u,h)=>IU(u,t[h]));return u=>{for(let h=0;h<i;h++)r[h]=a[h](u);return r}},Iie=(e,t)=>{const r={...e,...t},i={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(i[a]=IU(e[a],t[a]));return a=>{for(const u in i)r[u]=i[u](a);return r}},RU=(e,t)=>{const r=Hu.createTransformer(t),i=z1(e),a=z1(t);return i.numVars===a.numVars&&i.numColors===a.numColors&&i.numNumbers>=a.numNumbers?Lu(DU(i.values,a.values),r):AU(e,t)},Ev=(e,t,r)=>{const i=t-e;return i===0?1:(r-e)/i},Vj=(e,t)=>r=>ii(e,t,r);function Die(e){return typeof e=="number"?Vj:typeof e=="string"?Ms.test(e)?EU:RU:Array.isArray(e)?DU:typeof e=="object"?Iie:Vj}function Rie(e,t,r){const i=[],a=r||Die(e[0]),u=e.length-1;for(let h=0;h<u;h++){let g=a(e[h],e[h+1]);if(t){const s=Array.isArray(t)?t[h]||mi:t;g=Lu(s,g)}i.push(g)}return i}function NU(e,t,{clamp:r=!0,ease:i,mixer:a}={}){const u=e.length;if(O1(u===t.length),u===1)return()=>t[0];e[0]>e[u-1]&&(e=[...e].reverse(),t=[...t].reverse());const h=Rie(t,i,a),g=h.length,s=_=>{let b=0;if(g>1)for(;b<e.length-2&&!(_<e[b+1]);b++);const C=Ev(e[b],e[b+1],_);return h[b](C)};return r?_=>s(Gu(e[0],e[u-1],_)):s}function Nie(e,t){const r=e[e.length-1];for(let i=1;i<=t;i++){const a=Ev(0,t,i);e.push(ii(r,1,a))}}function jie(e){const t=[0];return Nie(t,e.length-1),t}function Lie(e,t){return e.map(r=>r*t)}function Oie(e,t){return e.map(()=>t||vU).splice(0,e.length-1)}function F1({duration:e=300,keyframes:t,times:r,ease:i="easeInOut"}){const a=xie(i)?i.map(Bj):Bj(i),u={done:!1,value:t[0]},h=Lie(r&&r.length===t.length?r:jie(t),e),g=NU(h,t,{ease:Array.isArray(a)?a:Oie(t,a)});return{calculatedDuration:e,next:s=>(u.value=g(s),u.done=s>=e,u)}}function jU(e,t){return t?e*(1e3/t):0}const zie=5;function LU(e,t,r){const i=Math.max(t-zie,0);return jU(r-e(i),t-i)}const aT=.001,Fie=.01,Bie=10,Uie=.05,Vie=1;function $ie({duration:e=800,bounce:t=.25,velocity:r=0,mass:i=1}){let a,u,h=1-t;h=Gu(Uie,Vie,h),e=Gu(Fie,Bie,hc(e)),h<1?(a=_=>{const b=_*h,C=b*e,M=b-r,D=YC(_,h),N=Math.exp(-C);return aT-M/D*N},u=_=>{const C=_*h*e,M=C*r+r,D=Math.pow(h,2)*Math.pow(_,2)*e,N=Math.exp(-C),j=YC(Math.pow(_,2),h);return(-a(_)+aT>0?-1:1)*((M-D)*N)/j}):(a=_=>{const b=Math.exp(-_*e),C=(_-r)*e+1;return-aT+b*C},u=_=>{const b=Math.exp(-_*e),C=(r-_)*(e*e);return b*C});const g=5/e,s=Gie(a,u,g);if(e=gh(e),isNaN(s))return{stiffness:100,damping:10,duration:e};{const _=Math.pow(s,2)*i;return{stiffness:_,damping:h*2*Math.sqrt(i*_),duration:e}}}const Wie=12;function Gie(e,t,r){let i=r;for(let a=1;a<Wie;a++)i=i-e(i)/t(i);return i}function YC(e,t){return e*Math.sqrt(1-t*t)}const Hie=["duration","bounce"],qie=["stiffness","damping","mass"];function $j(e,t){return t.some(r=>e[r]!==void 0)}function Zie(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!$j(e,qie)&&$j(e,Hie)){const r=$ie(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function OU({keyframes:e,restDelta:t,restSpeed:r,...i}){const a=e[0],u=e[e.length-1],h={done:!1,value:a},{stiffness:g,damping:s,mass:_,duration:b,velocity:C,isResolvedFromDuration:M}=Zie({...i,velocity:-hc(i.velocity||0)}),D=C||0,N=s/(2*Math.sqrt(g*_)),j=u-a,V=hc(Math.sqrt(g/_)),B=Math.abs(j)<5;r||(r=B?.01:2),t||(t=B?.005:.5);let z;if(N<1){const U=YC(V,N);z=Z=>{const Q=Math.exp(-N*V*Z);return u-Q*((D+N*V*j)/U*Math.sin(U*Z)+j*Math.cos(U*Z))}}else if(N===1)z=U=>u-Math.exp(-V*U)*(j+(D+V*j)*U);else{const U=V*Math.sqrt(N*N-1);z=Z=>{const Q=Math.exp(-N*V*Z),re=Math.min(U*Z,300);return u-Q*((D+N*V*j)*Math.sinh(re)+U*j*Math.cosh(re))/U}}return{calculatedDuration:M&&b||null,next:U=>{const Z=z(U);if(M)h.done=U>=b;else{let Q=D;U!==0&&(N<1?Q=LU(z,U,Z):Q=0);const re=Math.abs(Q)<=r,oe=Math.abs(u-Z)<=t;h.done=re&&oe}return h.value=h.done?u:Z,h}}}function Wj({keyframes:e,velocity:t=0,power:r=.8,timeConstant:i=325,bounceDamping:a=10,bounceStiffness:u=500,modifyTarget:h,min:g,max:s,restDelta:_=.5,restSpeed:b}){const C=e[0],M={done:!1,value:C},D=pe=>g!==void 0&&pe<g||s!==void 0&&pe>s,N=pe=>g===void 0?s:s===void 0||Math.abs(g-pe)<Math.abs(s-pe)?g:s;let j=r*t;const V=C+j,B=h===void 0?V:h(V);B!==V&&(j=B-C);const z=pe=>-j*Math.exp(-pe/i),U=pe=>B+z(pe),Z=pe=>{const ve=z(pe),he=U(pe);M.done=Math.abs(ve)<=_,M.value=M.done?B:he};let Q,re;const oe=pe=>{D(M.value)&&(Q=pe,re=OU({keyframes:[M.value,N(M.value)],velocity:LU(U,pe,M.value),damping:a,stiffness:u,restDelta:_,restSpeed:b}))};return oe(0),{calculatedDuration:null,next:pe=>{let ve=!1;return!re&&Q===void 0&&(ve=!0,Z(pe),oe(pe)),Q!==void 0&&pe>Q?re.next(pe-Q):(!ve&&Z(pe),M)}}}const Xie=e=>{const t=({timestamp:r})=>e(r);return{start:()=>$n.update(t,!0),stop:()=>wc(t),now:()=>ps.isProcessing?ps.timestamp:performance.now()}},Gj=2e4;function Hj(e){let t=0;const r=50;let i=e.next(t);for(;!i.done&&t<Gj;)t+=r,i=e.next(t);return t>=Gj?1/0:t}const Yie={decay:Wj,inertia:Wj,tween:F1,keyframes:F1,spring:OU};function B1({autoplay:e=!0,delay:t=0,driver:r=Xie,keyframes:i,type:a="keyframes",repeat:u=0,repeatDelay:h=0,repeatType:g="loop",onPlay:s,onStop:_,onComplete:b,onUpdate:C,...M}){let D=1,N=!1,j,V;const B=()=>{V=new Promise(Ge=>{j=Ge})};B();let z;const U=Yie[a]||F1;let Z;U!==F1&&typeof i[0]!="number"&&(Z=NU([0,100],i,{clamp:!1}),i=[0,100]);const Q=U({...M,keyframes:i});let re;g==="mirror"&&(re=U({...M,keyframes:[...i].reverse(),velocity:-(M.velocity||0)}));let oe="idle",pe=null,ve=null,he=null;Q.calculatedDuration===null&&u&&(Q.calculatedDuration=Hj(Q));const{calculatedDuration:Ke}=Q;let qe=1/0,Ie=1/0;Ke!==null&&(qe=Ke+h,Ie=qe*(u+1)-h);let rt=0;const Pt=Ge=>{if(ve===null)return;D>0&&(ve=Math.min(ve,Ge)),D<0&&(ve=Math.min(Ge-Ie/D,ve)),pe!==null?rt=pe:rt=Math.round(Ge-ve)*D;const wt=rt-t*(D>=0?1:-1),ct=D>=0?wt<0:wt>Ie;rt=Math.max(wt,0),oe==="finished"&&pe===null&&(rt=Ie);let dt=rt,tr=Q;if(u){const cr=Math.min(rt,Ie)/qe;let lr=Math.floor(cr),dr=cr%1;!dr&&cr>=1&&(dr=1),dr===1&&lr--,lr=Math.min(lr,u+1),!!(lr%2)&&(g==="reverse"?(dr=1-dr,h&&(dr-=h/qe)):g==="mirror"&&(tr=re)),dt=Gu(0,1,dr)*qe}const Bt=ct?{done:!1,value:i[0]}:tr.next(dt);Z&&(Bt.value=Z(Bt.value));let{done:St}=Bt;!ct&&Ke!==null&&(St=D>=0?rt>=Ie:rt<=0);const nr=pe===null&&(oe==="finished"||oe==="running"&&St);return C&&C(Bt.value),nr&&Te(),Bt},it=()=>{z&&z.stop(),z=void 0},Je=()=>{oe="idle",it(),j(),B(),ve=he=null},Te=()=>{oe="finished",b&&b(),it(),j()},Re=()=>{if(N)return;z||(z=r(Pt));const Ge=z.now();s&&s(),pe!==null?ve=Ge-pe:(!ve||oe==="finished")&&(ve=Ge),oe==="finished"&&B(),he=ve,pe=null,oe="running",z.start()};e&&Re();const Tt={then(Ge,wt){return V.then(Ge,wt)},get time(){return hc(rt)},set time(Ge){Ge=gh(Ge),rt=Ge,pe!==null||!z||D===0?pe=Ge:ve=z.now()-Ge/D},get duration(){const Ge=Q.calculatedDuration===null?Hj(Q):Q.calculatedDuration;return hc(Ge)},get speed(){return D},set speed(Ge){Ge===D||!z||(D=Ge,Tt.time=hc(rt))},get state(){return oe},play:Re,pause:()=>{oe="paused",pe=rt},stop:()=>{N=!0,oe!=="idle"&&(oe="idle",_&&_(),Je())},cancel:()=>{he!==null&&Pt(he),Je()},complete:()=>{oe="finished"},sample:Ge=>(ve=0,Pt(Ge))};return Tt}function Kie(e){let t;return()=>(t===void 0&&(t=e()),t)}const Qie=Kie(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Jie=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),b0=10,ese=2e4,tse=(e,t)=>t.type==="spring"||e==="backgroundColor"||!pU(t.ease);function rse(e,t,{onUpdate:r,onComplete:i,...a}){if(!(Qie()&&Jie.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let h=!1,g,s,_=!1;const b=()=>{s=new Promise(U=>{g=U})};b();let{keyframes:C,duration:M=300,ease:D,times:N}=a;if(tse(t,a)){const U=B1({...a,repeat:0,delay:0});let Z={done:!1,value:C[0]};const Q=[];let re=0;for(;!Z.done&&re<ese;)Z=U.sample(re),Q.push(Z.value),re+=b0;N=void 0,C=Q,M=re-b0,D="linear"}const j=hie(e.owner.current,t,C,{...a,duration:M,ease:D,times:N}),V=()=>{_=!1,j.cancel()},B=()=>{_=!0,$n.update(V),g(),b()};return j.onfinish=()=>{_||(e.set(fie(C,a)),i&&i(),B())},{then(U,Z){return s.then(U,Z)},attachTimeline(U){return j.timeline=U,j.onfinish=null,mi},get time(){return hc(j.currentTime||0)},set time(U){j.currentTime=gh(U)},get speed(){return j.playbackRate},set speed(U){j.playbackRate=U},get duration(){return hc(M)},play:()=>{h||(j.play(),wc(V))},pause:()=>j.pause(),stop:()=>{if(h=!0,j.playState==="idle")return;const{currentTime:U}=j;if(U){const Z=B1({...a,autoplay:!1});e.setWithVelocity(Z.sample(U-b0).value,Z.sample(U).value,b0)}B()},complete:()=>{_||j.finish()},cancel:B}}function nse({keyframes:e,delay:t,onUpdate:r,onComplete:i}){const a=()=>(r&&r(e[e.length-1]),i&&i(),{time:0,speed:1,duration:0,play:mi,pause:mi,stop:mi,then:u=>(u(),Promise.resolve()),cancel:mi,complete:mi});return t?B1({keyframes:[0,1],duration:0,delay:t,onComplete:a}):a()}const ise={type:"spring",stiffness:500,damping:25,restSpeed:10},sse=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),ose={type:"keyframes",duration:.8},ase={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lse=(e,{keyframes:t})=>t.length>2?ose:Fh.has(e)?e.startsWith("scale")?sse(t[1]):ise:ase,KC=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Hu.test(t)||t==="0")&&!t.startsWith("url(")),cse=new Set(["brightness","contrast","saturate","opacity"]);function use(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=r.match(ab)||[];if(!i)return e;const a=r.replace(i,"");let u=cse.has(t)?1:0;return i!==r&&(u*=100),t+"("+u+a+")"}const dse=/([a-z-]*)\(.*?\)/g,QC={...Hu,getAnimatableNone:e=>{const t=e.match(dse);return t?t.map(use).join(" "):e}},hse={...QB,color:Ms,backgroundColor:Ms,outlineColor:Ms,fill:Ms,stroke:Ms,borderColor:Ms,borderTopColor:Ms,borderRightColor:Ms,borderBottomColor:Ms,borderLeftColor:Ms,filter:QC,WebkitFilter:QC},OP=e=>hse[e];function zU(e,t){let r=OP(e);return r!==QC&&(r=Hu),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const FU=e=>/^0[^.\s]+$/.test(e);function fse(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||FU(e)}function pse(e,t,r,i){const a=KC(t,r);let u;Array.isArray(r)?u=[...r]:u=[null,r];const h=i.from!==void 0?i.from:e.get();let g;const s=[];for(let _=0;_<u.length;_++)u[_]===null&&(u[_]=_===0?h:u[_-1]),fse(u[_])&&s.push(_),typeof u[_]=="string"&&u[_]!=="none"&&u[_]!=="0"&&(g=u[_]);if(a&&s.length&&g)for(let _=0;_<s.length;_++){const b=s[_];u[b]=zU(t,g)}return u}function mse({when:e,delay:t,delayChildren:r,staggerChildren:i,staggerDirection:a,repeat:u,repeatType:h,repeatDelay:g,from:s,elapsed:_,...b}){return!!Object.keys(b).length}function zP(e,t){return e[t]||e.default||e}const gse={skipAnimations:!1},FP=(e,t,r,i={})=>a=>{const u=zP(i,e)||{},h=u.delay||i.delay||0;let{elapsed:g=0}=i;g=g-gh(h);const s=pse(t,e,r,u),_=s[0],b=s[s.length-1],C=KC(e,_),M=KC(e,b);let D={keyframes:s,velocity:t.getVelocity(),ease:"easeOut",...u,delay:-g,onUpdate:N=>{t.set(N),u.onUpdate&&u.onUpdate(N)},onComplete:()=>{a(),u.onComplete&&u.onComplete()}};if(mse(u)||(D={...D,...lse(e,D)}),D.duration&&(D.duration=gh(D.duration)),D.repeatDelay&&(D.repeatDelay=gh(D.repeatDelay)),!C||!M||die.current||u.type===!1||gse.skipAnimations)return nse(D);if(!i.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const N=rse(t,e,D);if(N)return N}return B1(D)};function U1(e){return!!(co(e)&&e.add)}const BU=e=>/^\-?\d*\.?\d+$/.test(e);function BP(e,t){e.indexOf(t)===-1&&e.push(t)}function UP(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class VP{constructor(){this.subscriptions=[]}add(t){return BP(this.subscriptions,t),()=>UP(this.subscriptions,t)}notify(t,r,i){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,i);else for(let u=0;u<a;u++){const h=this.subscriptions[u];h&&h(t,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const yse=e=>!isNaN(parseFloat(e));class vse{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,a=!0)=>{this.prev=this.current,this.current=i;const{delta:u,timestamp:h}=ps;this.lastUpdated!==h&&(this.timeDelta=u,this.lastUpdated=h,$n.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>$n.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=yse(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new VP);const i=this.events[t].add(r);return t==="change"?()=>{i(),$n.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,i){this.set(r),this.prev=t,this.timeDelta=i}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?jU(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bp(e,t){return new vse(e,t)}const UU=e=>t=>t.test(e),xse={test:e=>e==="auto",parse:e=>e},VU=[Bh,Sr,bl,cu,Cne,Tne,xse],uy=e=>VU.find(UU(e)),_se=[...VU,Ms,Hu],wse=e=>_se.find(UU(e));function bse(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Bp(r))}function Sse(e,t){const r=cb(e,t);let{transitionEnd:i={},transition:a={},...u}=r?e.makeTargetAnimatable(r,!1):{};u={...u,...i};for(const h in u){const g=Une(u[h]);bse(e,h,g)}}function Ese(e,t,r){var i,a;const u=Object.keys(t).filter(g=>!e.hasValue(g)),h=u.length;if(h)for(let g=0;g<h;g++){const s=u[g],_=t[s];let b=null;Array.isArray(_)&&(b=_[0]),b===null&&(b=(a=(i=r[s])!==null&&i!==void 0?i:e.readValue(s))!==null&&a!==void 0?a:t[s]),b!=null&&(typeof b=="string"&&(BU(b)||FU(b))?b=parseFloat(b):!wse(b)&&Hu.test(_)&&(b=zU(s,_)),e.addValue(s,Bp(b,{owner:e})),r[s]===void 0&&(r[s]=b),b!==null&&e.setBaseTarget(s,b))}}function Tse(e,t){return t?(t[e]||t.default||t).from:void 0}function Cse(e,t,r){const i={};for(const a in e){const u=Tse(a,t);if(u!==void 0)i[a]=u;else{const h=r.getValue(a);h&&(i[a]=h.get())}}return i}function Mse({protectedKeys:e,needsAnimating:t},r){const i=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,i}function kse(e,t){const r=e.get();if(Array.isArray(t)){for(let i=0;i<t.length;i++)if(t[i]!==r)return!0}else return r!==t}function $U(e,t,{delay:r=0,transitionOverride:i,type:a}={}){let{transition:u=e.getDefaultTransition(),transitionEnd:h,...g}=e.makeTargetAnimatable(t);const s=e.getValue("willChange");i&&(u=i);const _=[],b=a&&e.animationState&&e.animationState.getState()[a];for(const C in g){const M=e.getValue(C),D=g[C];if(!M||D===void 0||b&&Mse(b,C))continue;const N={delay:r,elapsed:0,...zP(u||{},C)};if(window.HandoffAppearAnimations){const B=e.getProps()[WB];if(B){const z=window.HandoffAppearAnimations(B,C,M,$n);z!==null&&(N.elapsed=z,N.isHandoff=!0)}}let j=!N.isHandoff&&!kse(M,D);if(N.type==="spring"&&(M.getVelocity()||N.velocity)&&(j=!1),M.animation&&(j=!1),j)continue;M.start(FP(C,M,D,e.shouldReduceMotion&&Fh.has(C)?{type:!1}:N));const V=M.animation;U1(s)&&(s.add(C),V.then(()=>s.remove(C))),_.push(V)}return h&&Promise.all(_).then(()=>{h&&Sse(e,h)}),_}function JC(e,t,r={}){const i=cb(e,t,r.custom);let{transition:a=e.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(a=r.transitionOverride);const u=i?()=>Promise.all($U(e,i,r)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(s=0)=>{const{delayChildren:_=0,staggerChildren:b,staggerDirection:C}=a;return Pse(e,t,_+s,b,C,r)}:()=>Promise.resolve(),{when:g}=a;if(g){const[s,_]=g==="beforeChildren"?[u,h]:[h,u];return s().then(()=>_())}else return Promise.all([u(),h(r.delay)])}function Pse(e,t,r=0,i=0,a=1,u){const h=[],g=(e.variantChildren.size-1)*i,s=a===1?(_=0)=>_*i:(_=0)=>g-_*i;return Array.from(e.variantChildren).sort(Ase).forEach((_,b)=>{_.notify("AnimationStart",t),h.push(JC(_,t,{...u,delay:r+s(b)}).then(()=>_.notify("AnimationComplete",t)))}),Promise.all(h)}function Ase(e,t){return e.sortNodePosition(t)}function Ise(e,t,r={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const a=t.map(u=>JC(e,u,r));i=Promise.all(a)}else if(typeof t=="string")i=JC(e,t,r);else{const a=typeof t=="function"?cb(e,t,r.custom):t;i=Promise.all($U(e,a,r))}return i.then(()=>e.notify("AnimationComplete",t))}const Dse=[...TP].reverse(),Rse=TP.length;function Nse(e){return t=>Promise.all(t.map(({animation:r,options:i})=>Ise(e,r,i)))}function jse(e){let t=Nse(e);const r=Ose();let i=!0;const a=(s,_)=>{const b=cb(e,_);if(b){const{transition:C,transitionEnd:M,...D}=b;s={...s,...D,...M}}return s};function u(s){t=s(e)}function h(s,_){const b=e.getProps(),C=e.getVariantContext(!0)||{},M=[],D=new Set;let N={},j=1/0;for(let B=0;B<Rse;B++){const z=Dse[B],U=r[z],Z=b[z]!==void 0?b[z]:C[z],Q=bv(Z),re=z===_?U.isActive:null;re===!1&&(j=B);let oe=Z===C[z]&&Z!==b[z]&&Q;if(oe&&i&&e.manuallyAnimateOnMount&&(oe=!1),U.protectedKeys={...N},!U.isActive&&re===null||!Z&&!U.prevProp||sb(Z)||typeof Z=="boolean")continue;let ve=Lse(U.prevProp,Z)||z===_&&U.isActive&&!oe&&Q||B>j&&Q,he=!1;const Ke=Array.isArray(Z)?Z:[Z];let qe=Ke.reduce(a,{});re===!1&&(qe={});const{prevResolvedValues:Ie={}}=U,rt={...Ie,...qe},Pt=it=>{ve=!0,D.has(it)&&(he=!0,D.delete(it)),U.needsAnimating[it]=!0};for(const it in rt){const Je=qe[it],Te=Ie[it];if(N.hasOwnProperty(it))continue;let Re=!1;L1(Je)&&L1(Te)?Re=!hU(Je,Te):Re=Je!==Te,Re?Je!==void 0?Pt(it):D.add(it):Je!==void 0&&D.has(it)?Pt(it):U.protectedKeys[it]=!0}U.prevProp=Z,U.prevResolvedValues=qe,U.isActive&&(N={...N,...qe}),i&&e.blockInitialAnimation&&(ve=!1),ve&&(!oe||he)&&M.push(...Ke.map(it=>({animation:it,options:{type:z,...s}})))}if(D.size){const B={};D.forEach(z=>{const U=e.getBaseTarget(z);U!==void 0&&(B[z]=U)}),M.push({animation:B})}let V=!!M.length;return i&&(b.initial===!1||b.initial===b.animate)&&!e.manuallyAnimateOnMount&&(V=!1),i=!1,V?t(M):Promise.resolve()}function g(s,_,b){var C;if(r[s].isActive===_)return Promise.resolve();(C=e.variantChildren)===null||C===void 0||C.forEach(D=>{var N;return(N=D.animationState)===null||N===void 0?void 0:N.setActive(s,_)}),r[s].isActive=_;const M=h(b,s);for(const D in r)r[D].protectedKeys={};return M}return{animateChanges:h,setActive:g,setAnimateFunction:u,getState:()=>r}}function Lse(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!hU(t,e):!1}function qd(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ose(){return{animate:qd(!0),whileInView:qd(),whileHover:qd(),whileTap:qd(),whileDrag:qd(),whileFocus:qd(),exit:qd()}}class zse extends td{constructor(t){super(t),t.animationState||(t.animationState=jse(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),sb(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let Fse=0;class Bse extends td{constructor(){super(...arguments),this.id=Fse++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const u=this.node.animationState.setActive("exit",!t,{custom:i??this.node.getProps().custom});r&&!t&&u.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Use={animation:{Feature:zse},exit:{Feature:Bse}},qj=(e,t)=>Math.abs(e-t);function Vse(e,t){const r=qj(e.x,t.x),i=qj(e.y,t.y);return Math.sqrt(r**2+i**2)}class WU{constructor(t,r,{transformPagePoint:i,contextWindow:a,dragSnapToOrigin:u=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=cT(this.lastMoveEventInfo,this.history),M=this.startEvent!==null,D=Vse(C.offset,{x:0,y:0})>=3;if(!M&&!D)return;const{point:N}=C,{timestamp:j}=ps;this.history.push({...N,timestamp:j});const{onStart:V,onMove:B}=this.handlers;M||(V&&V(this.lastMoveEvent,C),this.startEvent=this.lastMoveEvent),B&&B(this.lastMoveEvent,C)},this.handlePointerMove=(C,M)=>{this.lastMoveEvent=C,this.lastMoveEventInfo=lT(M,this.transformPagePoint),$n.update(this.updatePoint,!0)},this.handlePointerUp=(C,M)=>{this.end();const{onEnd:D,onSessionEnd:N,resumeAnimation:j}=this.handlers;if(this.dragSnapToOrigin&&j&&j(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=cT(C.type==="pointercancel"?this.lastMoveEventInfo:lT(M,this.transformPagePoint),this.history);this.startEvent&&D&&D(C,V),N&&N(C,V)},!aU(t))return;this.dragSnapToOrigin=u,this.handlers=r,this.transformPagePoint=i,this.contextWindow=a||window;const h=lb(t),g=lT(h,this.transformPagePoint),{point:s}=g,{timestamp:_}=ps;this.history=[{...s,timestamp:_}];const{onSessionStart:b}=r;b&&b(t,cT(g,this.history)),this.removeListeners=Lu(dc(this.contextWindow,"pointermove",this.handlePointerMove),dc(this.contextWindow,"pointerup",this.handlePointerUp),dc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),wc(this.updatePoint)}}function lT(e,t){return t?{point:t(e.point)}:e}function Zj(e,t){return{x:e.x-t.x,y:e.y-t.y}}function cT({point:e},t){return{point:e,delta:Zj(e,GU(t)),offset:Zj(e,$se(t)),velocity:Wse(t,.1)}}function $se(e){return e[0]}function GU(e){return e[e.length-1]}function Wse(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,i=null;const a=GU(e);for(;r>=0&&(i=e[r],!(a.timestamp-i.timestamp>gh(t)));)r--;if(!i)return{x:0,y:0};const u=hc(a.timestamp-i.timestamp);if(u===0)return{x:0,y:0};const h={x:(a.x-i.x)/u,y:(a.y-i.y)/u};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function No(e){return e.max-e.min}function eM(e,t=0,r=.01){return Math.abs(e-t)<=r}function Xj(e,t,r,i=.5){e.origin=i,e.originPoint=ii(t.min,t.max,e.origin),e.scale=No(r)/No(t),(eM(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ii(r.min,r.max,e.origin)-e.originPoint,(eM(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Ly(e,t,r,i){Xj(e.x,t.x,r.x,i?i.originX:void 0),Xj(e.y,t.y,r.y,i?i.originY:void 0)}function Yj(e,t,r){e.min=r.min+t.min,e.max=e.min+No(t)}function Gse(e,t,r){Yj(e.x,t.x,r.x),Yj(e.y,t.y,r.y)}function Kj(e,t,r){e.min=t.min-r.min,e.max=e.min+No(t)}function Oy(e,t,r){Kj(e.x,t.x,r.x),Kj(e.y,t.y,r.y)}function Hse(e,{min:t,max:r},i){return t!==void 0&&e<t?e=i?ii(t,e,i.min):Math.max(e,t):r!==void 0&&e>r&&(e=i?ii(r,e,i.max):Math.min(e,r)),e}function Qj(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function qse(e,{top:t,left:r,bottom:i,right:a}){return{x:Qj(e.x,r,a),y:Qj(e.y,t,i)}}function Jj(e,t){let r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,i]=[i,r]),{min:r,max:i}}function Zse(e,t){return{x:Jj(e.x,t.x),y:Jj(e.y,t.y)}}function Xse(e,t){let r=.5;const i=No(e),a=No(t);return a>i?r=Ev(t.min,t.max-i,e.min):i>a&&(r=Ev(e.min,e.max-a,t.min)),Gu(0,1,r)}function Yse(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const tM=.35;function Kse(e=tM){return e===!1?e=0:e===!0&&(e=tM),{x:e3(e,"left","right"),y:e3(e,"top","bottom")}}function e3(e,t,r){return{min:t3(e,t),max:t3(e,r)}}function t3(e,t){return typeof e=="number"?e:e[t]||0}const r3=()=>({translate:0,scale:1,origin:0,originPoint:0}),lp=()=>({x:r3(),y:r3()}),n3=()=>({min:0,max:0}),Ti=()=>({x:n3(),y:n3()});function Yo(e){return[e("x"),e("y")]}function HU({top:e,left:t,right:r,bottom:i}){return{x:{min:t,max:r},y:{min:e,max:i}}}function Qse({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Jse(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}function uT(e){return e===void 0||e===1}function rM({scale:e,scaleX:t,scaleY:r}){return!uT(e)||!uT(t)||!uT(r)}function Jd(e){return rM(e)||qU(e)||e.z||e.rotate||e.rotateX||e.rotateY}function qU(e){return i3(e.x)||i3(e.y)}function i3(e){return e&&e!=="0%"}function V1(e,t,r){const i=e-r,a=t*i;return r+a}function s3(e,t,r,i,a){return a!==void 0&&(e=V1(e,a,i)),V1(e,r,i)+t}function nM(e,t=0,r=1,i,a){e.min=s3(e.min,t,r,i,a),e.max=s3(e.max,t,r,i,a)}function ZU(e,{x:t,y:r}){nM(e.x,t.translate,t.scale,t.originPoint),nM(e.y,r.translate,r.scale,r.originPoint)}function eoe(e,t,r,i=!1){const a=r.length;if(!a)return;t.x=t.y=1;let u,h;for(let g=0;g<a;g++){u=r[g],h=u.projectionDelta;const s=u.instance;s&&s.style&&s.style.display==="contents"||(i&&u.options.layoutScroll&&u.scroll&&u!==u.root&&cp(e,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,ZU(e,h)),i&&Jd(u.latestValues)&&cp(e,u.latestValues))}t.x=o3(t.x),t.y=o3(t.y)}function o3(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function hu(e,t){e.min=e.min+t,e.max=e.max+t}function a3(e,t,[r,i,a]){const u=t[a]!==void 0?t[a]:.5,h=ii(e.min,e.max,u);nM(e,t[r],t[i],h,t.scale)}const toe=["x","scaleX","originX"],roe=["y","scaleY","originY"];function cp(e,t){a3(e.x,t,toe),a3(e.y,t,roe)}function XU(e,t){return HU(Jse(e.getBoundingClientRect(),t))}function noe(e,t,r){const i=XU(e,r),{scroll:a}=t;return a&&(hu(i.x,a.offset.x),hu(i.y,a.offset.y)),i}const YU=({current:e})=>e?e.ownerDocument.defaultView:null,ioe=new WeakMap;class soe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ti(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=b=>{const{dragSnapToOrigin:C}=this.getProps();C?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(lb(b,"page").point)},u=(b,C)=>{const{drag:M,dragPropagation:D,onDragStart:N}=this.getProps();if(M&&!D&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=cU(M),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Yo(V=>{let B=this.getAxisMotionValue(V).get()||0;if(bl.test(B)){const{projection:z}=this.visualElement;if(z&&z.layout){const U=z.layout.layoutBox[V];U&&(B=No(U)*(parseFloat(B)/100))}}this.originPoint[V]=B}),N&&$n.update(()=>N(b,C),!1,!0);const{animationState:j}=this.visualElement;j&&j.setActive("whileDrag",!0)},h=(b,C)=>{const{dragPropagation:M,dragDirectionLock:D,onDirectionLock:N,onDrag:j}=this.getProps();if(!M&&!this.openGlobalLock)return;const{offset:V}=C;if(D&&this.currentDirection===null){this.currentDirection=ooe(V),this.currentDirection!==null&&N&&N(this.currentDirection);return}this.updateAxis("x",C.point,V),this.updateAxis("y",C.point,V),this.visualElement.render(),j&&j(b,C)},g=(b,C)=>this.stop(b,C),s=()=>Yo(b=>{var C;return this.getAnimationState(b)==="paused"&&((C=this.getAxisMotionValue(b).animation)===null||C===void 0?void 0:C.play())}),{dragSnapToOrigin:_}=this.getProps();this.panSession=new WU(t,{onSessionStart:a,onStart:u,onMove:h,onSessionEnd:g,resumeAnimation:s},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:_,contextWindow:YU(this.visualElement)})}stop(t,r){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:u}=this.getProps();u&&$n.update(()=>u(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,i){const{drag:a}=this.getProps();if(!i||!S0(t,a,this.currentDirection))return;const u=this.getAxisMotionValue(t);let h=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(h=Hse(h,this.constraints[t],this.elastic[t])),u.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,u=this.constraints;r&&op(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=qse(a.layoutBox,r):this.constraints=!1,this.elastic=Kse(i),u!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Yo(h=>{this.getAxisMotionValue(h)&&(this.constraints[h]=Yse(a.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!op(t))return!1;const i=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const u=noe(i,a.root,this.visualElement.getTransformPagePoint());let h=Zse(a.layout.layoutBox,u);if(r){const g=r(Qse(h));this.hasMutatedConstraints=!!g,g&&(h=HU(g))}return h}startAnimation(t){const{drag:r,dragMomentum:i,dragElastic:a,dragTransition:u,dragSnapToOrigin:h,onDragTransitionEnd:g}=this.getProps(),s=this.constraints||{},_=Yo(b=>{if(!S0(b,r,this.currentDirection))return;let C=s&&s[b]||{};h&&(C={min:0,max:0});const M=a?200:1e6,D=a?40:1e7,N={type:"inertia",velocity:i?t[b]:0,bounceStiffness:M,bounceDamping:D,timeConstant:750,restDelta:1,restSpeed:10,...u,...C};return this.startAxisValueAnimation(b,N)});return Promise.all(_).then(g)}startAxisValueAnimation(t,r){const i=this.getAxisMotionValue(t);return i.start(FP(t,i,0,r))}stopAnimation(){Yo(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Yo(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),i=this.visualElement.getProps(),a=i[r];return a||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Yo(r=>{const{drag:i}=this.getProps();if(!S0(r,i,this.currentDirection))return;const{projection:a}=this.visualElement,u=this.getAxisMotionValue(r);if(a&&a.layout){const{min:h,max:g}=a.layout.layoutBox[r];u.set(t[r]-ii(h,g,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:i}=this.visualElement;if(!op(r)||!i||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Yo(h=>{const g=this.getAxisMotionValue(h);if(g){const s=g.get();a[h]=Xse({min:s,max:s},this.constraints[h])}});const{transformTemplate:u}=this.visualElement.getProps();this.visualElement.current.style.transform=u?u({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Yo(h=>{if(!S0(h,t,null))return;const g=this.getAxisMotionValue(h),{min:s,max:_}=this.constraints[h];g.set(ii(s,_,a[h]))})}addListeners(){if(!this.visualElement.current)return;ioe.set(this.visualElement,this);const t=this.visualElement.current,r=dc(t,"pointerdown",s=>{const{drag:_,dragListener:b=!0}=this.getProps();_&&b&&this.start(s)}),i=()=>{const{dragConstraints:s}=this.getProps();op(s)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,u=a.addEventListener("measure",i);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),i();const h=oc(window,"resize",()=>this.scalePositionWithinConstraints()),g=a.addEventListener("didUpdate",({delta:s,hasLayoutChanged:_})=>{this.isDragging&&_&&(Yo(b=>{const C=this.getAxisMotionValue(b);C&&(this.originPoint[b]+=s[b].translate,C.set(C.get()+s[b].translate))}),this.visualElement.render())});return()=>{h(),r(),u(),g&&g()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:i=!1,dragPropagation:a=!1,dragConstraints:u=!1,dragElastic:h=tM,dragMomentum:g=!0}=t;return{...t,drag:r,dragDirectionLock:i,dragPropagation:a,dragConstraints:u,dragElastic:h,dragMomentum:g}}}function S0(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function ooe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class aoe extends td{constructor(t){super(t),this.removeGroupControls=mi,this.removeListeners=mi,this.controls=new soe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||mi}unmount(){this.removeGroupControls(),this.removeListeners()}}const l3=e=>(t,r)=>{e&&$n.update(()=>e(t,r))};class loe extends td{constructor(){super(...arguments),this.removePointerDownListener=mi}onPointerDown(t){this.session=new WU(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:YU(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:i,onPanEnd:a}=this.node.getProps();return{onSessionStart:l3(t),onStart:l3(r),onMove:i,onEnd:(u,h)=>{delete this.session,a&&$n.update(()=>a(u,h))}}}mount(){this.removePointerDownListener=dc(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function coe(){const e=A.useContext(SP);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,a=A.useId();return A.useEffect(()=>i(a),[]),!t&&r?[!1,()=>r&&r(a)]:[!0]}const H0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function c3(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const dy={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Sr.test(e))e=parseFloat(e);else return e;const r=c3(e,t.target.x),i=c3(e,t.target.y);return`${r}% ${i}%`}},uoe={correct:(e,{treeScale:t,projectionDelta:r})=>{const i=e,a=Hu.parse(e);if(a.length>5)return i;const u=Hu.createTransformer(e),h=typeof a[0]!="number"?1:0,g=r.x.scale*t.x,s=r.y.scale*t.y;a[0+h]/=g,a[1+h]/=s;const _=ii(g,s,.5);return typeof a[2+h]=="number"&&(a[2+h]/=_),typeof a[3+h]=="number"&&(a[3+h]/=_),u(a)}};class doe extends lt.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i,layoutId:a}=this.props,{projection:u}=t;vne(hoe),u&&(r.group&&r.group.add(u),i&&i.register&&a&&i.register(u),u.root.didUpdate(),u.addEventListener("animationComplete",()=>{this.safeToRemove()}),u.setOptions({...u.options,onExitComplete:()=>this.safeToRemove()})),H0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:i,drag:a,isPresent:u}=this.props,h=i.projection;return h&&(h.isPresent=u,a||t.layoutDependency!==r||r===void 0?h.willUpdate():this.safeToRemove(),t.isPresent!==u&&(u?h.promote():h.relegate()||$n.postRender(()=>{const g=h.getStack();(!g||!g.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),i&&i.deregister&&i.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function KU(e){const[t,r]=coe(),i=A.useContext(HB);return lt.createElement(doe,{...e,layoutGroup:i,switchLayoutGroup:A.useContext(qB),isPresent:t,safeToRemove:r})}const hoe={borderRadius:{...dy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:dy,borderTopRightRadius:dy,borderBottomLeftRadius:dy,borderBottomRightRadius:dy,boxShadow:uoe},QU=["TopLeft","TopRight","BottomLeft","BottomRight"],foe=QU.length,u3=e=>typeof e=="string"?parseFloat(e):e,d3=e=>typeof e=="number"||Sr.test(e);function poe(e,t,r,i,a,u){a?(e.opacity=ii(0,r.opacity!==void 0?r.opacity:1,moe(i)),e.opacityExit=ii(t.opacity!==void 0?t.opacity:1,0,goe(i))):u&&(e.opacity=ii(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,i));for(let h=0;h<foe;h++){const g=`border${QU[h]}Radius`;let s=h3(t,g),_=h3(r,g);if(s===void 0&&_===void 0)continue;s||(s=0),_||(_=0),s===0||_===0||d3(s)===d3(_)?(e[g]=Math.max(ii(u3(s),u3(_),i),0),(bl.test(_)||bl.test(s))&&(e[g]+="%")):e[g]=_}(t.rotate||r.rotate)&&(e.rotate=ii(t.rotate||0,r.rotate||0,i))}function h3(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const moe=JU(0,.5,wU),goe=JU(.5,.95,mi);function JU(e,t,r){return i=>i<e?0:i>t?1:r(Ev(e,t,i))}function f3(e,t){e.min=t.min,e.max=t.max}function Xo(e,t){f3(e.x,t.x),f3(e.y,t.y)}function p3(e,t,r,i,a){return e-=t,e=V1(e,1/r,i),a!==void 0&&(e=V1(e,1/a,i)),e}function yoe(e,t=0,r=1,i=.5,a,u=e,h=e){if(bl.test(t)&&(t=parseFloat(t),t=ii(h.min,h.max,t/100)-h.min),typeof t!="number")return;let g=ii(u.min,u.max,i);e===u&&(g-=t),e.min=p3(e.min,t,r,g,a),e.max=p3(e.max,t,r,g,a)}function m3(e,t,[r,i,a],u,h){yoe(e,t[r],t[i],t[a],t.scale,u,h)}const voe=["x","scaleX","originX"],xoe=["y","scaleY","originY"];function g3(e,t,r,i){m3(e.x,t,voe,r?r.x:void 0,i?i.x:void 0),m3(e.y,t,xoe,r?r.y:void 0,i?i.y:void 0)}function y3(e){return e.translate===0&&e.scale===1}function e6(e){return y3(e.x)&&y3(e.y)}function _oe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function t6(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function v3(e){return No(e.x)/No(e.y)}class woe{constructor(){this.members=[]}add(t){BP(this.members,t),t.scheduleRender()}remove(t){if(UP(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let i;for(let a=r;a>=0;a--){const u=this.members[a];if(u.isPresent!==!1){i=u;break}}return i?(this.promote(i),!0):!1}promote(t,r){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,r&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:i}=t;r.onExitComplete&&r.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function x3(e,t,r){let i="";const a=e.x.translate/t.x,u=e.y.translate/t.y;if((a||u)&&(i=`translate3d(${a}px, ${u}px, 0) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:s,rotateX:_,rotateY:b}=r;s&&(i+=`rotate(${s}deg) `),_&&(i+=`rotateX(${_}deg) `),b&&(i+=`rotateY(${b}deg) `)}const h=e.x.scale*t.x,g=e.y.scale*t.y;return(h!==1||g!==1)&&(i+=`scale(${h}, ${g})`),i||"none"}const boe=(e,t)=>e.depth-t.depth;class Soe{constructor(){this.children=[],this.isDirty=!1}add(t){BP(this.children,t),this.isDirty=!0}remove(t){UP(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(boe),this.isDirty=!1,this.children.forEach(t)}}function Eoe(e,t){const r=performance.now(),i=({timestamp:a})=>{const u=a-r;u>=t&&(wc(i),e(u-t))};return $n.read(i,!0),()=>wc(i)}function Toe(e){window.MotionDebug&&window.MotionDebug.record(e)}function Coe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Moe(e,t,r){const i=co(e)?e:Bp(e);return i.start(FP("",i,t,r)),i.animation}const _3=["","X","Y","Z"],koe={visibility:"hidden"},w3=1e3;let Poe=0;const eh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function r6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:i,resetTransform:a}){return class{constructor(h={},g=t==null?void 0:t()){this.id=Poe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,eh.totalNodes=eh.resolvedTargetDeltas=eh.recalculatedProjection=0,this.nodes.forEach(Doe),this.nodes.forEach(Ooe),this.nodes.forEach(zoe),this.nodes.forEach(Roe),Toe(eh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=g?g.root||g:this,this.path=g?[...g.path,g]:[],this.parent=g,this.depth=g?g.depth+1:0;for(let s=0;s<this.path.length;s++)this.path[s].shouldResetTransform=!0;this.root===this&&(this.nodes=new Soe)}addEventListener(h,g){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new VP),this.eventHandlers.get(h).add(g)}notifyListeners(h,...g){const s=this.eventHandlers.get(h);s&&s.notify(...g)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,g=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Coe(h),this.instance=h;const{layoutId:s,layout:_,visualElement:b}=this.options;if(b&&!b.current&&b.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),g&&(_||s)&&(this.isLayoutDirty=!0),e){let C;const M=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,C&&C(),C=Eoe(M,250),H0.hasAnimatedSinceResize&&(H0.hasAnimatedSinceResize=!1,this.nodes.forEach(S3))})}s&&this.root.registerSharedNode(s,this),this.options.animate!==!1&&b&&(s||_)&&this.addEventListener("didUpdate",({delta:C,hasLayoutChanged:M,hasRelativeTargetChanged:D,layout:N})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const j=this.options.transition||b.getDefaultTransition()||$oe,{onLayoutAnimationStart:V,onLayoutAnimationComplete:B}=b.getProps(),z=!this.targetLayout||!t6(this.targetLayout,N)||D,U=!M&&D;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||U||M&&(z||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(C,U);const Z={...zP(j,"layout"),onPlay:V,onComplete:B};(b.shouldReduceMotion||this.options.layoutRoot)&&(Z.delay=0,Z.type=!1),this.startAnimation(Z)}else M||S3(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=N})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Foe),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let b=0;b<this.path.length;b++){const C=this.path[b];C.shouldResetTransform=!0,C.updateScroll("snapshot"),C.options.layoutRoot&&C.willUpdate(!1)}const{layoutId:g,layout:s}=this.options;if(g===void 0&&!s)return;const _=this.getTransformTemplate();this.prevTransformTemplateValue=_?_(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(b3);return}this.isUpdating||this.nodes.forEach(joe),this.isUpdating=!1,this.nodes.forEach(Loe),this.nodes.forEach(Aoe),this.nodes.forEach(Ioe),this.clearAllSnapshots();const g=performance.now();ps.delta=Gu(0,1e3/60,g-ps.timestamp),ps.timestamp=g,ps.isProcessing=!0,eT.update.process(ps),eT.preRender.process(ps),eT.render.process(ps),ps.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Noe),this.sharedNodes.forEach(Boe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let s=0;s<this.path.length;s++)this.path[s].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ti(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:g}=this.options;g&&g.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let g=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(g=!1),g&&(this.scroll={animationId:this.root.animationId,phase:h,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!a)return;const h=this.isLayoutDirty||this.shouldResetTransform,g=this.projectionDelta&&!e6(this.projectionDelta),s=this.getTransformTemplate(),_=s?s(this.latestValues,""):void 0,b=_!==this.prevTransformTemplateValue;h&&(g||Jd(this.latestValues)||b)&&(a(this.instance,_),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const g=this.measurePageBox();let s=this.removeElementScroll(g);return h&&(s=this.removeTransform(s)),Woe(s),{animationId:this.root.animationId,measuredBox:g,layoutBox:s,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:h}=this.options;if(!h)return Ti();const g=h.measureViewportBox(),{scroll:s}=this.root;return s&&(hu(g.x,s.offset.x),hu(g.y,s.offset.y)),g}removeElementScroll(h){const g=Ti();Xo(g,h);for(let s=0;s<this.path.length;s++){const _=this.path[s],{scroll:b,options:C}=_;if(_!==this.root&&b&&C.layoutScroll){if(b.isRoot){Xo(g,h);const{scroll:M}=this.root;M&&(hu(g.x,-M.offset.x),hu(g.y,-M.offset.y))}hu(g.x,b.offset.x),hu(g.y,b.offset.y)}}return g}applyTransform(h,g=!1){const s=Ti();Xo(s,h);for(let _=0;_<this.path.length;_++){const b=this.path[_];!g&&b.options.layoutScroll&&b.scroll&&b!==b.root&&cp(s,{x:-b.scroll.offset.x,y:-b.scroll.offset.y}),Jd(b.latestValues)&&cp(s,b.latestValues)}return Jd(this.latestValues)&&cp(s,this.latestValues),s}removeTransform(h){const g=Ti();Xo(g,h);for(let s=0;s<this.path.length;s++){const _=this.path[s];if(!_.instance||!Jd(_.latestValues))continue;rM(_.latestValues)&&_.updateSnapshot();const b=Ti(),C=_.measurePageBox();Xo(b,C),g3(g,_.latestValues,_.snapshot?_.snapshot.layoutBox:void 0,b)}return Jd(this.latestValues)&&g3(g,this.latestValues),g}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ps.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var g;const s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);const _=!!this.resumingFrom||this!==s;if(!(h||_&&this.isSharedProjectionDirty||this.isProjectionDirty||!((g=this.parent)===null||g===void 0)&&g.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:C,layoutId:M}=this.options;if(!(!this.layout||!(C||M))){if(this.resolvedRelativeTargetAt=ps.timestamp,!this.targetDelta&&!this.relativeTarget){const D=this.getClosestProjectingParent();D&&D.layout&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ti(),this.relativeTargetOrigin=Ti(),Oy(this.relativeTargetOrigin,this.layout.layoutBox,D.layout.layoutBox),Xo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ti(),this.targetWithTransforms=Ti()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Gse(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xo(this.target,this.layout.layoutBox),ZU(this.target,this.targetDelta)):Xo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const D=this.getClosestProjectingParent();D&&!!D.resumingFrom==!!this.resumingFrom&&!D.options.layoutScroll&&D.target&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ti(),this.relativeTargetOrigin=Ti(),Oy(this.relativeTargetOrigin,this.target,D.target),Xo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}eh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||rM(this.parent.latestValues)||qU(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const g=this.getLead(),s=!!this.resumingFrom||this!==g;let _=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(_=!1),s&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(_=!1),this.resolvedRelativeTargetAt===ps.timestamp&&(_=!1),_)return;const{layout:b,layoutId:C}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(b||C))return;Xo(this.layoutCorrected,this.layout.layoutBox);const M=this.treeScale.x,D=this.treeScale.y;eoe(this.layoutCorrected,this.treeScale,this.path,s),g.layout&&!g.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(g.target=g.layout.layoutBox);const{target:N}=g;if(!N){this.projectionTransform&&(this.projectionDelta=lp(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=lp(),this.projectionDeltaWithTransform=lp());const j=this.projectionTransform;Ly(this.projectionDelta,this.layoutCorrected,N,this.latestValues),this.projectionTransform=x3(this.projectionDelta,this.treeScale),(this.projectionTransform!==j||this.treeScale.x!==M||this.treeScale.y!==D)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",N)),eh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),h){const g=this.getStack();g&&g.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(h,g=!1){const s=this.snapshot,_=s?s.latestValues:{},b={...this.latestValues},C=lp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!g;const M=Ti(),D=s?s.source:void 0,N=this.layout?this.layout.source:void 0,j=D!==N,V=this.getStack(),B=!V||V.members.length<=1,z=!!(j&&!B&&this.options.crossfade===!0&&!this.path.some(Voe));this.animationProgress=0;let U;this.mixTargetDelta=Z=>{const Q=Z/1e3;E3(C.x,h.x,Q),E3(C.y,h.y,Q),this.setTargetDelta(C),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Oy(M,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Uoe(this.relativeTarget,this.relativeTargetOrigin,M,Q),U&&_oe(this.relativeTarget,U)&&(this.isProjectionDirty=!1),U||(U=Ti()),Xo(U,this.relativeTarget)),j&&(this.animationValues=b,poe(b,_,this.latestValues,Q,z,B)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Q},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$n.update(()=>{H0.hasAnimatedSinceResize=!0,this.currentAnimation=Moe(0,w3,{...h,onUpdate:g=>{this.mixTargetDelta(g),h.onUpdate&&h.onUpdate(g)},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(w3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:g,target:s,layout:_,latestValues:b}=h;if(!(!g||!s||!_)){if(this!==h&&this.layout&&_&&n6(this.options.animationType,this.layout.layoutBox,_.layoutBox)){s=this.target||Ti();const C=No(this.layout.layoutBox.x);s.x.min=h.target.x.min,s.x.max=s.x.min+C;const M=No(this.layout.layoutBox.y);s.y.min=h.target.y.min,s.y.max=s.y.min+M}Xo(g,s),cp(g,b),Ly(this.projectionDeltaWithTransform,this.layoutCorrected,g,b)}}registerSharedNode(h,g){this.sharedNodes.has(h)||this.sharedNodes.set(h,new woe),this.sharedNodes.get(h).add(g);const _=g.options.initialPromotionConfig;g.promote({transition:_?_.transition:void 0,preserveFollowOpacity:_&&_.shouldPreserveFollowOpacity?_.shouldPreserveFollowOpacity(g):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:g}=this.options;return g?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:g}=this.options;return g?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:g,preserveFollowOpacity:s}={}){const _=this.getStack();_&&_.promote(this,s),h&&(this.projectionDelta=void 0,this.needsReset=!0),g&&this.setOptions({transition:g})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetRotation(){const{visualElement:h}=this.options;if(!h)return;let g=!1;const{latestValues:s}=h;if((s.rotate||s.rotateX||s.rotateY||s.rotateZ)&&(g=!0),!g)return;const _={};for(let b=0;b<_3.length;b++){const C="rotate"+_3[b];s[C]&&(_[C]=s[C],h.setStaticValue(C,0))}h.render();for(const b in _)h.setStaticValue(b,_[b]);h.scheduleRender()}getProjectionStyles(h){var g,s;if(!this.instance||this.isSVG)return;if(!this.isVisible)return koe;const _={visibility:""},b=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,_.opacity="",_.pointerEvents=G0(h==null?void 0:h.pointerEvents)||"",_.transform=b?b(this.latestValues,""):"none",_;const C=this.getLead();if(!this.projectionDelta||!this.layout||!C.target){const j={};return this.options.layoutId&&(j.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,j.pointerEvents=G0(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!Jd(this.latestValues)&&(j.transform=b?b({},""):"none",this.hasProjected=!1),j}const M=C.animationValues||C.latestValues;this.applyTransformsToTarget(),_.transform=x3(this.projectionDeltaWithTransform,this.treeScale,M),b&&(_.transform=b(M,_.transform));const{x:D,y:N}=this.projectionDelta;_.transformOrigin=`${D.origin*100}% ${N.origin*100}% 0`,C.animationValues?_.opacity=C===this?(s=(g=M.opacity)!==null&&g!==void 0?g:this.latestValues.opacity)!==null&&s!==void 0?s:1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:_.opacity=C===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const j in N1){if(M[j]===void 0)continue;const{correct:V,applyTo:B}=N1[j],z=_.transform==="none"?M[j]:V(M[j],C);if(B){const U=B.length;for(let Z=0;Z<U;Z++)_[B[Z]]=z}else _[j]=z}return this.options.layoutId&&(_.pointerEvents=C===this?G0(h==null?void 0:h.pointerEvents)||"":"none"),_}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var g;return(g=h.currentAnimation)===null||g===void 0?void 0:g.stop()}),this.root.nodes.forEach(b3),this.root.sharedNodes.clear()}}}function Aoe(e){e.updateLayout()}function Ioe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:a}=e.layout,{animationType:u}=e.options,h=r.source!==e.layout.source;u==="size"?Yo(C=>{const M=h?r.measuredBox[C]:r.layoutBox[C],D=No(M);M.min=i[C].min,M.max=M.min+D}):n6(u,r.layoutBox,i)&&Yo(C=>{const M=h?r.measuredBox[C]:r.layoutBox[C],D=No(i[C]);M.max=M.min+D,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[C].max=e.relativeTarget[C].min+D)});const g=lp();Ly(g,i,r.layoutBox);const s=lp();h?Ly(s,e.applyTransform(a,!0),r.measuredBox):Ly(s,i,r.layoutBox);const _=!e6(g);let b=!1;if(!e.resumeFrom){const C=e.getClosestProjectingParent();if(C&&!C.resumeFrom){const{snapshot:M,layout:D}=C;if(M&&D){const N=Ti();Oy(N,r.layoutBox,M.layoutBox);const j=Ti();Oy(j,i,D.layoutBox),t6(N,j)||(b=!0),C.options.layoutRoot&&(e.relativeTarget=j,e.relativeTargetOrigin=N,e.relativeParent=C)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:r,delta:s,layoutDelta:g,hasLayoutChanged:_,hasRelativeTargetChanged:b})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function Doe(e){eh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Roe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Noe(e){e.clearSnapshot()}function b3(e){e.clearMeasurements()}function joe(e){e.isLayoutDirty=!1}function Loe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function S3(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Ooe(e){e.resolveTargetDelta()}function zoe(e){e.calcProjection()}function Foe(e){e.resetRotation()}function Boe(e){e.removeLeadSnapshot()}function E3(e,t,r){e.translate=ii(t.translate,0,r),e.scale=ii(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function T3(e,t,r,i){e.min=ii(t.min,r.min,i),e.max=ii(t.max,r.max,i)}function Uoe(e,t,r,i){T3(e.x,t.x,r.x,i),T3(e.y,t.y,r.y,i)}function Voe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const $oe={duration:.45,ease:[.4,0,.1,1]},C3=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),M3=C3("applewebkit/")&&!C3("chrome/")?Math.round:mi;function k3(e){e.min=M3(e.min),e.max=M3(e.max)}function Woe(e){k3(e.x),k3(e.y)}function n6(e,t,r){return e==="position"||e==="preserve-aspect"&&!eM(v3(t),v3(r),.2)}const Goe=r6({attachResizeListener:(e,t)=>oc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),dT={current:void 0},i6=r6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!dT.current){const e=new Goe({});e.mount(window),e.setOptions({layoutScroll:!0}),dT.current=e}return dT.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Hoe={pan:{Feature:loe},drag:{Feature:aoe,ProjectionNode:i6,MeasureLayout:KU}},qoe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Zoe(e){const t=qoe.exec(e);if(!t)return[,];const[,r,i]=t;return[r,i]}function iM(e,t,r=1){const[i,a]=Zoe(e);if(!i)return;const u=window.getComputedStyle(t).getPropertyValue(i);if(u){const h=u.trim();return BU(h)?parseFloat(h):h}else return qC(a)?iM(a,t,r+1):a}function Xoe(e,{...t},r){const i=e.current;if(!(i instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(a=>{const u=a.get();if(!qC(u))return;const h=iM(u,i);h&&a.set(h)});for(const a in t){const u=t[a];if(!qC(u))continue;const h=iM(u,i);h&&(t[a]=h,r||(r={}),r[a]===void 0&&(r[a]=u))}return{target:t,transitionEnd:r}}const Yoe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),s6=e=>Yoe.has(e),Koe=e=>Object.keys(e).some(s6),P3=e=>e===Bh||e===Sr,A3=(e,t)=>parseFloat(e.split(", ")[t]),I3=(e,t)=>(r,{transform:i})=>{if(i==="none"||!i)return 0;const a=i.match(/^matrix3d\((.+)\)$/);if(a)return A3(a[1],t);{const u=i.match(/^matrix\((.+)\)$/);return u?A3(u[1],e):0}},Qoe=new Set(["x","y","z"]),Joe=sx.filter(e=>!Qoe.has(e));function eae(e){const t=[];return Joe.forEach(r=>{const i=e.getValue(r);i!==void 0&&(t.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Up={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:I3(4,13),y:I3(5,14)};Up.translateX=Up.x;Up.translateY=Up.y;const tae=(e,t,r)=>{const i=t.measureViewportBox(),a=t.current,u=getComputedStyle(a),{display:h}=u,g={};h==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(_=>{g[_]=Up[_](i,u)}),t.render();const s=t.measureViewportBox();return r.forEach(_=>{const b=t.getValue(_);b&&b.jump(g[_]),e[_]=Up[_](s,u)}),e},rae=(e,t,r={},i={})=>{t={...t},i={...i};const a=Object.keys(t).filter(s6);let u=[],h=!1;const g=[];if(a.forEach(s=>{const _=e.getValue(s);if(!e.hasValue(s))return;let b=r[s],C=uy(b);const M=t[s];let D;if(L1(M)){const N=M.length,j=M[0]===null?1:0;b=M[j],C=uy(b);for(let V=j;V<N&&M[V]!==null;V++)D?O1(uy(M[V])===D):D=uy(M[V])}else D=uy(M);if(C!==D)if(P3(C)&&P3(D)){const N=_.get();typeof N=="string"&&_.set(parseFloat(N)),typeof M=="string"?t[s]=parseFloat(M):Array.isArray(M)&&D===Sr&&(t[s]=M.map(parseFloat))}else C!=null&&C.transform&&(D!=null&&D.transform)&&(b===0||M===0)?b===0?_.set(D.transform(b)):t[s]=C.transform(M):(h||(u=eae(e),h=!0),g.push(s),i[s]=i[s]!==void 0?i[s]:t[s],_.jump(M))}),g.length){const s=g.indexOf("height")>=0?window.pageYOffset:null,_=tae(t,e,g);return u.length&&u.forEach(([b,C])=>{e.getValue(b).set(C)}),e.render(),ib&&s!==null&&window.scrollTo({top:s}),{target:_,transitionEnd:i}}else return{target:t,transitionEnd:i}};function nae(e,t,r,i){return Koe(t)?rae(e,t,r,i):{target:t,transitionEnd:i}}const iae=(e,t,r,i)=>{const a=Xoe(e,t,i);return t=a.target,i=a.transitionEnd,nae(e,t,r,i)},sM={current:null},o6={current:!1};function sae(){if(o6.current=!0,!!ib)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>sM.current=e.matches;e.addListener(t),t()}else sM.current=!1}function oae(e,t,r){const{willChange:i}=t;for(const a in t){const u=t[a],h=r[a];if(co(u))e.addValue(a,u),U1(i)&&i.add(a);else if(co(h))e.addValue(a,Bp(u,{owner:e})),U1(i)&&i.remove(a);else if(h!==u)if(e.hasValue(a)){const g=e.getValue(a);!g.hasAnimated&&g.set(u)}else{const g=e.getStaticValue(a);e.addValue(a,Bp(g!==void 0?g:u,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const D3=new WeakMap,a6=Object.keys(Sv),aae=a6.length,R3=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],lae=CP.length;class cae{constructor({parent:t,props:r,presenceContext:i,reducedMotionConfig:a,visualState:u},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>$n.render(this.render,!1,!0);const{latestValues:g,renderState:s}=u;this.latestValues=g,this.baseTarget={...g},this.initialValues=r.initial?{...g}:{},this.renderState=s,this.parent=t,this.props=r,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=h,this.isControllingVariants=ob(r),this.isVariantNode=GB(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:_,...b}=this.scrapeMotionValuesFromProps(r,{});for(const C in b){const M=b[C];g[C]!==void 0&&co(M)&&(M.set(g[C],!1),U1(_)&&_.add(C))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,D3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),o6.current||sae(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:sM.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){D3.delete(this.current),this.projection&&this.projection.unmount(),wc(this.notifyUpdate),wc(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const i=Fh.has(t),a=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&$n.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),u=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),u()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},i,a,u){let h,g;for(let s=0;s<aae;s++){const _=a6[s],{isEnabled:b,Feature:C,ProjectionNode:M,MeasureLayout:D}=Sv[_];M&&(h=M),b(r)&&(!this.features[_]&&C&&(this.features[_]=new C(this)),D&&(g=D))}if((this.type==="html"||this.type==="svg")&&!this.projection&&h){this.projection=new h(this.latestValues,this.parent&&this.parent.projection);const{layoutId:s,layout:_,drag:b,dragConstraints:C,layoutScroll:M,layoutRoot:D}=r;this.projection.setOptions({layoutId:s,layout:_,alwaysMeasureLayout:!!b||C&&op(C),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof _=="string"?_:"both",initialPromotionConfig:u,layoutScroll:M,layoutRoot:D})}return g}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ti()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<R3.length;i++){const a=R3[i];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const u=t["on"+a];u&&(this.propEventSubscriptions[a]=this.on(a,u))}this.prevMotionValues=oae(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const r={};for(let i=0;i<lae;i++){const a=CP[i],u=this.props[a];(bv(u)||u===!1)&&(r[a]=u)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&r!==void 0&&(i=Bp(r,{owner:this}),this.addValue(t,i)),i}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:i}=this.props,a=typeof i=="string"||typeof i=="object"?(r=RP(this.props,i))===null||r===void 0?void 0:r[t]:void 0;if(i&&a!==void 0)return a;const u=this.getBaseTargetFromProps(this.props,t);return u!==void 0&&!co(u)?u:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new VP),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class l6 extends cae{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:i}){delete r[t],delete i[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...i},{transformValues:a},u){let h=Cse(i,t||{},this);if(a&&(r&&(r=a(r)),i&&(i=a(i)),h&&(h=a(h))),u){Ese(this,i,h);const g=iae(this,i,h,r);r=g.transitionEnd,i=g.target}return{transition:t,transitionEnd:r,...i}}}function uae(e){return window.getComputedStyle(e)}class dae extends l6{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(Fh.has(r)){const i=OP(r);return i&&i.default||0}else{const i=uae(t),a=(YB(r)?i.getPropertyValue(r):i[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return XU(t,r)}build(t,r,i,a){kP(t,r,i,a.transformTemplate)}scrapeMotionValuesFromProps(t,r){return DP(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;co(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,i,a){rU(t,r,i,a)}}class hae extends l6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Fh.has(r)){const i=OP(r);return i&&i.default||0}return r=nU.has(r)?r:EP(r),t.getAttribute(r)}measureInstanceViewportBox(){return Ti()}scrapeMotionValuesFromProps(t,r){return sU(t,r)}build(t,r,i,a){AP(t,r,i,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,i,a){iU(t,r,i,a)}mount(t){this.isSVGTag=IP(t.tagName),super.mount(t)}}const fae=(e,t)=>MP(e)?new hae(t,{enableHardwareAcceleration:!1}):new dae(t,{enableHardwareAcceleration:!0}),pae={layout:{ProjectionNode:i6,MeasureLayout:KU}},mae={...Use,...lie,...Hoe,...pae},Qi=gne((e,t)=>Xne(e,t,mae,fae));function gae(){const{vouchers:e,refreshVouchers:t,loading:r}=ca();Hi();const[i,a]=A.useState([]),[u,h]=A.useState(!1);return A.useEffect(()=>{const g=new Date,s=e.filter(_=>_.isActive&&new Date(_.startDate)<=g&&new Date(_.endDate)>=g);a(s)},[e]),A.useEffect(()=>{(async()=>{h(!0);try{await t()}catch(s){console.error("Error loading vouchers:",s)}finally{h(!1)}})()},[]),u||r?m.jsx("section",{className:"py-8 md:py-12",children:m.jsxs("div",{className:"container-custom mx-auto px-4 sm:px-6",children:[m.jsxs("div",{className:"mb-6 md:mb-8 text-center",children:[m.jsx("h2",{className:"text-2xl md:text-3xl font-display font-semibold mb-2",children:"Special Offers"}),m.jsx("p",{className:"text-muted-foreground",children:"Loading vouchers..."})]}),m.jsxs("div",{className:"flex justify-center items-center py-12",children:[m.jsx(_s,{className:"h-8 w-8 animate-spin text-primary mr-2"}),m.jsx("p",{children:"Loading vouchers..."})]})]})}):i.length===0?null:m.jsxs("section",{className:"py-12 bg-gradient-to-r from-primary/5 via-primary/10 to-primary/5 relative overflow-hidden",children:[m.jsxs("div",{className:"absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none",children:[m.jsx("div",{className:"absolute -top-10 -left-10 w-40 h-40 rounded-full bg-primary/20"}),m.jsx("div",{className:"absolute top-1/4 right-10 w-20 h-20 rounded-full bg-primary/30"}),m.jsx("div",{className:"absolute bottom-10 left-1/4 w-24 h-24 rounded-full bg-primary/25"})]}),m.jsxs("div",{className:"container-custom mx-auto px-4 sm:px-6 relative z-10",children:[m.jsxs(Qi.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"mb-8 md:mb-10 text-center",children:[m.jsxs("div",{className:"flex items-center justify-center mb-3",children:[m.jsx(Qi.div,{whileHover:{rotate:15},transition:{duration:.2},children:m.jsx(kz,{className:"h-8 w-8 text-primary mr-3"})}),m.jsx("h2",{className:"text-2xl md:text-3xl font-display font-semibold",children:"Special Offers & Vouchers"})]}),m.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Take advantage of these limited-time offers and save on your next order."})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.slice(0,3).map((g,s)=>m.jsx(Qi.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.3,delay:s*.1},viewport:{once:!0},whileHover:{y:-5,boxShadow:"0 10px 25px rgba(0,0,0,0.1)",transition:{duration:.2}},children:m.jsx(UB,{voucher:g,onRedeem:void 0})},g.id))}),i.length>3&&m.jsx(Qi.div,{className:"mt-10 text-center",initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.5},viewport:{once:!0},children:m.jsx(Et,{asChild:!0,className:"group",children:m.jsxs("a",{href:"/vouchers",className:"flex items-center",children:["View All Vouchers",m.jsx(wz,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})})]})]})}var c6={exports:{}};(function(e,t){var r={};(function(i,a){e.exports=a()})(Gf,function(){var i,a,u;function h(s,_){if(!i)i=_;else if(!a)a=_;else{var b="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",C={};i(C),u=_(C),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(u.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}h(["exports"],function(s){var _=typeof self<"u"?self:{},b="2.15.0";let C;const M={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(C==null){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{C=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):o}catch{C=o}}return C},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!M.API_URL)return null;try{const o=new URL(M.API_URL);return o.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":o.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},D={supported:!1,testSupport:function(o){!V&&j&&(B?z(o):N=o)}};let N,j,V=!1,B=!1;function z(o){const n=o.createTexture();o.bindTexture(o.TEXTURE_2D,n);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,j),o.isContextLost())return;D.supported=!0}catch{}o.deleteTexture(n),V=!0}_.document&&(j=_.document.createElement("img"),j.onload=function(){N&&z(N),N=null,B=!0},j.onerror=function(){V=!0,N=null},j.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const U="01";function Z(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Q=re;function re(o,n,l,d){this.cx=3*o,this.bx=3*(l-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=n,this.p2x=l,this.p2y=d}re.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,n){if(n===void 0&&(n=1e-6),o<0)return 0;if(o>1)return 1;for(var l=o,d=0;d<8;d++){var p=this.sampleCurveX(l)-o;if(Math.abs(p)<n)return l;var v=this.sampleCurveDerivativeX(l);if(Math.abs(v)<1e-6)break;l-=p/v}var w=0,E=1;for(l=o,d=0;d<20&&(p=this.sampleCurveX(l),!(Math.abs(p-o)<n));d++)o>p?w=l:E=l,l=.5*(E-w)+w;return l},solve:function(o,n){return this.sampleCurveY(this.solveCurveX(o,n))}};var oe=Z(Q),pe=ve;function ve(o,n){this.x=o,this.y=n}ve.prototype={clone:function(){return new ve(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,n){return this.clone()._rotateAround(o,n)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var n=o.x-this.x,l=o.y-this.y;return n*n+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,n){return Math.atan2(this.x*n-this.y*o,this.x*o+this.y*n)},_matMult:function(o){var n=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=n,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var n=Math.cos(o),l=Math.sin(o),d=l*this.x+n*this.y;return this.x=n*this.x-l*this.y,this.y=d,this},_rotateAround:function(o,n){var l=Math.cos(o),d=Math.sin(o),p=n.y+d*(this.x-n.x)+l*(this.y-n.y);return this.x=n.x+l*(this.x-n.x)-d*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ve.convert=function(o){return o instanceof ve?o:Array.isArray(o)?new ve(o[0],o[1]):o};var he=Z(pe);const Ke=Math.PI/180,qe=180/Math.PI;function Ie(o){return o*Ke}function rt(o){return o*qe}const Pt=[[0,0],[1,0],[1,1],[0,1]];function it(o){if(o<=0)return 0;if(o>=1)return 1;const n=o*o,l=n*o;return 4*(o<.5?l:3*(o-n)+l-.75)}function Je(o,n,l,d){const p=new oe(o,n,l,d);return function(v){return p.solve(v)}}const Te=Je(.25,.1,.25,1);function Re(o,n,l){return Math.min(l,Math.max(n,o))}function Tt(o,n,l){return(l=Re((l-o)/(n-o),0,1))*l*(3-2*l)}function Ge(o,n,l){const d=l-n,p=((o-n)%d+d)%d+n;return p===n?l:p}function wt(o,n,l){if(!o.length)return l(null,[]);let d=o.length;const p=new Array(o.length);let v=null;o.forEach((w,E)=>{n(w,(k,P)=>{k&&(v=k),p[E]=P,--d==0&&l(v,p)})})}function ct(o){const n=[];for(const l in o)n.push(o[l]);return n}function dt(o,...n){for(const l of n)for(const d in l)o[d]=l[d];return o}let tr=1;function Bt(){return tr++}function St(){return function o(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function nr(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function cr(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function lr(o,n){o.forEach(l=>{n[l]&&(n[l]=n[l].bind(n))})}function dr(o,n){return o.indexOf(n,o.length-n.length)!==-1}function Ut(o,n,l){const d={};for(const p in o)d[p]=n.call(this,o[p],p,o);return d}function Kr(o,n,l){const d={};for(const p in o)n.call(l||this,o[p],p,o)&&(d[p]=o[p]);return d}function Zr(o){return Array.isArray(o)?o.map(Zr):typeof o=="object"&&o?Ut(o,Zr):o}const vi={};function Ir(o){vi[o]||(typeof console<"u"&&console.warn(o),vi[o]=!0)}function Rn(o,n,l){return(l.y-o.y)*(n.x-o.x)>(n.y-o.y)*(l.x-o.x)}function ke(o){let n=0;for(let l,d,p=0,v=o.length,w=v-1;p<v;w=p++)l=o[p],d=o[w],n+=(d.x-l.x)*(l.y+d.y);return n}function Oe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ze(o){const n={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,p,v)=>{const w=p||v;return n[d]=!w||w.toLowerCase(),""}),n["max-age"]){const l=parseInt(n["max-age"],10);isNaN(l)?delete n["max-age"]:n["max-age"]=l}return n}let Vt=null;function jt(o){if(Vt==null){const n=o.navigator?o.navigator.userAgent:null;Vt=!!o.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Vt}function Ct(o){try{const n=_[o];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}function Qt(o,n){return[o[4*n],o[4*n+1],o[4*n+2],o[4*n+3]]}const fr="mapbox-tiles";let mn=500,At=50,nn,Mn;function qi(){try{return _.caches}catch{}}function bs(){qi()&&!nn&&(nn=_.caches.open(fr))}function ho(o){const n=o.indexOf("?");if(n<0)return o;const l=function(p){const v=p.indexOf("?");return v>0?p.slice(v+1).split("&"):[]}(o),d=l.filter(p=>{const v=p.split("=");return v[0]==="language"||v[0]==="worldview"});return d.length?`${o.slice(0,n)}?${d.join("&")}`:o.slice(0,n)}let fo=1/0;const po={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(po);class Zi extends Error{constructor(n,l,d){l===401&&Le(d)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Li=Oe()?()=>self.worker&&self.worker.referrer:()=>(_.location.protocol==="blob:"?_.parent:_).location.href,ha=function(o,n){if(!(/^file:/.test(l=o.url)||/^file:/.test(Li())&&!/^\w+:/.test(l))){if(_.fetch&&_.Request&&_.AbortController&&_.Request.prototype.hasOwnProperty("signal"))return function(d,p){const v=new _.AbortController,w=new _.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:Li(),referrerPolicy:d.referrerPolicy,signal:v.signal});let E=!1,k=!1;const P=(L=w.url).indexOf("sku=")>0&&Le(L);var L;d.type==="json"&&w.headers.set("Accept","application/json");const F=(H,q,K)=>{if(k)return;if(H&&H.message!=="SecurityError"&&Ir(H.toString()),q&&K)return $(q);const ne=Date.now();_.fetch(w).then(ue=>{if(ue.ok){const _e=P?ue.clone():null;return $(ue,_e,ne)}return p(new Zi(ue.statusText,ue.status,d.url))}).catch(ue=>{ue.name!=="AbortError"&&p(new Error(`${ue.message} ${d.url}`))})},$=(H,q,K)=>{(d.type==="arrayBuffer"?H.arrayBuffer():d.type==="json"?H.json():H.text()).then(ne=>{k||(q&&K&&function(ue,_e,de){if(bs(),!nn)return;const xe={status:_e.status,statusText:_e.statusText,headers:new _.Headers};_e.headers.forEach((Ve,Fe)=>xe.headers.set(Fe,Ve));const be=Ze(_e.headers.get("Cache-Control")||"");if(be["no-store"])return;be["max-age"]&&xe.headers.set("Expires",new Date(de+1e3*be["max-age"]).toUTCString());const we=xe.headers.get("Expires");we&&(new Date(we).getTime()-de<42e4||function(Ve,Fe){if(Mn===void 0)try{new Response(new ReadableStream),Mn=!0}catch{Mn=!1}Mn?Fe(Ve.body):Ve.blob().then(Fe)}(_e,Ve=>{const Fe=new _.Response(Ve,xe);bs(),nn&&nn.then(Qe=>Qe.put(ho(ue.url),Fe)).catch(Qe=>Ir(Qe.message))}))}(w,q,K),E=!0,p(null,ne,H.headers.get("Cache-Control"),H.headers.get("Expires")))}).catch(ne=>{k||p(new Error(ne.message))})};return P?function(H,q){if(bs(),!nn)return q(null);const K=ho(H.url);nn.then(ne=>{ne.match(K).then(ue=>{const _e=function(de){if(!de)return!1;const xe=new Date(de.headers.get("Expires")||0),be=Ze(de.headers.get("Cache-Control")||"");return xe>Date.now()&&!be["no-cache"]}(ue);ne.delete(K),_e&&ne.put(K,ue.clone()),q(null,ue,_e)}).catch(q)}).catch(q)}(w,F):F(null,null),{cancel:()=>{k=!0,E||v.abort()}}}(o,n);if(Oe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,n,void 0,!0)}var l;return function(d,p){const v=new _.XMLHttpRequest;v.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const w in d.headers)v.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=d.credentials==="include",v.onerror=()=>{p(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let w=v.response;if(d.type==="json")try{w=JSON.parse(v.response)}catch(E){return p(E)}p(null,w,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else p(new Zi(v.statusText,v.status,d.url))},v.send(d.body),{cancel:()=>v.abort()}}(o,n)},vr=function(o,n){return ha(dt(o,{type:"arrayBuffer"}),n)};function sn(o){const n=_.document.createElement("a");return n.href=o,n.protocol===_.document.location.protocol&&n.host===_.document.location.host}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let J,ee;J=[],ee=0;const ye=function(o,n){if(D.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),ee>=M.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:o,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return J.push(v),v}ee++;let l=!1;const d=()=>{if(!l)for(l=!0,ee--;J.length&&ee<M.MAX_PARALLEL_IMAGE_REQUESTS;){const v=J.shift(),{requestParameters:w,callback:E,cancelled:k}=v;k||(v.cancel=ye(w,E).cancel)}},p=vr(o,(v,w,E,k)=>{d(),v?n(v):w&&(_.createImageBitmap?function(P,L){const F=new _.Blob([new Uint8Array(P)],{type:"image/png"});_.createImageBitmap(F).then($=>{L(null,$)}).catch($=>{L(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(P,L)=>n(P,L,E,k)):function(P,L){const F=new _.Image,$=_.URL;F.onload=()=>{L(null,F),$.revokeObjectURL(F.src),F.onload=null,_.requestAnimationFrame(()=>{F.src=me})},F.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new _.Blob([new Uint8Array(P)],{type:"image/png"});F.src=P.byteLength?$.createObjectURL(H):me}(w,(P,L)=>n(P,L,E,k)))});return{cancel:()=>{p.cancel(),d()}}},Se="NO_ACCESS_TOKEN";function Ae(o){return o.indexOf("mapbox:")===0}function Le(o){return M.API_URL_REGEX.test(o)}function je(o){return M.API_CDN_URL_REGEX.test(o)}function Pe(o){return M.API_STYLE_REGEX.test(o)&&!He(o)}function He(o){return M.API_SPRITE_REGEX.test(o)}const bt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Mt(o){const n=o.match(bt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function yt(o){const n=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${n}`}const xr="mapbox.eventData";function Mr(o){if(!o)return null;const n=o.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(_.atob(n[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class _r{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const l=Mr(M.ACCESS_TOKEN);let d="";return d=l&&l.u?_.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(p,v)=>String.fromCharCode(+("0x"+v)))):M.ACCESS_TOKEN||"",n?`${xr}.${n}:${d}`:`${xr}:${d}`}fetchEventData(){const n=Ct("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(n)try{const p=_.localStorage.getItem(l);p&&(this.eventData=JSON.parse(p));const v=_.localStorage.getItem(d);v&&(this.anonId=v)}catch{Ir("Unable to read from LocalStorage")}}saveEventData(){const n=Ct("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(n)try{_.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&_.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{Ir("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,l,d,p){if(!M.EVENTS_URL)return;const v=Mt(M.EVENTS_URL);v.params.push(`access_token=${p||M.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(n).toISOString()},E=l?dt(w,l):w,k={url:yt(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=function(P,L){return ha(dt(P,{method:"POST"}),L)}(k,P=>{this.pendingRequest=null,d(P),this.saveEventData(),this.processRequests(p)})}queueRequest(n,l){this.queue.push(n),this.processRequests(l)}}const kr=new class extends _r{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,n){M.EVENTS_URL&&M.ACCESS_TOKEN&&Array.isArray(o)&&o.some(l=>Ae(l)||Le(l))&&this.queueRequest(Date.now(),n)}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=Mr(M.ACCESS_TOKEN),l=n?n.u:M.ACCESS_TOKEN;let d=l!==this.eventData.tokenU;cr(this.anonId)||(this.anonId=St(),d=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),w=new Date(p),E=(p-this.eventData.lastSuccess)/864e5;d=d||E>=1||E<-1||v.getDate()!==w.getDate()}else d=!0;d?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:U,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=p,this.eventData.tokenU=l)},o):this.processRequests()}},Lr=kr.postTurnstileEvent.bind(kr),An=new class extends _r{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,n,l,d){this.skuToken=n,this.errorCb=d,M.EVENTS_URL&&(l||M.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},l):this.errorCb(new Error(Se)))}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),cr(this.anonId)||(this.anonId=St()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:U,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):n&&(this.success[n]=!0)},o))}},qn=An.postMapLoadEvent.bind(An),Oi=new class extends _r{constructor(){super("gljs.performance")}postPerformanceEvent(o,n){M.EVENTS_URL&&(o||M.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},o)}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:l}=this.queue.shift(),d=function(p){const v=_.performance.getEntriesByType("resource"),w=_.performance.getEntriesByType("mark"),E=function($){const H={};if($){for(const q in $)if(q!=="other")for(const K of $[q]){const ne=`${q}ResolveRangeMin`,ue=`${q}ResolveRangeMax`,_e=`${q}RequestCount`,de=`${q}RequestCachedCount`;H[ne]=Math.min(H[ne]||1/0,K.startTime),H[ue]=Math.max(H[ue]||-1/0,K.responseEnd);const xe=be=>{H[be]===void 0&&(H[be]=0),++H[be]};K.transferSize!==void 0&&K.transferSize===0&&xe(de),xe(_e)}}return H}(function($,H){const q={};if($)for(const K of $){const ne=H(K);q[ne]===void 0&&(q[ne]=[]),q[ne].push(K)}return q}(v,yx)),k=_.devicePixelRatio,P=_.navigator.connection||_.navigator.mozConnection||_.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},F=($,H,q)=>{q!=null&&$.push({name:H,value:q.toString()})};for(const $ in E)F(L.counters,$,E[$]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(F(L.counters,"interactionRangeMin",p.interactionRange[0]),F(L.counters,"interactionRangeMax",p.interactionRange[1])),w)for(const $ of Object.keys(Mc)){const H=Mc[$],q=w.find(K=>K.name===H);q&&F(L.counters,H,q.startTime)}return F(L.counters,"visibilityHidden",p.visibilityHidden),F(L.attributes,"style",function($){if($)for(const H of $){const q=H.name.split("?")[0];if(Pe(q)){const K=q.split("/").slice(-2);if(K.length===2)return`mapbox://styles/${K[0]}/${K[1]}`}}}(v)),F(L.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),F(L.attributes,"fogEnabled",p.fogEnabled?"true":"false"),F(L.attributes,"projection",p.projection),F(L.attributes,"zoom",p.zoom),F(L.metadata,"devicePixelRatio",k),F(L.metadata,"connectionEffectiveType",P?P.effectiveType:void 0),F(L.metadata,"navigatorUserAgent",_.navigator.userAgent),F(L.metadata,"screenWidth",_.screen.width),F(L.metadata,"screenHeight",_.screen.height),F(L.metadata,"windowWidth",_.innerWidth),F(L.metadata,"windowHeight",_.innerHeight),F(L.metadata,"mapWidth",p.width/k),F(L.metadata,"mapHeight",p.height/k),F(L.metadata,"webglRenderer",p.renderer),F(L.metadata,"webglVendor",p.vendor),F(L.metadata,"sdkVersion",b),F(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(l);for(const p of d.metadata);for(const p of d.counters);for(const p of d.attributes);this.postEvent(n,d,()=>{},o)}},ai=Oi.postPerformanceEvent.bind(Oi),zo=new class extends _r{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,n,l,d){if(!M.API_URL||!M.SESSION_PATH)return;const p=Mt(M.API_URL+M.SESSION_PATH);p.params.push(`sku=${n||""}`),p.params.push(`access_token=${d||M.ACCESS_TOKEN||""}`);const v={url:yt(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(w,E){return ha(dt(w,{method:"GET"}),E)}(v,w=>{this.pendingRequest=null,l(w),this.saveEventData(),this.processRequests(d)})}getSessionAPI(o,n,l,d){this.skuToken=n,this.errorCb=d,M.SESSION_PATH&&M.API_URL&&(l||M.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},l):this.errorCb(new Error(Se)))}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||this.getSession(l,this.skuToken,d=>{d?this.errorCb(d):n&&(this.success[n]=!0)},o)}},xi=zo.getSessionAPI.bind(zo),Xi=new Set,Mc={create:"create",load:"load",fullLoad:"fullLoad"},Eb={mark(o){_.performance.mark(o)},measure(o,n,l){_.performance.measure(o,n,l)}};function yx(o){const n=o.name.split("?")[0];return je(n)&&n.includes("mapbox-gl.js")?"javascript":je(n)&&n.includes("mapbox-gl.css")?"css":function(l){return M.API_FONTS_REGEX.test(l)}(n)?"fontRange":He(n)?"sprite":Pe(n)?"style":function(l){return M.API_TILEJSON_REGEX.test(l)}(n)?"tilejson":"other"}const Xr=_.performance;function xm(o){const n=o?o.url.toString():void 0;return Xr.getEntriesByName(n)}let od,_m,Uh,Fo;const fa={now:()=>Uh!==void 0?Uh:_.performance.now(),setNow(o){Uh=o},restoreNow(){Uh=void 0},frame(o){const n=_.requestAnimationFrame(o);return{cancel:()=>_.cancelAnimationFrame(n)}},getImageData(o,n=0){const{width:l,height:d}=o;Fo||(Fo=_.document.createElement("canvas"));const p=Fo.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Fo.width||d>Fo.height)&&(Fo.width=l,Fo.height=d),p.clearRect(-n,-n,l+2*n,d+2*n),p.drawImage(o,0,0,l,d),p.getImageData(-n,-n,l+2*n,d+2*n)},resolveURL:o=>(od||(od=_.document.createElement("a")),od.href=o,od.href),get devicePixelRatio(){return _.devicePixelRatio},get prefersReducedMotion(){return!!_.matchMedia&&(_m==null&&(_m=_.matchMedia("(prefers-reduced-motion: reduce)")),_m.matches)}};function wm(o,n,l){l[o]&&l[o].indexOf(n)!==-1||(l[o]=l[o]||[],l[o].push(n))}function bm(o,n,l){if(l&&l[o]){const d=l[o].indexOf(n);d!==-1&&l[o].splice(d,1)}}class Dl{constructor(n,l={}){dt(this,l),this.type=n}}class pa extends Dl{constructor(n,l={}){super("error",dt({error:n},l))}}class ad{on(n,l){return this._listeners=this._listeners||{},wm(n,l,this._listeners),this}off(n,l){return bm(n,l,this._listeners),bm(n,l,this._oneTimeListeners),this}once(n,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},wm(n,l,this._oneTimeListeners),this):new Promise(d=>this.once(n,d))}fire(n,l){typeof n=="string"&&(n=new Dl(n,l||{}));const d=n.type;if(this.listens(d)){n.target=this;const p=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const E of p)E.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const E of v)bm(d,E,this._oneTimeListeners),E.call(this,n);const w=this._eventedParent;w&&(dt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(n))}else n instanceof pa&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,l){return this._eventedParent=n,this._eventedParentData=l,this}}var Ye=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ma(o,...n){for(const l of n)for(const d in l)o[d]=l[d];return o}function Zn(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function _i(o){if(Array.isArray(o))return o.map(_i);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const n={};for(const l in o)n[l]=_i(o[l]);return n}return Zn(o)}class vx extends Error{constructor(n,l){super(l),this.message=l,this.key=n}}var Bo=vx;class Sm{constructor(n,l=[]){this.parent=n,this.bindings={};for(const[d,p]of l)this.bindings[d]=p}concat(n){return new Sm(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}var xx=Sm;const kc={kind:"null"},zt={kind:"number"},jr={kind:"string"},Dr={kind:"boolean"},Ss={kind:"color"},mo={kind:"object"},Rr={kind:"value"},Es={kind:"collator"},ld={kind:"formatted"},Rl={kind:"resolvedImage"};function Us(o,n){return{kind:"array",itemType:o,N:n}}function kn(o){if(o.kind==="array"){const n=kn(o.itemType);return typeof o.N=="number"?`array<${n}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${n}>`}return o.kind}const _x=[kc,zt,jr,Dr,Ss,ld,mo,Us(Rr),Rl];function ga(o,n){if(n.kind==="error")return null;if(o.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ga(o.itemType,n.itemType))&&(typeof o.N!="number"||o.N===n.N))return null}else{if(o.kind===n.kind)return null;if(o.kind==="value"){for(const l of _x)if(!ga(l,n))return null}}return`Expected ${kn(o)} but found ${kn(n)} instead.`}function cd(o,n){return n.some(l=>l.kind===o.kind)}function ud(o,n){return n.some(l=>l==="null"?o===null:l==="array"?Array.isArray(o):l==="object"?o&&!Array.isArray(o)&&typeof o=="object":l===typeof o)}var Em,wx={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function dd(o){return(o=Math.round(o))<0?0:o>255?255:o}function hd(o){return dd(o[o.length-1]==="%"?parseFloat(o)/100*255:parseInt(o))}function Vh(o){return(n=o[o.length-1]==="%"?parseFloat(o)/100:parseFloat(o))<0?0:n>1?1:n;var n}function Pc(o,n,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?o+(n-o)*l*6:2*l<1?n:3*l<2?o+(n-o)*(2/3-l)*6:o}try{Em={}.parseCSSColor=function(o){var n,l=o.replace(/ /g,"").toLowerCase();if(l in wx)return wx[l].slice();if(l[0]==="#")return l.length===4?(n=parseInt(l.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:l.length===7&&(n=parseInt(l.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var d=l.indexOf("("),p=l.indexOf(")");if(d!==-1&&p+1===l.length){var v=l.substr(0,d),w=l.substr(d+1,p-(d+1)).split(","),E=1;switch(v){case"rgba":if(w.length!==4)return null;E=Vh(w.pop());case"rgb":return w.length!==3?null:[hd(w[0]),hd(w[1]),hd(w[2]),E];case"hsla":if(w.length!==4)return null;E=Vh(w.pop());case"hsl":if(w.length!==3)return null;var k=(parseFloat(w[0])%360+360)%360/360,P=Vh(w[1]),L=Vh(w[2]),F=L<=.5?L*(P+1):L+P-L*P,$=2*L-F;return[dd(255*Pc($,F,k+1/3)),dd(255*Pc($,F,k)),dd(255*Pc($,F,k-1/3)),E];default:return null}}return null}}catch{}class rs{constructor(n,l,d,p=1){this.r=n,this.g=l,this.b=d,this.a=p}static parse(n){if(!n)return;if(n instanceof rs)return n;if(typeof n!="string")return;const l=Em(n);return l?new rs(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[n,l,d,p]=this.toArray();return`rgba(${Math.round(n)},${Math.round(l)},${Math.round(d)},${p})`}toArray(){const{r:n,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[255*n/p,255*l/p,255*d/p,p]}toArray01(){const{r:n,g:l,b:d,a:p}=this;return p===0?[0,0,0,0]:[n/p,l/p,d/p,p]}toArray01PremultipliedAlpha(){const{r:n,g:l,b:d,a:p}=this;return[n,l,d,p]}}rs.black=new rs(0,0,0,1),rs.white=new rs(1,1,1,1),rs.transparent=new rs(0,0,0,0),rs.red=new rs(1,0,0,1),rs.blue=new rs(0,0,1,1);var Wn=rs;class Tm{constructor(n,l,d){this.sensitivity=n?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,l){return this.collator.compare(n,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Cm{constructor(n,l,d,p,v){this.text=n.normalize?n.normalize():n,this.image=l,this.scale=d,this.fontStack=p,this.textColor=v}}class ns{constructor(n){this.sections=n}static fromString(n){return new ns([new Cm(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof ns?n:ns.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const l of this.sections){if(l.image){n.push(["image",l.image.name]);continue}n.push(l.text);const d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toArray())),n.push(d)}return n}}class Vs{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Vs({name:n,available:!1}):null}serialize(){return["image",this.name]}}function bx(o,n,l,d){return typeof o=="number"&&o>=0&&o<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof l=="number"&&l>=0&&l<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[o,n,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[o,n,l,d]:[o,n,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fd(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Wn||o instanceof Tm||o instanceof ns||o instanceof Vs)return!0;if(Array.isArray(o)){for(const n of o)if(!fd(n))return!1;return!0}if(typeof o=="object"){for(const n in o)if(!fd(o[n]))return!1;return!0}return!1}function zn(o){if(o===null)return kc;if(typeof o=="string")return jr;if(typeof o=="boolean")return Dr;if(typeof o=="number")return zt;if(o instanceof Wn)return Ss;if(o instanceof Tm)return Es;if(o instanceof ns)return ld;if(o instanceof Vs)return Rl;if(Array.isArray(o)){const n=o.length;let l;for(const d of o){const p=zn(d);if(l){if(l===p)continue;l=Rr;break}l=p}return Us(l||Rr,n)}return mo}function pd(o){const n=typeof o;return o===null?"":n==="string"||n==="number"||n==="boolean"?String(o):o instanceof Wn||o instanceof ns||o instanceof Vs?o.toString():JSON.stringify(o)}class Mm{constructor(n,l){this.type=n,this.value=l}static parse(n,l){if(n.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!fd(n[1]))return l.error("invalid value");const d=n[1];let p=zn(d);const v=l.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new Mm(p,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Wn?["rgba"].concat(this.value.toArray()):this.value instanceof ns?this.value.serialize():this.value}}var Nl=Mm,ki=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const km={string:jr,number:zt,boolean:Dr,object:mo};class Pm{constructor(n,l){this.type=n,this.args=l}static parse(n,l){if(n.length<2)return l.error("Expected at least one argument.");let d,p=1;const v=n[0];if(v==="array"){let E,k;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in km)||P==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);E=km[P],p++}else E=Rr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return l.error('The length argument to "array" must be a positive integer literal',2);k=n[2],p++}d=Us(E,k)}else d=km[v];const w=[];for(;p<n.length;p++){const E=l.parse(n[p],p,Rr);if(!E)return null;w.push(E)}return new Pm(d,w)}evaluate(n){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(n);if(!ga(this.type,zn(d)))return d;if(l===this.args.length-1)throw new ki(`Expected value to be of type ${kn(this.type)}, but found ${kn(zn(d))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,l=[n.kind];if(n.kind==="array"){const d=n.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){l.push(d.kind);const p=n.N;(typeof p=="number"||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(d=>d.serialize()))}}var ya=Pm;class Qa{constructor(n){this.type=ld,this.sections=n}static parse(n,l){if(n.length<2)return l.error("Expected at least one argument.");const d=n[1];if(!Array.isArray(d)&&typeof d=="object")return l.error("First argument must be an image or text section.");const p=[];let v=!1;for(let w=1;w<=n.length-1;++w){const E=n[w];if(v&&typeof E=="object"&&!Array.isArray(E)){v=!1;let k=null;if(E["font-scale"]&&(k=l.parse(E["font-scale"],1,zt),!k))return null;let P=null;if(E["text-font"]&&(P=l.parse(E["text-font"],1,Us(jr)),!P))return null;let L=null;if(E["text-color"]&&(L=l.parse(E["text-color"],1,Ss),!L))return null;const F=p[p.length-1];F.scale=k,F.font=P,F.textColor=L}else{const k=l.parse(n[w],1,Rr);if(!k)return null;const P=k.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:k,scale:null,font:null,textColor:null})}}return new Qa(p)}evaluate(n){return new ns(this.sections.map(l=>{const d=l.content.evaluate(n);return zn(d)===Rl?new Cm("",d,null,null,null):new Cm(pd(d),null,l.scale?l.scale.evaluate(n):null,l.font?l.font.evaluate(n).join(","):null,l.textColor?l.textColor.evaluate(n):null)}))}eachChild(n){for(const l of this.sections)n(l.content),l.scale&&n(l.scale),l.font&&n(l.font),l.textColor&&n(l.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const l of this.sections){n.push(l.content.serialize());const d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),n.push(d)}return n}}class $h{constructor(n){this.type=Rl,this.input=n}static parse(n,l){if(n.length!==2)return l.error("Expected two arguments.");const d=l.parse(n[1],1,jr);return d?new $h(d):l.error("No image name provided.")}evaluate(n){const l=this.input.evaluate(n),d=Vs.fromString(l);return d&&n.availableImages&&(d.available=n.availableImages.indexOf(l)>-1),d}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Tb={"to-boolean":Dr,"to-color":Ss,"to-number":zt,"to-string":jr};class Am{constructor(n,l){this.type=n,this.args=l}static parse(n,l){if(n.length<2)return l.error("Expected at least one argument.");const d=n[0];if((d==="to-boolean"||d==="to-string")&&n.length!==2)return l.error("Expected one argument.");const p=Tb[d],v=[];for(let w=1;w<n.length;w++){const E=l.parse(n[w],w,Rr);if(!E)return null;v.push(E)}return new Am(p,v)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let l,d;for(const p of this.args){if(l=p.evaluate(n),d=null,l instanceof Wn)return l;if(typeof l=="string"){const v=n.parseColor(l);if(v)return v}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:bx(l[0],l[1],l[2],l[3]),!d))return new Wn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new ki(d||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const d of this.args){if(l=d.evaluate(n),l===null)return 0;const p=Number(l);if(!isNaN(p))return p}throw new ki(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?ns.fromString(pd(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Vs.fromString(pd(this.args[0].evaluate(n))):pd(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $h(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild(l=>{n.push(l.serialize())}),n}}var Ac=Am;const Uo=["Unknown","Point","LineString","Polygon"];var Im=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Uo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:l,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*n-o[0])+this.featureDistanceData.bearing[1]*(d*n-o[1])}return 0}parseColor(o){let n=this._parseColorCache[o];return n||(n=this._parseColorCache[o]=Wn.parse(o)),n}};class jl{constructor(n,l,d,p){this.name=n,this.type=l,this._evaluate=d,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,l){const d=n[0],p=jl.definitions[d];if(!p)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,w=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=w.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let k=null;for(const[P,L]of E){k=new Om(l.registry,l.path,null,l.scope);const F=[];let $=!1;for(let H=1;H<n.length;H++){const q=n[H],K=Array.isArray(P)?P[H-1]:P.type,ne=k.parse(q,1+F.length,K);if(!ne){$=!0;break}F.push(ne)}if(!$)if(Array.isArray(P)&&P.length!==F.length)k.error(`Expected ${P.length} arguments, but found ${F.length} instead.`);else{for(let H=0;H<F.length;H++){const q=Array.isArray(P)?P[H]:P.type,K=F[H];k.concat(H+1).checkSubtype(q,K.type)}if(k.errors.length===0)return new jl(d,v,L,F)}}if(E.length===1)l.errors.push(...k.errors);else{const P=(E.length?E:w).map(([F])=>{return $=F,Array.isArray($)?`(${$.map(kn).join(", ")})`:`(${kn($.type)}...)`;var $}).join(" | "),L=[];for(let F=1;F<n.length;F++){const $=l.parse(n[F],1+L.length);if(!$)return null;L.push(kn($.type))}l.error(`Expected arguments of type ${P}, but found (${L.join(", ")}) instead.`)}return null}static register(n,l){jl.definitions=l;for(const d in l)n[d]=jl}}var va=jl;class md{constructor(n,l,d){this.type=Es,this.locale=d,this.caseSensitive=n,this.diacriticSensitive=l}static parse(n,l){if(n.length!==2)return l.error("Expected one argument.");const d=n[1];if(typeof d!="object"||Array.isArray(d))return l.error("Collator options argument must be an object.");const p=l.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Dr);if(!p)return null;const v=l.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Dr);if(!v)return null;let w=null;return d.locale&&(w=l.parse(d.locale,1,jr),!w)?null:new md(p,v,w)}evaluate(n){return new Tm(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const xa=8192;function Wh(o,n){o[0]=Math.min(o[0],n[0]),o[1]=Math.min(o[1],n[1]),o[2]=Math.max(o[2],n[0]),o[3]=Math.max(o[3],n[1])}function Ic(o,n){return!(o[0]<=n[0]||o[2]>=n[2]||o[1]<=n[1]||o[3]>=n[3])}function gd(o,n){const l=(180+o[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(l*p*xa),Math.round(d*p*xa)]}function Sx(o,n,l){const d=o[0]-n[0],p=o[1]-n[1],v=o[0]-l[0],w=o[1]-l[1];return d*w-v*p==0&&d*v<=0&&p*w<=0}function Gh(o,n){let l=!1;for(let w=0,E=n.length;w<E;w++){const k=n[w];for(let P=0,L=k.length;P<L-1;P++){if(Sx(o,k[P],k[P+1]))return!1;(p=k[P])[1]>(d=o)[1]!=(v=k[P+1])[1]>d[1]&&d[0]<(v[0]-p[0])*(d[1]-p[1])/(v[1]-p[1])+p[0]&&(l=!l)}}var d,p,v;return l}function Dm(o,n){for(let l=0;l<n.length;l++)if(Gh(o,n[l]))return!0;return!1}function Rm(o,n,l,d){const p=d[0]-l[0],v=d[1]-l[1],w=(o[0]-l[0])*v-p*(o[1]-l[1]),E=(n[0]-l[0])*v-p*(n[1]-l[1]);return w>0&&E<0||w<0&&E>0}function Dc(o,n,l){for(const P of l)for(let L=0;L<P.length-1;++L)if((E=[(w=P[L+1])[0]-(v=P[L])[0],w[1]-v[1]])[0]*(k=[(p=n)[0]-(d=o)[0],p[1]-d[1]])[1]-E[1]*k[0]!=0&&Rm(d,p,v,w)&&Rm(v,w,d,p))return!0;var d,p,v,w,E,k;return!1}function Yr(o,n){for(let l=0;l<o.length;++l)if(!Gh(o[l],n))return!1;for(let l=0;l<o.length-1;++l)if(Dc(o[l],o[l+1],n))return!1;return!0}function Cb(o,n){for(let l=0;l<n.length;l++)if(Yr(o,n[l]))return!0;return!1}function Nm(o,n,l){const d=[];for(let p=0;p<o.length;p++){const v=[];for(let w=0;w<o[p].length;w++){const E=gd(o[p][w],l);Wh(n,E),v.push(E)}d.push(v)}return d}function Ex(o,n,l){const d=[];for(let p=0;p<o.length;p++){const v=Nm(o[p],n,l);d.push(v)}return d}function jm(o,n,l,d){if(o[0]<l[0]||o[0]>l[2]){const p=.5*d;let v=o[0]-l[0]>p?-d:l[0]-o[0]>p?d:0;v===0&&(v=o[0]-l[2]>p?-d:l[2]-o[0]>p?d:0),o[0]+=v}Wh(n,o)}function Tx(o,n,l,d){const p=Math.pow(2,d.z)*xa,v=[d.x*xa,d.y*xa],w=[];if(!o)return w;for(const E of o)for(const k of E){const P=[k.x+v[0],k.y+v[1]];jm(P,n,l,p),w.push(P)}return w}function Lm(o,n,l,d){const p=Math.pow(2,d.z)*xa,v=[d.x*xa,d.y*xa],w=[];if(!o)return w;for(const k of o){const P=[];for(const L of k){const F=[L.x+v[0],L.y+v[1]];Wh(n,F),P.push(F)}w.push(P)}if(n[2]-n[0]<=p/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const k of w)for(const P of k)jm(P,n,l,p)}var E;return w}class Rc{constructor(n,l){this.type=Dr,this.geojson=n,this.geometries=l}static parse(n,l){if(n.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(fd(n[1])){const d=n[1];if(d.type==="FeatureCollection")for(let p=0;p<d.features.length;++p){const v=d.features[p].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Rc(d,d.features[p].geometry)}else if(d.type==="Feature"){const p=d.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Rc(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Rc(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(l,d){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const E=Nm(d.coordinates,v,w),k=Tx(l.geometry(),p,v,w);if(!Ic(p,v))return!1;for(const P of k)if(!Gh(P,E))return!1}if(d.type==="MultiPolygon"){const E=Ex(d.coordinates,v,w),k=Tx(l.geometry(),p,v,w);if(!Ic(p,v))return!1;for(const P of k)if(!Dm(P,E))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(l,d){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const E=Nm(d.coordinates,v,w),k=Lm(l.geometry(),p,v,w);if(!Ic(p,v))return!1;for(const P of k)if(!Yr(P,E))return!1}if(d.type==="MultiPolygon"){const E=Ex(d.coordinates,v,w),k=Lm(l.geometry(),p,v,w);if(!Ic(p,v))return!1;for(const P of k)if(!Cb(P,E))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Hh=Rc;function Nc(o){if(o instanceof va&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Hh)return!1;let n=!0;return o.eachChild(l=>{n&&!Nc(l)&&(n=!1)}),n}function _a(o){if(o instanceof va&&o.name==="feature-state")return!1;let n=!0;return o.eachChild(l=>{n&&!_a(l)&&(n=!1)}),n}function Ll(o,n){if(o instanceof va&&n.indexOf(o.name)>=0)return!1;let l=!0;return o.eachChild(d=>{l&&!Ll(d,n)&&(l=!1)}),l}class qh{constructor(n,l){this.type=l.type,this.name=n,this.boundExpression=l}static parse(n,l){if(n.length!==2||typeof n[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const d=n[1];return l.scope.has(d)?new qh(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Cx=qh;class yd{constructor(n,l=[],d,p=new xx,v=[]){this.registry=n,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=p,this.errors=v,this.expectedType=d}parse(n,l,d,p,v={}){return l?this.concat(l,d,p)._parse(n,v):this._parse(n,v)}_parse(n,l){function d(p,v,w){return w==="assert"?new ya(v,[p]):w==="coerce"?new Ac(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let w=v.parse(n,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,k=w.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||k.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(E,k))return null}else w=d(w,E,l.typeAnnotation||"coerce");else w=d(w,E,l.typeAnnotation||"assert")}if(!(w instanceof Nl)&&w.type.kind!=="resolvedImage"&&zm(w)){const E=new Im;try{w=new Nl(w.type,w.evaluate(E))}catch(k){return this.error(k.message),null}}return w}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,l,d){const p=typeof n=="number"?this.path.concat(n):this.path,v=d?this.scope.concat(d):this.scope;return new yd(this.registry,p,l||null,v,this.errors)}error(n,...l){const d=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new Bo(d,n))}checkSubtype(n,l){const d=ga(n,l);return d&&this.error(d),d}}var Om=yd;function zm(o){if(o instanceof Cx)return zm(o.boundExpression);if(o instanceof va&&o.name==="error"||o instanceof md||o instanceof Hh)return!1;const n=o instanceof Ac||o instanceof ya;let l=!0;return o.eachChild(d=>{l=n?l&&zm(d):l&&d instanceof Nl}),!!l&&Nc(o)&&Ll(o,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Zh(o,n){const l=o.length-1;let d,p,v=0,w=l,E=0;for(;v<=w;)if(E=Math.floor((v+w)/2),d=o[E],p=o[E+1],d<=n){if(E===l||n<p)return E;v=E+1}else{if(!(d>n))throw new ki("Input is not a number.");w=E-1}return 0}class Xh{constructor(n,l,d){this.type=n,this.input=l,this.labels=[],this.outputs=[];for(const[p,v]of d)this.labels.push(p),this.outputs.push(v)}static parse(n,l){if(n.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(n[1],1,zt);if(!d)return null;const p=[];let v=null;l.expectedType&&l.expectedType.kind!=="value"&&(v=l.expectedType);for(let w=1;w<n.length;w+=2){const E=w===1?-1/0:n[w],k=n[w+1],P=w,L=w+1;if(typeof E!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const F=l.parse(k,L,v);if(!F)return null;v=v||F.type,p.push([E,F])}return new Xh(v,d,p)}evaluate(n){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(n);const p=this.input.evaluate(n);if(p<=l[0])return d[0].evaluate(n);const v=l.length;return p>=l[v-1]?d[v-1].evaluate(n):d[Zh(l,p)].evaluate(n)}eachChild(n){n(this.input);for(const l of this.outputs)n(l)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&n.push(this.labels[l]),n.push(this.outputs[l].serialize());return n}}var Fm=Xh;function Ur(o,n,l){return o*(1-l)+n*l}var vd=Object.freeze({__proto__:null,array:function(o,n,l){return o.map((d,p)=>Ur(d,n[p],l))},color:function(o,n,l){return new Wn(Ur(o.r,n.r,l),Ur(o.g,n.g,l),Ur(o.b,n.b,l),Ur(o.a,n.a,l))},number:Ur});const Mx=.95047,Bm=1.08883,kx=4/29,Ol=6/29,Um=3*Ol*Ol,Mb=Ol*Ol*Ol,kb=Math.PI/180,Pb=180/Math.PI;function Vm(o){return o>Mb?Math.pow(o,1/3):o/Um+kx}function $m(o){return o>Ol?o*o*o:Um*(o-kx)}function Wm(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function Yh(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Px(o){const n=Yh(o.r),l=Yh(o.g),d=Yh(o.b),p=Vm((.4124564*n+.3575761*l+.1804375*d)/Mx),v=Vm((.2126729*n+.7151522*l+.072175*d)/1);return{l:116*v-16,a:500*(p-v),b:200*(v-Vm((.0193339*n+.119192*l+.9503041*d)/Bm)),alpha:o.a}}function Ax(o){let n=(o.l+16)/116,l=isNaN(o.a)?n:n+o.a/500,d=isNaN(o.b)?n:n-o.b/200;return n=1*$m(n),l=Mx*$m(l),d=Bm*$m(d),new Wn(Wm(3.2404542*l-1.5371385*n-.4985314*d),Wm(-.969266*l+1.8760108*n+.041556*d),Wm(.0556434*l-.2040259*n+1.0572252*d),o.alpha)}function Ab(o,n,l){const d=n-o;return o+l*(d>180||d<-180?d-360*Math.round(d/360):d)}const xd={forward:Px,reverse:Ax,interpolate:function(o,n,l){return{l:Ur(o.l,n.l,l),a:Ur(o.a,n.a,l),b:Ur(o.b,n.b,l),alpha:Ur(o.alpha,n.alpha,l)}}},jc={forward:function(o){const{l:n,a:l,b:d}=Px(o),p=Math.atan2(d,l)*Pb;return{h:p<0?p+360:p,c:Math.sqrt(l*l+d*d),l:n,alpha:o.a}},reverse:function(o){const n=o.h*kb,l=o.c;return Ax({l:o.l,a:Math.cos(n)*l,b:Math.sin(n)*l,alpha:o.alpha})},interpolate:function(o,n,l){return{h:Ab(o.h,n.h,l),c:Ur(o.c,n.c,l),l:Ur(o.l,n.l,l),alpha:Ur(o.alpha,n.alpha,l)}}};var Gm=Object.freeze({__proto__:null,hcl:jc,lab:xd});class _d{constructor(n,l,d,p,v){this.type=n,this.operator=l,this.interpolation=d,this.input=p,this.labels=[],this.outputs=[];for(const[w,E]of v)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(n,l,d,p){let v=0;if(n.name==="exponential")v=Hm(l,n.base,d,p);else if(n.name==="linear")v=Hm(l,1,d,p);else if(n.name==="cubic-bezier"){const w=n.controlPoints;v=new oe(w[0],w[1],w[2],w[3]).solve(Hm(l,1,d,p))}return v}static parse(n,l){let[d,p,v,...w]=n;if(!Array.isArray(p)||p.length===0)return l.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some(L=>typeof L!="number"||L<0||L>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(v=l.parse(v,2,zt),!v)return null;const E=[];let k=null;d==="interpolate-hcl"||d==="interpolate-lab"?k=Ss:l.expectedType&&l.expectedType.kind!=="value"&&(k=l.expectedType);for(let P=0;P<w.length;P+=2){const L=w[P],F=w[P+1],$=P+3,H=P+4;if(typeof L!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(E.length&&E[E.length-1][0]>=L)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const q=l.parse(F,H,k);if(!q)return null;k=k||q.type,E.push([L,q])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new _d(k,d,p,v,E):l.error(`Type ${kn(k)} is not interpolatable.`)}evaluate(n){const l=this.labels,d=this.outputs;if(l.length===1)return d[0].evaluate(n);const p=this.input.evaluate(n);if(p<=l[0])return d[0].evaluate(n);const v=l.length;if(p>=l[v-1])return d[v-1].evaluate(n);const w=Zh(l,p),E=_d.interpolationFactor(this.interpolation,p,l[w],l[w+1]),k=d[w].evaluate(n),P=d[w+1].evaluate(n);return this.operator==="interpolate"?vd[this.type.kind.toLowerCase()](k,P,E):this.operator==="interpolate-hcl"?jc.reverse(jc.interpolate(jc.forward(k),jc.forward(P),E)):xd.reverse(xd.interpolate(xd.forward(k),xd.forward(P),E))}eachChild(n){n(this.input);for(const l of this.outputs)n(l)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,n,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function Hm(o,n,l,d){const p=d-l,v=o-l;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}var Vo=_d;class Kh{constructor(n,l){this.type=n,this.args=l}static parse(n,l){if(n.length<2)return l.error("Expectected at least one argument.");let d=null;const p=l.expectedType;p&&p.kind!=="value"&&(d=p);const v=[];for(const E of n.slice(1)){const k=l.parse(E,1+v.length,d,void 0,{typeAnnotation:"omit"});if(!k)return null;d=d||k.type,v.push(k)}const w=p&&v.some(E=>ga(p,E.type));return new Kh(w?Rr:d,v)}evaluate(n){let l,d=null,p=0;for(const v of this.args){if(p++,d=v.evaluate(n),d&&d instanceof Vs&&!d.available&&(l||(l=d),d=null,p===this.args.length))return l;if(d!==null)break}return d}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(l=>{n.push(l.serialize())}),n}}var qm=Kh;class Qh{constructor(n,l){this.type=l.type,this.bindings=[].concat(n),this.result=l}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const l of this.bindings)n(l[1]);n(this.result)}static parse(n,l){if(n.length<4)return l.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const d=[];for(let v=1;v<n.length-1;v+=2){const w=n[v];if(typeof w!="string")return l.error(`Expected string, but found ${typeof w} instead.`,v);if(/[^a-zA-Z0-9_]/.test(w))return l.error("Variable names must contain only alphanumeric characters or '_'.",v);const E=l.parse(n[v+1],v+1);if(!E)return null;d.push([w,E])}const p=l.parse(n[n.length-1],n.length-1,l.expectedType,d);return p?new Qh(d,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[l,d]of this.bindings)n.push(l,d.serialize());return n.push(this.result.serialize()),n}}var Ix=Qh;class Zm{constructor(n,l,d){this.type=n,this.index=l,this.input=d}static parse(n,l){if(n.length!==3)return l.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const d=l.parse(n[1],1,zt),p=l.parse(n[2],2,Us(l.expectedType||Rr));return d&&p?new Zm(p.type.itemType,d,p):null}evaluate(n){const l=this.index.evaluate(n),d=this.input.evaluate(n);if(l<0)throw new ki(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new ki(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new ki(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ib=Zm;class Xm{constructor(n,l){this.type=Dr,this.needle=n,this.haystack=l}static parse(n,l){if(n.length!==3)return l.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const d=l.parse(n[1],1,Rr),p=l.parse(n[2],2,Rr);return d&&p?cd(d.type,[Dr,jr,zt,kc,Rr])?new Xm(d,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(d.type)} instead`):null}evaluate(n){const l=this.needle.evaluate(n),d=this.haystack.evaluate(n);if(d==null)return!1;if(!ud(l,["boolean","string","number","null"]))throw new ki(`Expected first argument to be of type boolean, string, number or null, but found ${kn(zn(l))} instead.`);if(!ud(d,["string","array"]))throw new ki(`Expected second argument to be of type array or string, but found ${kn(zn(d))} instead.`);return d.indexOf(l)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Jh=Xm;class wd{constructor(n,l,d){this.type=zt,this.needle=n,this.haystack=l,this.fromIndex=d}static parse(n,l){if(n.length<=2||n.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const d=l.parse(n[1],1,Rr),p=l.parse(n[2],2,Rr);if(!d||!p)return null;if(!cd(d.type,[Dr,jr,zt,kc,Rr]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(d.type)} instead`);if(n.length===4){const v=l.parse(n[3],3,zt);return v?new wd(d,p,v):null}return new wd(d,p)}evaluate(n){const l=this.needle.evaluate(n),d=this.haystack.evaluate(n);if(!ud(l,["boolean","string","number","null"]))throw new ki(`Expected first argument to be of type boolean, string, number or null, but found ${kn(zn(l))} instead.`);if(!ud(d,["string","array"]))throw new ki(`Expected second argument to be of type array or string, but found ${kn(zn(d))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return d.indexOf(l,p)}return d.indexOf(l)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Dx=wd;class Ym{constructor(n,l,d,p,v,w){this.inputType=n,this.type=l,this.input=d,this.cases=p,this.outputs=v,this.otherwise=w}static parse(n,l){if(n.length<5)return l.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return l.error("Expected an even number of arguments.");let d,p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const v={},w=[];for(let P=2;P<n.length-1;P+=2){let L=n[P];const F=n[P+1];Array.isArray(L)||(L=[L]);const $=l.concat(P);if(L.length===0)return $.error("Expected at least one branch label.");for(const q of L){if(typeof q!="number"&&typeof q!="string")return $.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return $.error("Numeric branch labels must be integer values.");if(d){if($.checkSubtype(d,zn(q)))return null}else d=zn(q);if(v[String(q)]!==void 0)return $.error("Branch labels must be unique.");v[String(q)]=w.length}const H=l.parse(F,P,p);if(!H)return null;p=p||H.type,w.push(H)}const E=l.parse(n[1],1,Rr);if(!E)return null;const k=l.parse(n[n.length-1],n.length-1,p);return k?E.type.kind!=="value"&&l.concat(1).checkSubtype(d,E.type)?null:new Ym(d,p,E,v,w,k):null}evaluate(n){const l=this.input.evaluate(n);return(zn(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],p={};for(const w of l){const E=p[this.cases[w]];E===void 0?(p[this.cases[w]]=d.length,d.push([this.cases[w],[w]])):d[E][1].push(w)}const v=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,E]of d)n.push(E.length===1?v(E[0]):E.map(v)),n.push(this.outputs[w].serialize());return n.push(this.otherwise.serialize()),n}}var Db=Ym;class Km{constructor(n,l,d){this.type=n,this.branches=l,this.otherwise=d}static parse(n,l){if(n.length<4)return l.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);const p=[];for(let w=1;w<n.length-1;w+=2){const E=l.parse(n[w],w,Dr);if(!E)return null;const k=l.parse(n[w+1],w+1,d);if(!k)return null;p.push([E,k]),d=d||k.type}const v=l.parse(n[n.length-1],n.length-1,d);return v?new Km(d,p,v):null}evaluate(n){for(const[l,d]of this.branches)if(l.evaluate(n))return d.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[l,d]of this.branches)n(l),n(d);n(this.otherwise)}outputDefined(){return this.branches.every(([n,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(l=>{n.push(l.serialize())}),n}}var Rx=Km;class bd{constructor(n,l,d,p){this.type=n,this.input=l,this.beginIndex=d,this.endIndex=p}static parse(n,l){if(n.length<=2||n.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const d=l.parse(n[1],1,Rr),p=l.parse(n[2],2,zt);if(!d||!p)return null;if(!cd(d.type,[Us(Rr),jr,Rr]))return l.error(`Expected first argument to be of type array or string, but found ${kn(d.type)} instead`);if(n.length===4){const v=l.parse(n[3],3,zt);return v?new bd(d.type,d,p,v):null}return new bd(d.type,d,p)}evaluate(n){const l=this.input.evaluate(n),d=this.beginIndex.evaluate(n);if(!ud(l,["string","array"]))throw new ki(`Expected first argument to be of type array or string, but found ${kn(zn(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return l.slice(d,p)}return l.slice(d)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Nx=bd;function ef(o,n){return o==="=="||o==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function jx(o,n,l,d){return d.compare(n,l)===0}function Lc(o,n,l){const d=o!=="=="&&o!=="!=";return class u6{constructor(v,w,E){this.type=Dr,this.lhs=v,this.rhs=w,this.collator=E,this.hasUntypedArgument=v.type.kind==="value"||w.type.kind==="value"}static parse(v,w){if(v.length!==3&&v.length!==4)return w.error("Expected two or three arguments.");const E=v[0];let k=w.parse(v[1],1,Rr);if(!k)return null;if(!ef(E,k.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${kn(k.type)}'.`);let P=w.parse(v[2],2,Rr);if(!P)return null;if(!ef(E,P.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${kn(P.type)}'.`);if(k.type.kind!==P.type.kind&&k.type.kind!=="value"&&P.type.kind!=="value")return w.error(`Cannot compare types '${kn(k.type)}' and '${kn(P.type)}'.`);d&&(k.type.kind==="value"&&P.type.kind!=="value"?k=new ya(P.type,[k]):k.type.kind!=="value"&&P.type.kind==="value"&&(P=new ya(k.type,[P])));let L=null;if(v.length===4){if(k.type.kind!=="string"&&P.type.kind!=="string"&&k.type.kind!=="value"&&P.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(L=w.parse(v[3],3,Es),!L)return null}return new u6(k,P,L)}evaluate(v){const w=this.lhs.evaluate(v),E=this.rhs.evaluate(v);if(d&&this.hasUntypedArgument){const k=zn(w),P=zn(E);if(k.kind!==P.kind||k.kind!=="string"&&k.kind!=="number")throw new ki(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${k.kind}, ${P.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const k=zn(w),P=zn(E);if(k.kind!=="string"||P.kind!=="string")return n(v,w,E)}return this.collator?l(v,w,E,this.collator.evaluate(v)):n(v,w,E)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[o];return this.eachChild(w=>{v.push(w.serialize())}),v}}}const Rb=Lc("==",function(o,n,l){return n===l},jx),Nb=Lc("!=",function(o,n,l){return n!==l},function(o,n,l,d){return!jx(0,n,l,d)}),jb=Lc("<",function(o,n,l){return n<l},function(o,n,l,d){return d.compare(n,l)<0}),Lb=Lc(">",function(o,n,l){return n>l},function(o,n,l,d){return d.compare(n,l)>0}),Ob=Lc("<=",function(o,n,l){return n<=l},function(o,n,l,d){return d.compare(n,l)<=0}),Lx=Lc(">=",function(o,n,l){return n>=l},function(o,n,l,d){return d.compare(n,l)>=0});class tf{constructor(n,l,d,p,v,w){this.type=jr,this.number=n,this.locale=l,this.currency=d,this.unit=p,this.minFractionDigits=v,this.maxFractionDigits=w}static parse(n,l){if(n.length!==3)return l.error("Expected two arguments.");const d=l.parse(n[1],1,zt);if(!d)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=l.parse(p.locale,1,jr),!v))return null;let w=null;if(p.currency&&(w=l.parse(p.currency,1,jr),!w))return null;let E=null;if(p.unit&&(E=l.parse(p.unit,1,jr),!E))return null;let k=null;if(p["min-fraction-digits"]&&(k=l.parse(p["min-fraction-digits"],1,zt),!k))return null;let P=null;return p["max-fraction-digits"]&&(P=l.parse(p["max-fraction-digits"],1,zt),!P)?null:new tf(d,v,w,E,k,P)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Oc{constructor(n){this.type=zt,this.input=n}static parse(n,l){if(n.length!==2)return l.error(`Expected 1 argument, but found ${n.length-1} instead.`);const d=l.parse(n[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${kn(d.type)} instead.`):new Oc(d):null}evaluate(n){const l=this.input.evaluate(n);if(typeof l=="string"||Array.isArray(l))return l.length;throw new ki(`Expected value to be of type string or array, but found ${kn(zn(l))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(l=>{n.push(l.serialize())}),n}}const Ox={"==":Rb,"!=":Nb,">":Lb,"<":jb,">=":Lx,"<=":Ob,array:ya,at:Ib,boolean:ya,case:Rx,coalesce:qm,collator:md,format:Qa,image:$h,in:Jh,"index-of":Dx,interpolate:Vo,"interpolate-hcl":Vo,"interpolate-lab":Vo,length:Oc,let:Ix,literal:Nl,match:Db,number:ya,"number-format":tf,object:ya,slice:Nx,step:Fm,string:ya,"to-boolean":Ac,"to-color":Ac,"to-number":Ac,"to-string":Ac,var:Cx,within:Hh};function zx(o,[n,l,d,p]){n=n.evaluate(o),l=l.evaluate(o),d=d.evaluate(o);const v=p?p.evaluate(o):1,w=bx(n,l,d,v);if(w)throw new ki(w);return new Wn(n/255*v,l/255*v,d/255*v,v)}function wa(o,n){return o in n}function rf(o,n){const l=n[o];return l===void 0?null:l}function $s(o){return{type:o}}va.register(Ox,{error:[{kind:"error"},[jr],(o,[n])=>{throw new ki(n.evaluate(o))}],typeof:[jr,[Rr],(o,[n])=>kn(zn(n.evaluate(o)))],"to-rgba":[Us(zt,4),[Ss],(o,[n])=>n.evaluate(o).toArray()],rgb:[Ss,[zt,zt,zt],zx],rgba:[Ss,[zt,zt,zt,zt],zx],has:{type:Dr,overloads:[[[jr],(o,[n])=>wa(n.evaluate(o),o.properties())],[[jr,mo],(o,[n,l])=>wa(n.evaluate(o),l.evaluate(o))]]},get:{type:Rr,overloads:[[[jr],(o,[n])=>rf(n.evaluate(o),o.properties())],[[jr,mo],(o,[n,l])=>rf(n.evaluate(o),l.evaluate(o))]]},"feature-state":[Rr,[jr],(o,[n])=>rf(n.evaluate(o),o.featureState||{})],properties:[mo,[],o=>o.properties()],"geometry-type":[jr,[],o=>o.geometryType()],id:[Rr,[],o=>o.id()],zoom:[zt,[],o=>o.globals.zoom],pitch:[zt,[],o=>o.globals.pitch||0],"distance-from-center":[zt,[],o=>o.distanceFromCenter()],"heatmap-density":[zt,[],o=>o.globals.heatmapDensity||0],"line-progress":[zt,[],o=>o.globals.lineProgress||0],"sky-radial-progress":[zt,[],o=>o.globals.skyRadialProgress||0],accumulated:[Rr,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[zt,$s(zt),(o,n)=>{let l=0;for(const d of n)l+=d.evaluate(o);return l}],"*":[zt,$s(zt),(o,n)=>{let l=1;for(const d of n)l*=d.evaluate(o);return l}],"-":{type:zt,overloads:[[[zt,zt],(o,[n,l])=>n.evaluate(o)-l.evaluate(o)],[[zt],(o,[n])=>-n.evaluate(o)]]},"/":[zt,[zt,zt],(o,[n,l])=>n.evaluate(o)/l.evaluate(o)],"%":[zt,[zt,zt],(o,[n,l])=>n.evaluate(o)%l.evaluate(o)],ln2:[zt,[],()=>Math.LN2],pi:[zt,[],()=>Math.PI],e:[zt,[],()=>Math.E],"^":[zt,[zt,zt],(o,[n,l])=>Math.pow(n.evaluate(o),l.evaluate(o))],sqrt:[zt,[zt],(o,[n])=>Math.sqrt(n.evaluate(o))],log10:[zt,[zt],(o,[n])=>Math.log(n.evaluate(o))/Math.LN10],ln:[zt,[zt],(o,[n])=>Math.log(n.evaluate(o))],log2:[zt,[zt],(o,[n])=>Math.log(n.evaluate(o))/Math.LN2],sin:[zt,[zt],(o,[n])=>Math.sin(n.evaluate(o))],cos:[zt,[zt],(o,[n])=>Math.cos(n.evaluate(o))],tan:[zt,[zt],(o,[n])=>Math.tan(n.evaluate(o))],asin:[zt,[zt],(o,[n])=>Math.asin(n.evaluate(o))],acos:[zt,[zt],(o,[n])=>Math.acos(n.evaluate(o))],atan:[zt,[zt],(o,[n])=>Math.atan(n.evaluate(o))],min:[zt,$s(zt),(o,n)=>Math.min(...n.map(l=>l.evaluate(o)))],max:[zt,$s(zt),(o,n)=>Math.max(...n.map(l=>l.evaluate(o)))],abs:[zt,[zt],(o,[n])=>Math.abs(n.evaluate(o))],round:[zt,[zt],(o,[n])=>{const l=n.evaluate(o);return l<0?-Math.round(-l):Math.round(l)}],floor:[zt,[zt],(o,[n])=>Math.floor(n.evaluate(o))],ceil:[zt,[zt],(o,[n])=>Math.ceil(n.evaluate(o))],"filter-==":[Dr,[jr,Rr],(o,[n,l])=>o.properties()[n.value]===l.value],"filter-id-==":[Dr,[Rr],(o,[n])=>o.id()===n.value],"filter-type-==":[Dr,[jr],(o,[n])=>o.geometryType()===n.value],"filter-<":[Dr,[jr,Rr],(o,[n,l])=>{const d=o.properties()[n.value],p=l.value;return typeof d==typeof p&&d<p}],"filter-id-<":[Dr,[Rr],(o,[n])=>{const l=o.id(),d=n.value;return typeof l==typeof d&&l<d}],"filter->":[Dr,[jr,Rr],(o,[n,l])=>{const d=o.properties()[n.value],p=l.value;return typeof d==typeof p&&d>p}],"filter-id->":[Dr,[Rr],(o,[n])=>{const l=o.id(),d=n.value;return typeof l==typeof d&&l>d}],"filter-<=":[Dr,[jr,Rr],(o,[n,l])=>{const d=o.properties()[n.value],p=l.value;return typeof d==typeof p&&d<=p}],"filter-id-<=":[Dr,[Rr],(o,[n])=>{const l=o.id(),d=n.value;return typeof l==typeof d&&l<=d}],"filter->=":[Dr,[jr,Rr],(o,[n,l])=>{const d=o.properties()[n.value],p=l.value;return typeof d==typeof p&&d>=p}],"filter-id->=":[Dr,[Rr],(o,[n])=>{const l=o.id(),d=n.value;return typeof l==typeof d&&l>=d}],"filter-has":[Dr,[Rr],(o,[n])=>n.value in o.properties()],"filter-has-id":[Dr,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Dr,[Us(jr)],(o,[n])=>n.value.indexOf(o.geometryType())>=0],"filter-id-in":[Dr,[Us(Rr)],(o,[n])=>n.value.indexOf(o.id())>=0],"filter-in-small":[Dr,[jr,Us(Rr)],(o,[n,l])=>l.value.indexOf(o.properties()[n.value])>=0],"filter-in-large":[Dr,[jr,Us(Rr)],(o,[n,l])=>function(d,p,v,w){for(;v<=w;){const E=v+w>>1;if(p[E]===d)return!0;p[E]>d?w=E-1:v=E+1}return!1}(o.properties()[n.value],l.value,0,l.value.length-1)],all:{type:Dr,overloads:[[[Dr,Dr],(o,[n,l])=>n.evaluate(o)&&l.evaluate(o)],[$s(Dr),(o,n)=>{for(const l of n)if(!l.evaluate(o))return!1;return!0}]]},any:{type:Dr,overloads:[[[Dr,Dr],(o,[n,l])=>n.evaluate(o)||l.evaluate(o)],[$s(Dr),(o,n)=>{for(const l of n)if(l.evaluate(o))return!0;return!1}]]},"!":[Dr,[Dr],(o,[n])=>!n.evaluate(o)],"is-supported-script":[Dr,[jr],(o,[n])=>{const l=o.globals&&o.globals.isSupportedScript;return!l||l(n.evaluate(o))}],upcase:[jr,[jr],(o,[n])=>n.evaluate(o).toUpperCase()],downcase:[jr,[jr],(o,[n])=>n.evaluate(o).toLowerCase()],concat:[jr,$s(Rr),(o,n)=>n.map(l=>pd(l.evaluate(o))).join("")],"resolved-locale":[jr,[Es],(o,[n])=>n.evaluate(o).resolvedLocale()]});var Sd=Ox;function Fx(o){return{result:"success",value:o}}function zl(o){return{result:"error",value:o}}function zc(o){return o["property-type"]==="data-driven"}function nf(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function sf(o){return!!o.expression&&o.expression.interpolated}function Vr(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Ed(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function Bx(o){return o}function of(o,n){const l=n.type==="color",d=o.stops&&typeof o.stops[0][0]=="object",p=d||!(d||o.property!==void 0),v=o.type||(sf(n)?"exponential":"interval");if(l&&((o=ma({},o)).stops&&(o.stops=o.stops.map(P=>[P[0],Wn.parse(P[1])])),o.default=Wn.parse(o.default?o.default:n.default)),o.colorSpace&&o.colorSpace!=="rgb"&&!Gm[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let w,E,k;if(v==="exponential")w=ba;else if(v==="interval")w=af;else if(v==="categorical"){w=Ux,E=Object.create(null);for(const P of o.stops)E[P[0]]=P[1];k=typeof o.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=Vx}if(d){const P={},L=[];for(let H=0;H<o.stops.length;H++){const q=o.stops[H],K=q[0].zoom;P[K]===void 0&&(P[K]={zoom:K,type:o.type,property:o.property,default:o.default,stops:[]},L.push(K)),P[K].stops.push([q[0].value,q[1]])}const F=[];for(const H of L)F.push([P[H].zoom,of(P[H],n)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Vo.interpolationFactor.bind(void 0,$),zoomStops:F.map(H=>H[0]),evaluate:({zoom:H},q)=>ba({stops:F,base:o.base},n,H).evaluate(H,q)}}if(p){const P=v==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Vo.interpolationFactor.bind(void 0,P),zoomStops:o.stops.map(L=>L[0]),evaluate:({zoom:L})=>w(o,n,L,E,k)}}return{kind:"source",evaluate(P,L){const F=L&&L.properties?L.properties[o.property]:void 0;return F===void 0?Fc(o.default,n.default):w(o,n,F,E,k)}}}function Fc(o,n,l){return o!==void 0?o:n!==void 0?n:l!==void 0?l:void 0}function Ux(o,n,l,d,p){return Fc(typeof l===p?d[l]:void 0,o.default,n.default)}function af(o,n,l){if(Vr(l)!=="number")return Fc(o.default,n.default);const d=o.stops.length;if(d===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[d-1][0])return o.stops[d-1][1];const p=Zh(o.stops.map(v=>v[0]),l);return o.stops[p][1]}function ba(o,n,l){const d=o.base!==void 0?o.base:1;if(Vr(l)!=="number")return Fc(o.default,n.default);const p=o.stops.length;if(p===1||l<=o.stops[0][0])return o.stops[0][1];if(l>=o.stops[p-1][0])return o.stops[p-1][1];const v=Zh(o.stops.map(L=>L[0]),l),w=function(L,F,$,H){const q=H-$,K=L-$;return q===0?0:F===1?K/q:(Math.pow(F,K)-1)/(Math.pow(F,q)-1)}(l,d,o.stops[v][0],o.stops[v+1][0]),E=o.stops[v][1],k=o.stops[v+1][1];let P=vd[n.type]||Bx;if(o.colorSpace&&o.colorSpace!=="rgb"){const L=Gm[o.colorSpace];P=(F,$)=>L.reverse(L.interpolate(L.forward(F),L.forward($),w))}return typeof E.evaluate=="function"?{evaluate(...L){const F=E.evaluate.apply(void 0,L),$=k.evaluate.apply(void 0,L);if(F!==void 0&&$!==void 0)return P(F,$,w)}}:P(E,k,w)}function Vx(o,n,l){return n.type==="color"?l=Wn.parse(l):n.type==="formatted"?l=ns.fromString(l.toString()):n.type==="resolvedImage"?l=Vs.fromString(l.toString()):Vr(l)===n.type||n.type==="enum"&&n.values[l]||(l=void 0),Fc(l,o.default,n.default)}class lf{constructor(n,l){this.expression=n,this._warningHistory={},this._evaluator=new Im,this._defaultValue=l?function(d){return d.type==="color"&&(Ed(d.default)||Array.isArray(d.default))?new Wn(0,0,0,0):d.type==="color"?Wn.parse(d.default)||null:d.default===void 0?null:d.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(n,l,d,p,v,w,E,k){return this._evaluator.globals=n,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(n,l,d,p,v,w,E,k){this._evaluator.globals=n,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=k||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new ki(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function Bc(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Sd}function Uc(o,n){const l=new Om(Sd,[],n?function(p){const v={color:Ss,string:jr,number:zt,enum:jr,boolean:Dr,formatted:ld,resolvedImage:Rl};return p.type==="array"?Us(v[p.value]||Rr,p.length):v[p.type]}(n):void 0),d=l.parse(o,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Fx(new lf(d,n)):zl(l.errors)}class Qm{constructor(n,l){this.kind=n,this._styleExpression=l,this.isStateDependent=n!=="constant"&&!_a(l.expression)}evaluateWithoutErrorHandling(n,l,d,p,v,w){return this._styleExpression.evaluateWithoutErrorHandling(n,l,d,p,v,w)}evaluate(n,l,d,p,v,w){return this._styleExpression.evaluate(n,l,d,p,v,w)}}class Td{constructor(n,l,d,p){this.kind=n,this.zoomStops=d,this._styleExpression=l,this.isStateDependent=n!=="camera"&&!_a(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,l,d,p,v,w){return this._styleExpression.evaluateWithoutErrorHandling(n,l,d,p,v,w)}evaluate(n,l,d,p,v,w){return this._styleExpression.evaluate(n,l,d,p,v,w)}interpolationFactor(n,l,d){return this.interpolationType?Vo.interpolationFactor(this.interpolationType,n,l,d):0}}function Cd(o,n){if((o=Uc(o,n)).result==="error")return o;const l=o.value.expression,d=Nc(l);if(!d&&!zc(n))return zl([new Bo("","data expressions not supported")]);const p=Ll(l,["zoom","pitch","distance-from-center"]);if(!p&&!nf(n))return zl([new Bo("","zoom expressions not supported")]);const v=uf(l);return v||p?v instanceof Bo?zl([v]):v instanceof Vo&&!sf(n)?zl([new Bo("",'"interpolate" expressions cannot be used with this property')]):Fx(v?new Td(d?"camera":"composite",o.value,v.labels,v instanceof Vo?v.interpolation:void 0):new Qm(d?"constant":"source",o.value)):zl([new Bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class cf{constructor(n,l){this._parameters=n,this._specification=l,ma(this,of(this._parameters,this._specification))}static deserialize(n){return new cf(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function uf(o){let n=null;if(o instanceof Ix)n=uf(o.result);else if(o instanceof qm){for(const l of o.args)if(n=uf(l),n)break}else(o instanceof Fm||o instanceof Vo)&&o.input instanceof va&&o.input.name==="zoom"&&(n=o);return n instanceof Bo||o.eachChild(l=>{const d=uf(l);d instanceof Bo?n=d:!n&&d?n=new Bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&d&&n!==d&&(n=new Bo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}class Ft{constructor(n,l,d,p){this.message=(n?`${n}: `:"")+d,p&&(this.identifier=p),l!=null&&l.__line__&&(this.line=l.__line__)}}function go(o){const n=o.key,l=o.value,d=o.valueSpec||{},p=o.objectElementValidators||{},v=o.style,w=o.styleSpec;let E=[];const k=Vr(l);if(k!=="object")return[new Ft(n,l,`object expected, ${k} found`)];for(const P in l){const L=P.split(".")[0];let F;p[L]?F=p[L]:d[L]?F=zi:p["*"]?F=p["*"]:d["*"]&&(F=zi),F?E=E.concat(F({key:(n&&`${n}.`)+P,value:l[P],valueSpec:d[L]||d["*"],style:v,styleSpec:w,object:l,objectKey:P},l)):E.push(new Ft(n,l[P],`unknown property "${P}"`))}for(const P in d)p[P]||d[P].required&&d[P].default===void 0&&l[P]===void 0&&E.push(new Ft(n,l,`missing required property "${P}"`));return E}function $x(o){const n=o.value,l=o.valueSpec,d=o.style,p=o.styleSpec,v=o.key,w=o.arrayElementValidator||zi;if(Vr(n)!=="array")return[new Ft(v,n,`array expected, ${Vr(n)} found`)];if(l.length&&n.length!==l.length)return[new Ft(v,n,`array length ${l.length} expected, length ${n.length} found`)];if(l["min-length"]&&n.length<l["min-length"])return[new Ft(v,n,`array length at least ${l["min-length"]} expected, length ${n.length} found`)];let E={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};p.$version<7&&(E.function=l.function),Vr(l.value)==="object"&&(E=l.value);let k=[];for(let P=0;P<n.length;P++)k=k.concat(w({array:n,arrayIndex:P,value:n[P],valueSpec:E,style:d,styleSpec:p,key:`${v}[${P}]`}));return k}function Md(o){const n=o.key,l=o.value,d=o.valueSpec;let p=Vr(l);if(p==="number"&&l!=l&&(p="NaN"),p!=="number")return[new Ft(n,l,`number expected, ${p} found`)];if("minimum"in d){let v=d.minimum;if(Vr(d.minimum)==="array"&&(v=d.minimum[o.arrayIndex]),l<v)return[new Ft(n,l,`${l} is less than the minimum value ${v}`)]}if("maximum"in d){let v=d.maximum;if(Vr(d.maximum)==="array"&&(v=d.maximum[o.arrayIndex]),l>v)return[new Ft(n,l,`${l} is greater than the maximum value ${v}`)]}return[]}function kd(o){const n=o.valueSpec,l=Zn(o.value.type);let d,p,v,w={};const E=l!=="categorical"&&o.value.property===void 0,k=!E,P=Vr(o.value.stops)==="array"&&Vr(o.value.stops[0])==="array"&&Vr(o.value.stops[0][0])==="object",L=go({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(H){if(l==="identity")return[new Ft(H.key,H.value,'identity function may not have a "stops" property')];let q=[];const K=H.value;return q=q.concat($x({key:H.key,value:K,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:F})),Vr(K)==="array"&&K.length===0&&q.push(new Ft(H.key,K,"array must have at least one stop")),q},default:function(H){return zi({key:H.key,value:H.value,valueSpec:n,style:H.style,styleSpec:H.styleSpec})}}});return l==="identity"&&E&&L.push(new Ft(o.key,o.value,'missing required property "property"')),l==="identity"||o.value.stops||L.push(new Ft(o.key,o.value,'missing required property "stops"')),l==="exponential"&&o.valueSpec.expression&&!sf(o.valueSpec)&&L.push(new Ft(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(k&&!zc(o.valueSpec)?L.push(new Ft(o.key,o.value,"property functions not supported")):E&&!nf(o.valueSpec)&&L.push(new Ft(o.key,o.value,"zoom functions not supported"))),l!=="categorical"&&!P||o.value.property!==void 0||L.push(new Ft(o.key,o.value,'"property" property is required')),L;function F(H){let q=[];const K=H.value,ne=H.key;if(Vr(K)!=="array")return[new Ft(ne,K,`array expected, ${Vr(K)} found`)];if(K.length!==2)return[new Ft(ne,K,`array length 2 expected, length ${K.length} found`)];if(P){if(Vr(K[0])!=="object")return[new Ft(ne,K,`object expected, ${Vr(K[0])} found`)];if(K[0].zoom===void 0)return[new Ft(ne,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Ft(ne,K,"object stop key must have value")];const ue=Zn(K[0].zoom);if(typeof ue!="number")return[new Ft(ne,K[0].zoom,"stop zoom values must be numbers")];if(v&&v>ue)return[new Ft(ne,K[0].zoom,"stop zoom values must appear in ascending order")];ue!==v&&(v=ue,p=void 0,w={}),q=q.concat(go({key:`${ne}[0]`,value:K[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Md,value:$}}))}else q=q.concat($({key:`${ne}[0]`,value:K[0],valueSpec:{},style:H.style,styleSpec:H.styleSpec},K));return Bc(_i(K[1]))?q.concat([new Ft(`${ne}[1]`,K[1],"expressions are not allowed in function stops.")]):q.concat(zi({key:`${ne}[1]`,value:K[1],valueSpec:n,style:H.style,styleSpec:H.styleSpec}))}function $(H,q){const K=Vr(H.value),ne=Zn(H.value),ue=H.value!==null?H.value:q;if(d){if(K!==d)return[new Ft(H.key,ue,`${K} stop domain type must match previous stop domain type ${d}`)]}else d=K;if(K!=="number"&&K!=="string"&&K!=="boolean"&&typeof ne!="number"&&typeof ne!="string"&&typeof ne!="boolean")return[new Ft(H.key,ue,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&l!=="categorical"){let _e=`number expected, ${K} found`;return zc(n)&&l===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ft(H.key,ue,_e)]}return l!=="categorical"||K!=="number"||typeof ne=="number"&&isFinite(ne)&&Math.floor(ne)===ne?l!=="categorical"&&K==="number"&&typeof ne=="number"&&typeof p=="number"&&p!==void 0&&ne<p?[new Ft(H.key,ue,"stop domain values must appear in ascending order")]:(p=ne,l==="categorical"&&ne in w?[new Ft(H.key,ue,"stop domain values must be unique")]:(w[ne]=!0,[])):[new Ft(H.key,ue,`integer expected, found ${String(ne)}`)]}}function wi(o){const n=(o.expressionContext==="property"?Cd:Uc)(_i(o.value),o.valueSpec);if(n.result==="error")return n.value.map(d=>new Ft(`${o.key}${d.key}`,o.value,d.message));const l=n.value.expression||n.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!l.outputDefined())return[new Ft(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!_a(l))return[new Ft(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter")return Pd(l,o);if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Ll(l,["zoom","feature-state"]))return[new Ft(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Nc(l))return[new Ft(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pd(o,n){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const p of n.valueSpec.expression.parameters)l.delete(p);if(l.size===0)return[];const d=[];return o instanceof va&&l.has(o.name)?[new Ft(n.key,n.value,`["${o.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(o.eachChild(p=>{d.push(...Pd(p,n))}),d)}function df(o){const n=o.key,l=o.value,d=o.valueSpec,p=[];return Array.isArray(d.values)?d.values.indexOf(Zn(l))===-1&&p.push(new Ft(n,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(d.values).indexOf(Zn(l))===-1&&p.push(new Ft(n,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),p}function Jm(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const n of o.slice(1))if(!Jm(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function hf(o,n="fill"){if(o==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Jm(o)||(o=$c(o));const l=o;let d=!0;try{d=function(P){if(!Vc(P))return P;let L=_i(P);return ff(L),L=Wx(L),L}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(l,null,2)}
        `)}const p=Ye[`filter_${n}`],v=Uc(d,p);let w=null;if(v.result==="error")throw new Error(v.value.map(P=>`${P.key}: ${P.message}`).join(", "));w=(P,L,F)=>v.value.evaluate(P,L,{},F);let E=null,k=null;if(d!==l){const P=Uc(l,p);if(P.result==="error")throw new Error(P.value.map(L=>`${L.key}: ${L.message}`).join(", "));E=(L,F,$,H,q)=>P.value.evaluate(L,F,{},$,void 0,void 0,H,q),k=!Nc(P.value.expression)}return{filter:w,dynamicFilter:E||void 0,needGeometry:Gx(d),needFeature:!!k}}function Wx(o){if(!Array.isArray(o))return o;const n=function(l){if(eg.has(l[0])){for(let d=1;d<l.length;d++)if(Vc(l[d]))return!0}return l}(o);return n===!0?n:n.map(l=>Wx(l))}function ff(o){let n=!1;const l=[];if(o[0]==="case"){for(let d=1;d<o.length-1;d+=2)n=n||Vc(o[d]),l.push(o[d+1]);l.push(o[o.length-1])}else if(o[0]==="match"){n=n||Vc(o[1]);for(let d=2;d<o.length-1;d+=2)l.push(o[d+1]);l.push(o[o.length-1])}else if(o[0]==="step"){n=n||Vc(o[1]);for(let d=1;d<o.length-1;d+=2)l.push(o[d+1])}n&&(o.length=0,o.push("any",...l));for(let d=1;d<o.length;d++)ff(o[d])}function Vc(o){if(!Array.isArray(o))return!1;if((n=o[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let l=1;l<o.length;l++)if(Vc(o[l]))return!0;return!1}const eg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function zb(o,n){return o<n?-1:o>n?1:0}function Gx(o){if(!Array.isArray(o))return!1;if(o[0]==="within")return!0;for(let n=1;n<o.length;n++)if(Gx(o[n]))return!0;return!1}function $c(o){if(!o)return!0;const n=o[0];return o.length<=1?n!=="any":n==="=="?tg(o[1],o[2],"=="):n==="!="?pf(tg(o[1],o[2],"==")):n==="<"||n===">"||n==="<="||n===">="?tg(o[1],o[2],n):n==="any"?(l=o.slice(1),["any"].concat(l.map($c))):n==="all"?["all"].concat(o.slice(1).map($c)):n==="none"?["all"].concat(o.slice(1).map($c).map(pf)):n==="in"?rg(o[1],o.slice(2)):n==="!in"?pf(rg(o[1],o.slice(2))):n==="has"?ng(o[1]):n==="!has"?pf(ng(o[1])):n!=="within"||o;var l}function tg(o,n,l){switch(o){case"$type":return[`filter-type-${l}`,n];case"$id":return[`filter-id-${l}`,n];default:return[`filter-${l}`,o,n]}}function rg(o,n){if(n.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(l=>typeof l!=typeof n[0])?["filter-in-large",o,["literal",n.sort(zb)]]:["filter-in-small",o,["literal",n]]}}function ng(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function pf(o){return["!",o]}function Ad(o){return Jm(_i(o.value))?wi(ma({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):Id(o)}function Id(o){const n=o.value,l=o.key;if(Vr(n)!=="array")return[new Ft(l,n,`array expected, ${Vr(n)} found`)];const d=o.styleSpec;let p,v=[];if(n.length<1)return[new Ft(l,n,"filter array must have at least 1 element")];switch(v=v.concat(df({key:`${l}[0]`,value:n[0],valueSpec:d.filter_operator,style:o.style,styleSpec:o.styleSpec})),Zn(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&Zn(n[1])==="$type"&&v.push(new Ft(l,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new Ft(l,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=Vr(n[1]),p!=="string"&&v.push(new Ft(`${l}[1]`,n[1],`string expected, ${p} found`)));for(let w=2;w<n.length;w++)p=Vr(n[w]),Zn(n[1])==="$type"?v=v.concat(df({key:`${l}[${w}]`,value:n[w],valueSpec:d.geometry_type,style:o.style,styleSpec:o.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Ft(`${l}[${w}]`,n[w],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)v=v.concat(Id({key:`${l}[${w}]`,value:n[w],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":p=Vr(n[1]),n.length!==2?v.push(new Ft(l,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new Ft(`${l}[1]`,n[1],`string expected, ${p} found`));break;case"within":p=Vr(n[1]),n.length!==2?v.push(new Ft(l,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="object"&&v.push(new Ft(`${l}[1]`,n[1],`object expected, ${p} found`))}return v}function ig(o,n){const l=o.key,d=o.style,p=o.styleSpec,v=o.value,w=o.objectKey,E=p[`${n}_${o.layerType}`];if(!E)return[];const k=w.match(/^(.*)-transition$/);if(n==="paint"&&k&&E[k[1]]&&E[k[1]].transition)return zi({key:l,value:v,valueSpec:p.transition,style:d,styleSpec:p});const P=o.valueSpec||E[w];if(!P)return[new Ft(l,v,`unknown property "${w}"`)];let L;if(Vr(v)==="string"&&zc(P)&&!P.tokens&&(L=/^{([^}]+)}$/.exec(v))){const $=`\`{ "type": "identity", "property": ${L?JSON.stringify(L[1]):'"_"'} }\``;return[new Ft(l,v,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${$}.`)]}const F=[];return o.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&F.push(new Ft(l,v,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Ed(_i(v))&&Zn(v.type)==="identity"&&F.push(new Ft(l,v,'"text-font" does not support identity functions'))),F.concat(zi({key:o.key,value:v,valueSpec:P,style:d,styleSpec:p,expressionContext:"property",propertyType:n,propertyKey:w}))}function Hx(o){return ig(o,"paint")}function sg(o){return ig(o,"layout")}function qx(o){let n=[];const l=o.value,d=o.key,p=o.style,v=o.styleSpec;l.type||l.ref||n.push(new Ft(d,l,'either "type" or "ref" is required'));let w=Zn(l.type);const E=Zn(l.ref);if(l.id){const k=Zn(l.id);for(let P=0;P<o.arrayIndex;P++){const L=p.layers[P];Zn(L.id)===k&&n.push(new Ft(d,l.id,`duplicate layer id "${l.id}", previously used at line ${L.id.__line__}`))}}if("ref"in l){let k;["type","source","source-layer","filter","layout"].forEach(P=>{P in l&&n.push(new Ft(d,l[P],`"${P}" is prohibited for ref layers`))}),p.layers.forEach(P=>{Zn(P.id)===E&&(k=P)}),k?k.ref?n.push(new Ft(d,l.ref,"ref cannot reference another ref layer")):w=Zn(k.type):typeof E=="string"&&n.push(new Ft(d,l.ref,`ref layer "${E}" not found`))}else if(w!=="background"&&w!=="sky")if(l.source){const k=p.sources&&p.sources[l.source],P=k&&Zn(k.type);k?P==="vector"&&w==="raster"?n.push(new Ft(d,l.source,`layer "${l.id}" requires a raster source`)):P==="raster"&&w!=="raster"?n.push(new Ft(d,l.source,`layer "${l.id}" requires a vector source`)):P!=="vector"||l["source-layer"]?P==="raster-dem"&&w!=="hillshade"?n.push(new Ft(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||P==="geojson"&&k.lineMetrics||n.push(new Ft(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ft(d,l,`layer "${l.id}" must specify a "source-layer"`)):n.push(new Ft(d,l.source,`source "${l.source}" not found`))}else n.push(new Ft(d,l,'missing required property "source"'));return n=n.concat(go({key:d,value:l,valueSpec:v.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>zi({key:`${d}.type`,value:l.type,valueSpec:v.layer.type,style:o.style,styleSpec:o.styleSpec,object:l,objectKey:"type"}),filter:k=>Ad(ma({layerType:w},k)),layout:k=>go({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":P=>sg(ma({layerType:w},P))}}),paint:k=>go({layer:l,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":P=>Hx(ma({layerType:w},P))}})}})),n}function Ja(o){const n=o.value,l=o.key,d=Vr(n);return d!=="string"?[new Ft(l,n,`string expected, ${d} found`)]:[]}const Zx={promoteId:function({key:o,value:n}){if(Vr(n)==="string")return Ja({key:o,value:n});{const l=[];for(const d in n)l.push(...Ja({key:`${o}.${d}`,value:n[d]}));return l}}};function Xx(o){const n=o.value,l=o.key,d=o.styleSpec,p=o.style;if(!n.type)return[new Ft(l,n,'"type" is required')];const v=Zn(n.type);let w;switch(v){case"vector":case"raster":case"raster-dem":return w=go({key:l,value:n,valueSpec:d[`source_${v.replace("-","_")}`],style:o.style,styleSpec:d,objectElementValidators:Zx}),w;case"geojson":if(w=go({key:l,value:n,valueSpec:d.source_geojson,style:p,styleSpec:d,objectElementValidators:Zx}),n.cluster)for(const E in n.clusterProperties){const[k,P]=n.clusterProperties[E],L=typeof k=="string"?[k,["accumulated"],["get",E]]:k;w.push(...wi({key:`${l}.${E}.map`,value:P,expressionContext:"cluster-map"})),w.push(...wi({key:`${l}.${E}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return w;case"video":return go({key:l,value:n,valueSpec:d.source_video,style:p,styleSpec:d});case"image":return go({key:l,value:n,valueSpec:d.source_image,style:p,styleSpec:d});case"canvas":return[new Ft(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return df({key:`${l}.type`,value:n.type,valueSpec:{values:Fb(d)},style:p,styleSpec:d})}}function Fb(o){return o.source.reduce((n,l)=>{const d=o[l];return d.type.type==="enum"&&(n=n.concat(Object.keys(d.type.values))),n},[])}function Yx(o){const n=o.value,l=o.styleSpec,d=l.light,p=o.style;let v=[];const w=Vr(n);if(n===void 0)return v;if(w!=="object")return v=v.concat([new Ft("light",n,`object expected, ${w} found`)]),v;for(const E in n){const k=E.match(/^(.*)-transition$/);v=v.concat(k&&d[k[1]]&&d[k[1]].transition?zi({key:E,value:n[E],valueSpec:l.transition,style:p,styleSpec:l}):d[E]?zi({key:E,value:n[E],valueSpec:d[E],style:p,styleSpec:l}):[new Ft(E,n[E],`unknown property "${E}"`)])}return v}function og(o){const n=o.value,l=o.key,d=o.style,p=o.styleSpec,v=p.terrain;let w=[];const E=Vr(n);if(n===void 0)return w;if(E!=="object")return w=w.concat([new Ft("terrain",n,`object expected, ${E} found`)]),w;for(const k in n){const P=k.match(/^(.*)-transition$/);w=w.concat(P&&v[P[1]]&&v[P[1]].transition?zi({key:k,value:n[k],valueSpec:p.transition,style:d,styleSpec:p}):v[k]?zi({key:k,value:n[k],valueSpec:v[k],style:d,styleSpec:p}):[new Ft(k,n[k],`unknown property "${k}"`)])}if(n.source){const k=d.sources&&d.sources[n.source],P=k&&Zn(k.type);k?P!=="raster-dem"&&w.push(new Ft(l,n.source,`terrain cannot be used with a source of type ${String(P)}, it only be used with a "raster-dem" source type`)):w.push(new Ft(l,n.source,`source "${n.source}" not found`))}else w.push(new Ft(l,n,'terrain is missing required property "source"'));return w}function Kx(o){const n=o.value,l=o.style,d=o.styleSpec,p=d.fog;let v=[];const w=Vr(n);if(n===void 0)return v;if(w!=="object")return v=v.concat([new Ft("fog",n,`object expected, ${w} found`)]),v;for(const E in n){const k=E.match(/^(.*)-transition$/);v=v.concat(k&&p[k[1]]&&p[k[1]].transition?zi({key:E,value:n[E],valueSpec:d.transition,style:l,styleSpec:d}):p[E]?zi({key:E,value:n[E],valueSpec:p[E],style:l,styleSpec:d}):[new Ft(E,n[E],`unknown property "${E}"`)])}return v}const Qx={"*":()=>[],array:$x,boolean:function(o){const n=o.value,l=o.key,d=Vr(n);return d!=="boolean"?[new Ft(l,n,`boolean expected, ${d} found`)]:[]},number:Md,color:function(o){const n=o.key,l=o.value,d=Vr(l);return d!=="string"?[new Ft(n,l,`color expected, ${d} found`)]:Em(l)===null?[new Ft(n,l,`color expected, "${l}" found`)]:[]},enum:df,filter:Ad,function:kd,layer:qx,object:go,source:Xx,light:Yx,terrain:og,fog:Kx,string:Ja,formatted:function(o){return Ja(o).length===0?[]:wi(o)},resolvedImage:function(o){return Ja(o).length===0?[]:wi(o)},projection:function(o){const n=o.value,l=o.styleSpec,d=l.projection,p=o.style;let v=[];const w=Vr(n);if(w==="object")for(const E in n)v=v.concat(zi({key:E,value:n[E],valueSpec:d[E],style:p,styleSpec:l}));else w!=="string"&&(v=v.concat([new Ft("projection",n,`object or string expected, ${w} found`)]));return v}};function zi(o){const n=o.value,l=o.valueSpec,d=o.styleSpec;return l.expression&&Ed(Zn(n))?kd(o):l.expression&&Bc(_i(n))?wi(o):l.type&&Qx[l.type]?Qx[l.type](o):go(ma({},o,{valueSpec:l.type?d[l.type]:l}))}function Bb(o){const n=o.value,l=o.key,d=Ja(o);return d.length||(n.indexOf("{fontstack}")===-1&&d.push(new Ft(l,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&d.push(new Ft(l,n,'"glyphs" url must include a "{range}" token'))),d}function Jx(o,n=Ye){return Ws(zi({key:"",value:o,valueSpec:n.$root,styleSpec:n,style:o,objectElementValidators:{glyphs:Bb,"*":()=>[]}}))}const Ub=o=>Ws(Hx(o)),Vb=o=>Ws(sg(o));function Ws(o){return o.slice().sort((n,l)=>n.line&&l.line?n.line-l.line:0)}function e_(o,n){let l=!1;if(n&&n.length)for(const d of n)o.fire(new pa(new Error(d.message))),l=!0;return l}var $b=$o,yo=3;function $o(o,n,l){var d=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var p=new Int32Array(this.arrayBuffer);o=p[0],this.d=(n=p[1])+2*(l=p[2]);for(var v=0;v<this.d*this.d;v++){var w=p[yo+v],E=p[yo+v+1];d.push(w===E?null:p.subarray(w,E))}var k=p[yo+d.length+1];this.keys=p.subarray(p[yo+d.length],k),this.bboxes=p.subarray(k),this.insert=this._insertReadonly}else{this.d=n+2*l;for(var P=0;P<this.d*this.d;P++)d.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=o,this.padding=l,this.scale=n/o,this.uid=0;var L=l/n*o;this.min=-L,this.max=o+L}$o.prototype.insert=function(o,n,l,d,p){this._forEachCell(n,l,d,p,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(p)},$o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},$o.prototype._insertCell=function(o,n,l,d,p,v){this.cells[p].push(v)},$o.prototype.query=function(o,n,l,d,p){var v=this.min,w=this.max;if(o<=v&&n<=v&&w<=l&&w<=d&&!p)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(o,n,l,d,this._queryCell,E,{},p),E},$o.prototype._queryCell=function(o,n,l,d,p,v,w,E){var k=this.cells[p];if(k!==null)for(var P=this.keys,L=this.bboxes,F=0;F<k.length;F++){var $=k[F];if(w[$]===void 0){var H=4*$;(E?E(L[H+0],L[H+1],L[H+2],L[H+3]):o<=L[H+2]&&n<=L[H+3]&&l>=L[H+0]&&d>=L[H+1])?(w[$]=!0,v.push(P[$])):w[$]=!1}}},$o.prototype._forEachCell=function(o,n,l,d,p,v,w,E){for(var k=this._convertToCellCoord(o),P=this._convertToCellCoord(n),L=this._convertToCellCoord(l),F=this._convertToCellCoord(d),$=k;$<=L;$++)for(var H=P;H<=F;H++){var q=this.d*H+$;if((!E||E(this._convertFromCellCoord($),this._convertFromCellCoord(H),this._convertFromCellCoord($+1),this._convertFromCellCoord(H+1)))&&p.call(this,o,n,l,d,q,v,w,E))return}},$o.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},$o.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},$o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,n=yo+this.cells.length+1+1,l=0,d=0;d<this.cells.length;d++)l+=this.cells[d].length;var p=new Int32Array(n+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var v=n,w=0;w<o.length;w++){var E=o[w];p[yo+w]=v,p.set(E,v),v+=E.length}return p[yo+o.length]=v,p.set(this.keys,v),p[yo+o.length+1]=v+=this.keys.length,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer};var Fl=Z($b);const mf={};function $t(o,n,l={}){Object.defineProperty(o,"_classRegistryKey",{value:n,writeable:!1}),mf[n]={klass:o,omit:l.omit||[]}}$t(Object,"Object"),Fl.serialize=function(o,n){const l=o.toArrayBuffer();return n&&n.push(l),{buffer:l}},Fl.deserialize=function(o){return new Fl(o.buffer)},Object.defineProperty(Fl,"name",{value:"Grid"}),$t(Fl,"Grid"),$t(Wn,"Color"),$t(Error,"Error"),$t(Zi,"AJAXError"),$t(Vs,"ResolvedImage"),$t(cf,"StylePropertyFunction"),$t(lf,"StyleExpression",{omit:["_evaluator"]}),$t(Td,"ZoomDependentExpression"),$t(Qm,"ZoomConstantExpression"),$t(va,"CompoundExpression",{omit:["_evaluate"]});for(const o in Sd)mf[Sd[o]._classRegistryKey]||$t(Sd[o],`Expression${o}`);function ag(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function lg(o){return _.ImageBitmap&&o instanceof _.ImageBitmap}function Wc(o,n){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(ag(o)||lg(o))return n&&n.push(o),o;if(ArrayBuffer.isView(o)){const l=o;return n&&n.push(l.buffer),l}if(o instanceof _.ImageData)return n&&n.push(o.data.buffer),o;if(Array.isArray(o)){const l=[];for(const d of o)l.push(Wc(d,n));return l}if(typeof o=="object"){const l=o.constructor,d=l._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const p=l.serialize?l.serialize(o,n):{};if(!l.serialize){for(const v in o)o.hasOwnProperty(v)&&(mf[d].omit.indexOf(v)>=0||(p[v]=Wc(o[v],n)));o instanceof Error&&(p.message=o.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(p.$name=d),p}throw new Error("can't serialize object of type "+typeof o)}function Bl(o){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||ag(o)||lg(o)||ArrayBuffer.isView(o)||o instanceof _.ImageData)return o;if(Array.isArray(o))return o.map(Bl);if(typeof o=="object"){const n=o.$name||"Object",{klass:l}=mf[n];if(!l)throw new Error(`can't deserialize unregistered class ${n}`);if(l.deserialize)return l.deserialize(o);const d=Object.create(l.prototype);for(const p of Object.keys(o))p!=="$name"&&(d[p]=Bl(o[p]));return d}throw new Error("can't deserialize object of type "+typeof o)}const Ot={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function cg(o){for(const n of o)if(ug(n.charCodeAt(0)))return!0;return!1}function Wb(o){for(const n of o)if(!t_(n.charCodeAt(0)))return!1;return!0}function t_(o){return!(Ot.Arabic(o)||Ot["Arabic Supplement"](o)||Ot["Arabic Extended-A"](o)||Ot["Arabic Presentation Forms-A"](o)||Ot["Arabic Presentation Forms-B"](o))}function ug(o){return!(o!==746&&o!==747&&(o<4352||!(Ot["Bopomofo Extended"](o)||Ot.Bopomofo(o)||Ot["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Ot["CJK Compatibility Ideographs"](o)||Ot["CJK Compatibility"](o)||Ot["CJK Radicals Supplement"](o)||Ot["CJK Strokes"](o)||!(!Ot["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Ot["CJK Unified Ideographs Extension A"](o)||Ot["CJK Unified Ideographs"](o)||Ot["Enclosed CJK Letters and Months"](o)||Ot["Hangul Compatibility Jamo"](o)||Ot["Hangul Jamo Extended-A"](o)||Ot["Hangul Jamo Extended-B"](o)||Ot["Hangul Jamo"](o)||Ot["Hangul Syllables"](o)||Ot.Hiragana(o)||Ot["Ideographic Description Characters"](o)||Ot.Kanbun(o)||Ot["Kangxi Radicals"](o)||Ot["Katakana Phonetic Extensions"](o)||Ot.Katakana(o)&&o!==12540||!(!Ot["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Ot["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Ot["Unified Canadian Aboriginal Syllabics"](o)||Ot["Unified Canadian Aboriginal Syllabics Extended"](o)||Ot["Vertical Forms"](o)||Ot["Yijing Hexagram Symbols"](o)||Ot["Yi Syllables"](o)||Ot["Yi Radicals"](o))))}function r_(o){return!(ug(o)||function(n){return!!(Ot["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ot["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ot["Letterlike Symbols"](n)||Ot["Number Forms"](n)||Ot["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ot["Control Pictures"](n)&&n!==9251||Ot["Optical Character Recognition"](n)||Ot["Enclosed Alphanumerics"](n)||Ot["Geometric Shapes"](n)||Ot["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ot["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ot["CJK Symbols and Punctuation"](n)||Ot.Katakana(n)||Ot["Private Use Area"](n)||Ot["CJK Compatibility Forms"](n)||Ot["Small Form Variants"](n)||Ot["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(o))}function n_(o){return o>=1424&&o<=2303||Ot["Arabic Presentation Forms-A"](o)||Ot["Arabic Presentation Forms-B"](o)}function Gb(o,n){return!(!n&&n_(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Ot.Khmer(o))}function Hb(o){for(const n of o)if(n_(n.charCodeAt(0)))return!0;return!1}const dg="deferred",hg="loading",fg="loaded";let Gc=null,y="unavailable",c=null;const f=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(y="error"),Gc&&Gc(o)};function x(){S.fire(new Dl("pluginStateChange",{pluginStatus:y,pluginURL:c}))}const S=new ad,T=function(){return y},I=function(){if(y!==dg||!c)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");y=hg,x(),c&&vr({url:c},o=>{o?f(o):(y=fg,x())})},R={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>y===fg||R.applyArabicShaping!=null,isLoading:()=>y===hg,setState(o){y=o.pluginStatus,c=o.pluginURL},isParsed:()=>R.applyArabicShaping!=null&&R.processBidirectionalText!=null&&R.processStyledBidirectionalText!=null,getPluginURL:()=>c};class O{constructor(n,l){this.zoom=n,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(n){return function(l,d){for(const p of l)if(!Gb(p.charCodeAt(0),d))return!1;return!0}(n,R.isLoaded())}}class G{constructor(n,l){this.property=n,this.value=l,this.expression=function(d,p){if(Ed(d))return new cf(d,p);if(Bc(d)){const v=Cd(d,p);if(v.result==="error")throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));return v.value}{let v=d;return typeof d=="string"&&p.type==="color"&&(v=Wn.parse(d)),{kind:"constant",evaluate:()=>v}}}(l===void 0?n.specification.default:l,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,l,d){return this.property.possiblyEvaluate(this,n,l,d)}}class W{constructor(n){this.property=n,this.value=new G(n,void 0)}transitioned(n,l){return new te(this.property,this.value,l,dt({},n.transition,this.transition),n.now)}untransitioned(){return new te(this.property,this.value,null,{},0)}}class X{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Zr(this._values[n].value.value)}setValue(n,l){this._values.hasOwnProperty(n)||(this._values[n]=new W(this._values[n].property)),this._values[n].value=new G(this._values[n].property,l===null?void 0:Zr(l))}getTransition(n){return Zr(this._values[n].transition)}setTransition(n,l){this._values.hasOwnProperty(n)||(this._values[n]=new W(this._values[n].property)),this._values[n].transition=Zr(l)||void 0}serialize(){const n={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(n[l]=d);const p=this.getTransition(l);p!==void 0&&(n[`${l}-transition`]=p)}return n}transitioned(n,l){const d=new se(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].transitioned(n,l._values[p]);return d}untransitioned(){const n=new se(this._properties);for(const l of Object.keys(this._values))n._values[l]=this._values[l].untransitioned();return n}}class te{constructor(n,l,d,p,v){const w=p.delay||0,E=p.duration||0;v=v||0,this.property=n,this.value=l,this.begin=v+w,this.end=this.begin+E,n.specification.transition&&(p.delay||p.duration)&&(this.prior=d)}possiblyEvaluate(n,l,d){const p=n.now||0,v=this.value.possiblyEvaluate(n,l,d),w=this.prior;if(w){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return w.possiblyEvaluate(n,l,d);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(n,l,d),v,it(E))}}return v}}class se{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,l,d){const p=new ce(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,l,d);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class le{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return Zr(this._values[n].value)}setValue(n,l){this._values[n]=new G(this._values[n].property,l===null?void 0:Zr(l))}serialize(){const n={};for(const l of Object.keys(this._values)){const d=this.getValue(l);d!==void 0&&(n[l]=d)}return n}possiblyEvaluate(n,l,d){const p=new ce(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,l,d);return p}}class ae{constructor(n,l,d){this.property=n,this.value=l,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,l,d,p){return this.property.evaluate(this.value,this.parameters,n,l,d,p)}}class ce{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Y{constructor(n){this.specification=n}possiblyEvaluate(n,l){return n.expression.evaluate(l)}interpolate(n,l,d){const p=vd[this.specification.type];return p?p(n,l,d):n}}class ie{constructor(n,l){this.specification=n,this.overrides=l}possiblyEvaluate(n,l,d,p){return new ae(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(l,null,{},d,p)}:n.expression,l)}interpolate(n,l,d){if(n.value.kind!=="constant"||l.value.kind!=="constant")return n;if(n.value.value===void 0||l.value.value===void 0)return new ae(this,{kind:"constant",value:void 0},n.parameters);const p=vd[this.specification.type];return p?new ae(this,{kind:"constant",value:p(n.value.value,l.value.value,d)},n.parameters):n}evaluate(n,l,d,p,v,w){return n.kind==="constant"?n.value:n.evaluate(l,d,p,v,w)}}class fe{constructor(n){this.specification=n}possiblyEvaluate(n,l,d,p){return!!n.expression.evaluate(l,null,{},d,p)}interpolate(){return!1}}class ge{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new O(0,{});for(const d in n){const p=n[d];p.specification.overridable&&this.overridableProperties.push(d);const v=this.defaultPropertyValues[d]=new G(p,void 0),w=this.defaultTransitionablePropertyValues[d]=new W(p);this.defaultTransitioningPropertyValues[d]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=v.possiblyEvaluate(l)}}}function Ee(o,n){return 256*(o=Re(Math.floor(o),0,255))+Re(Math.floor(n),0,255)}$t(ie,"DataDrivenProperty"),$t(Y,"DataConstantProperty"),$t(fe,"ColorRampProperty");const Me={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ce{constructor(n,l){this._structArray=n,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ne{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,l){return n._trim(),l&&(n.isTransferred=!0,l.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const l=Object.create(this.prototype);return l.arrayBuffer=n.arrayBuffer,l.length=n.length,l.capacity=n.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function De(o,n=1){let l=0,d=0;return{members:o.map(p=>{const v=Me[p.type].BYTES_PER_ELEMENT,w=l=Ue(l,Math.max(n,v)),E=p.components||1;return d=Math.max(d,v),l+=v*E,{name:p.name,type:p.type,components:E,offset:w}}),size:Ue(l,Math.max(d,n)),alignment:n}}function Ue(o,n){return Math.ceil(o/n)*n}class ft extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l){const d=this.length;return this.resize(d+1),this.emplace(d,n,l)}emplace(n,l,d){const p=2*n;return this.int16[p+0]=l,this.int16[p+1]=d,n}}ft.prototype.bytesPerElement=4,$t(ft,"StructArrayLayout2i4");class ze extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,n,l,d)}emplace(n,l,d,p){const v=3*n;return this.int16[v+0]=l,this.int16[v+1]=d,this.int16[v+2]=p,n}}ze.prototype.bytesPerElement=6,$t(ze,"StructArrayLayout3i6");class tt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l,d,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,l,d,p)}emplace(n,l,d,p,v){const w=4*n;return this.int16[w+0]=l,this.int16[w+1]=d,this.int16[w+2]=p,this.int16[w+3]=v,n}}tt.prototype.bytesPerElement=8,$t(tt,"StructArrayLayout4i8");class $e extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E){const k=this.length;return this.resize(k+1),this.emplace(k,n,l,d,p,v,w,E)}emplace(n,l,d,p,v,w,E,k){const P=6*n,L=12*n,F=3*n;return this.int16[P+0]=l,this.int16[P+1]=d,this.uint8[L+4]=p,this.uint8[L+5]=v,this.uint8[L+6]=w,this.uint8[L+7]=E,this.float32[F+2]=k,n}}$e.prototype.bytesPerElement=12,$t($e,"StructArrayLayout2i4ub1f12");class ht extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,l,d,p)}emplace(n,l,d,p,v){const w=4*n;return this.float32[w+0]=l,this.float32[w+1]=d,this.float32[w+2]=p,this.float32[w+3]=v,n}}ht.prototype.bytesPerElement=16,$t(ht,"StructArrayLayout4f16");class Be extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,l,d,p,v)}emplace(n,l,d,p,v,w){const E=6*n,k=3*n;return this.uint16[E+0]=l,this.uint16[E+1]=d,this.uint16[E+2]=p,this.uint16[E+3]=v,this.float32[k+2]=w,n}}Be.prototype.bytesPerElement=12,$t(Be,"StructArrayLayout4ui1f12");class et extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l,d,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,l,d,p)}emplace(n,l,d,p,v){const w=4*n;return this.uint16[w+0]=l,this.uint16[w+1]=d,this.uint16[w+2]=p,this.uint16[w+3]=v,n}}et.prototype.bytesPerElement=8,$t(et,"StructArrayLayout4ui8");class mt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,l,d,p,v,w)}emplace(n,l,d,p,v,w,E){const k=6*n;return this.int16[k+0]=l,this.int16[k+1]=d,this.int16[k+2]=p,this.int16[k+3]=v,this.int16[k+4]=w,this.int16[k+5]=E,n}}mt.prototype.bytesPerElement=12,$t(mt,"StructArrayLayout6i12");class at extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E,k,P,L,F,$){const H=this.length;return this.resize(H+1),this.emplace(H,n,l,d,p,v,w,E,k,P,L,F,$)}emplace(n,l,d,p,v,w,E,k,P,L,F,$,H){const q=12*n;return this.int16[q+0]=l,this.int16[q+1]=d,this.int16[q+2]=p,this.int16[q+3]=v,this.uint16[q+4]=w,this.uint16[q+5]=E,this.uint16[q+6]=k,this.uint16[q+7]=P,this.int16[q+8]=L,this.int16[q+9]=F,this.int16[q+10]=$,this.int16[q+11]=H,n}}at.prototype.bytesPerElement=24,$t(at,"StructArrayLayout4i4ui4i24");class gt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,l,d,p,v,w)}emplace(n,l,d,p,v,w,E){const k=10*n,P=5*n;return this.int16[k+0]=l,this.int16[k+1]=d,this.int16[k+2]=p,this.float32[P+2]=v,this.float32[P+3]=w,this.float32[P+4]=E,n}}gt.prototype.bytesPerElement=20,$t(gt,"StructArrayLayout3i3f20");class Yt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const l=this.length;return this.resize(l+1),this.emplace(l,n)}emplace(n,l){return this.uint32[1*n+0]=l,n}}Yt.prototype.bytesPerElement=4,$t(Yt,"StructArrayLayout1ul4");class hr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E,k,P,L,F,$,H){const q=this.length;return this.resize(q+1),this.emplace(q,n,l,d,p,v,w,E,k,P,L,F,$,H)}emplace(n,l,d,p,v,w,E,k,P,L,F,$,H,q){const K=20*n,ne=10*n;return this.int16[K+0]=l,this.int16[K+1]=d,this.int16[K+2]=p,this.int16[K+3]=v,this.int16[K+4]=w,this.float32[ne+3]=E,this.float32[ne+4]=k,this.float32[ne+5]=P,this.float32[ne+6]=L,this.int16[K+14]=F,this.uint32[ne+8]=$,this.uint16[K+18]=H,this.uint16[K+19]=q,n}}hr.prototype.bytesPerElement=40,$t(hr,"StructArrayLayout5i4f1i1ul2ui40");class Gt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E){const k=this.length;return this.resize(k+1),this.emplace(k,n,l,d,p,v,w,E)}emplace(n,l,d,p,v,w,E,k){const P=8*n;return this.int16[P+0]=l,this.int16[P+1]=d,this.int16[P+2]=p,this.int16[P+4]=v,this.int16[P+5]=w,this.int16[P+6]=E,this.int16[P+7]=k,n}}Gt.prototype.bytesPerElement=16,$t(Gt,"StructArrayLayout3i2i2i16");class ir extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,l,d,p,v)}emplace(n,l,d,p,v,w){const E=4*n,k=8*n;return this.float32[E+0]=l,this.float32[E+1]=d,this.float32[E+2]=p,this.int16[k+6]=v,this.int16[k+7]=w,n}}ir.prototype.bytesPerElement=16,$t(ir,"StructArrayLayout2f1f2i16");class Nr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,l,d,p)}emplace(n,l,d,p,v){const w=12*n,E=3*n;return this.uint8[w+0]=l,this.uint8[w+1]=d,this.float32[E+1]=p,this.float32[E+2]=v,n}}Nr.prototype.bytesPerElement=12,$t(Nr,"StructArrayLayout2ub2f12");class Pr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,n,l,d)}emplace(n,l,d,p){const v=3*n;return this.float32[v+0]=l,this.float32[v+1]=d,this.float32[v+2]=p,n}}Pr.prototype.bytesPerElement=12,$t(Pr,"StructArrayLayout3f12");class qt extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,n,l,d)}emplace(n,l,d,p){const v=3*n;return this.uint16[v+0]=l,this.uint16[v+1]=d,this.uint16[v+2]=p,n}}qt.prototype.bytesPerElement=6,$t(qt,"StructArrayLayout3ui6");class Qr extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be){const we=this.length;return this.resize(we+1),this.emplace(we,n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be)}emplace(n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be,we){const Ve=30*n,Fe=15*n,Qe=60*n;return this.int16[Ve+0]=l,this.int16[Ve+1]=d,this.int16[Ve+2]=p,this.float32[Fe+2]=v,this.float32[Fe+3]=w,this.uint16[Ve+8]=E,this.uint16[Ve+9]=k,this.uint32[Fe+5]=P,this.uint32[Fe+6]=L,this.uint32[Fe+7]=F,this.uint16[Ve+16]=$,this.uint16[Ve+17]=H,this.uint16[Ve+18]=q,this.float32[Fe+10]=K,this.float32[Fe+11]=ne,this.uint8[Qe+48]=ue,this.uint8[Qe+49]=_e,this.uint8[Qe+50]=de,this.uint32[Fe+13]=xe,this.int16[Ve+28]=be,this.uint8[Qe+58]=we,n}}Qr.prototype.bytesPerElement=60,$t(Qr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class on extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be,we,Ve,Fe,Qe,pt,We,st,ot,ut){const xt=this.length;return this.resize(xt+1),this.emplace(xt,n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be,we,Ve,Fe,Qe,pt,We,st,ot,ut)}emplace(n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne,ue,_e,de,xe,be,we,Ve,Fe,Qe,pt,We,st,ot,ut,xt){const Xe=38*n,Rt=19*n;return this.int16[Xe+0]=l,this.int16[Xe+1]=d,this.int16[Xe+2]=p,this.float32[Rt+2]=v,this.float32[Rt+3]=w,this.int16[Xe+8]=E,this.int16[Xe+9]=k,this.int16[Xe+10]=P,this.int16[Xe+11]=L,this.int16[Xe+12]=F,this.int16[Xe+13]=$,this.uint16[Xe+14]=H,this.uint16[Xe+15]=q,this.uint16[Xe+16]=K,this.uint16[Xe+17]=ne,this.uint16[Xe+18]=ue,this.uint16[Xe+19]=_e,this.uint16[Xe+20]=de,this.uint16[Xe+21]=xe,this.uint16[Xe+22]=be,this.uint16[Xe+23]=we,this.uint16[Xe+24]=Ve,this.uint16[Xe+25]=Fe,this.uint16[Xe+26]=Qe,this.uint16[Xe+27]=pt,this.uint16[Xe+28]=We,this.uint32[Rt+15]=st,this.float32[Rt+16]=ot,this.float32[Rt+17]=ut,this.float32[Rt+18]=xt,n}}on.prototype.bytesPerElement=76,$t(on,"StructArrayLayout3i2f6i15ui1ul3f76");class an extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const l=this.length;return this.resize(l+1),this.emplace(l,n)}emplace(n,l){return this.float32[1*n+0]=l,n}}an.prototype.bytesPerElement=4,$t(an,"StructArrayLayout1f4");class ln extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l,d,p,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,l,d,p,v)}emplace(n,l,d,p,v,w){const E=5*n;return this.float32[E+0]=l,this.float32[E+1]=d,this.float32[E+2]=p,this.float32[E+3]=v,this.float32[E+4]=w,n}}ln.prototype.bytesPerElement=20,$t(ln,"StructArrayLayout5f20");class Fi extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l,d,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,l,d,p)}emplace(n,l,d,p,v){const w=6*n;return this.uint32[3*n+0]=l,this.uint16[w+2]=d,this.uint16[w+3]=p,this.uint16[w+4]=v,n}}Fi.prototype.bytesPerElement=12,$t(Fi,"StructArrayLayout1ul3ui12");class bi extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,l){const d=this.length;return this.resize(d+1),this.emplace(d,n,l)}emplace(n,l,d){const p=2*n;return this.uint16[p+0]=l,this.uint16[p+1]=d,n}}bi.prototype.bytesPerElement=4,$t(bi,"StructArrayLayout2ui4");class Gs extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const l=this.length;return this.resize(l+1),this.emplace(l,n)}emplace(n,l){return this.uint16[1*n+0]=l,n}}Gs.prototype.bytesPerElement=2,$t(Gs,"StructArrayLayout1ui2");class Wo extends Ne{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,l){const d=this.length;return this.resize(d+1),this.emplace(d,n,l)}emplace(n,l,d){const p=2*n;return this.float32[p+0]=l,this.float32[p+1]=d,n}}Wo.prototype.bytesPerElement=8,$t(Wo,"StructArrayLayout2f8");class Pn extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Pn.prototype.size=40;class cn extends hr{get(n){return new Pn(this,n)}}$t(cn,"CollisionBoxArray");class Wr extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Wr.prototype.size=60;class Xn extends Qr{get(n){return new Wr(this,n)}}$t(Xn,"PlacedSymbolArray");class Yi extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Yi.prototype.size=76;class En extends on{get(n){return new Yi(this,n)}}$t(En,"SymbolInstanceArray");class is extends an{getoffsetX(n){return this.float32[1*n+0]}}$t(is,"GlyphOffsetArray");class gf extends ft{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}$t(gf,"SymbolLineVertexArray");class Ul extends Ce{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ul.prototype.size=12;class Dd extends Fi{get(n){return new Ul(this,n)}}$t(Dd,"FeatureIndexArray");class Sa extends bi{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}$t(Sa,"FillExtrusionCentroidArray");const el=De([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Vl=De([{name:"a_dash",components:4,type:"Uint16"}]);var yf={exports:{}},Rd={exports:{}};Rd.exports=function(o,n){var l,d,p,v,w,E,k,P;for(d=o.length-(l=3&o.length),p=n,w=3432918353,E=461845907,P=0;P<d;)k=255&o.charCodeAt(P)|(255&o.charCodeAt(++P))<<8|(255&o.charCodeAt(++P))<<16|(255&o.charCodeAt(++P))<<24,++P,p=27492+(65535&(v=5*(65535&(p=(p^=k=(65535&(k=(k=(65535&k)*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*E+(((k>>>16)*E&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(k=0,l){case 3:k^=(255&o.charCodeAt(P+2))<<16;case 2:k^=(255&o.charCodeAt(P+1))<<8;case 1:p^=k=(65535&(k=(k=(65535&(k^=255&o.charCodeAt(P)))*w+(((k>>>16)*w&65535)<<16)&4294967295)<<15|k>>>17))*E+(((k>>>16)*E&65535)<<16)&4294967295}return p^=o.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var pg=Rd.exports,kA={exports:{}};kA.exports=function(o,n){for(var l,d=o.length,p=n^d,v=0;d>=4;)l=1540483477*(65535&(l=255&o.charCodeAt(v)|(255&o.charCodeAt(++v))<<8|(255&o.charCodeAt(++v))<<16|(255&o.charCodeAt(++v))<<24))+((1540483477*(l>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++v;switch(d){case 3:p^=(255&o.charCodeAt(v+2))<<16;case 2:p^=(255&o.charCodeAt(v+1))<<8;case 1:p=1540483477*(65535&(p^=255&o.charCodeAt(v)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var PA=pg,D$=kA.exports;yf.exports=PA,yf.exports.murmur3=PA,yf.exports.murmur2=D$;var qb=Z(yf.exports);class i_{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,l,d,p){this.ids.push(AA(n)),this.positions.push(l,d,p)}getPositions(n){const l=AA(n);let d=0,p=this.ids.length-1;for(;d<p;){const w=d+p>>1;this.ids[w]>=l?p=w:d=w+1}const v=[];for(;this.ids[d]===l;)v.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return v}static serialize(n,l){const d=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Zb(d,p,0,d.length-1),l&&l.push(d.buffer,p.buffer),{ids:d,positions:p}}static deserialize(n){const l=new i_;return l.ids=n.ids,l.positions=n.positions,l.indexed=!0,l}}function AA(o){const n=+o;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:qb(String(o))}function Zb(o,n,l,d){for(;l<d;){const p=o[l+d>>1];let v=l-1,w=d+1;for(;;){do v++;while(o[v]<p);do w--;while(o[w]>p);if(v>=w)break;s_(o,v,w),s_(n,3*v,3*w),s_(n,3*v+1,3*w+1),s_(n,3*v+2,3*w+2)}w-l<d-w?(Zb(o,n,l,w),l=w+1):(Zb(o,n,w+1,d),d=w)}}function s_(o,n,l){const d=o[n];o[n]=o[l],o[l]=d}$t(i_,"FeaturePositionMap");class $l{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,l),this.initialized=!0),!!this.location}}class o_ extends $l{constructor(n){super(n),this.current=0}set(n,l,d){this.fetchUniformLocation(n,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class IA extends $l{constructor(n){super(n),this.current=[0,0,0,0]}set(n,l,d){this.fetchUniformLocation(n,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class DA extends $l{constructor(n){super(n),this.current=Wn.transparent}set(n,l,d){this.fetchUniformLocation(n,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const R$=new Float32Array(16),N$=new Float32Array(9),j$=new Float32Array(4);function Xb(o){return[Ee(255*o.r,255*o.g),Ee(255*o.b,255*o.a)]}class mg{constructor(n,l,d){this.value=n,this.uniformNames=l.map(p=>`u_${p}`),this.type=d}setUniform(n,l,d,p,v){l.set(n,v,p.constantOr(this.value))}getBinding(n,l){return this.type==="color"?new DA(n):new o_(n)}}class vf{constructor(n,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,l,d,p,v){const w=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;w&&l.set(n,v,w)}getBinding(n,l){return l==="u_pattern"||l==="u_dash"?new IA(n):new o_(n)}}class Wl{constructor(n,l,d,p){this.expression=n,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(v=>({name:`a_${v}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,l,d,p,v,w){const E=this.paintVertexArray.length,k=this.expression.evaluate(new O(0),l,{},v,p,w);this.paintVertexArray.resize(n),this._setPaintValue(E,n,k)}updatePaintArray(n,l,d,p,v){const w=this.expression.evaluate({zoom:0},d,p,void 0,v);this._setPaintValue(n,l,w)}_setPaintValue(n,l,d){if(this.type==="color"){const p=Xb(d);for(let v=n;v<l;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=n;p<l;p++)this.paintVertexArray.emplace(p,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ea{constructor(n,l,d,p,v,w){this.expression=n,this.uniformNames=l.map(E=>`u_${E}_t`),this.type=d,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=l.map(E=>({name:`a_${E}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(n,l,d,p,v,w){const E=this.expression.evaluate(new O(this.zoom),l,{},v,p,w),k=this.expression.evaluate(new O(this.zoom+1),l,{},v,p,w),P=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(P,n,E,k)}updatePaintArray(n,l,d,p,v){const w=this.expression.evaluate({zoom:this.zoom},d,p,void 0,v),E=this.expression.evaluate({zoom:this.zoom+1},d,p,void 0,v);this._setPaintValue(n,l,w,E)}_setPaintValue(n,l,d,p){if(this.type==="color"){const v=Xb(d),w=Xb(p);for(let E=n;E<l;E++)this.paintVertexArray.emplace(E,v[0],v[1],w[0],w[1])}else{for(let v=n;v<l;v++)this.paintVertexArray.emplace(v,d,p);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,l,d,p,v){const w=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,E=Re(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);l.set(n,v,E)}getBinding(n,l){return new o_(n)}}class Hc{constructor(n,l,d,p,v){this.expression=n,this.layerId=v,this.paintVertexAttributes=(d==="array"?Vl:el).members;for(let w=0;w<l.length;++w);this.paintVertexArray=new p}populatePaintArray(n,l,d){const p=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(p,n,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(n,l,d,p,v,w){this._setPaintValues(n,l,d.patterns&&d.patterns[this.layerId],w)}_setPaintValues(n,l,d,p){if(!p||!d)return;const v=p[d];if(!v)return;const{tl:w,br:E,pixelRatio:k}=v;for(let P=n;P<l;P++)this.paintVertexArray.emplace(P,w[0],w[1],E[0],E[1],k)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qc{constructor(n,l,d=()=>!0){this.binders={},this._buffers=[];const p=[];for(const v in n.paint._values){if(!d(v))continue;const w=n.paint.get(v);if(!(w instanceof ae&&zc(w.property.specification)))continue;const E=O$(v,n.type),k=w.value,P=w.property.specification.type,L=!!w.property.useIntegerZoom,F=v==="line-dasharray"||v.endsWith("pattern"),$=v==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(k.kind!=="constant"||$)if(k.kind==="source"||$||F){const H=RA(v,P,"source");this.binders[v]=F?new Hc(k,E,P,H,n.id):new Wl(k,E,P,H),p.push(`/a_${v}`)}else{const H=RA(v,P,"composite");this.binders[v]=new Ea(k,E,P,L,l,H),p.push(`/z_${v}`)}else this.binders[v]=F?new vf(k.value,E):new mg(k.value,E,P),p.push(`/u_${v}`)}this.cacheKey=p.sort().join("")}getMaxValue(n){const l=this.binders[n];return l instanceof Wl||l instanceof Ea?l.maxValue:0}populatePaintArrays(n,l,d,p,v,w){for(const E in this.binders){const k=this.binders[E];(k instanceof Wl||k instanceof Ea||k instanceof Hc)&&k.populatePaintArray(n,l,d,p,v,w)}}setConstantPatternPositions(n){for(const l in this.binders){const d=this.binders[l];d instanceof vf&&d.setConstantPatternPositions(n)}}updatePaintArrays(n,l,d,p,v,w){let E=!1;for(const k in n){const P=l.getPositions(k);for(const L of P){const F=d.feature(L.index);for(const $ in this.binders){const H=this.binders[$];if((H instanceof Wl||H instanceof Ea||H instanceof Hc)&&H.expression.isStateDependent===!0){const q=p.paint.get($);H.expression=q.value,H.updatePaintArray(L.start,L.end,F,n[k],v,w),E=!0}}}}return E}defines(){const n=[];for(const l in this.binders){const d=this.binders[l];(d instanceof mg||d instanceof vf)&&n.push(...d.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof Wl||d instanceof Ea||d instanceof Hc)for(let p=0;p<d.paintVertexAttributes.length;p++)n.push(d.paintVertexAttributes[p].name)}return n}getBinderUniforms(){const n=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof mg||d instanceof vf||d instanceof Ea)for(const p of d.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const l=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof mg||p instanceof vf||p instanceof Ea)for(const v of p.uniformNames)l.push({name:v,property:d,binding:p.getBinding(n,v)})}return l}setUniforms(n,l,d,p,v){for(const{name:w,property:E,binding:k}of d)this.binders[E].setUniform(n,k,v,p.get(E),w)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const l=this.binders[n];(l instanceof Wl||l instanceof Ea||l instanceof Hc)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(n){for(const l in this.binders){const d=this.binders[l];(d instanceof Wl||d instanceof Ea||d instanceof Hc)&&d.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const l=this.binders[n];(l instanceof Wl||l instanceof Ea||l instanceof Hc)&&l.destroy()}}}class Nd{constructor(n,l,d=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new qc(p,l,d);this.needsUpload=!1,this._featureMap=new i_,this._bufferOffset=0}populatePaintArrays(n,l,d,p,v,w,E){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(n,l,p,v,w,E);l.id!==void 0&&this._featureMap.add(l.id,d,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,l,d,p,v){for(const w of d)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(n,this._featureMap,l,w,p,v)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const L$={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function O$(o,n){return L$[o]||[o.replace(`${n}-`,"").replace(/-/g,"_")]}const z$={"line-pattern":{source:Be,composite:Be},"fill-pattern":{source:Be,composite:Be},"fill-extrusion-pattern":{source:Be,composite:Be},"line-dasharray":{source:et,composite:et}},F$={color:{source:Wo,composite:ht},number:{source:an,composite:Wo}};function RA(o,n,l){const d=z$[o];return d&&d[l]||F$[n][l]}$t(mg,"ConstantBinder"),$t(vf,"PatternConstantBinder"),$t(Wl,"SourceExpressionBinder"),$t(Hc,"PatternCompositeBinder"),$t(Ea,"CompositeExpressionBinder"),$t(qc,"ProgramConfiguration",{omit:["_buffers"]}),$t(Nd,"ProgramConfigurationSet");const NA="-transition";class Ta extends ad{constructor(n,l){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),l.layout&&(this._unevaluatedLayout=new le(l.layout)),l.paint)){this._transitionablePaint=new X(l.paint);for(const d in n.paint)this.setPaintProperty(d,n.paint[d],{validate:!1});for(const d in n.layout)this.setLayoutProperty(d,n.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ce(l.paint)}}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,l,d={}){l!=null&&this._validate(Vb,`layers.${this.id}.layout.${n}`,n,l,d)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,l):this.visibility=l)}getPaintProperty(n){return dr(n,NA)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,l,d={}){if(l!=null&&this._validate(Ub,`layers.${this.id}.paint.${n}`,n,l,d))return!1;if(dr(n,NA))return this._transitionablePaint.setTransition(n.slice(0,-11),l||void 0),!1;{const p=this._transitionablePaint._values[n],v=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(n,l),this._handleSpecialPaintPropertyUpdate(n);const E=this._transitionablePaint._values[n].value,k=E.isDataDriven(),P=dr(n,"pattern")||n==="line-dasharray";return k||v||P||this._handleOverridablePaintPropertyUpdate(n,w,E)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,l,d){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,l)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Kr(n,(l,d)=>!(l===void 0||d==="layout"&&!Object.keys(l).length||d==="paint"&&!Object.keys(l).length))}_validate(n,l,d,p,v={}){return(!v||v.validate!==!1)&&e_(this,n.call(Jx,{key:l,layerType:this.type,objectKey:d,value:p,styleSpec:Ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const l=this.paint.get(n);if(l instanceof ae&&zc(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=hf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const B$=De([{name:"a_pos",components:2,type:"Int16"}],4),U$=De([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yn{constructor(n=[]){this.segments=n}prepareSegment(n,l,d,p){let v=this.segments[this.segments.length-1];return n>Yn.MAX_VERTEX_ARRAY_LENGTH&&Ir(`Max vertices per segment is ${Yn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!v||v.vertexLength+n>Yn.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},p!==void 0&&(v.sortKey=p),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const n of this.segments)for(const l in n.vaos)n.vaos[l].destroy()}static simpleSegment(n,l,d,p){return new Yn([{vertexOffset:n,primitiveOffset:l,vertexLength:d,primitiveLength:p,vaos:{},sortKey:0}])}}Yn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t(Yn,"SegmentVector");var rr=8192;class Zc{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof un?new un(n.lng,n.lat):un.convert(n),this}setSouthWest(n){return this._sw=n instanceof un?new un(n.lng,n.lat):un.convert(n),this}extend(n){const l=this._sw,d=this._ne;let p,v;if(n instanceof un)p=n,v=n;else{if(!(n instanceof Zc))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Zc.convert(n)):this.extend(un.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(un.convert(n)):this;if(p=n._sw,v=n._ne,!p||!v)return this}return l||d?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),d.lng=Math.max(v.lng,d.lng),d.lat=Math.max(v.lat,d.lat)):(this._sw=new un(p.lng,p.lat),this._ne=new un(v.lng,v.lat)),this}getCenter(){return new un((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new un(this.getWest(),this.getNorth())}getSouthEast(){return new un(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:d}=un.convert(n);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(n){return!n||n instanceof Zc?n:new Zc(n)}}var a_=1e-6,Hs=typeof Float32Array<"u"?Float32Array:Array;function jA(){var o=new Hs(9);return Hs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function LA(o,n,l){var d=n[0],p=n[1],v=n[2],w=n[3],E=n[4],k=n[5],P=n[6],L=n[7],F=n[8],$=l[0],H=l[1],q=l[2],K=l[3],ne=l[4],ue=l[5],_e=l[6],de=l[7],xe=l[8];return o[0]=$*d+H*w+q*P,o[1]=$*p+H*E+q*L,o[2]=$*v+H*k+q*F,o[3]=K*d+ne*w+ue*P,o[4]=K*p+ne*E+ue*L,o[5]=K*v+ne*k+ue*F,o[6]=_e*d+de*w+xe*P,o[7]=_e*p+de*E+xe*L,o[8]=_e*v+de*k+xe*F,o}function Ca(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Yb(o,n){var l=n[0],d=n[1],p=n[2],v=n[3],w=n[4],E=n[5],k=n[6],P=n[7],L=n[8],F=n[9],$=n[10],H=n[11],q=n[12],K=n[13],ne=n[14],ue=n[15],_e=l*E-d*w,de=l*k-p*w,xe=l*P-v*w,be=d*k-p*E,we=d*P-v*E,Ve=p*P-v*k,Fe=L*K-F*q,Qe=L*ne-$*q,pt=L*ue-H*q,We=F*ne-$*K,st=F*ue-H*K,ot=$*ue-H*ne,ut=_e*ot-de*st+xe*We+be*pt-we*Qe+Ve*Fe;return ut?(o[0]=(E*ot-k*st+P*We)*(ut=1/ut),o[1]=(p*st-d*ot-v*We)*ut,o[2]=(K*Ve-ne*we+ue*be)*ut,o[3]=($*we-F*Ve-H*be)*ut,o[4]=(k*pt-w*ot-P*Qe)*ut,o[5]=(l*ot-p*pt+v*Qe)*ut,o[6]=(ne*xe-q*Ve-ue*de)*ut,o[7]=(L*Ve-$*xe+H*de)*ut,o[8]=(w*st-E*pt+P*Fe)*ut,o[9]=(d*pt-l*st-v*Fe)*ut,o[10]=(q*we-K*xe+ue*_e)*ut,o[11]=(F*xe-L*we-H*_e)*ut,o[12]=(E*Qe-w*We-k*Fe)*ut,o[13]=(l*We-d*Qe+p*Fe)*ut,o[14]=(K*de-q*be-ne*_e)*ut,o[15]=(L*be-F*de+$*_e)*ut,o):null}function jd(o,n,l){var d=n[0],p=n[1],v=n[2],w=n[3],E=n[4],k=n[5],P=n[6],L=n[7],F=n[8],$=n[9],H=n[10],q=n[11],K=n[12],ne=n[13],ue=n[14],_e=n[15],de=l[0],xe=l[1],be=l[2],we=l[3];return o[0]=de*d+xe*E+be*F+we*K,o[1]=de*p+xe*k+be*$+we*ne,o[2]=de*v+xe*P+be*H+we*ue,o[3]=de*w+xe*L+be*q+we*_e,o[4]=(de=l[4])*d+(xe=l[5])*E+(be=l[6])*F+(we=l[7])*K,o[5]=de*p+xe*k+be*$+we*ne,o[6]=de*v+xe*P+be*H+we*ue,o[7]=de*w+xe*L+be*q+we*_e,o[8]=(de=l[8])*d+(xe=l[9])*E+(be=l[10])*F+(we=l[11])*K,o[9]=de*p+xe*k+be*$+we*ne,o[10]=de*v+xe*P+be*H+we*ue,o[11]=de*w+xe*L+be*q+we*_e,o[12]=(de=l[12])*d+(xe=l[13])*E+(be=l[14])*F+(we=l[15])*K,o[13]=de*p+xe*k+be*$+we*ne,o[14]=de*v+xe*P+be*H+we*ue,o[15]=de*w+xe*L+be*q+we*_e,o}function gg(o,n,l){var d,p,v,w,E,k,P,L,F,$,H,q,K=l[0],ne=l[1],ue=l[2];return n===o?(o[12]=n[0]*K+n[4]*ne+n[8]*ue+n[12],o[13]=n[1]*K+n[5]*ne+n[9]*ue+n[13],o[14]=n[2]*K+n[6]*ne+n[10]*ue+n[14],o[15]=n[3]*K+n[7]*ne+n[11]*ue+n[15]):(p=n[1],v=n[2],w=n[3],E=n[4],k=n[5],P=n[6],L=n[7],F=n[8],$=n[9],H=n[10],q=n[11],o[0]=d=n[0],o[1]=p,o[2]=v,o[3]=w,o[4]=E,o[5]=k,o[6]=P,o[7]=L,o[8]=F,o[9]=$,o[10]=H,o[11]=q,o[12]=d*K+E*ne+F*ue+n[12],o[13]=p*K+k*ne+$*ue+n[13],o[14]=v*K+P*ne+H*ue+n[14],o[15]=w*K+L*ne+q*ue+n[15]),o}function Ld(o,n,l){var d=l[0],p=l[1],v=l[2];return o[0]=n[0]*d,o[1]=n[1]*d,o[2]=n[2]*d,o[3]=n[3]*d,o[4]=n[4]*p,o[5]=n[5]*p,o[6]=n[6]*p,o[7]=n[7]*p,o[8]=n[8]*v,o[9]=n[9]*v,o[10]=n[10]*v,o[11]=n[11]*v,o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15],o}function Kb(o,n,l){var d=Math.sin(l),p=Math.cos(l),v=n[4],w=n[5],E=n[6],k=n[7],P=n[8],L=n[9],F=n[10],$=n[11];return n!==o&&(o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[3],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o[4]=v*p+P*d,o[5]=w*p+L*d,o[6]=E*p+F*d,o[7]=k*p+$*d,o[8]=P*p-v*d,o[9]=L*p-w*d,o[10]=F*p-E*d,o[11]=$*p-k*d,o}function l_(o,n,l){var d=Math.sin(l),p=Math.cos(l),v=n[0],w=n[1],E=n[2],k=n[3],P=n[8],L=n[9],F=n[10],$=n[11];return n!==o&&(o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=n[7],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o[0]=v*p-P*d,o[1]=w*p-L*d,o[2]=E*p-F*d,o[3]=k*p-$*d,o[8]=v*d+P*p,o[9]=w*d+L*p,o[10]=E*d+F*p,o[11]=k*d+$*p,o}function OA(o,n){return o[0]=n[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=n[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=n[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function zA(o,n,l){var d,p,v,w=l[0],E=l[1],k=l[2],P=Math.hypot(w,E,k);return P<a_?null:(w*=P=1/P,E*=P,k*=P,d=Math.sin(n),p=Math.cos(n),o[0]=w*w*(v=1-p)+p,o[1]=E*w*v+k*d,o[2]=k*w*v-E*d,o[3]=0,o[4]=w*E*v-k*d,o[5]=E*E*v+p,o[6]=k*E*v+w*d,o[7]=0,o[8]=w*k*v+E*d,o[9]=E*k*v-w*d,o[10]=k*k*v+p,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)}Math.hypot||(Math.hypot=function(){for(var o=0,n=arguments.length;n--;)o+=arguments[n]*arguments[n];return Math.sqrt(o)});var V$=jd;function Qb(){var o=new Hs(3);return Hs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function FA(o){var n=new Hs(3);return n[0]=o[0],n[1]=o[1],n[2]=o[2],n}function yg(o){return Math.hypot(o[0],o[1],o[2])}function xf(o,n,l){var d=new Hs(3);return d[0]=o,d[1]=n,d[2]=l,d}function Gl(o,n,l){return o[0]=n[0]+l[0],o[1]=n[1]+l[1],o[2]=n[2]+l[2],o}function Jb(o,n,l){return o[0]=n[0]-l[0],o[1]=n[1]-l[1],o[2]=n[2]-l[2],o}function BA(o,n,l){return o[0]=n[0]*l[0],o[1]=n[1]*l[1],o[2]=n[2]*l[2],o}function vg(o,n,l){return o[0]=Math.min(n[0],l[0]),o[1]=Math.min(n[1],l[1]),o[2]=Math.min(n[2],l[2]),o}function xg(o,n,l){return o[0]=Math.max(n[0],l[0]),o[1]=Math.max(n[1],l[1]),o[2]=Math.max(n[2],l[2]),o}function vo(o,n,l){return o[0]=n[0]*l,o[1]=n[1]*l,o[2]=n[2]*l,o}function _g(o,n,l,d){return o[0]=n[0]+l[0]*d,o[1]=n[1]+l[1]*d,o[2]=n[2]+l[2]*d,o}function ss(o,n){var l=n[0],d=n[1],p=n[2],v=l*l+d*d+p*p;return v>0&&(v=1/Math.sqrt(v)),o[0]=n[0]*v,o[1]=n[1]*v,o[2]=n[2]*v,o}function Go(o,n){return o[0]*n[0]+o[1]*n[1]+o[2]*n[2]}function eS(o,n,l){var d=n[0],p=n[1],v=n[2],w=l[0],E=l[1],k=l[2];return o[0]=p*k-v*E,o[1]=v*w-d*k,o[2]=d*E-p*w,o}function Gn(o,n,l){var d=n[0],p=n[1],v=n[2],w=l[3]*d+l[7]*p+l[11]*v+l[15];return o[0]=(l[0]*d+l[4]*p+l[8]*v+l[12])/(w=w||1),o[1]=(l[1]*d+l[5]*p+l[9]*v+l[13])/w,o[2]=(l[2]*d+l[6]*p+l[10]*v+l[14])/w,o}function UA(o,n,l){var d=l[0],p=l[1],v=l[2],w=n[0],E=n[1],k=n[2],P=p*k-v*E,L=v*w-d*k,F=d*E-p*w,$=p*F-v*L,H=v*P-d*F,q=d*L-p*P,K=2*l[3];return L*=K,F*=K,H*=2,q*=2,o[0]=w+(P*=K)+($*=2),o[1]=E+L+H,o[2]=k+F+q,o}var wg,Ma=Jb,$$=BA,W$=yg;function VA(o,n,l){return o[0]=n[0]*l,o[1]=n[1]*l,o[2]=n[2]*l,o[3]=n[3]*l,o}function $A(o,n){var l=n[0],d=n[1],p=n[2],v=n[3],w=l*l+d*d+p*p+v*v;return w>0&&(w=1/Math.sqrt(w)),o[0]=l*w,o[1]=d*w,o[2]=p*w,o[3]=v*w,o}function Od(o,n,l){var d=n[0],p=n[1],v=n[2],w=n[3];return o[0]=l[0]*d+l[4]*p+l[8]*v+l[12]*w,o[1]=l[1]*d+l[5]*p+l[9]*v+l[13]*w,o[2]=l[2]*d+l[6]*p+l[10]*v+l[14]*w,o[3]=l[3]*d+l[7]*p+l[11]*v+l[15]*w,o}function WA(){var o=new Hs(4);return Hs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function GA(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function HA(o,n,l){l*=.5;var d=n[0],p=n[1],v=n[2],w=n[3],E=Math.sin(l),k=Math.cos(l);return o[0]=d*k+w*E,o[1]=p*k+v*E,o[2]=v*k-p*E,o[3]=w*k-d*E,o}function qA(o,n,l){l*=.5;var d=n[0],p=n[1],v=n[2],w=n[3],E=Math.sin(l),k=Math.cos(l);return o[0]=d*k-v*E,o[1]=p*k+w*E,o[2]=v*k+d*E,o[3]=w*k-p*E,o}Qb(),wg=new Hs(4),Hs!=Float32Array&&(wg[0]=0,wg[1]=0,wg[2]=0,wg[3]=0);var G$=$A;Qb(),xf(1,0,0),xf(0,1,0),WA(),WA(),jA();const H$=De([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ZA}=H$,XA=De([{name:"a_pos_3",components:3,type:"Int16"}]);var bg=De([{name:"a_pos",type:"Int16",components:2}]);class tS{constructor(n,l){this.pos=n,this.dir=l}intersectsPlane(n,l,d){const p=Go(l,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((n[0]-this.pos[0])*l[0]+(n[1]-this.pos[1])*l[1]+(n[2]-this.pos[2])*l[2])/p;return d[0]=this.pos[0]+this.dir[0]*v,d[1]=this.pos[1]+this.dir[1]*v,d[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(n,l,d){if(function(H,q){var K=H[0],ne=H[1],ue=H[2],_e=q[0],de=q[1],xe=q[2];return Math.abs(K-_e)<=a_*Math.max(1,Math.abs(K),Math.abs(_e))&&Math.abs(ne-de)<=a_*Math.max(1,Math.abs(ne),Math.abs(de))&&Math.abs(ue-xe)<=a_*Math.max(1,Math.abs(ue),Math.abs(xe))}(this.pos,n)||l===0)return d[0]=d[1]=d[2]=0,!1;const[p,v,w]=this.dir,E=this.pos[0]-n[0],k=this.pos[1]-n[1],P=this.pos[2]-n[2],L=p*p+v*v+w*w,F=2*(E*p+k*v+P*w),$=F*F-4*L*(E*E+k*k+P*P-l*l);if($<0){const H=Math.max(-F/2,0),q=E+p*H,K=k+v*H,ne=P+w*H,ue=Math.hypot(q,K,ne);return d[0]=q*l/ue,d[1]=K*l/ue,d[2]=ne*l/ue,!1}{const H=(-F-Math.sqrt($))/(2*L);if(H<0){const q=Math.hypot(E,k,P);return d[0]=E*l/q,d[1]=k*l/q,d[2]=P*l/q,!1}return d[0]=E+p*H,d[1]=k+v*H,d[2]=P+w*H,!0}}}class rS{constructor(n,l,d,p,v){this.TL=n,this.TR=l,this.BR=d,this.BL=p,this.horizon=v}static fromInvProjectionMatrix(n,l,d){const p=[-1,1,1],v=[1,1,1],w=[1,-1,1],E=[-1,-1,1],k=Gn(p,p,n),P=Gn(v,v,n),L=Gn(w,w,n),F=Gn(E,E,n);return new rS(k,P,L,F,l/d)}}class nS{constructor(n,l){this.points=n,this.planes=l}static fromInvProjectionMatrix(n,l,d,p){const v=Math.pow(2,d),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const P=Od([],k,n),L=1/P[3]/l*v;return function(F,$,H){return F[0]=$[0]*H[0],F[1]=$[1]*H[1],F[2]=$[2]*H[2],F[3]=$[3]*H[3],F}(P,P,[L,L,p?1/P[3]:L,L])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const P=ss([],eS([],Ma([],w[k[0]],w[k[1]]),Ma([],w[k[2]],w[k[1]]))),L=-Go(P,w[k[1]]);return P.concat(L)});return new nS(w,E)}}class os{static fromPoints(n){const l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const p of n)vg(l,l,p),xg(d,d,p);return new os(l,d)}static applyTransform(n,l){const d=n.getCorners();for(let p=0;p<d.length;++p)Gn(d[p],d[p],l);return os.fromPoints(d)}constructor(n,l){this.min=n,this.max=l,this.center=vo([],Gl([],this.min,this.max),.5)}quadrant(n){const l=[n%2==0,n<2],d=FA(this.min),p=FA(this.max);for(let v=0;v<l.length;v++)d[v]=l[v]?this.min[v]:this.center[v],p[v]=l[v]?this.center[v]:this.max[v];return p[2]=this.max[2],new os(d,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,l=this.max;return[[n[0],n[1],n[2]],[l[0],n[1],n[2]],[l[0],l[1],n[2]],[n[0],l[1],n[2]],[n[0],n[1],l[2]],[l[0],n[1],l[2]],[l[0],l[1],l[2]],[n[0],l[1],l[2]]]}intersects(n){const l=this.getCorners();let d=!0;for(let p=0;p<n.planes.length;p++){const v=n.planes[p];let w=0;for(let E=0;E<l.length;E++)w+=Go(v,l[E])+v[3]>=0;if(w===0)return 0;w!==l.length&&(d=!1)}if(d)return 2;for(let p=0;p<3;p++){let v=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){const k=n.points[E][p]-this.min[p];v=Math.min(v,k),w=Math.max(w,k)}if(w<0||v>this.max[p]-this.min[p])return 0}return 1}}const iS=5,YA=6,tl=rr/Math.PI/2,q$=16383,zd=64,Sg=[zd,32,16],Ho=-tl,qo=tl,Z$=[new os([Ho,Ho,Ho],[qo,qo,qo]),new os([Ho,Ho,Ho],[0,0,qo]),new os([0,Ho,Ho],[qo,0,qo]),new os([Ho,0,Ho],[0,qo,qo]),new os([0,0,Ho],[qo,qo,qo])];function c_(o){return o*tl/Cg}function KA(o,n,l,d=!0){const p=vo([],o._camera.position,o.worldSize),v=[n,l,1,1];Od(v,v,o.pixelMatrixInverse),VA(v,v,1/v[3]);const w=ss([],Ma([],v,p)),E=o.globeMatrix,k=[E[12],E[13],E[14]],P=Ma([],k,p),L=yg(P),F=ss([],P),$=o.worldSize/(2*Math.PI),H=Go(F,w),q=Math.asin($/L);if(q<Math.acos(H)){if(!d)return null;const pt=[],We=[];vo(pt,w,L/H),ss(We,Ma(We,pt,P)),ss(w,Gl(w,P,vo(w,We,Math.tan(q)*L)))}const K=[];new tS(p,w).closestPointOnSphere(k,$,K);const ne=ss([],Qt(E,0)),ue=ss([],Qt(E,1)),_e=ss([],Qt(E,2)),de=Go(ne,K),xe=Go(ue,K),be=Go(_e,K),we=rt(Math.asin(-xe/$));let Ve=rt(Math.atan2(de,be));Ve=o.center.lng+function(pt,We){const st=(We-pt+180)%360-180;return st<-180?st+360:st}(o.center.lng,Ve);const Fe=nl(Ve),Qe=Re(il(we),0,1);return new Sf(Fe,Qe)}class X${constructor(n,l,d){this.a=Ma([],n,d),this.b=Ma([],l,d),this.center=d;const p=ss([],this.a),v=ss([],this.b);this.angle=Math.acos(Go(p,v))}}function sS(o,n){if(o.angle===0)return null;let l;return l=o.a[n]===0?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[n]/o.a[n]/Math.sin(o.angle)-1/Math.tan(o.angle)),l<0||l>1?null:function(d,p,v,w){const E=Math.sin(v);return d*(Math.sin((1-w)*v)/E)+p*(Math.sin(w*v)/E)}(o.a[n],o.b[n],o.angle,Re(l,0,1))+o.center[n]}function rl(o){if(o.z<=1)return Z$[o.z+2*o.y+o.x];const n=oS(u_(o));return os.fromPoints(n)}function Fd(o,n,l){return vo(o,o,1-l),_g(o,o,n,l)}function QA(o,n){const l=bf(n.zoom);if(l===0)return rl(o);const d=u_(o),p=oS(d),v=nl(d.getWest())*n.worldSize,w=nl(d.getEast())*n.worldSize,E=il(d.getNorth())*n.worldSize,k=il(d.getSouth())*n.worldSize,P=[v,E,0],L=[w,E,0],F=[v,k,0],$=[w,k,0],H=Yb([],n.globeMatrix);return Gn(P,P,H),Gn(L,L,H),Gn(F,F,H),Gn($,$,H),p[0]=Fd(p[0],F,l),p[1]=Fd(p[1],$,l),p[2]=Fd(p[2],L,l),p[3]=Fd(p[3],P,l),os.fromPoints(p)}function JA(o,n,l){for(const d of o)Gn(d,d,n),vo(d,d,l)}function Y$(o,n,l){const d=n/o.worldSize,p=o.globeMatrix;if(l.z<=1){const Fe=rl(l).getCorners();return JA(Fe,p,d),os.fromPoints(Fe)}const v=u_(l),w=oS(v);JA(w,p,d);const E=Number.MAX_VALUE,k=[-E,-E,-E],P=[E,E,E];if(v.contains(o.center)){for(const pt of w)vg(P,P,pt),xg(k,k,pt);k[2]=0;const Fe=o.point,Qe=[Fe.x*d,Fe.y*d,0];return vg(P,P,Qe),xg(k,k,Qe),new os(P,k)}const L=[p[12]*d,p[13]*d,p[14]*d],F=v.getCenter(),$=Re(o.center.lat,-Ui,Ui),H=Re(F.lat,-Ui,Ui),q=nl(o.center.lng),K=il($);let ne=q-nl(F.lng);const ue=K-il(H);ne>.5?ne-=1:ne<-.5&&(ne+=1);let _e=0;Math.abs(ne)>Math.abs(ue)?_e=ne>=0?1:3:(_e=ue>=0?0:2,_g(L,L,[p[4]*d,p[5]*d,p[6]*d],-Math.sin(Ie(ue>=0?v.getSouth():v.getNorth()))*tl));const de=w[_e],xe=w[(_e+1)%4],be=new X$(de,xe,L),we=[sS(be,0)||de[0],sS(be,1)||de[1],sS(be,2)||de[2]],Ve=bf(o.zoom);if(Ve>0){const Fe=function({x:pt,y:We,z:st},ot,ut,xt,Xe){const Rt=1/(1<<st);let Ht=pt*Rt,Lt=Ht+Rt,mr=We*Rt,_t=mr+Rt,Jt=0;const gr=(Ht+Lt)/2-xt;return gr>.5?Jt=-1:gr<-.5&&(Jt=1),Ht=((Ht+Jt)*ot-(xt*=ot))*ut+xt,Lt=((Lt+Jt)*ot-xt)*ut+xt,mr=(mr*ot-(Xe*=ot))*ut+Xe,_t=(_t*ot-Xe)*ut+Xe,[[Ht,_t,0],[Lt,_t,0],[Lt,mr,0],[Ht,mr,0]]}(l,n,o._pixelsPerMercatorPixel,q,K);for(let pt=0;pt<w.length;pt++)Fd(w[pt],Fe[pt],Ve);const Qe=Gl([],Fe[_e],Fe[(_e+1)%4]);vo(Qe,Qe,.5),Fd(we,Qe,Ve)}for(const Fe of w)vg(P,P,Fe),xg(k,k,Fe);return P[2]=Math.min(de[2],xe[2]),vg(P,P,we),xg(k,k,we),new os(P,k)}function u_({x:o,y:n,z:l}){const d=1/(1<<l),p=new un(xo(o*d),Bi((n+1)*d)),v=new un(xo((o+1)*d),Bi(n*d));return new Zc(p,v)}function oS(o){const n=Ie(o.getNorth()),l=Ie(o.getSouth()),d=Math.cos(n),p=Math.cos(l),v=Math.sin(n),w=Math.sin(l),E=o.getWest(),k=o.getEast();return[_f(p,w,E),_f(p,w,k),_f(d,v,k),_f(d,v,E)]}function _f(o,n,l,d=tl){return l=Ie(l),[o*Math.sin(l)*d,-n*d,o*Math.cos(l)*d]}function wf(o,n,l){return _f(Math.cos(Ie(o)),Math.sin(Ie(o)),n,l)}function Eg(o,n,l,d){const p=1<<l.z,v=(o/rr+l.x)/p;return wf(Bi((n/rr+l.y)/p),xo(v),d)}function d_({min:o,max:n}){return q$/Math.max(n[0]-o[0],n[1]-o[1],n[2]-o[2])}const eI=new Float64Array(16);function Tg(o){const n=d_(o),l=OA(eI,[n,n,n]);return gg(l,l,((d=[])[0]=-(p=o.min)[0],d[1]=-p[1],d[2]=-p[2],d));var d,p}function aS(o){const n=(d=o.min,(l=eI)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=d[0],l[13]=d[1],l[14]=d[2],l[15]=1,l);var l,d;const p=1/d_(o);return Ld(n,n,[p,p,p])}function tI(o,n,l,d,p){const v=function(k){const P=rr/(2*Math.PI);return k/(2*Math.PI)/P}(l),w=[o,n,-l/(2*Math.PI)],E=Ca(new Float64Array(16));return gg(E,E,w),Ld(E,E,[v,v,v]),Kb(E,E,Ie(-p)),l_(E,E,Ie(-d)),E}function bf(o){return Tt(iS,YA,o)}function rI(o,n){const l=wf(n.lat,n.lng),d=function(q){const K=wf(q._center.lat,q._center.lng);let ne=eS([],xf(0,1,0),K);const ue=zA([],-q.angle,K);ne=Gn(ne,ne,ue),zA(ue,-q._pitch,ne);const _e=ss([],K);return vo(_e,_e,c_(q.cameraToCenterDistance/q.pixelsPerMeter)),Gn(_e,_e,ue),Gl([],K,_e)}(o);return w=(p=Jb([],d,l))[0],E=p[1],k=p[2],P=(v=l)[0],L=v[1],F=v[2],H=($=Math.sqrt(w*w+E*E+k*k)*Math.sqrt(P*P+L*L+F*F))&&Go(p,v)/$,Math.acos(Math.min(Math.max(H,-1),1));var p,v,w,E,k,P,L,F,$,H}function lS(o,n){return rI(o,n)>Math.PI/2*1.01}const nI=Ie(85),K$=Math.cos(nI),Q$=Math.sin(nI),Cg=63710088e-1,iI=2*Math.PI*Cg;class Xc{constructor(n,l){if(isNaN(n)||isNaN(l))throw new Error(`Invalid LngLat object: (${n}, ${l})`);if(this.lng=+n,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xc(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const l=Math.PI/180,d=this.lat*l,p=n.lat*l,v=Math.sin(d)*Math.sin(p)+Math.cos(d)*Math.cos(p)*Math.cos((n.lng-this.lng)*l);return Cg*Math.acos(Math.min(v,1))}toBounds(n=0){const l=360*n/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new Zc(new Xc(this.lng-d,this.lat-l),new Xc(this.lng+d,this.lat+l))}toEcef(n){const l=c_(n);return wf(this.lat,this.lng,tl+l)}static convert(n){if(n instanceof Xc)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Xc(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Xc(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var un=Xc;function cS(o){return iI*Math.cos(o*Math.PI/180)}function nl(o){return(180+o)/360}function il(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function ka(o,n){return o/cS(n)}function xo(o){return 360*o-180}function Bi(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function sI(o,n){return o*cS(Bi(n))}const Ui=85.051129;function oI(o){return 1/Math.cos(o*Math.PI/180)}class Sf{constructor(n,l,d=0){this.x=+n,this.y=+l,this.z=+d}static fromLngLat(n,l=0){const d=un.convert(n);return new Sf(nl(d.lng),il(d.lat),ka(l,d.lat))}toLngLat(){return new un(xo(this.x),Bi(this.y))}toAltitude(){return sI(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/iI*oI(Bi(this.y))}}function uS(o,n,l,d,p,v,w,E,k){const P=(n+d)/2,L=(l+p)/2,F=new he(P,L);E(F),function($,H,q,K,ne,ue){const _e=q-ne,de=K-ue;return Math.abs((K-H)*_e-(q-$)*de)/Math.hypot(_e,de)}(F.x,F.y,v.x,v.y,w.x,w.y)>=k?(uS(o,n,l,P,L,v,F,E,k),uS(o,P,L,d,p,F,w,E,k)):o.push(w)}function aI(o,n,l){let d=o[0],p=d.x,v=d.y;n(d);const w=[d];for(let E=1;E<o.length;E++){const k=o[E],{x:P,y:L}=k;n(k),uS(w,p,v,P,L,d,k,n,l),p=P,v=L,d=k}return w}function dS(o,n,l,d){if(d(n,l)){const p=n.add(l)._mult(.5);dS(o,n,p,d),dS(o,p,l,d)}else o.push(l)}function J$(o,n){let l=o[0];const d=[l];for(let p=1;p<o.length;p++){const v=o[p];dS(d,l,v,n),l=v}return d}const hS=Math.pow(2,14)-1,lI=-hS-1;function e2(o,n){const l=Math.round(o.x*n),d=Math.round(o.y*n);return o.x=Re(l,lI,hS),o.y=Re(d,lI,hS),(l<o.x||l>o.x+1||d<o.y||d>o.y+1)&&Ir("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function Hl(o,n,l){const d=o.loadGeometry(),p=o.extent,v=rr/p;if(n&&l&&l.projection.isReprojectedInTileSpace){const w=1<<n.z,{scale:E,x:k,y:P,projection:L}=l,F=$=>{const H=xo((n.x+$.x/p)/w),q=Bi((n.y+$.y/p)/w),K=L.project(H,q);$.x=(K.x*E-k)*p,$.y=(K.y*E-P)*p};for(let $=0;$<d.length;$++)if(o.type!==1)d[$]=aI(d[$],F,1);else{const H=[];for(const q of d[$])q.x<0||q.x>=p||q.y<0||q.y>=p||(F(q),H.push(q));d[$]=H}}for(const w of d)for(const E of w)e2(E,v);return d}function Bd(o,n){return{type:o.type,id:o.id,properties:o.properties,geometry:n?Hl(o):[]}}function h_(o,n,l,d,p){o.emplaceBack(2*n+(d+1)/2,2*l+(p+1)/2)}function f_(o,n,l){o.emplaceBack(n.x,n.y,n.z,l[0]*16384,l[1]*16384,l[2]*16384)}class fS{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(l=>l.id),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new ft,this.indexArray=new qt,this.segments=new Yn,this.programConfigurations=new Nd(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(n,l,d,p){const v=this.layers[0],w=[];let E=null;v.type==="circle"&&(E=v.layout.get("circle-sort-key"));for(const{feature:P,id:L,index:F,sourceLayerIndex:$}of n){const H=this.layers[0]._featureFilter.needGeometry,q=Bd(P,H);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),q,d))continue;const K=E?E.evaluate(q,{},d):void 0,ne={id:L,properties:P.properties,type:P.type,sourceLayerIndex:$,index:F,geometry:H?q.geometry:Hl(P,d,p),patterns:{},sortKey:K};w.push(ne)}E&&w.sort((P,L)=>P.sortKey-L.sortKey);let k=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new mt,k=p.projection);for(const P of w){const{geometry:L,index:F,sourceLayerIndex:$}=P,H=n[F].feature;this.addFeature(P,L,F,l.availableImages,d,k),l.featureIndex.insert(H,L,F,$,this.index)}}update(n,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,l,this.stateDependentLayers,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,B$.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,U$.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,l,d,p,v,w){for(const E of l)for(const k of E){const P=k.x,L=k.y;if(P<0||P>=rr||L<0||L>=rr)continue;if(w){const H=w.projectTilePoint(P,L,v),q=w.upVector(v,P,L),K=this.globeExtVertexArray;f_(K,H,q),f_(K,H,q),f_(K,H,q),f_(K,H,q)}const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),$=F.vertexLength;h_(this.layoutVertexArray,P,L,-1,-1),h_(this.layoutVertexArray,P,L,1,-1),h_(this.layoutVertexArray,P,L,1,1),h_(this.layoutVertexArray,P,L,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,d,{},p,v)}}function cI(o,n){for(let l=0;l<o.length;l++)if(Ud(n,o[l]))return!0;for(let l=0;l<n.length;l++)if(Ud(o,n[l]))return!0;return!!pS(o,n)}function t2(o,n,l){return!!Ud(o,n)||!!mS(n,o,l)}function uI(o,n){if(o.length===1)return hI(n,o[0]);for(let l=0;l<n.length;l++){const d=n[l];for(let p=0;p<d.length;p++)if(Ud(o,d[p]))return!0}for(let l=0;l<o.length;l++)if(hI(n,o[l]))return!0;for(let l=0;l<n.length;l++)if(pS(o,n[l]))return!0;return!1}function r2(o,n,l){if(o.length>1){if(pS(o,n))return!0;for(let d=0;d<n.length;d++)if(mS(n[d],o,l))return!0}for(let d=0;d<o.length;d++)if(mS(o[d],n,l))return!0;return!1}function pS(o,n){if(o.length===0||n.length===0)return!1;for(let l=0;l<o.length-1;l++){const d=o[l],p=o[l+1];for(let v=0;v<n.length-1;v++)if(n2(d,p,n[v],n[v+1]))return!0}return!1}function n2(o,n,l,d){return Rn(o,l,d)!==Rn(n,l,d)&&Rn(o,n,l)!==Rn(o,n,d)}function mS(o,n,l){const d=l*l;if(n.length===1)return o.distSqr(n[0])<d;for(let p=1;p<n.length;p++)if(dI(o,n[p-1],n[p])<d)return!0;return!1}function dI(o,n,l){const d=n.distSqr(l);if(d===0)return o.distSqr(n);const p=((o.x-n.x)*(l.x-n.x)+(o.y-n.y)*(l.y-n.y))/d;return o.distSqr(p<0?n:p>1?l:l.sub(n)._mult(p)._add(n))}function hI(o,n){let l,d,p,v=!1;for(let w=0;w<o.length;w++){l=o[w];for(let E=0,k=l.length-1;E<l.length;k=E++)d=l[E],p=l[k],d.y>n.y!=p.y>n.y&&n.x<(p.x-d.x)*(n.y-d.y)/(p.y-d.y)+d.x&&(v=!v)}return v}function Ud(o,n){let l=!1;for(let d=0,p=o.length-1;d<o.length;p=d++){const v=o[d],w=o[p];v.y>n.y!=w.y>n.y&&n.x<(w.x-v.x)*(n.y-v.y)/(w.y-v.y)+v.x&&(l=!l)}return l}function fI(o,n,l,d,p){for(const w of o)if(n<=w.x&&l<=w.y&&d>=w.x&&p>=w.y)return!0;const v=[new he(n,l),new he(n,p),new he(d,p),new he(d,l)];if(o.length>2){for(const w of v)if(Ud(o,w))return!0}for(let w=0;w<o.length-1;w++)if(i2(o[w],o[w+1],v))return!0;return!1}function i2(o,n,l){const d=l[0],p=l[2];if(o.x<d.x&&n.x<d.x||o.x>p.x&&n.x>p.x||o.y<d.y&&n.y<d.y||o.y>p.y&&n.y>p.y)return!1;const v=Rn(o,n,l[0]);return v!==Rn(o,n,l[1])||v!==Rn(o,n,l[2])||v!==Rn(o,n,l[3])}function Ef(o,n,l){const d=n.paint.get(o).value;return d.kind==="constant"?d.value:l.programConfigurations.get(n.id).getMaxValue(o)}function p_(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function pI(o,n,l,d,p){if(!n[0]&&!n[1])return o;const v=he.convert(n)._mult(p);l==="viewport"&&v._rotate(-d);const w=[];for(let E=0;E<o.length;E++)w.push(o[E].sub(v));return w}function mI(o,n,l,d){const p=he.convert(o)._mult(d);return n==="viewport"&&p._rotate(-l),p}$t(fS,"CircleBucket",{omit:["layers"]});const s2=new ge({"circle-sort-key":new ie(Ye.layout_circle["circle-sort-key"])});var o2={paint:new ge({"circle-radius":new ie(Ye.paint_circle["circle-radius"]),"circle-color":new ie(Ye.paint_circle["circle-color"]),"circle-blur":new ie(Ye.paint_circle["circle-blur"]),"circle-opacity":new ie(Ye.paint_circle["circle-opacity"]),"circle-translate":new Y(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Y(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Y(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Y(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ie(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ie(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ie(Ye.paint_circle["circle-stroke-opacity"])}),layout:s2};function gI(o,n,l,d,p,v,w,E,k){if(v&&o.queryGeometry.isAboveHorizon)return!1;v&&(k*=o.pixelToTileUnitsFactor);const P=o.tileID.canonical,L=l.projection.upVectorScale(P,l.center.lat,l.worldSize).metersToTile;for(const F of n)for(const $ of F){const H=$.add(E),q=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(H.x,H.y,!0):0,K=l.projection.projectTilePoint(H.x,H.y,P);if(q>0){const de=l.projection.upVector(P,H.x,H.y);K.x+=de[0]*L*q,K.y+=de[1]*L*q,K.z+=de[2]*L*q}const ne=v?H:a2(K.x,K.y,K.z,d),ue=v?o.tilespaceRays.map(de=>c2(de,q)):o.queryGeometry.screenGeometry,_e=Od([],[K.x,K.y,K.z,1],d);if(!w&&v?k*=_e[3]/l.cameraToCenterDistance:w&&!v&&(k*=l.cameraToCenterDistance/_e[3]),v){const de=Bi(($.y/rr+P.y)/(1<<P.z));k/=l.projection.pixelsPerMeter(de,1)/ka(1,de)}if(t2(ue,ne,k))return!0}return!1}function a2(o,n,l,d){const p=Od([],[o,n,l,1],d);return new he(p[0]/p[3],p[1]/p[3])}const yI=xf(0,0,0),l2=xf(0,0,1);function c2(o,n){const l=Qb();return yI[2]=n,o.intersectsPlane(yI,l2,l),new he(l[0],l[1])}class vI extends fS{}function xI(o,{width:n,height:l},d,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*l*d)throw new RangeError("mismatched image size")}else p=new Uint8Array(n*l*d);return o.width=n,o.height=l,o.data=p,o}function _I(o,n,l){const{width:d,height:p}=n;d===o.width&&p===o.height||(gS(o,n,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,d),height:Math.min(o.height,p)},l),o.width=d,o.height=p,o.data=n.data)}function gS(o,n,l,d,p,v){if(p.width===0||p.height===0)return n;if(p.width>o.width||p.height>o.height||l.x>o.width-p.width||l.y>o.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||d.x>n.width-p.width||d.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const w=o.data,E=n.data;for(let k=0;k<p.height;k++){const P=((l.y+k)*o.width+l.x)*v,L=((d.y+k)*n.width+d.x)*v;for(let F=0;F<p.width*v;F++)E[L+F]=w[P+F]}return n}$t(vI,"HeatmapBucket",{omit:["layers"]});class ql{constructor(n,l){xI(this,n,1,l)}resize(n){_I(this,new ql(n),1)}clone(){return new ql({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,l,d,p,v){gS(n,l,d,p,v,1)}}class qs{constructor(n,l){xI(this,n,4,l)}resize(n){_I(this,new qs(n),4)}replace(n,l){l?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,l,d,p,v){gS(n,l,d,p,v,4)}}$t(ql,"AlphaImage"),$t(qs,"RGBAImage");var u2={paint:new ge({"heatmap-radius":new ie(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ie(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Y(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fe(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Y(Ye.paint_heatmap["heatmap-opacity"])})};function yS(o){const n={},l=o.resolution||256,d=o.clips?o.clips.length:1,p=o.image||new qs({width:l,height:d}),v=(w,E,k)=>{n[o.evaluationKey]=k;const P=o.expression.evaluate(n);p.data[w+E+0]=Math.floor(255*P.r/P.a),p.data[w+E+1]=Math.floor(255*P.g/P.a),p.data[w+E+2]=Math.floor(255*P.b/P.a),p.data[w+E+3]=Math.floor(255*P.a)};if(o.clips)for(let w=0,E=0;w<d;++w,E+=4*l)for(let k=0,P=0;k<l;k++,P+=4){const L=k/(l-1),{start:F,end:$}=o.clips[w];v(E,P,F*(1-L)+$*L)}else for(let w=0,E=0;w<l;w++,E+=4)v(0,E,w/(l-1));return p}var d2={paint:new ge({"hillshade-illumination-direction":new Y(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Y(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Y(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Y(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Y(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Y(Ye.paint_hillshade["hillshade-accent-color"])})};const h2=De([{name:"a_pos",components:2,type:"Int16"}],4),{members:f2}=h2;var vS={exports:{}};function m_(o,n,l){l=l||2;var d,p,v,w,E,k,P,L=n&&n.length,F=L?n[0]*l:o.length,$=wI(o,0,F,l,!0),H=[];if(!$||$.next===$.prev)return H;if(L&&($=function(K,ne,ue,_e){var de,xe,be,we=[];for(de=0,xe=ne.length;de<xe;de++)(be=wI(K,ne[de]*_e,de<xe-1?ne[de+1]*_e:K.length,_e,!1))===be.next&&(be.steiner=!0),we.push(w2(be));for(we.sort(v2),de=0;de<we.length;de++)ue=x2(we[de],ue);return ue}(o,n,$,l)),o.length>80*l){d=v=o[0],p=w=o[1];for(var q=l;q<F;q+=l)(E=o[q])<d&&(d=E),(k=o[q+1])<p&&(p=k),E>v&&(v=E),k>w&&(w=k);P=(P=Math.max(v-d,w-p))!==0?32767/P:0}return Mg($,H,l,d,p,P,0),H}function wI(o,n,l,d,p){var v,w;if(p===wS(o,n,l,d)>0)for(v=n;v<l;v+=d)w=EI(v,o[v],o[v+1],w);else for(v=l-d;v>=n;v-=d)w=EI(v,o[v],o[v+1],w);return w&&g_(w,w.next)&&(Pg(w),w=w.next),w}function Vd(o,n){if(!o)return o;n||(n=o);var l,d=o;do if(l=!1,d.steiner||!g_(d,d.next)&&Kn(d.prev,d,d.next)!==0)d=d.next;else{if(Pg(d),(d=n=d.prev)===d.next)break;l=!0}while(l||d!==n);return n}function Mg(o,n,l,d,p,v,w){if(o){!w&&v&&function(L,F,$,H){var q=L;do q.z===0&&(q.z=xS(q.x,q.y,F,$,H)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==L);q.prevZ.nextZ=null,q.prevZ=null,function(K){var ne,ue,_e,de,xe,be,we,Ve,Fe=1;do{for(ue=K,K=null,xe=null,be=0;ue;){for(be++,_e=ue,we=0,ne=0;ne<Fe&&(we++,_e=_e.nextZ);ne++);for(Ve=Fe;we>0||Ve>0&&_e;)we!==0&&(Ve===0||!_e||ue.z<=_e.z)?(de=ue,ue=ue.nextZ,we--):(de=_e,_e=_e.nextZ,Ve--),xe?xe.nextZ=de:K=de,de.prevZ=xe,xe=de;ue=_e}xe.nextZ=null,Fe*=2}while(be>1)}(q)}(o,d,p,v);for(var E,k,P=o;o.prev!==o.next;)if(E=o.prev,k=o.next,v?m2(o,d,p,v):p2(o))n.push(E.i/l|0),n.push(o.i/l|0),n.push(k.i/l|0),Pg(o),o=k.next,P=k.next;else if((o=k)===P){w?w===1?Mg(o=g2(Vd(o),n,l),n,l,d,p,v,2):w===2&&y2(o,n,l,d,p,v):Mg(Vd(o),n,l,d,p,v,1);break}}}function p2(o){var n=o.prev,l=o,d=o.next;if(Kn(n,l,d)>=0)return!1;for(var p=n.x,v=l.x,w=d.x,E=n.y,k=l.y,P=d.y,L=p<v?p<w?p:w:v<w?v:w,F=E<k?E<P?E:P:k<P?k:P,$=p>v?p>w?p:w:v>w?v:w,H=E>k?E>P?E:P:k>P?k:P,q=d.next;q!==n;){if(q.x>=L&&q.x<=$&&q.y>=F&&q.y<=H&&Tf(p,E,v,k,w,P,q.x,q.y)&&Kn(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function m2(o,n,l,d){var p=o.prev,v=o,w=o.next;if(Kn(p,v,w)>=0)return!1;for(var E=p.x,k=v.x,P=w.x,L=p.y,F=v.y,$=w.y,H=E<k?E<P?E:P:k<P?k:P,q=L<F?L<$?L:$:F<$?F:$,K=E>k?E>P?E:P:k>P?k:P,ne=L>F?L>$?L:$:F>$?F:$,ue=xS(H,q,n,l,d),_e=xS(K,ne,n,l,d),de=o.prevZ,xe=o.nextZ;de&&de.z>=ue&&xe&&xe.z<=_e;){if(de.x>=H&&de.x<=K&&de.y>=q&&de.y<=ne&&de!==p&&de!==w&&Tf(E,L,k,F,P,$,de.x,de.y)&&Kn(de.prev,de,de.next)>=0||(de=de.prevZ,xe.x>=H&&xe.x<=K&&xe.y>=q&&xe.y<=ne&&xe!==p&&xe!==w&&Tf(E,L,k,F,P,$,xe.x,xe.y)&&Kn(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;de&&de.z>=ue;){if(de.x>=H&&de.x<=K&&de.y>=q&&de.y<=ne&&de!==p&&de!==w&&Tf(E,L,k,F,P,$,de.x,de.y)&&Kn(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;xe&&xe.z<=_e;){if(xe.x>=H&&xe.x<=K&&xe.y>=q&&xe.y<=ne&&xe!==p&&xe!==w&&Tf(E,L,k,F,P,$,xe.x,xe.y)&&Kn(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function g2(o,n,l){var d=o;do{var p=d.prev,v=d.next.next;!g_(p,v)&&bI(p,d,d.next,v)&&kg(p,v)&&kg(v,p)&&(n.push(p.i/l|0),n.push(d.i/l|0),n.push(v.i/l|0),Pg(d),Pg(d.next),d=o=v),d=d.next}while(d!==o);return Vd(d)}function y2(o,n,l,d,p,v){var w=o;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&b2(w,E)){var k=SI(w,E);return w=Vd(w,w.next),k=Vd(k,k.next),Mg(w,n,l,d,p,v,0),void Mg(k,n,l,d,p,v,0)}E=E.next}w=w.next}while(w!==o)}function v2(o,n){return o.x-n.x}function x2(o,n){var l=function(p,v){var w,E=v,k=p.x,P=p.y,L=-1/0;do{if(P<=E.y&&P>=E.next.y&&E.next.y!==E.y){var F=E.x+(P-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(F<=k&&F>L&&(L=F,w=E.x<E.next.x?E:E.next,F===k))return w}E=E.next}while(E!==v);if(!w)return null;var $,H=w,q=w.x,K=w.y,ne=1/0;E=w;do k>=E.x&&E.x>=q&&k!==E.x&&Tf(P<K?k:L,P,q,K,P<K?L:k,P,E.x,E.y)&&($=Math.abs(P-E.y)/(k-E.x),kg(E,p)&&($<ne||$===ne&&(E.x>w.x||E.x===w.x&&_2(w,E)))&&(w=E,ne=$)),E=E.next;while(E!==H);return w}(o,n);if(!l)return n;var d=SI(l,o);return Vd(d,d.next),Vd(l,l.next)}function _2(o,n){return Kn(o.prev,o,n.prev)<0&&Kn(n.next,o,o.next)<0}function xS(o,n,l,d,p){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-l)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-d)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function w2(o){var n=o,l=o;do(n.x<l.x||n.x===l.x&&n.y<l.y)&&(l=n),n=n.next;while(n!==o);return l}function Tf(o,n,l,d,p,v,w,E){return(p-w)*(n-E)>=(o-w)*(v-E)&&(o-w)*(d-E)>=(l-w)*(n-E)&&(l-w)*(v-E)>=(p-w)*(d-E)}function b2(o,n){return o.next.i!==n.i&&o.prev.i!==n.i&&!function(l,d){var p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==d.i&&p.next.i!==d.i&&bI(p,p.next,l,d))return!0;p=p.next}while(p!==l);return!1}(o,n)&&(kg(o,n)&&kg(n,o)&&function(l,d){var p=l,v=!1,w=(l.x+d.x)/2,E=(l.y+d.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&w<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==l);return v}(o,n)&&(Kn(o.prev,o,n.prev)||Kn(o,n.prev,n))||g_(o,n)&&Kn(o.prev,o,o.next)>0&&Kn(n.prev,n,n.next)>0)}function Kn(o,n,l){return(n.y-o.y)*(l.x-n.x)-(n.x-o.x)*(l.y-n.y)}function g_(o,n){return o.x===n.x&&o.y===n.y}function bI(o,n,l,d){var p=v_(Kn(o,n,l)),v=v_(Kn(o,n,d)),w=v_(Kn(l,d,o)),E=v_(Kn(l,d,n));return p!==v&&w!==E||!(p!==0||!y_(o,l,n))||!(v!==0||!y_(o,d,n))||!(w!==0||!y_(l,o,d))||!(E!==0||!y_(l,n,d))}function y_(o,n,l){return n.x<=Math.max(o.x,l.x)&&n.x>=Math.min(o.x,l.x)&&n.y<=Math.max(o.y,l.y)&&n.y>=Math.min(o.y,l.y)}function v_(o){return o>0?1:o<0?-1:0}function kg(o,n){return Kn(o.prev,o,o.next)<0?Kn(o,n,o.next)>=0&&Kn(o,o.prev,n)>=0:Kn(o,n,o.prev)<0||Kn(o,o.next,n)<0}function SI(o,n){var l=new _S(o.i,o.x,o.y),d=new _S(n.i,n.x,n.y),p=o.next,v=n.prev;return o.next=n,n.prev=o,l.next=p,p.prev=l,d.next=l,l.prev=d,v.next=d,d.prev=v,d}function EI(o,n,l,d){var p=new _S(o,n,l);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function Pg(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function _S(o,n,l){this.i=o,this.x=n,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wS(o,n,l,d){for(var p=0,v=n,w=l-d;v<l;v+=d)p+=(o[w]-o[v])*(o[v+1]+o[w+1]),w=v;return p}vS.exports=m_,vS.exports.default=m_,m_.deviation=function(o,n,l,d){var p=n&&n.length,v=Math.abs(wS(o,0,p?n[0]*l:o.length,l));if(p)for(var w=0,E=n.length;w<E;w++)v-=Math.abs(wS(o,n[w]*l,w<E-1?n[w+1]*l:o.length,l));var k=0;for(w=0;w<d.length;w+=3){var P=d[w]*l,L=d[w+1]*l,F=d[w+2]*l;k+=Math.abs((o[P]-o[F])*(o[L+1]-o[P+1])-(o[P]-o[L])*(o[F+1]-o[P+1]))}return v===0&&k===0?0:Math.abs((k-v)/v)},m_.flatten=function(o){for(var n=o[0][0].length,l={vertices:[],holes:[],dimensions:n},d=0,p=0;p<o.length;p++){for(var v=0;v<o[p].length;v++)for(var w=0;w<n;w++)l.vertices.push(o[p][v][w]);p>0&&l.holes.push(d+=o[p-1].length)}return l};var bS=Z(vS.exports);function S2(o,n,l,d,p){TI(o,n,l,d||o.length-1,p||E2)}function TI(o,n,l,d,p){for(;d>l;){if(d-l>600){var v=d-l+1,w=n-l+1,E=Math.log(v),k=.5*Math.exp(2*E/3),P=.5*Math.sqrt(E*k*(v-k)/v)*(w-v/2<0?-1:1);TI(o,n,Math.max(l,Math.floor(n-w*k/v+P)),Math.min(d,Math.floor(n+(v-w)*k/v+P)),p)}var L=o[n],F=l,$=d;for(Ag(o,l,n),p(o[d],L)>0&&Ag(o,l,d);F<$;){for(Ag(o,F,$),F++,$--;p(o[F],L)<0;)F++;for(;p(o[$],L)>0;)$--}p(o[l],L)===0?Ag(o,l,$):Ag(o,++$,d),$<=n&&(l=$+1),n<=$&&(d=$-1)}}function Ag(o,n,l){var d=o[n];o[n]=o[l],o[l]=d}function E2(o,n){return o<n?-1:o>n?1:0}function SS(o,n){const l=o.length;if(l<=1)return[o];const d=[];let p,v;for(let w=0;w<l;w++){const E=ke(o[w]);E!==0&&(o[w].area=Math.abs(E),v===void 0&&(v=E<0),v===E<0?(p&&d.push(p),p=[o[w]]):p.push(o[w]))}if(p&&d.push(p),n>1)for(let w=0;w<d.length;w++)d[w].length<=n||(S2(d[w],n,1,d[w].length-1,T2),d[w]=d[w].slice(0,n));return d}function T2(o,n){return n.area-o.area}function ES(o,n,l){const d=l.patternDependencies;let p=!1;for(const v of n){const w=v.paint.get(`${o}-pattern`);w.isConstant()||(p=!0);const E=w.constantOr(null);E&&(p=!0,d[E]=!0)}return p}function TS(o,n,l,d,p){const v=p.patternDependencies;for(const w of n){const E=w.paint.get(`${o}-pattern`).value;if(E.kind!=="constant"){let k=E.evaluate({zoom:d},l,{},p.availableImages);k=k&&k.name?k.name:k,v[k]=!0,l.patterns[w.id]=k}}return l}class x_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(l=>l.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ft,this.indexArray=new qt,this.indexArray2=new bi,this.programConfigurations=new Nd(n.layers,n.zoom),this.segments=new Yn,this.segments2=new Yn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=n.projection}populate(n,l,d,p){this.hasPattern=ES("fill",this.layers,l);const v=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:E,id:k,index:P,sourceLayerIndex:L}of n){const F=this.layers[0]._featureFilter.needGeometry,$=Bd(E,F);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),$,d))continue;const H=v?v.evaluate($,{},d,l.availableImages):void 0,q={id:k,properties:E.properties,type:E.type,sourceLayerIndex:L,index:P,geometry:F?$.geometry:Hl(E,d,p),patterns:{},sortKey:H};w.push(q)}v&&w.sort((E,k)=>E.sortKey-k.sortKey);for(const E of w){const{geometry:k,index:P,sourceLayerIndex:L}=E;if(this.hasPattern){const F=TS("fill",this.layers,E,this.zoom,l);this.patternFeatures.push(F)}else this.addFeature(E,k,P,d,{},l.availableImages);l.featureIndex.insert(n[P].feature,k,P,L,this.index)}}update(n,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,l,this.stateDependentLayers,d,p)}addFeatures(n,l,d,p,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,l,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,f2),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,l,d,p,v,w=[]){for(const E of SS(l,500)){let k=0;for(const q of E)k+=q.length;const P=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),L=P.vertexLength,F=[],$=[];for(const q of E){if(q.length===0)continue;q!==E[0]&&$.push(F.length/2);const K=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),ne=K.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(ne+q.length-1,ne),F.push(q[0].x),F.push(q[0].y);for(let ue=1;ue<q.length;ue++)this.layoutVertexArray.emplaceBack(q[ue].x,q[ue].y),this.indexArray2.emplaceBack(ne+ue-1,ne+ue),F.push(q[ue].x),F.push(q[ue].y);K.vertexLength+=q.length,K.primitiveLength+=q.length}const H=bS(F,$);for(let q=0;q<H.length;q+=3)this.indexArray.emplaceBack(L+H[q],L+H[q+1],L+H[q+2]);P.vertexLength+=k,P.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,d,v,w,p)}}$t(x_,"FillBucket",{omit:["layers","patternFeatures"]});const C2=new ge({"fill-sort-key":new ie(Ye.layout_fill["fill-sort-key"])});var M2={paint:new ge({"fill-antialias":new Y(Ye.paint_fill["fill-antialias"]),"fill-opacity":new ie(Ye.paint_fill["fill-opacity"]),"fill-color":new ie(Ye.paint_fill["fill-color"]),"fill-outline-color":new ie(Ye.paint_fill["fill-outline-color"]),"fill-translate":new Y(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Y(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ie(Ye.paint_fill["fill-pattern"])}),layout:C2};const k2=De([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),P2=De([{name:"a_centroid_pos",components:2,type:"Uint16"}]),A2=De([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:I2}=k2;var __={},D2=pe,CI=Cf;function Cf(o,n,l,d,p){this.properties={},this.extent=l,this.type=0,this._pbf=o,this._geometry=-1,this._keys=d,this._values=p,o.readFields(R2,this,n)}function R2(o,n,l){o==1?n.id=l.readVarint():o==2?function(d,p){for(var v=d.readVarint()+d.pos;d.pos<v;){var w=p._keys[d.readVarint()],E=p._values[d.readVarint()];p.properties[w]=E}}(l,n):o==3?n.type=l.readVarint():o==4&&(n._geometry=l.pos)}function N2(o){for(var n,l,d=0,p=0,v=o.length,w=v-1;p<v;w=p++)d+=((l=o[w]).x-(n=o[p]).x)*(n.y+l.y);return d}Cf.types=["Unknown","Point","LineString","Polygon"],Cf.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var n,l=o.readVarint()+o.pos,d=1,p=0,v=0,w=0,E=[];o.pos<l;){if(p<=0){var k=o.readVarint();d=7&k,p=k>>3}if(p--,d===1||d===2)v+=o.readSVarint(),w+=o.readSVarint(),d===1&&(n&&E.push(n),n=[]),n.push(new D2(v,w));else{if(d!==7)throw new Error("unknown command "+d);n&&n.push(n[0].clone())}}return n&&E.push(n),E},Cf.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var n=o.readVarint()+o.pos,l=1,d=0,p=0,v=0,w=1/0,E=-1/0,k=1/0,P=-1/0;o.pos<n;){if(d<=0){var L=o.readVarint();l=7&L,d=L>>3}if(d--,l===1||l===2)(p+=o.readSVarint())<w&&(w=p),p>E&&(E=p),(v+=o.readSVarint())<k&&(k=v),v>P&&(P=v);else if(l!==7)throw new Error("unknown command "+l)}return[w,k,E,P]},Cf.prototype.toGeoJSON=function(o,n,l){var d,p,v=this.extent*Math.pow(2,l),w=this.extent*o,E=this.extent*n,k=this.loadGeometry(),P=Cf.types[this.type];function L(H){for(var q=0;q<H.length;q++){var K=H[q];H[q]=[360*(K.x+w)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+E)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(d=0;d<k.length;d++)F[d]=k[d][0];L(k=F);break;case 2:for(d=0;d<k.length;d++)L(k[d]);break;case 3:for(k=function(H){var q=H.length;if(q<=1)return[H];for(var K,ne,ue=[],_e=0;_e<q;_e++){var de=N2(H[_e]);de!==0&&(ne===void 0&&(ne=de<0),ne===de<0?(K&&ue.push(K),K=[H[_e]]):K.push(H[_e]))}return K&&ue.push(K),ue}(k),d=0;d<k.length;d++)for(p=0;p<k[d].length;p++)L(k[d][p])}k.length===1?k=k[0]:P="Multi"+P;var $={type:"Feature",geometry:{type:P,coordinates:k},properties:this.properties};return"id"in this&&($.id=this.id),$};var j2=CI,MI=kI;function kI(o,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(L2,this,n),this.length=this._features.length}function L2(o,n,l){o===15?n.version=l.readVarint():o===1?n.name=l.readString():o===5?n.extent=l.readVarint():o===2?n._features.push(l.pos):o===3?n._keys.push(l.readString()):o===4&&n._values.push(function(d){for(var p=null,v=d.readVarint()+d.pos;d.pos<v;){var w=d.readVarint()>>3;p=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return p}(l))}kI.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var n=this._pbf.readVarint()+this._pbf.pos;return new j2(this._pbf,n,this.extent,this._keys,this._values)};var O2=MI;function z2(o,n,l){if(o===3){var d=new O2(l,l.readVarint()+l.pos);d.length&&(n[d.name]=d)}}var CS=__.VectorTile=function(o,n){this.layers=o.readFields(z2,{},n)},w_=__.VectorTileFeature=CI;function b_(o,n,l,d){const p=[],v=d===0?(w,E,k,P,L,F)=>{w.push(new he(F,k+(F-E)/(P-E)*(L-k)))}:(w,E,k,P,L,F)=>{w.push(new he(E+(F-k)/(L-k)*(P-E),F))};for(const w of o){const E=[];for(const k of w){if(k.length<=2)continue;const P=[];for(let $=0;$<k.length-1;$++){const H=k[$].x,q=k[$].y,K=k[$+1].x,ne=k[$+1].y,ue=d===0?H:q,_e=d===0?K:ne;ue<n?_e>n&&v(P,H,q,K,ne,n):ue>l?_e<l&&v(P,H,q,K,ne,l):P.push(k[$]),_e<n&&ue>=n&&v(P,H,q,K,ne,n),_e>l&&ue<=l&&v(P,H,q,K,ne,l)}let L=k[k.length-1];const F=d===0?L.x:L.y;F>=n&&F<=l&&P.push(L),P.length&&(L=P[P.length-1],P[0].x===L.x&&P[0].y===L.y||P.push(P[0]),E.push(P))}E.length&&p.push(E)}return p}__.VectorTileLayer=MI;const F2=w_.types,B2=Math.pow(2,13);function Ig(o,n,l,d,p,v,w,E){o.emplaceBack((n<<1)+w,(l<<1)+v,(Math.floor(d*B2)<<1)+p,Math.round(E))}function Dg(o,n,l){o.emplaceBack(n.x,n.y,n.z,l[0]*16384,l[1]*16384,l[2]*16384)}class PI{constructor(){this.acc=new he(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new he(n.x,n.y),this.max=new he(n.x,n.y))}append(n,l){this.currentPolyCount.edges++,this.acc._add(n);const d=this.min,p=this.max;n.x<d.x?d.x=n.x:n.x>p.x&&(p.x=n.x),n.y<d.y?d.y=n.y:n.y>p.y&&(p.y=n.y),((n.x===0||n.x===rr)&&n.x===l.x)!=((n.y===0||n.y===rr)&&n.y===l.y)&&this.processBorderOverlap(n,l),l.x<0!=n.x<0&&this.addBorderIntersection(0,Ur(l.y,n.y,(0-l.x)/(n.x-l.x))),l.x>rr!=n.x>rr&&this.addBorderIntersection(1,Ur(l.y,n.y,(rr-l.x)/(n.x-l.x))),l.y<0!=n.y<0&&this.addBorderIntersection(2,Ur(l.x,n.x,(0-l.y)/(n.y-l.y))),l.y>rr!=n.y>rr&&this.addBorderIntersection(3,Ur(l.x,n.x,(rr-l.y)/(n.y-l.y)))}addBorderIntersection(n,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[n];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(n,l){if(n.x===l.x){if(n.y===l.y)return;const d=n.x===0?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,n.y)}else{const d=n.y===0?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,n.x)}}centroid(){const n=this.polyCount.reduce((l,d)=>l+d.edges,0);return n!==0?this.acc.div(n)._round():new he(0,0)}span(){return new he(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((n,l)=>n+ +(l[0]!==Number.MAX_VALUE),0)}}class Rg{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(l=>l.id),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.layoutVertexArray=new tt,this.centroidVertexArray=new Sa,this.indexArray=new qt,this.programConfigurations=new Nd(n.layers,n.zoom),this.segments=new Yn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=n.enableTerrain}populate(n,l,d,p){this.features=[],this.hasPattern=ES("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const w=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*w/(w*w+1)/rr/(1<<v.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:w,index:E,sourceLayerIndex:k}of n){const P=this.layers[0]._featureFilter.needGeometry,L=Bd(v,P);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),L,d))continue;const F={id:w,sourceLayerIndex:k,index:E,geometry:P?L.geometry:Hl(v,d,p),properties:v.properties,type:v.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(TS("fill-extrusion",this.layers,F,this.zoom,l)):this.addFeature(F,F.geometry,E,d,{},l.availableImages,p),l.featureIndex.insert(v,F.geometry,E,k,this.index,$)}this.sortBorders()}addFeatures(n,l,d,p,v){for(const w of this.features){const{geometry:E}=w;this.addFeature(w,E,w.index,l,d,p,v)}this.sortBorders()}update(n,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,l,this.stateDependentLayers,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,I2),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,A2.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,P2.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,l,d,p,v,w,E){const k=[new he(0,0),new he(rr,rr)],P=E.projection,L=P.name==="globe",F=this.enableTerrain&&!L?new PI:null,$=F2[n.type]==="Polygon";L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new mt);const H=SS(l,500);for(let ue=H.length-1;ue>=0;ue--){const _e=H[ue];(_e.length===0||(q=_e[0]).every(de=>de.x<=0)||q.every(de=>de.x>=rr)||q.every(de=>de.y<=0)||q.every(de=>de.y>=rr))&&H.splice(ue,1)}var q;let K;if(L)K=LI(H,k,p);else{K=[];for(const ue of H)K.push({polygon:ue,bounds:k})}const ne=$?this.edgeRadius:0;for(const{polygon:ue,bounds:_e}of K){let de=0,xe=0;for(const we of ue)$&&!we[0].equals(we[we.length-1])&&we.push(we[0]),xe+=$?we.length-1:we.length;const be=this.segments.prepareSegment(($?5:4)*xe,this.layoutVertexArray,this.indexArray);if($){const we=[],Ve=[];de=be.vertexLength;for(const Qe of ue){let pt,We;Qe.length&&Qe!==ue[0]&&Ve.push(we.length/2),pt=Qe[1].sub(Qe[0])._perp()._unit();for(let st=1;st<Qe.length;st++){const ot=Qe[st],ut=Qe[st===Qe.length-1?1:st+1];let{x:xt,y:Xe}=ot;if(ne){We=ut.sub(ot)._perp()._unit();const Rt=pt.add(We)._unit(),Ht=ne*Math.min(4,1/(pt.x*Rt.x+pt.y*Rt.y));xt+=Ht*Rt.x,Xe+=Ht*Rt.y,pt=We}Ig(this.layoutVertexArray,xt,Xe,0,0,1,1,0),be.vertexLength++,we.push(ot.x,ot.y),L&&Dg(this.layoutVertexExtArray,P.projectTilePoint(xt,Xe,p),P.upVector(p,xt,Xe))}}const Fe=bS(we,Ve);for(let Qe=0;Qe<Fe.length;Qe+=3)this.indexArray.emplaceBack(de+Fe[Qe],de+Fe[Qe+2],de+Fe[Qe+1]),be.primitiveLength++}for(const we of ue){F&&we.length&&F.startRing(we[0]);let Ve,Fe,Qe,pt=we.length>4&&RI(we[we.length-2],we[0],we[1]),We=ne?U2(we[we.length-2],we[0],we[1],ne):0;Fe=we[1].sub(we[0])._perp()._unit();let st=!0;for(let ot=1,ut=0;ot<we.length;ot++){let xt=we[ot-1],Xe=we[ot];const Rt=we[ot===we.length-1?1:ot+1];if(F&&$&&F.currentPolyCount.top++,DI(Xe,xt,_e)){ne&&(Fe=Rt.sub(Xe)._perp()._unit(),st=!st);continue}F&&F.append(Xe,xt);const Ht=Xe.sub(xt)._perp(),Lt=Ht.x/(Math.abs(Ht.x)+Math.abs(Ht.y)),mr=Ht.y>0?1:0,_t=xt.dist(Xe);if(ut+_t>32768&&(ut=0),ne){Qe=Rt.sub(Xe)._perp()._unit();let yr=II(xt,Xe,Rt,AI(Fe,Qe),ne);isNaN(yr)&&(yr=0);const or=Xe.sub(xt)._unit();xt=xt.add(or.mult(We))._round(),Xe=Xe.add(or.mult(-yr))._round(),We=yr,Fe=Qe}const Jt=be.vertexLength,gr=we.length>4&&RI(xt,Xe,Rt);let $r=NI(ut,pt,st);if(Ig(this.layoutVertexArray,xt.x,xt.y,Lt,mr,0,0,$r),Ig(this.layoutVertexArray,xt.x,xt.y,Lt,mr,0,1,$r),ut+=_t,$r=NI(ut,gr,!st),pt=gr,Ig(this.layoutVertexArray,Xe.x,Xe.y,Lt,mr,0,0,$r),Ig(this.layoutVertexArray,Xe.x,Xe.y,Lt,mr,0,1,$r),be.vertexLength+=4,this.indexArray.emplaceBack(Jt+0,Jt+1,Jt+2),this.indexArray.emplaceBack(Jt+1,Jt+3,Jt+2),be.primitiveLength+=2,ne){const yr=de+(ot===1?we.length-2:ot-2),or=ot===1?de:yr+1;if(this.indexArray.emplaceBack(Jt+1,yr,Jt+3),this.indexArray.emplaceBack(yr,or,Jt+3),be.primitiveLength+=2,Ve===void 0&&(Ve=Jt),!DI(Rt,we[ot],_e)){const _n=ot===we.length-1?Ve:be.vertexLength;this.indexArray.emplaceBack(Jt+2,Jt+3,_n),this.indexArray.emplaceBack(Jt+3,_n+1,_n),this.indexArray.emplaceBack(Jt+3,or,_n+1),be.primitiveLength+=3}st=!st}if(L){const yr=this.layoutVertexExtArray,or=P.projectTilePoint(xt.x,xt.y,p),_n=P.projectTilePoint(Xe.x,Xe.y,p),wr=P.upVector(p,xt.x,xt.y),br=P.upVector(p,Xe.x,Xe.y);Dg(yr,or,wr),Dg(yr,or,wr),Dg(yr,_n,br),Dg(yr,_n,br)}}$&&(de+=we.length-1)}}if(F&&F.polyCount.length>0){if(F.borders){F.vertexArrayOffset=this.centroidVertexArray.length;const ue=F.borders,_e=this.featuresOnBorder.push(F)-1;for(let de=0;de<4;de++)ue[de][0]!==Number.MAX_VALUE&&this.borders[de].push(_e)}this.encodeCentroid(F.borders?void 0:F.centroid(),F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,d,v,w,p)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort((l,d)=>this.featuresOnBorder[l].borders[n][0]-this.featuresOnBorder[d].borders[n][0])}encodeCentroid(n,l,d=!0){let p,v;if(n)if(n.y!==0){const E=l.span()._mult(this.tileToMeter);p=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(E.x/10)),v=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else p=Math.ceil(7*(n.x+450)),v=0;else p=0,v=+d;let w=d?this.centroidVertexArray.length:l.vertexArrayOffset;for(const E of l.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let k=0;k<E.top;k++)this.centroidVertexArray.emplace(w++,p,v);for(let k=0;k<2*E.edges;k++)this.centroidVertexArray.emplace(w++,0,v),this.centroidVertexArray.emplace(w++,p,v)}}}function AI(o,n){const l=o.add(n)._unit();return o.x*l.x+o.y*l.y}function U2(o,n,l,d){const p=n.sub(o)._perp()._unit(),v=l.sub(n)._perp()._unit();return II(o,n,l,AI(p,v),d)}function II(o,n,l,d,p){const v=Math.sqrt(1-d*d);return Math.min(o.dist(n)/3,n.dist(l)/3,p*v/d)}function DI(o,n,l){return o.x<l[0].x&&n.x<l[0].x||o.x>l[1].x&&n.x>l[1].x||o.y<l[0].y&&n.y<l[0].y||o.y>l[1].y&&n.y>l[1].y}function RI(o,n,l){if(o.x<0||o.x>=rr||n.x<0||n.x>=rr||l.x<0||l.x>=rr)return!1;const d=l.sub(n),p=d.perp(),v=o.sub(n);return(d.x*v.x+d.y*v.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(v.x*v.x+v.y*v.y))>-.866&&p.x*v.x+p.y*v.y<0}function NI(o,n,l){const d=n?2|o:-3&o;return l?1|d:-2&d}function jI(){const o=Math.PI/32,n=Math.tan(o),l=Cg;return l*Math.sqrt(1+2*n*n)-l}function LI(o,n,l){const d=1<<l.z,p=xo(l.x/d),v=xo((l.x+1)/d),w=Bi(l.y/d),E=Bi((l.y+1)/d);return function(k,P,L,F,$=0,H){const q=[];if(!k.length||!L||!F)return q;const K=(we,Ve)=>{for(const Fe of we)q.push({polygon:Fe,bounds:Ve})},ne=Math.ceil(Math.log2(L)),ue=Math.ceil(Math.log2(F)),_e=ne-ue,de=[];for(let we=0;we<Math.abs(_e);we++)de.push(_e>0?0:1);for(let we=0;we<Math.min(ne,ue);we++)de.push(0),de.push(1);let xe=k;if(xe=b_(xe,P[0].y-$,P[1].y+$,1),xe=b_(xe,P[0].x-$,P[1].x+$,0),!xe.length)return q;const be=[];for(de.length?be.push({polygons:xe,bounds:P,depth:0}):K(xe,P);be.length;){const we=be.pop(),Ve=we.depth,Fe=de[Ve],Qe=we.bounds[0],pt=we.bounds[1],We=Fe===0?Qe.x:Qe.y,st=Fe===0?pt.x:pt.y,ot=H?H(Fe,We,st):.5*(We+st),ut=b_(we.polygons,We-$,ot+$,Fe),xt=b_(we.polygons,ot-$,st+$,Fe);if(ut.length){const Xe=[Qe,new he(Fe===0?ot:pt.x,Fe===1?ot:pt.y)];de.length>Ve+1?be.push({polygons:ut,bounds:Xe,depth:Ve+1}):K(ut,Xe)}if(xt.length){const Xe=[new he(Fe===0?ot:Qe.x,Fe===1?ot:Qe.y),pt];de.length>Ve+1?be.push({polygons:xt,bounds:Xe,depth:Ve+1}):K(xt,Xe)}}return q}(o,n,Math.ceil((v-p)/11.25),Math.ceil((w-E)/11.25),1,(k,P,L)=>{if(k===0)return .5*(P+L);{const F=Bi((l.y+P/rr)/d);return(il(.5*(Bi((l.y+L/rr)/d)+F))*d-l.y)*rr}})}$t(Rg,"FillExtrusionBucket",{omit:["layers","features"]}),$t(PI,"PartMetadata");const V2=new ge({"fill-extrusion-edge-radius":new Y(Ye["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var $2={paint:new ge({"fill-extrusion-opacity":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ie(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ie(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ie(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ie(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Y(Ye["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:V2};function OI(o,n,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[o*d-2*Math.PI*6378137/2,n*d-2*Math.PI*6378137/2]}class S_{constructor(n,l,d){this.z=n,this.x=l,this.y=d,this.key=Ng(0,n,n,l,d)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,l){const d=function(v,w,E){var k=OI(256*v,256*(w=Math.pow(2,E)-w-1),E),P=OI(256*(v+1),256*(w+1),E);return k[0]+","+k[1]+","+P[0]+","+P[1]}(this.x,this.y,this.z),p=function(v,w,E){let k,P="";for(let L=v;L>0;L--)k=1<<L-1,P+=(w&k?1:0)+(E&k?2:0);return P}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zI{constructor(n,l){this.wrap=n,this.canonical=l,this.key=Ng(n,l.z,l.z,l.x,l.y)}}class as{constructor(n,l,d,p,v){this.overscaledZ=n,this.wrap=l,this.canonical=new S_(d,+p,+v),this.key=l===0&&n===d?this.canonical.key:Ng(l,n,d,p,v)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const l=this.canonical.z-n;return n>this.canonical.z?new as(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new as(n,this.wrap,n,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(n,l=!0){if(this.overscaledZ===n&&l)return this.key;if(n>this.canonical.z)return Ng(this.wrap*+l,n,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-n;return Ng(this.wrap*+l,n,n,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const l=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>l&&n.canonical.y===this.canonical.y>>l}children(n){if(this.overscaledZ>=n)return[new as(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,p=2*this.canonical.y;return[new as(l,this.wrap,l,d,p),new as(l,this.wrap,l,d+1,p),new as(l,this.wrap,l,d,p+1),new as(l,this.wrap,l,d+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new as(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new as(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zI(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ng(o,n,l,d,p){const v=1<<Math.min(l,22);let w=v*(p%v)+d%v;return o&&l<22&&(w+=v*v*((o<0?-2*o-1:2*o)%(1<<2*(22-l)))),16*(32*w+l)+(n-l)}$t(S_,"CanonicalTileID"),$t(as,"OverscaledTileID",{omit:["projMatrix"]});class Mf extends he{constructor(n,l,d){super(n,l),this.z=d}}function jg(o,n){return o.x*n.x+o.y*n.y}function FI(o,n){if(o.length===1){let l=0;const d=n[l++];let p;for(;!p||d.equals(p);)if(p=n[l++],!p)return 1/0;for(;l<n.length;l++){const v=n[l],w=o[0],E=p.sub(d),k=v.sub(d),P=w.sub(d),L=jg(E,E),F=jg(E,k),$=jg(k,k),H=jg(P,E),q=jg(P,k),K=L*$-F*F,ne=($*H-F*q)/K,ue=(L*q-F*H)/K,_e=d.z*(1-ne-ue)+p.z*ne+v.z*ue;if(isFinite(_e))return _e}return 1/0}{let l=1/0;for(const d of n)l=Math.min(l,d.z);return l}}function BI(o,n,l,d,p,v,w,E){const k=w*p.getElevationAt(o,n,!0,!0),P=v[0]!==0,L=P?v[1]===0?w*(v[0]/7-450):w*function(F,$,H){const q=Math.floor($[0]/8),K=Math.floor($[1]/8),ne=10*($[0]-8*q),ue=10*($[1]-8*K),_e=F.getElevationAt(q,K,!0,!0),de=F.getMeterToDEM(H),xe=Math.floor(.5*(ne*de-1)),be=Math.floor(.5*(ue*de-1)),we=F.tileCoordToPixel(q,K),Ve=2*xe+1,Fe=2*be+1,Qe=function(xt,Xe,Rt,Ht,Lt){return[xt.getElevationAtPixel(Xe,Rt,!0),xt.getElevationAtPixel(Xe+Lt,Rt,!0),xt.getElevationAtPixel(Xe,Rt+Lt,!0),xt.getElevationAtPixel(Xe+Ht,Rt+Lt,!0)]}(F,we.x-xe,we.y-be,Ve,Fe),pt=Math.abs(Qe[0]-Qe[1]),We=Math.abs(Qe[2]-Qe[3]),st=Math.abs(Qe[0]-Qe[2])+Math.abs(Qe[1]-Qe[3]),ot=Math.min(.25,.5*de*(pt+We)/Ve),ut=Math.min(.25,.5*de*st/Fe);return _e+Math.max(ot*ne,ut*ue)}(p,v,E):k;return{base:k+(l===0)?-1:l,top:P?Math.max(L+d,k+l+2):k+d}}const W2=De([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:G2}=W2,H2=De([{name:"a_packed",components:4,type:"Float32"}]),{members:q2}=H2,Z2=w_.types,X2=Math.cos(Math.PI/180*37.5);class E_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(l=>l.id),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new $e,this.layoutVertexArray2=new ht,this.indexArray=new qt,this.programConfigurations=new Nd(n.layers,n.zoom),this.segments=new Yn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(n,l,d,p){this.hasPattern=ES("line",this.layers,l);const v=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:L,id:F,index:$,sourceLayerIndex:H}of n){const q=this.layers[0]._featureFilter.needGeometry,K=Bd(L,q);if(!this.layers[0]._featureFilter.filter(new O(this.zoom),K,d))continue;const ne=v?v.evaluate(K,{},d):void 0,ue={id:F,properties:L.properties,type:L.type,sourceLayerIndex:H,index:$,geometry:q?K.geometry:Hl(L,d,p),patterns:{},sortKey:ne};w.push(ue)}v&&w.sort((L,F)=>L.sortKey-F.sortKey);const{lineAtlas:E,featureIndex:k}=l,P=this.addConstantDashes(E);for(const L of w){const{geometry:F,index:$,sourceLayerIndex:H}=L;if(P&&this.addFeatureDashes(L,E),this.hasPattern){const q=TS("line",this.layers,L,this.zoom,l);this.patternFeatures.push(q)}else this.addFeature(L,F,$,d,E.positions,l.availableImages);k.insert(n[$].feature,F,$,H,this.index)}}addConstantDashes(n){let l=!1;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,v=d.layout.get("line-cap").value;if(p.kind!=="constant"||v.kind!=="constant")l=!0;else{const w=v.value,E=p.value;if(!E)continue;n.addDash(E,w)}}return l}addFeatureDashes(n,l){const d=this.zoom;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,w=p.layout.get("line-cap").value;if(v.kind==="constant"&&w.kind==="constant")continue;let E,k;if(v.kind==="constant"){if(E=v.value,!E)continue}else E=v.evaluate({zoom:d},n);k=w.kind==="constant"?w.value:w.evaluate({zoom:d},n),l.addDash(E,k),n.patterns[p.id]=l.getKey(E,k)}}update(n,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,l,this.stateDependentLayers,d,p)}addFeatures(n,l,d,p,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,l,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,q2)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,G2),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,l,d,p,v,w){const E=this.layers[0].layout,k=E.get("line-join").evaluate(n,{}),P=E.get("line-cap").evaluate(n,{}),L=E.get("line-miter-limit"),F=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const $ of l)this.addLine($,n,k,P,L,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,d,v,w,p)}addLine(n,l,d,p,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<n.length-1;ue++)this.totalDistance+=n[ue].dist(n[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=Z2[l.type]==="Polygon";let k=n.length;for(;k>=2&&n[k-1].equals(n[k-2]);)k--;let P=0;for(;P<k-1&&n[P].equals(n[P+1]);)P++;if(k<(E?3:2))return;d==="bevel"&&(v=1.05);const L=this.overscaling<=16?15*rr/(512*this.overscaling):0,F=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let $,H,q,K,ne;this.e1=this.e2=-1,E&&($=n[k-2],ne=n[P].sub($)._unit()._perp());for(let ue=P;ue<k;ue++){if(q=ue===k-1?E?n[P+1]:void 0:n[ue+1],q&&n[ue].equals(q))continue;ne&&(K=ne),$&&(H=$),$=n[ue],ne=q?q.sub($)._unit()._perp():K,K=K||ne;let _e=K.add(ne);_e.x===0&&_e.y===0||_e._unit();const de=K.x*ne.x+K.y*ne.y,xe=_e.x*ne.x+_e.y*ne.y,be=xe!==0?1/xe:1/0,we=2*Math.sqrt(2-2*xe),Ve=xe<X2&&H&&q,Fe=K.x*ne.y-K.y*ne.x>0;if(Ve&&ue>P){const We=$.dist(H);if(We>2*L){const st=$.sub($.sub(H)._mult(L/We)._round());this.updateDistance(H,st),this.addCurrentVertex(st,K,0,0,F),H=st}}const Qe=H&&q;let pt=Qe?d:E?"butt":p;if(Qe&&pt==="round"&&(be<w?pt="miter":be<=2&&(pt="fakeround")),pt==="miter"&&be>v&&(pt="bevel"),pt==="bevel"&&(be>2&&(pt="flipbevel"),be<v&&(pt="miter")),H&&this.updateDistance(H,$),pt==="miter")_e._mult(be),this.addCurrentVertex($,_e,0,0,F);else if(pt==="flipbevel"){if(be>100)_e=ne.mult(-1);else{const We=be*K.add(ne).mag()/K.sub(ne).mag();_e._perp()._mult(We*(Fe?-1:1))}this.addCurrentVertex($,_e,0,0,F),this.addCurrentVertex($,_e.mult(-1),0,0,F)}else if(pt==="bevel"||pt==="fakeround"){const We=-Math.sqrt(be*be-1),st=Fe?We:0,ot=Fe?0:We;if(H&&this.addCurrentVertex($,K,st,ot,F),pt==="fakeround"){const ut=Math.round(180*we/Math.PI/20);for(let xt=1;xt<ut;xt++){let Xe=xt/ut;if(Xe!==.5){const Ht=Xe-.5;Xe+=Xe*Ht*(Xe-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*Ht*Ht+(.848013+de*(.215638*de-1.06021)))}const Rt=ne.sub(K)._mult(Xe)._add(K)._unit()._mult(Fe?-1:1);this.addHalfVertex($,Rt.x,Rt.y,!1,Fe,0,F)}}q&&this.addCurrentVertex($,ne,-st,-ot,F)}else if(pt==="butt")this.addCurrentVertex($,_e,0,0,F);else if(pt==="square"){const We=H?1:-1;H||this.addCurrentVertex($,_e,We,We,F),this.addCurrentVertex($,_e,0,0,F),H&&this.addCurrentVertex($,_e,We,We,F)}else pt==="round"&&(H&&(this.addCurrentVertex($,K,0,0,F),this.addCurrentVertex($,K,1,1,F,!0)),q&&(this.addCurrentVertex($,ne,-1,-1,F,!0),this.addCurrentVertex($,ne,0,0,F)));if(Ve&&ue<k-1){const We=$.dist(q);if(We>2*L){const st=$.add(q.sub($)._mult(L/We)._round());this.updateDistance($,st),this.addCurrentVertex(st,ne,0,0,F),$=st}}}}addCurrentVertex(n,l,d,p,v,w=!1){const E=l.y*p-l.x,k=-l.y-l.x*p;this.addHalfVertex(n,l.x+l.y*d,l.y-l.x*d,w,!1,d,v),this.addHalfVertex(n,E,k,w,!0,-p,v)}addHalfVertex({x:n,y:l},d,p,v,w,E,k){this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(l<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const P=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),k.primitiveLength++),w?this.e2=P:this.e1=P}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,l){this.distance+=n.dist(l),this.updateScaledDistance()}}$t(E_,"LineBucket",{omit:["layers","patternFeatures"]});const Y2=new ge({"line-cap":new ie(Ye.layout_line["line-cap"]),"line-join":new ie(Ye.layout_line["line-join"]),"line-miter-limit":new Y(Ye.layout_line["line-miter-limit"]),"line-round-limit":new Y(Ye.layout_line["line-round-limit"]),"line-sort-key":new ie(Ye.layout_line["line-sort-key"])});var UI={paint:new ge({"line-opacity":new ie(Ye.paint_line["line-opacity"]),"line-color":new ie(Ye.paint_line["line-color"]),"line-translate":new Y(Ye.paint_line["line-translate"]),"line-translate-anchor":new Y(Ye.paint_line["line-translate-anchor"]),"line-width":new ie(Ye.paint_line["line-width"]),"line-gap-width":new ie(Ye.paint_line["line-gap-width"]),"line-offset":new ie(Ye.paint_line["line-offset"]),"line-blur":new ie(Ye.paint_line["line-blur"]),"line-dasharray":new ie(Ye.paint_line["line-dasharray"]),"line-pattern":new ie(Ye.paint_line["line-pattern"]),"line-gradient":new fe(Ye.paint_line["line-gradient"]),"line-trim-offset":new Y(Ye.paint_line["line-trim-offset"])}),layout:Y2};const VI=new class extends ie{possiblyEvaluate(o,n){return n=new O(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),super.possiblyEvaluate(o,n)}evaluate(o,n,l,d){return n=dt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(o,n,l,d)}}(UI.paint.properties["line-width"].specification);function $I(o,n){return n>0?n+2*o:o}VI.useIntegerZoom=!0;const K2=De([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Q2=De([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),J2=De([{name:"a_projected_pos",components:4,type:"Float32"}],4);De([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const e9=De([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),t9=De([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);De([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const WI=De([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),r9=De([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);De([{name:"triangle",components:3,type:"Uint16"}]),De([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),De([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),De([{type:"Float32",name:"offsetX"}]),De([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Pi=24;const Pa=128;function MS(o,n){const{expression:l}=n;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new O(o+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:p}=l;let v=0;for(;v<d.length&&d[v]<=o;)v++;v=Math.max(0,v-1);let w=v;for(;w<d.length&&d[w]<o+1;)w++;w=Math.min(d.length-1,w);const E=d[v],k=d[w];return l.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:k,interpolationType:p}:{kind:"camera",minZoom:E,maxZoom:k,minSize:l.evaluate(new O(E)),maxSize:l.evaluate(new O(k)),interpolationType:p}}}function T_(o,{uSize:n,uSizeT:l},{lowerSize:d,upperSize:p}){return o.kind==="source"?d/Pa:o.kind==="composite"?Ur(d/Pa,p/Pa,l):n}function kf(o,n){let l=0,d=0;if(o.kind==="constant")d=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:w}=o,E=p?Re(Vo.interpolationFactor(p,n,v,w),0,1):0;o.kind==="camera"?d=Ur(o.minSize,o.maxSize,E):l=E}return{uSizeT:l,uSize:d}}var n9=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Pa,evaluateSizeForFeature:T_,evaluateSizeForZoom:kf,getSizeData:MS});function i9(o,n,l){return o.sections.forEach(d=>{d.text=function(p,v,w){const E=v.layout.get("text-transform").evaluate(w,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),R.applyArabicShaping&&(p=R.applyArabicShaping(p)),p}(d.text,n,l)}),o}const Lg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function s9(o){return o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""}function o9(o){return o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""||o===""}var GI=gn,HI=function(o,n,l,d,p){var v,w,E=8*p-d-1,k=(1<<E)-1,P=k>>1,L=-7,F=p-1,$=-1,H=o[n+F];for(F+=$,v=H&(1<<-L)-1,H>>=-L,L+=E;L>0;v=256*v+o[n+F],F+=$,L-=8);for(w=v&(1<<-L)-1,v>>=-L,L+=d;L>0;w=256*w+o[n+F],F+=$,L-=8);if(v===0)v=1-P;else{if(v===k)return w?NaN:1/0*(H?-1:1);w+=Math.pow(2,d),v-=P}return(H?-1:1)*w*Math.pow(2,v-d)},qI=function(o,n,l,d,p,v){var w,E,k,P=8*v-p-1,L=(1<<P)-1,F=L>>1,$=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=0,q=1,K=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,w=L):(w=Math.floor(Math.log(n)/Math.LN2),n*(k=Math.pow(2,-w))<1&&(w--,k*=2),(n+=w+F>=1?$/k:$*Math.pow(2,1-F))*k>=2&&(w++,k/=2),w+F>=L?(E=0,w=L):w+F>=1?(E=(n*k-1)*Math.pow(2,p),w+=F):(E=n*Math.pow(2,F-1)*Math.pow(2,p),w=0));p>=8;o[l+H]=255&E,H+=q,E/=256,p-=8);for(w=w<<p|E,P+=p;P>0;o[l+H]=255&w,H+=q,w/=256,P-=8);o[l+H-q]|=128*K};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function gn(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}gn.Varint=0,gn.Fixed64=1,gn.Bytes=2,gn.Fixed32=5;var kS=4294967296,ZI=1/kS,XI=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Zl(o){return o.type===gn.Bytes?o.readVarint()+o.pos:o.pos+1}function Pf(o,n,l){return l?4294967296*n+(o>>>0):4294967296*(n>>>0)+(o>>>0)}function YI(o,n,l){var d=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));l.realloc(d);for(var p=l.pos-1;p>=o;p--)l.buf[p+d]=l.buf[p]}function a9(o,n){for(var l=0;l<o.length;l++)n.writeVarint(o[l])}function l9(o,n){for(var l=0;l<o.length;l++)n.writeSVarint(o[l])}function c9(o,n){for(var l=0;l<o.length;l++)n.writeFloat(o[l])}function u9(o,n){for(var l=0;l<o.length;l++)n.writeDouble(o[l])}function d9(o,n){for(var l=0;l<o.length;l++)n.writeBoolean(o[l])}function h9(o,n){for(var l=0;l<o.length;l++)n.writeFixed32(o[l])}function f9(o,n){for(var l=0;l<o.length;l++)n.writeSFixed32(o[l])}function p9(o,n){for(var l=0;l<o.length;l++)n.writeFixed64(o[l])}function m9(o,n){for(var l=0;l<o.length;l++)n.writeSFixed64(o[l])}function C_(o,n){return(o[n]|o[n+1]<<8|o[n+2]<<16)+16777216*o[n+3]}function Af(o,n,l){o[l]=n,o[l+1]=n>>>8,o[l+2]=n>>>16,o[l+3]=n>>>24}function KI(o,n){return(o[n]|o[n+1]<<8|o[n+2]<<16)+(o[n+3]<<24)}gn.prototype={destroy:function(){this.buf=null},readFields:function(o,n,l){for(l=l||this.length;this.pos<l;){var d=this.readVarint(),p=d>>3,v=this.pos;this.type=7&d,o(p,n,this),this.pos===v&&this.skip(d)}return n},readMessage:function(o,n){return this.readFields(o,n,this.readVarint()+this.pos)},readFixed32:function(){var o=C_(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=KI(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=C_(this.buf,this.pos)+C_(this.buf,this.pos+4)*kS;return this.pos+=8,o},readSFixed64:function(){var o=C_(this.buf,this.pos)+KI(this.buf,this.pos+4)*kS;return this.pos+=8,o},readFloat:function(){var o=HI(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=HI(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var n,l,d=this.buf;return n=127&(l=d[this.pos++]),l<128?n:(n|=(127&(l=d[this.pos++]))<<7,l<128?n:(n|=(127&(l=d[this.pos++]))<<14,l<128?n:(n|=(127&(l=d[this.pos++]))<<21,l<128?n:function(p,v,w){var E,k,P=w.buf;if(E=(112&(k=P[w.pos++]))>>4,k<128||(E|=(127&(k=P[w.pos++]))<<3,k<128)||(E|=(127&(k=P[w.pos++]))<<10,k<128)||(E|=(127&(k=P[w.pos++]))<<17,k<128)||(E|=(127&(k=P[w.pos++]))<<24,k<128)||(E|=(1&(k=P[w.pos++]))<<31,k<128))return Pf(p,E,v);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(l=d[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,n=this.pos;return this.pos=o,o-n>=12&&XI?function(l,d,p){return XI.decode(l.subarray(d,p))}(this.buf,n,o):function(l,d,p){for(var v="",w=d;w<p;){var E,k,P,L=l[w],F=null,$=L>239?4:L>223?3:L>191?2:1;if(w+$>p)break;$===1?L<128&&(F=L):$===2?(192&(E=l[w+1]))==128&&(F=(31&L)<<6|63&E)<=127&&(F=null):$===3?(k=l[w+2],(192&(E=l[w+1]))==128&&(192&k)==128&&((F=(15&L)<<12|(63&E)<<6|63&k)<=2047||F>=55296&&F<=57343)&&(F=null)):$===4&&(k=l[w+2],P=l[w+3],(192&(E=l[w+1]))==128&&(192&k)==128&&(192&P)==128&&((F=(15&L)<<18|(63&E)<<12|(63&k)<<6|63&P)<=65535||F>=1114112)&&(F=null)),F===null?(F=65533,$=1):F>65535&&(F-=65536,v+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),v+=String.fromCharCode(F),w+=$}return v}(this.buf,n,o)},readBytes:function(){var o=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,o);return this.pos=o,n},readPackedVarint:function(o,n){if(this.type!==gn.Bytes)return o.push(this.readVarint(n));var l=Zl(this);for(o=o||[];this.pos<l;)o.push(this.readVarint(n));return o},readPackedSVarint:function(o){if(this.type!==gn.Bytes)return o.push(this.readSVarint());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==gn.Bytes)return o.push(this.readBoolean());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==gn.Bytes)return o.push(this.readFloat());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==gn.Bytes)return o.push(this.readDouble());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==gn.Bytes)return o.push(this.readFixed32());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==gn.Bytes)return o.push(this.readSFixed32());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==gn.Bytes)return o.push(this.readFixed64());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==gn.Bytes)return o.push(this.readSFixed64());var n=Zl(this);for(o=o||[];this.pos<n;)o.push(this.readSFixed64());return o},skip:function(o){var n=7&o;if(n===gn.Varint)for(;this.buf[this.pos++]>127;);else if(n===gn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===gn.Fixed32)this.pos+=4;else{if(n!==gn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(o,n){this.writeVarint(o<<3|n)},realloc:function(o){for(var n=this.length||16;n<this.pos+o;)n*=2;if(n!==this.length){var l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Af(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Af(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Af(this.buf,-1&o,this.pos),Af(this.buf,Math.floor(o*ZI),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Af(this.buf,-1&o,this.pos),Af(this.buf,Math.floor(o*ZI),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(n,l){var d,p;if(n>=0?(d=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(d=~(-n%4294967296))?d=d+1|0:(d=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(v,w,E){E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,E.buf[E.pos]=127&(v>>>=7)}(d,0,l),function(v,w){var E=(7&v)<<4;w.buf[w.pos++]|=E|((v>>>=3)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v)))))}(p,l)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var n=this.pos;this.pos=function(d,p,v){for(var w,E,k=0;k<p.length;k++){if((w=p.charCodeAt(k))>55295&&w<57344){if(!E){w>56319||k+1===p.length?(d[v++]=239,d[v++]=191,d[v++]=189):E=w;continue}if(w<56320){d[v++]=239,d[v++]=191,d[v++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(d[v++]=239,d[v++]=191,d[v++]=189,E=null);w<128?d[v++]=w:(w<2048?d[v++]=w>>6|192:(w<65536?d[v++]=w>>12|224:(d[v++]=w>>18|240,d[v++]=w>>12&63|128),d[v++]=w>>6&63|128),d[v++]=63&w|128)}return v}(this.buf,o,this.pos);var l=this.pos-n;l>=128&&YI(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeFloat:function(o){this.realloc(4),qI(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),qI(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var n=o.length;this.writeVarint(n),this.realloc(n);for(var l=0;l<n;l++)this.buf[this.pos++]=o[l]},writeRawMessage:function(o,n){this.pos++;var l=this.pos;o(n,this);var d=this.pos-l;d>=128&&YI(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d},writeMessage:function(o,n,l){this.writeTag(o,gn.Bytes),this.writeRawMessage(n,l)},writePackedVarint:function(o,n){n.length&&this.writeMessage(o,a9,n)},writePackedSVarint:function(o,n){n.length&&this.writeMessage(o,l9,n)},writePackedBoolean:function(o,n){n.length&&this.writeMessage(o,d9,n)},writePackedFloat:function(o,n){n.length&&this.writeMessage(o,c9,n)},writePackedDouble:function(o,n){n.length&&this.writeMessage(o,u9,n)},writePackedFixed32:function(o,n){n.length&&this.writeMessage(o,h9,n)},writePackedSFixed32:function(o,n){n.length&&this.writeMessage(o,f9,n)},writePackedFixed64:function(o,n){n.length&&this.writeMessage(o,p9,n)},writePackedSFixed64:function(o,n){n.length&&this.writeMessage(o,m9,n)},writeBytesField:function(o,n){this.writeTag(o,gn.Bytes),this.writeBytes(n)},writeFixed32Field:function(o,n){this.writeTag(o,gn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(o,n){this.writeTag(o,gn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(o,n){this.writeTag(o,gn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(o,n){this.writeTag(o,gn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(o,n){this.writeTag(o,gn.Varint),this.writeVarint(n)},writeSVarintField:function(o,n){this.writeTag(o,gn.Varint),this.writeSVarint(n)},writeStringField:function(o,n){this.writeTag(o,gn.Bytes),this.writeString(n)},writeFloatField:function(o,n){this.writeTag(o,gn.Fixed32),this.writeFloat(n)},writeDoubleField:function(o,n){this.writeTag(o,gn.Fixed64),this.writeDouble(n)},writeBooleanField:function(o,n){this.writeVarintField(o,!!n)}};var M_=Z(GI);const PS=3;function g9(o,n,l){n.glyphs=[],o===1&&l.readMessage(y9,n)}function y9(o,n,l){if(o===3){const{id:d,bitmap:p,width:v,height:w,left:E,top:k,advance:P}=l.readMessage(v9,{});n.glyphs.push({id:d,bitmap:new ql({width:v+2*PS,height:w+2*PS},p),metrics:{width:v,height:w,left:E,top:k,advance:P}})}else o===4?n.ascender=l.readSVarint():o===5&&(n.descender=l.readSVarint())}function v9(o,n,l){o===1?n.id=l.readVarint():o===2?n.bitmap=l.readBytes():o===3?n.width=l.readVarint():o===4?n.height=l.readVarint():o===5?n.left=l.readSVarint():o===6?n.top=l.readSVarint():o===7&&(n.advance=l.readVarint())}const QI=PS;function AS(o){let n=0,l=0;for(const w of o)n+=w.w*w.h,l=Math.max(l,w.w);o.sort((w,E)=>E.h-w.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),l),h:1/0}];let p=0,v=0;for(const w of o)for(let E=d.length-1;E>=0;E--){const k=d[E];if(!(w.w>k.w||w.h>k.h)){if(w.x=k.x,w.y=k.y,v=Math.max(v,w.y+w.h),p=Math.max(p,w.x+w.w),w.w===k.w&&w.h===k.h){const P=d.pop();E<d.length&&(d[E]=P)}else w.h===k.h?(k.x+=w.w,k.w-=w.w):w.w===k.w?(k.y+=w.h,k.h-=w.h):(d.push({x:k.x+w.w,y:k.y,w:k.w-w.w,h:w.h}),k.y+=w.h,k.h-=w.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}const Ts=1;class IS{constructor(n,{pixelRatio:l,version:d,stretchX:p,stretchY:v,content:w}){this.paddedRect=n,this.pixelRatio=l,this.stretchX=p,this.stretchY=v,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+Ts,this.paddedRect.y+Ts]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ts,this.paddedRect.y+this.paddedRect.h-Ts]}get displaySize(){return[(this.paddedRect.w-2*Ts)/this.pixelRatio,(this.paddedRect.h-2*Ts)/this.pixelRatio]}}class JI{constructor(n,l){const d={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,d,v),this.addImages(l,p,v);const{w,h:E}=AS(v),k=new qs({width:w||1,height:E||1});for(const P in n){const L=n[P],F=d[P].paddedRect;qs.copy(L.data,k,{x:0,y:0},{x:F.x+Ts,y:F.y+Ts},L.data)}for(const P in l){const L=l[P],F=p[P].paddedRect,$=F.x+Ts,H=F.y+Ts,q=L.data.width,K=L.data.height;qs.copy(L.data,k,{x:0,y:0},{x:$,y:H},L.data),qs.copy(L.data,k,{x:0,y:K-1},{x:$,y:H-1},{width:q,height:1}),qs.copy(L.data,k,{x:0,y:0},{x:$,y:H+K},{width:q,height:1}),qs.copy(L.data,k,{x:q-1,y:0},{x:$-1,y:H},{width:1,height:K}),qs.copy(L.data,k,{x:0,y:0},{x:$+q,y:H},{width:1,height:K})}this.image=k,this.iconPositions=d,this.patternPositions=p}addImages(n,l,d){for(const p in n){const v=n[p],w={x:0,y:0,w:v.data.width+2*Ts,h:v.data.height+2*Ts};d.push(w),l[p]=new IS(w,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>n.hasImage(d)),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in n.updatedImages)this.patchUpdatedImage(this.iconPositions[d],n.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],n.getImage(d),l)}patchUpdatedImage(n,l,d){if(!n||!l||n.version===l.version)return;n.version=l.version;const[p,v]=n.tl;d.update(l.data,void 0,{x:p,y:v})}}$t(IS,"ImagePosition"),$t(JI,"ImageAtlas");const _o={horizontal:1,vertical:2,horizontalOnly:3},eD=-17;class Og{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,l){const d=new Og;return d.scale=n||1,d.fontStack=l,d}static forImage(n){const l=new Og;return l.imageName=n,l}}class If{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,l){const d=new If;for(let p=0;p<n.sections.length;p++){const v=n.sections[p];v.image?d.addImageSection(v):d.addTextSection(v,l)}return d}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=function(l,d){let p="";for(let v=0;v<l.length;v++){const w=l.charCodeAt(v+1)||null,E=l.charCodeAt(v-1)||null;p+=!d&&(w&&r_(w)&&!Lg[l[v+1]]||E&&r_(E)&&!Lg[l[v-1]])||!Lg[l[v]]?l[v]:Lg[l[v]]}return p}(this.text,n)}trim(){let n=0;for(let d=0;d<this.text.length&&k_[this.text.charCodeAt(d)];d++)n++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=n&&k_[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(n,l),this.sectionIndex=this.sectionIndex.slice(n,l)}substring(n,l){const d=new If;return d.text=this.text.substring(n,l),d.sectionIndex=this.sectionIndex.slice(n,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,l)=>Math.max(n,this.sections[l].scale),0)}addTextSection(n,l){this.text+=n.text,this.sections.push(Og.forText(n.scale,n.fontStack||l));const d=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(d)}addImageSection(n){const l=n.image?n.image.name:"";if(l.length===0)return void Ir("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Og.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Ir("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function DS(o,n,l,d,p,v,w,E,k,P,L,F,$,H,q){const K=If.fromFeature(o,p);F===_o.vertical&&K.verticalizePunctuation($);let ne=[];const ue=function(we,Ve,Fe,Qe,pt,We){if(!we)return[];const st=[],ot=function(Rt,Ht,Lt,mr,_t,Jt){let gr=0;for(let $r=0;$r<Rt.length();$r++){const yr=Rt.getSection($r);gr+=tD(Rt.getCharCode($r),yr,mr,_t,Ht,Jt)}return gr/Math.max(1,Math.ceil(gr/Lt))}(we,Ve,Fe,Qe,pt,We),ut=we.text.indexOf("")>=0;let xt=0;for(let Rt=0;Rt<we.length();Rt++){const Ht=we.getSection(Rt),Lt=we.getCharCode(Rt);if(k_[Lt]||(xt+=tD(Lt,Ht,Qe,pt,Ve,We)),Rt<we.length()-1){const mr=!((Xe=Lt)<11904||!(Ot["Bopomofo Extended"](Xe)||Ot.Bopomofo(Xe)||Ot["CJK Compatibility Forms"](Xe)||Ot["CJK Compatibility Ideographs"](Xe)||Ot["CJK Compatibility"](Xe)||Ot["CJK Radicals Supplement"](Xe)||Ot["CJK Strokes"](Xe)||Ot["CJK Symbols and Punctuation"](Xe)||Ot["CJK Unified Ideographs Extension A"](Xe)||Ot["CJK Unified Ideographs"](Xe)||Ot["Enclosed CJK Letters and Months"](Xe)||Ot["Halfwidth and Fullwidth Forms"](Xe)||Ot.Hiragana(Xe)||Ot["Ideographic Description Characters"](Xe)||Ot["Kangxi Radicals"](Xe)||Ot["Katakana Phonetic Extensions"](Xe)||Ot.Katakana(Xe)||Ot["Vertical Forms"](Xe)||Ot["Yi Radicals"](Xe)||Ot["Yi Syllables"](Xe)));(x9[Lt]||mr||Ht.imageName)&&st.push(nD(Rt+1,xt,ot,st,_9(Lt,we.getCharCode(Rt+1),mr&&ut),!1))}}var Xe;return iD(nD(we.length(),xt,ot,st,0,!0))}(K,P,v,n,d,H),{processBidirectionalText:_e,processStyledBidirectionalText:de}=R;if(_e&&K.sections.length===1){const we=_e(K.toString(),ue);for(const Ve of we){const Fe=new If;Fe.text=Ve,Fe.sections=K.sections;for(let Qe=0;Qe<Ve.length;Qe++)Fe.sectionIndex.push(0);ne.push(Fe)}}else if(de){const we=de(K.text,K.sectionIndex,ue);for(const Ve of we){const Fe=new If;Fe.text=Ve[0],Fe.sectionIndex=Ve[1],Fe.sections=K.sections,ne.push(Fe)}}else ne=function(we,Ve){const Fe=[],Qe=we.text;let pt=0;for(const We of Ve)Fe.push(we.substring(pt,We)),pt=We;return pt<Qe.length&&Fe.push(we.substring(pt,Qe.length)),Fe}(K,ue);const xe=[],be={positionedLines:xe,text:K.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(we,Ve,Fe,Qe,pt,We,st,ot,ut,xt,Xe,Rt){let Ht=0,Lt=0,mr=0;const _t=ot==="right"?1:ot==="left"?0:.5;let Jt=!1;for(const wr of pt){const br=wr.getSections();for(const dn of br){if(dn.imageName)continue;const yn=Ve[dn.fontStack];if(yn&&(Jt=yn.ascender!==void 0&&yn.descender!==void 0,!Jt))break}if(!Jt)break}let gr=0;for(const wr of pt){wr.trim();const br=wr.getMaxScale(),dn=(br-1)*Pi,yn={positionedGlyphs:[],lineOffset:0};we.positionedLines[gr]=yn;const vn=yn.positionedGlyphs;let hn=0;if(!wr.length()){Lt+=We,++gr;continue}let In=0,Fn=0;for(let fn=0;fn<wr.length();fn++){const li=wr.getSection(fn),Jn=wr.getSectionIndex(fn),Nn=wr.getCharCode(fn);let Gr=li.scale,ei=null,xn=null,ls=null,ti=Pi,Ai=0;const Si=!(ut===_o.horizontal||!Xe&&!ug(Nn)||Xe&&(k_[Nn]||($r=Nn,Ot.Arabic($r)||Ot["Arabic Supplement"]($r)||Ot["Arabic Extended-A"]($r)||Ot["Arabic Presentation Forms-A"]($r)||Ot["Arabic Presentation Forms-B"]($r))));if(li.imageName){const cs=Qe[li.imageName];if(!cs)continue;ls=li.imageName,we.iconsInText=we.iconsInText||!0,xn=cs.paddedRect;const Ei=cs.displaySize;Gr=Gr*Pi/Rt,ei={width:Ei[0],height:Ei[1],left:Ts,top:-QI,advance:Si?Ei[1]:Ei[0],localGlyph:!1},Ai=Jt?-ei.height*Gr:eD+br*Pi-Ei[1]*Gr,ti=ei.advance;const Da=(Si?Ei[0]:Ei[1])*Gr-Pi*br;Da>0&&Da>hn&&(hn=Da)}else{const cs=Fe[li.fontStack];if(!cs)continue;cs[Nn]&&(xn=cs[Nn]);const Ei=Ve[li.fontStack];if(!Ei)continue;const Da=Ei.glyphs[Nn];if(!Da)continue;if(ei=Da.metrics,ti=Nn!==8203?Pi:0,Jt){const zf=Ei.ascender!==void 0?Math.abs(Ei.ascender):0,qg=Ei.descender!==void 0?Math.abs(Ei.descender):0,Zg=(zf+qg)*Gr;In<Zg&&(In=Zg,Fn=(zf-qg)/2*Gr),Ai=-zf*Gr}else Ai=eD+(br-Gr)*Pi}Si?(we.verticalizable=!0,vn.push({glyph:Nn,imageName:ls,x:Ht,y:Lt+Ai,vertical:Si,scale:Gr,localGlyph:ei.localGlyph,fontStack:li.fontStack,sectionIndex:Jn,metrics:ei,rect:xn}),Ht+=ti*Gr+xt):(vn.push({glyph:Nn,imageName:ls,x:Ht,y:Lt+Ai,vertical:Si,scale:Gr,localGlyph:ei.localGlyph,fontStack:li.fontStack,sectionIndex:Jn,metrics:ei,rect:xn}),Ht+=ei.advance*Gr+xt)}vn.length!==0&&(mr=Math.max(Ht-xt,mr),Jt?sD(vn,_t,hn,Fn,We*br/2):sD(vn,_t,hn,0,We/2)),Ht=0;const Qn=We*br+hn;yn.lineOffset=Math.max(hn,dn),Lt+=Qn,++gr}var $r;const yr=Lt,{horizontalAlign:or,verticalAlign:_n}=RS(st);(function(wr,br,dn,yn,vn,hn){const In=(br-dn)*vn,Fn=-hn*yn;for(const Qn of wr)for(const fn of Qn.positionedGlyphs)fn.x+=In,fn.y+=Fn})(we.positionedLines,_t,or,_n,mr,yr),we.top+=-_n*yr,we.bottom=we.top+yr,we.left+=-or*mr,we.right=we.left+mr,we.hasBaseline=Jt}(be,n,l,d,ne,w,E,k,F,P,$,q),!function(we){for(const Ve of we)if(Ve.positionedGlyphs.length!==0)return!1;return!0}(xe)&&be}const k_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},x9={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tD(o,n,l,d,p,v){if(n.imageName){const w=d[n.imageName];return w?w.displaySize[0]*n.scale*Pi/v+p:0}{const w=l[n.fontStack],E=w&&w.glyphs[o];return E?E.metrics.advance*n.scale+p:0}}function rD(o,n,l,d){const p=Math.pow(o-n,2);return d?o<n?p/2:2*p:p+Math.abs(l)*l}function _9(o,n,l){let d=0;return o===10&&(d-=1e4),l&&(d+=150),o!==40&&o!==65288||(d+=50),n!==41&&n!==65289||(d+=50),d}function nD(o,n,l,d,p,v){let w=null,E=rD(n,l,p,v);for(const k of d){const P=rD(n-k.x,l,p,v)+k.badness;P<=E&&(w=k,E=P)}return{index:o,x:n,priorBreak:w,badness:E}}function iD(o){return o?iD(o.priorBreak).concat(o.index):[]}function RS(o){let n=.5,l=.5;switch(o){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:n,verticalAlign:l}}function sD(o,n,l,d,p){if(!(n||l||d||p))return;const v=o.length-1,w=o[v],E=(w.x+w.metrics.advance*w.scale)*n;for(let k=0;k<=v;k++)o[k].x-=E,o[k].y+=l+d+p}function w9(o,n,l){const{horizontalAlign:d,verticalAlign:p}=RS(l),v=n[0]-o.displaySize[0]*d,w=n[1]-o.displaySize[1]*p;return{image:o,top:w,bottom:w+o.displaySize[1],left:v,right:v+o.displaySize[0]}}function oD(o,n,l,d,p,v){const w=o.image;let E;if(w.content){const ne=w.content,ue=w.pixelRatio||1;E=[ne[0]/ue,ne[1]/ue,w.displaySize[0]-ne[2]/ue,w.displaySize[1]-ne[3]/ue]}const k=n.left*v,P=n.right*v;let L,F,$,H;l==="width"||l==="both"?(H=p[0]+k-d[3],F=p[0]+P+d[1]):(H=p[0]+(k+P-w.displaySize[0])/2,F=H+w.displaySize[0]);const q=n.top*v,K=n.bottom*v;return l==="height"||l==="both"?(L=p[1]+q-d[0],$=p[1]+K+d[2]):(L=p[1]+(q+K-w.displaySize[1])/2,$=L+w.displaySize[1]),{image:w,top:L,right:F,bottom:$,left:H,collisionPadding:E}}class Xl extends he{constructor(n,l,d,p,v){super(n,l),this.angle=p,this.z=d,v!==void 0&&(this.segment=v)}clone(){return new Xl(this.x,this.y,this.z,this.angle,this.segment)}}function aD(o,n,l,d,p){if(n.segment===void 0)return!0;let v=n,w=n.segment+1,E=0;for(;E>-l/2;){if(w--,w<0)return!1;E-=o[w].dist(v),v=o[w]}E+=o[w].dist(o[w+1]),w++;const k=[];let P=0;for(;E<l/2;){const L=o[w],F=o[w+1];if(!F)return!1;let $=o[w-1].angleTo(L)-L.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:E,angleDelta:$}),P+=$;E-k[0].distance>d;)P-=k.shift().angleDelta;if(P>p)return!1;w++,E+=L.dist(F)}return!0}function lD(o){let n=0;for(let l=0;l<o.length-1;l++)n+=o[l].dist(o[l+1]);return n}function cD(o,n,l){return o?.6*n*l:0}function uD(o,n){return Math.max(o?o.right-o.left:0,n?n.right-n.left:0)}function b9(o,n,l,d,p,v){const w=cD(l,p,v),E=uD(l,d)*v;let k=0;const P=lD(o)/2;for(let L=0;L<o.length-1;L++){const F=o[L],$=o[L+1],H=F.dist($);if(k+H>P){const q=(P-k)/H,K=Ur(F.x,$.x,q),ne=Ur(F.y,$.y,q),ue=new Xl(K,ne,0,$.angleTo(F),L);return!w||aD(o,ue,E,w,n)?ue:void 0}k+=H}}function S9(o,n,l,d,p,v,w,E,k){const P=cD(d,v,w),L=uD(d,p),F=L*w,$=o[0].x===0||o[0].x===k||o[0].y===0||o[0].y===k;return n-F<n/4&&(n=F+n/4),dD(o,$?n/2*E%n:(L/2+2*v)*w*E%n,n,P,l,F,$,!1,k)}function dD(o,n,l,d,p,v,w,E,k){const P=v/2,L=lD(o);let F=0,$=n-l,H=[];for(let q=0;q<o.length-1;q++){const K=o[q],ne=o[q+1],ue=K.dist(ne),_e=ne.angleTo(K);for(;$+l<F+ue;){$+=l;const de=($-F)/ue,xe=Ur(K.x,ne.x,de),be=Ur(K.y,ne.y,de);if(xe>=0&&xe<k&&be>=0&&be<k&&$-P>=0&&$+P<=L){const we=new Xl(xe,be,0,_e,q);we._round(),d&&!aD(o,we,v,d,p)||H.push(we)}}F+=ue}return E||H.length||w||(H=dD(o,F/2,l,d,p,v,w,!0,k)),H}function hD(o,n,l,d,p){const v=[];for(let w=0;w<o.length;w++){const E=o[w];let k;for(let P=0;P<E.length-1;P++){let L=E[P],F=E[P+1];L.x<n&&F.x<n||(L.x<n?L=new he(n,L.y+(n-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x<n&&(F=new he(n,L.y+(n-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y<l&&F.y<l||(L.y<l?L=new he(L.x+(l-L.y)/(F.y-L.y)*(F.x-L.x),l)._round():F.y<l&&(F=new he(L.x+(l-L.y)/(F.y-L.y)*(F.x-L.x),l)._round()),L.x>=d&&F.x>=d||(L.x>=d?L=new he(d,L.y+(d-L.x)/(F.x-L.x)*(F.y-L.y))._round():F.x>=d&&(F=new he(d,L.y+(d-L.x)/(F.x-L.x)*(F.y-L.y))._round()),L.y>=p&&F.y>=p||(L.y>=p?L=new he(L.x+(p-L.y)/(F.y-L.y)*(F.x-L.x),p)._round():F.y>=p&&(F=new he(L.x+(p-L.y)/(F.y-L.y)*(F.x-L.x),p)._round()),k&&L.equals(k[k.length-1])||(k=[L],v.push(k)),k.push(F)))))}}return v}$t(Xl,"Anchor");const zg=1e20;function fD(o,n,l,d,p,v,w,E,k){for(let P=n;P<n+d;P++)pD(o,l*v+P,v,p,w,E,k);for(let P=l;P<l+p;P++)pD(o,P*v+n,1,d,w,E,k)}function pD(o,n,l,d,p,v,w){v[0]=0,w[0]=-zg,w[1]=zg,p[0]=o[n];for(let E=1,k=0,P=0;E<d;E++){p[E]=o[n+E*l];const L=E*E;do{const F=v[k];P=(p[E]-p[F]+L-F*F)/(E-F)/2}while(P<=w[k]&&--k>-1);k++,v[k]=E,w[k]=P,w[k+1]=zg}for(let E=0,k=0;E<d;E++){for(;w[k+1]<E;)k++;const P=v[k],L=E-P;o[n+E*l]=p[P]+L*L}}const Aa=2,NS={none:0,ideographs:1,all:2};class Df{constructor(n,l,d){this.requestManager=n,this.localGlyphMode=l,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,l){const d=[];for(const p in n)for(const v of n[p])d.push({stack:p,id:v});wt(d,({stack:p,id:v},w)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=E.glyphs[v];if(k!==void 0)return void w(null,{stack:p,id:v,glyph:k});if(k=this._tinySDF(E,p,v),k)return E.glyphs[v]=k,void w(null,{stack:p,id:v,glyph:k});const P=Math.floor(v/256);if(256*P>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[P])return void w(null,{stack:p,id:v,glyph:k});let L=E.requests[P];L||(L=E.requests[P]=[],Df.loadGlyphRange(p,P,this.url,this.requestManager,(F,$)=>{if($){E.ascender=$.ascender,E.descender=$.descender;for(const H in $.glyphs)this._doesCharSupportLocalGlyph(+H)||(E.glyphs[+H]=$.glyphs[+H]);E.ranges[P]=!0}for(const H of L)H(F,$);delete E.requests[P]})),L.push((F,$)=>{F?w(F):$&&w(null,{stack:p,id:v,glyph:$.glyphs[v]||null})})},(p,v)=>{if(p)l(p);else if(v){const w={};for(const{stack:E,id:k,glyph:P}of v)w[E]===void 0&&(w[E]={}),w[E].glyphs===void 0&&(w[E].glyphs={}),w[E].glyphs[k]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},w[E].ascender=this.entries[E].ascender,w[E].descender=this.entries[E].descender;l(null,w)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==NS.none&&(this.localGlyphMode===NS.all?!!this.localFontFamily:!!this.localFontFamily&&(Ot["CJK Unified Ideographs"](n)||Ot["Hangul Syllables"](n)||Ot.Hiragana(n)||Ot.Katakana(n)||Ot["CJK Symbols and Punctuation"](n)))}_tinySDF(n,l,d){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let v=n.tinySDF;if(!v){let K="400";/bold/i.test(l)?K="900":/medium/i.test(l)?K="500":/light/i.test(l)&&(K="200"),v=n.tinySDF=new Df.TinySDF({fontFamily:p,fontWeight:K,fontSize:24*Aa,buffer:3*Aa,radius:8*Aa}),v.fontWeight=K}if(this.localGlyphs[v.fontWeight][d])return this.localGlyphs[v.fontWeight][d];const w=String.fromCharCode(d),{data:E,width:k,height:P,glyphWidth:L,glyphHeight:F,glyphLeft:$,glyphTop:H,glyphAdvance:q}=v.draw(w);return this.localGlyphs[v.fontWeight][d]={id:d,bitmap:new ql({width:k,height:P},E),metrics:{width:L/Aa,height:F/Aa,left:$/Aa,top:H/Aa-27,advance:q/Aa,localGlyph:!0}}}}Df.loadGlyphRange=function(o,n,l,d,p){const v=256*n,w=v+255,E=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",o).replace("{range}",`${v}-${w}`),po.Glyphs);vr(E,(k,P)=>{if(k)p(k);else if(P){const L={},F=function($){return new M_($).readFields(g9,{})}(P);for(const $ of F.glyphs)L[$.id]=$;p(null,{glyphs:L,ascender:F.ascender,descender:F.descender})}})},Df.TinySDF=class{constructor({fontSize:o=24,buffer:n=3,radius:l=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:v="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=d,this.radius=l;const E=this.size=o+4*n,k=this._createCanvas(E),P=this.ctx=k.getContext("2d",{willReadFrequently:!0});P.font=`${w} ${v} ${o}px ${p}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(o){const n=document.createElement("canvas");return n.width=n.height=o,n}draw(o){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:v}=this.ctx.measureText(o),w=Math.ceil(l),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-p))),k=Math.min(this.size-this.buffer,w+Math.ceil(d)),P=E+2*this.buffer,L=k+2*this.buffer,F=Math.max(P*L,0),$=new Uint8ClampedArray(F),H={data:$,width:P,height:L,glyphWidth:E,glyphHeight:k,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(E===0||k===0)return H;const{ctx:q,buffer:K,gridInner:ne,gridOuter:ue}=this;q.clearRect(K,K,E,k),q.fillText(o,K,K+w);const _e=q.getImageData(K,K,E,k);ue.fill(zg,0,F),ne.fill(0,0,F);for(let de=0;de<k;de++)for(let xe=0;xe<E;xe++){const be=_e.data[4*(de*E+xe)+3]/255;if(be===0)continue;const we=(de+K)*P+xe+K;if(be===1)ue[we]=0,ne[we]=zg;else{const Ve=.5-be;ue[we]=Ve>0?Ve*Ve:0,ne[we]=Ve<0?Ve*Ve:0}}fD(ue,0,0,P,L,P,this.f,this.v,this.z),fD(ne,K,K,E,k,P,this.f,this.v,this.z);for(let de=0;de<F;de++){const xe=Math.sqrt(ue[de])-Math.sqrt(ne[de]);$[de]=Math.round(255-255*(xe/this.radius+this.cutoff))}return H}};const Rf=Ts;function mD(o,n,l,d){const p=[],v=o.image,w=v.pixelRatio,E=v.paddedRect.w-2*Rf,k=v.paddedRect.h-2*Rf,P=o.right-o.left,L=o.bottom-o.top,F=v.stretchX||[[0,E]],$=v.stretchY||[[0,k]],H=(We,st)=>We+st[1]-st[0],q=F.reduce(H,0),K=$.reduce(H,0),ne=E-q,ue=k-K;let _e=0,de=q,xe=0,be=K,we=0,Ve=ne,Fe=0,Qe=ue;if(v.content&&d){const We=v.content;_e=P_(F,0,We[0]),xe=P_($,0,We[1]),de=P_(F,We[0],We[2]),be=P_($,We[1],We[3]),we=We[0]-_e,Fe=We[1]-xe,Ve=We[2]-We[0]-de,Qe=We[3]-We[1]-be}const pt=(We,st,ot,ut)=>{const xt=A_(We.stretch-_e,de,P,o.left),Xe=I_(We.fixed-we,Ve,We.stretch,q),Rt=A_(st.stretch-xe,be,L,o.top),Ht=I_(st.fixed-Fe,Qe,st.stretch,K),Lt=A_(ot.stretch-_e,de,P,o.left),mr=I_(ot.fixed-we,Ve,ot.stretch,q),_t=A_(ut.stretch-xe,be,L,o.top),Jt=I_(ut.fixed-Fe,Qe,ut.stretch,K),gr=new he(xt,Rt),$r=new he(Lt,Rt),yr=new he(Lt,_t),or=new he(xt,_t),_n=new he(Xe/w,Ht/w),wr=new he(mr/w,Jt/w),br=n*Math.PI/180;if(br){const vn=Math.sin(br),hn=Math.cos(br),In=[hn,-vn,vn,hn];gr._matMult(In),$r._matMult(In),or._matMult(In),yr._matMult(In)}const dn=We.stretch+We.fixed,yn=st.stretch+st.fixed;return{tl:gr,tr:$r,bl:or,br:yr,tex:{x:v.paddedRect.x+Rf+dn,y:v.paddedRect.y+Rf+yn,w:ot.stretch+ot.fixed-dn,h:ut.stretch+ut.fixed-yn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:_n,pixelOffsetBR:wr,minFontScaleX:Ve/w/P,minFontScaleY:Qe/w/L,isSDF:l}};if(d&&(v.stretchX||v.stretchY)){const We=gD(F,ne,q),st=gD($,ue,K);for(let ot=0;ot<We.length-1;ot++){const ut=We[ot],xt=We[ot+1];for(let Xe=0;Xe<st.length-1;Xe++)p.push(pt(ut,st[Xe],xt,st[Xe+1]))}}else p.push(pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:k+1}));return p}function P_(o,n,l){let d=0;for(const p of o)d+=Math.max(n,Math.min(l,p[1]))-Math.max(n,Math.min(l,p[0]));return d}function gD(o,n,l){const d=[{fixed:-Rf,stretch:0}];for(const[p,v]of o){const w=d[d.length-1];d.push({fixed:p-w.stretch,stretch:w.stretch}),d.push({fixed:p-w.stretch,stretch:w.stretch+(v-p)})}return d.push({fixed:n+Rf,stretch:l}),d}function A_(o,n,l,d){return o/n*l+d}function I_(o,n,l,d){return o-n*l/d}function E9(o,n,l,d){const p=n+o.positionedLines[d].lineOffset;return d===0?l+p/2:l+(p+(n+o.positionedLines[d-1].lineOffset))/2}class T9{constructor(n=[],l=C9){if(this.data=n,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:l,compare:d}=this,p=l[n];for(;n>0;){const v=n-1>>1,w=l[v];if(d(p,w)>=0)break;l[n]=w,n=v}l[n]=p}_down(n){const{data:l,compare:d}=this,p=this.length>>1,v=l[n];for(;n<p;){let w=1+(n<<1),E=l[w];const k=w+1;if(k<this.length&&d(l[k],E)<0&&(w=k,E=l[k]),d(E,v)>=0)break;l[n]=E,n=w}l[n]=v}}function C9(o,n){return o<n?-1:o>n?1:0}function M9(o,n=1,l=!1){let d=1/0,p=1/0,v=-1/0,w=-1/0;const E=o[0];for(let H=0;H<E.length;H++){const q=E[H];(!H||q.x<d)&&(d=q.x),(!H||q.y<p)&&(p=q.y),(!H||q.x>v)&&(v=q.x),(!H||q.y>w)&&(w=q.y)}const k=Math.min(v-d,w-p);let P=k/2;const L=new T9([],k9);if(k===0)return new he(d,p);for(let H=d;H<v;H+=k)for(let q=p;q<w;q+=k)L.push(new Nf(H+P,q+P,P,o));let F=function(H){let q=0,K=0,ne=0;const ue=H[0];for(let _e=0,de=ue.length,xe=de-1;_e<de;xe=_e++){const be=ue[_e],we=ue[xe],Ve=be.x*we.y-we.x*be.y;K+=(be.x+we.x)*Ve,ne+=(be.y+we.y)*Ve,q+=3*Ve}return new Nf(K/q,ne/q,0,H)}(o),$=L.length;for(;L.length;){const H=L.pop();(H.d>F.d||!F.d)&&(F=H,l&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,$)),H.max-F.d<=n||(P=H.h/2,L.push(new Nf(H.p.x-P,H.p.y-P,P,o)),L.push(new Nf(H.p.x+P,H.p.y-P,P,o)),L.push(new Nf(H.p.x-P,H.p.y+P,P,o)),L.push(new Nf(H.p.x+P,H.p.y+P,P,o)),$+=4)}return l&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function k9(o,n){return n.max-o.max}class Nf{constructor(n,l,d,p){this.p=new he(n,l),this.h=d,this.d=function(v,w){let E=!1,k=1/0;for(let P=0;P<w.length;P++){const L=w[P];for(let F=0,$=L.length,H=$-1;F<$;H=F++){const q=L[F],K=L[H];q.y>v.y!=K.y>v.y&&v.x<(K.x-q.x)*(v.y-q.y)/(K.y-q.y)+q.x&&(E=!E),k=Math.min(k,dI(v,q,K))}}return(E?1:-1)*Math.sqrt(k)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const jf=7,jS=Number.POSITIVE_INFINITY,P9=Math.sqrt(2);function yD(o,[n,l]){let d=0,p=0;if(l===jS){n<0&&(n=0);const v=n/P9;switch(o){case"top-right":case"top-left":p=v-jf;break;case"bottom-right":case"bottom-left":p=-v+jf;break;case"bottom":p=-n+jf;break;case"top":p=n-jf}switch(o){case"top-right":case"bottom-right":d=-v;break;case"top-left":case"bottom-left":d=v;break;case"left":d=n;break;case"right":d=-n}}else{switch(n=Math.abs(n),l=Math.abs(l),o){case"top-right":case"top-left":case"top":p=l-jf;break;case"bottom-right":case"bottom-left":case"bottom":p=-l+jf}switch(o){case"top-right":case"bottom-right":case"right":d=-n;break;case"top-left":case"bottom-left":case"left":d=n}}return[d,p]}function A9(o,n,l,d,p,v,w,E,k,P){o.createArrays(),o.tilePixelRatio=rr/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const L=o.layers[0].layout,F=o.layers[0]._unevaluatedLayout._values,$={};if(o.textSizeData.kind==="composite"){const{minZoom:K,maxZoom:ne}=o.textSizeData;$.compositeTextSizes=[F["text-size"].possiblyEvaluate(new O(K),E),F["text-size"].possiblyEvaluate(new O(ne),E)]}if(o.iconSizeData.kind==="composite"){const{minZoom:K,maxZoom:ne}=o.iconSizeData;$.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new O(K),E),F["icon-size"].possiblyEvaluate(new O(ne),E)]}$.layoutTextSize=F["text-size"].possiblyEvaluate(new O(k+1),E),$.layoutIconSize=F["icon-size"].possiblyEvaluate(new O(k+1),E),$.textMaxSize=F["text-size"].possiblyEvaluate(new O(18),E);const H=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",q=L.get("text-size");for(const K of o.features){const ne=L.get("text-font").evaluate(K,{},E).join(","),ue=q.evaluate(K,{},E),_e=$.layoutTextSize.evaluate(K,{},E),de=($.layoutIconSize.evaluate(K,{},E),{horizontal:{},vertical:void 0}),xe=K.text;let be,we=[0,0];if(xe){const Qe=xe.toString(),pt=L.get("text-letter-spacing").evaluate(K,{},E)*Pi,We=L.get("text-line-height").evaluate(K,{},E)*Pi,st=Wb(Qe)?pt:0,ot=L.get("text-anchor").evaluate(K,{},E),ut=L.get("text-variable-anchor");if(!ut){const Lt=L.get("text-radial-offset").evaluate(K,{},E);we=Lt?yD(ot,[Lt*Pi,jS]):L.get("text-offset").evaluate(K,{},E).map(mr=>mr*Pi)}let xt=H?"center":L.get("text-justify").evaluate(K,{},E);const Xe=L.get("symbol-placement")==="point",Rt=Xe?L.get("text-max-width").evaluate(K,{},E)*Pi:1/0,Ht=Lt=>{o.allowVerticalPlacement&&cg(Qe)&&(de.vertical=DS(xe,n,l,p,ne,Rt,We,ot,Lt,st,we,_o.vertical,!0,_e,ue))};if(!H&&ut){const Lt=xt==="auto"?ut.map(_t=>LS(_t)):[xt];let mr=!1;for(let _t=0;_t<Lt.length;_t++){const Jt=Lt[_t];if(!de.horizontal[Jt])if(mr)de.horizontal[Jt]=de.horizontal[0];else{const gr=DS(xe,n,l,p,ne,Rt,We,"center",Jt,st,we,_o.horizontal,!1,_e,ue);gr&&(de.horizontal[Jt]=gr,mr=gr.positionedLines.length===1)}}Ht("left")}else{if(xt==="auto"&&(xt=LS(ot)),Xe||L.get("text-writing-mode").indexOf("horizontal")>=0||!cg(Qe)){const Lt=DS(xe,n,l,p,ne,Rt,We,ot,xt,st,we,_o.horizontal,!1,_e,ue);Lt&&(de.horizontal[xt]=Lt)}Ht(Xe?"left":xt)}}let Ve=!1;if(K.icon&&K.icon.name){const Qe=d[K.icon.name];Qe&&(be=w9(p[K.icon.name],L.get("icon-offset").evaluate(K,{},E),L.get("icon-anchor").evaluate(K,{},E)),Ve=Qe.sdf,o.sdfIcons===void 0?o.sdfIcons=Qe.sdf:o.sdfIcons!==Qe.sdf&&Ir("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==o.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(o.iconsNeedLinear=!0))}const Fe=xD(de.horizontal)||de.vertical;o.iconsInText||(o.iconsInText=!!Fe&&Fe.iconsInText),(Fe||be)&&I9(o,K,de,be,d,$,_e,0,we,Ve,w,E,P)}v&&o.generateCollisionDebugBuffers(k,o.collisionBoxArray)}function LS(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function I9(o,n,l,d,p,v,w,E,k,P,L,F,$){let H=v.textMaxSize.evaluate(n,{},F);H===void 0&&(H=w);const q=o.layers[0].layout,K=q.get("icon-offset").evaluate(n,{},F),ne=xD(l.horizontal)||l.vertical,ue=$.name==="globe",_e=Pi,de=w/_e,xe=o.tilePixelRatio*H/_e,be=(ot=o.overscaling,o.zoom>18&&ot>2&&(ot>>=1),Math.max(rr/(512*ot),1)*q.get("symbol-spacing")),we=q.get("text-padding")*o.tilePixelRatio,Ve=q.get("icon-padding")*o.tilePixelRatio,Fe=Ie(q.get("text-max-angle")),Qe=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",pt=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",We=q.get("symbol-placement"),st=be/2;var ot;const ut=q.get("icon-text-fit");let xt;d&&ut!=="none"&&(o.allowVerticalPlacement&&l.vertical&&(xt=oD(d,l.vertical,ut,q.get("icon-text-fit-padding"),K,de)),ne&&(d=oD(d,ne,ut,q.get("icon-text-fit-padding"),K,de)));const Xe=(Rt,Ht,Lt)=>{if(Ht.x<0||Ht.x>=rr||Ht.y<0||Ht.y>=rr)return;let mr=null;if(ue){const{x:_t,y:Jt,z:gr}=$.projectTilePoint(Ht.x,Ht.y,Lt);mr={anchor:new Xl(_t,Jt,gr,0,void 0),up:$.upVector(Lt,Ht.x,Ht.y)}}(function(_t,Jt,gr,$r,yr,or,_n,wr,br,dn,yn,vn,hn,In,Fn,Qn,fn,li,Jn,Nn,Gr,ei,xn,ls,ti){const Ai=_t.addToLineVertexArray(Jt,$r);let Si,cs,Ei,Da,zf,qg,Zg,QD=0,JD=0,eR=0,tR=0,KS=-1,QS=-1;const ll={};let rR=qb("");const Gd=gr?gr.anchor:Jt;let JS=0,eE=0;if(br._unevaluatedLayout.getValue("text-radial-offset")===void 0?[JS,eE]=br.layout.get("text-offset").evaluate(Gr,{},ti).map(Zs=>Zs*Pi):(JS=br.layout.get("text-radial-offset").evaluate(Gr,{},ti)*Pi,eE=jS),_t.allowVerticalPlacement&&yr.vertical){const Zs=yr.vertical;if(Fn)qg=OS(Zs),wr&&(Zg=OS(wr));else{const Xs=br.layout.get("text-rotate").evaluate(Gr,{},ti)+90;Ei=D_(dn,Gd,Jt,yn,vn,hn,Zs,In,Xs,Qn),wr&&(Da=D_(dn,Gd,Jt,yn,vn,hn,wr,li,Xs))}}if(or){const Zs=br.layout.get("icon-rotate").evaluate(Gr,{},ti),Xs=br.layout.get("icon-text-fit")!=="none",Xg=mD(or,Zs,xn,Xs),rE=wr?mD(wr,Zs,xn,Xs):void 0;cs=D_(dn,Gd,Jt,yn,vn,hn,or,li,Zs),QD=4*Xg.length;const nR=_t.iconSizeData;let Hd=null;nR.kind==="source"?(Hd=[Pa*br.layout.get("icon-size").evaluate(Gr,{},ti)],Hd[0]>Yc&&Ir(`${_t.layerIds[0]}: Value for "icon-size" is >= ${Fg}. Reduce your "icon-size".`)):nR.kind==="composite"&&(Hd=[Pa*ei.compositeIconSizes[0].evaluate(Gr,{},ti),Pa*ei.compositeIconSizes[1].evaluate(Gr,{},ti)],(Hd[0]>Yc||Hd[1]>Yc)&&Ir(`${_t.layerIds[0]}: Value for "icon-size" is >= ${Fg}. Reduce your "icon-size".`)),_t.addSymbols(_t.icon,Xg,Hd,Nn,Jn,Gr,!1,gr,Jt,Ai.lineStartIndex,Ai.lineLength,-1,ls,ti),KS=_t.icon.placedSymbolArray.length-1,rE&&(JD=4*rE.length,_t.addSymbols(_t.icon,rE,Hd,Nn,Jn,Gr,_o.vertical,gr,Jt,Ai.lineStartIndex,Ai.lineLength,-1,ls,ti),QS=_t.icon.placedSymbolArray.length-1)}for(const Zs in yr.horizontal){const Xs=yr.horizontal[Zs];Si||(rR=qb(Xs.text),Fn?zf=OS(Xs):Si=D_(dn,Gd,Jt,yn,vn,hn,Xs,In,br.layout.get("text-rotate").evaluate(Gr,{},ti),Qn));const Xg=Xs.positionedLines.length===1;if(eR+=vD(_t,gr,Jt,Xs,_n,br,Fn,Gr,Qn,Ai,yr.vertical?_o.horizontal:_o.horizontalOnly,Xg?Object.keys(yr.horizontal):[Zs],ll,KS,ei,ls,ti),Xg)break}yr.vertical&&(tR+=vD(_t,gr,Jt,yr.vertical,_n,br,Fn,Gr,Qn,Ai,_o.vertical,["vertical"],ll,QS,ei,ls,ti));let ru=-1;const tE=(Zs,Xs)=>Zs?Math.max(Zs,Xs):Xs;ru=tE(zf,ru),ru=tE(qg,ru),ru=tE(Zg,ru);const s7=ru>-1?1:0;_t.glyphOffsetArray.length>=Qc.MAX_GLYPHS&&Ir("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gr.sortKey!==void 0&&_t.addToSortKeyRanges(_t.symbolInstances.length,Gr.sortKey),_t.symbolInstances.emplaceBack(Gd.x,Gd.y,Gd.z,Jt.x,Jt.y,ll.right>=0?ll.right:-1,ll.center>=0?ll.center:-1,ll.left>=0?ll.left:-1,ll.vertical>=0?ll.vertical:-1,KS,QS,rR,Si!==void 0?Si:_t.collisionBoxArray.length,Si!==void 0?Si+1:_t.collisionBoxArray.length,Ei!==void 0?Ei:_t.collisionBoxArray.length,Ei!==void 0?Ei+1:_t.collisionBoxArray.length,cs!==void 0?cs:_t.collisionBoxArray.length,cs!==void 0?cs+1:_t.collisionBoxArray.length,Da||_t.collisionBoxArray.length,Da?Da+1:_t.collisionBoxArray.length,yn,eR,tR,QD,JD,s7,0,JS,eE,ru)})(o,Ht,mr,Rt,l,d,p,xt,o.layers[0],o.collisionBoxArray,n.index,n.sourceLayerIndex,o.index,we,Qe,k,0,Ve,pt,K,n,v,P,L,F)};if(We==="line")for(const Rt of hD(n.geometry,0,0,rr,rr)){const Ht=S9(Rt,be,Fe,l.vertical||ne,d,_e,xe,o.overscaling,rr);for(const Lt of Ht)ne&&D9(o,ne.text,st,Lt)||Xe(Rt,Lt,F)}else if(We==="line-center"){for(const Rt of n.geometry)if(Rt.length>1){const Ht=b9(Rt,Fe,l.vertical||ne,d,_e,xe);Ht&&Xe(Rt,Ht,F)}}else if(n.type==="Polygon")for(const Rt of SS(n.geometry,0)){const Ht=M9(Rt,16);Xe(Rt[0],new Xl(Ht.x,Ht.y,0,0,void 0),F)}else if(n.type==="LineString")for(const Rt of n.geometry)Xe(Rt,new Xl(Rt[0].x,Rt[0].y,0,0,void 0),F);else if(n.type==="Point")for(const Rt of n.geometry)for(const Ht of Rt)Xe([Ht],new Xl(Ht.x,Ht.y,0,0,void 0),F)}const Fg=255,Yc=Fg*Pa;function vD(o,n,l,d,p,v,w,E,k,P,L,F,$,H,q,K,ne){const ue=function(xe,be,we,Ve,Fe,Qe,pt,We){const st=[];if(be.positionedLines.length===0)return st;const ot=Ve.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,ut=function(Lt){const mr=Lt[0],_t=Lt[1],Jt=mr*_t;return Jt>0?[mr,-_t]:Jt<0?[-mr,_t]:mr===0?[_t,mr]:[_t,-mr]}(we);let xt=Math.abs(be.top-be.bottom);for(const Lt of be.positionedLines)xt-=Lt.lineOffset;const Xe=be.positionedLines.length,Rt=xt/Xe;let Ht=be.top-we[1];for(let Lt=0;Lt<Xe;++Lt){const mr=be.positionedLines[Lt];Ht=E9(be,Rt,Ht,Lt);for(const _t of mr.positionedGlyphs){if(!_t.rect)continue;const Jt=_t.rect||{};let gr=QI+1,$r=!0,yr=1,or=0;if(_t.imageName){const xn=pt[_t.imageName];if(!xn)continue;if(xn.sdf){Ir("SDF images are not supported in formatted text and will be ignored.");continue}$r=!1,yr=xn.pixelRatio,gr=Ts/yr}const _n=(Fe||We)&&_t.vertical,wr=_t.metrics.advance*_t.scale/2,br=_t.metrics,dn=_t.rect;if(dn===null)continue;We&&be.verticalizable&&(or=_t.imageName?wr-_t.metrics.width*_t.scale/2:0);const yn=Fe?[_t.x+wr,_t.y]:[0,0];let vn=[0,0],hn=[0,0],In=!1;Fe||(_n?(hn=[_t.x+wr+ut[0],_t.y+ut[1]-or],In=!0):vn=[_t.x+wr+we[0],_t.y+we[1]-or]);const Fn=dn.w*_t.scale/(yr*(_t.localGlyph?Aa:1)),Qn=dn.h*_t.scale/(yr*(_t.localGlyph?Aa:1));let fn,li,Jn,Nn;if(_n){const xn=_t.y-Ht,ls=new he(-wr,wr-xn),ti=-Math.PI/2,Ai=new he(...hn);fn=new he(-wr+vn[0],vn[1]),fn._rotateAround(ti,ls)._add(Ai),fn.x+=-xn+wr,fn.y-=(br.left-gr)*_t.scale;const Si=_t.imageName?br.advance*_t.scale:Pi*_t.scale,cs=String.fromCharCode(_t.glyph);s9(cs)?fn.x+=(1-gr)*_t.scale:o9(cs)?fn.x+=Si-br.height*_t.scale+(-gr-1)*_t.scale:fn.x+=_t.imageName||br.width+2*gr===dn.w&&br.height+2*gr===dn.h?(Si-Qn)/2:(Si-(br.height+2*gr)*_t.scale)/2,li=new he(fn.x,fn.y-Fn),Jn=new he(fn.x+Qn,fn.y),Nn=new he(fn.x+Qn,fn.y-Fn)}else{const xn=(br.left-gr)*_t.scale-wr+vn[0],ls=(-br.top-gr)*_t.scale+vn[1],ti=xn+Fn,Ai=ls+Qn;fn=new he(xn,ls),li=new he(ti,ls),Jn=new he(xn,Ai),Nn=new he(ti,Ai)}if(ot){let xn;xn=Fe?new he(0,0):In?new he(ut[0],ut[1]):new he(we[0],we[1]),fn._rotateAround(ot,xn),li._rotateAround(ot,xn),Jn._rotateAround(ot,xn),Nn._rotateAround(ot,xn)}const Gr=new he(0,0),ei=new he(0,0);st.push({tl:fn,tr:li,bl:Jn,br:Nn,tex:Jt,writingMode:be.writingMode,glyphOffset:yn,sectionIndex:_t.sectionIndex,isSDF:$r,pixelOffsetTL:Gr,pixelOffsetBR:ei,minFontScaleX:0,minFontScaleY:0})}}return st}(0,d,k,v,w,E,p,o.allowVerticalPlacement),_e=o.textSizeData;let de=null;_e.kind==="source"?(de=[Pa*v.layout.get("text-size").evaluate(E,{},ne)],de[0]>Yc&&Ir(`${o.layerIds[0]}: Value for "text-size" is >= ${Fg}. Reduce your "text-size".`)):_e.kind==="composite"&&(de=[Pa*q.compositeTextSizes[0].evaluate(E,{},ne),Pa*q.compositeTextSizes[1].evaluate(E,{},ne)],(de[0]>Yc||de[1]>Yc)&&Ir(`${o.layerIds[0]}: Value for "text-size" is >= ${Fg}. Reduce your "text-size".`)),o.addSymbols(o.text,ue,de,k,w,E,L,n,l,P.lineStartIndex,P.lineLength,H,K,ne);for(const xe of F)$[xe]=o.text.placedSymbolArray.length-1;return 4*ue.length}function xD(o){for(const n in o)return o[n];return null}function D_(o,n,l,d,p,v,w,E,k,P){let L=w.top,F=w.bottom,$=w.left,H=w.right;const q=w.collisionPadding;if(q&&($-=q[0],L-=q[1],H+=q[2],F+=q[3]),k){const K=new he($,L),ne=new he(H,L),ue=new he($,F),_e=new he(H,F),de=Ie(k);let xe=new he(0,0);P&&(xe=new he(P[0],P[1])),K._rotateAround(de,xe),ne._rotateAround(de,xe),ue._rotateAround(de,xe),_e._rotateAround(de,xe),$=Math.min(K.x,ne.x,ue.x,_e.x),H=Math.max(K.x,ne.x,ue.x,_e.x),L=Math.min(K.y,ne.y,ue.y,_e.y),F=Math.max(K.y,ne.y,ue.y,_e.y)}return o.emplaceBack(n.x,n.y,n.z,l.x,l.y,$,L,H,F,E,d,p,v),o.length-1}function OS(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const n=o.bottom-o.top;return n>0?Math.max(10,n):null}function D9(o,n,l,d){const p=o.compareText;if(n in p){const v=p[n];for(let w=v.length-1;w>=0;w--)if(d.dist(v[w])<l)return!0}else p[n]=[];return p[n].push(d),!1}function _D(o,n){const l=o.fovAboveCenter,d=o.elevation?o.elevation.getMinElevationBelowMSL()*n:0,p=(o._camera.position[2]*o.worldSize-d)/Math.cos(o._pitch),v=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-o._pitch-l,.01)),w=Math.sin(o._pitch)*v+p;return Math.min(1.01*w,p*(1/o._horizonShift))}function $d(o,n){if(!n.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:n};const l=Math.pow(2,-o.z),d=o.x*l,p=(o.x+1)*l,v=o.y*l,w=(o.y+1)*l,E=xo(d),k=xo(p),P=Bi(v),L=Bi(w),F=n.project(E,P),$=n.project(k,P),H=n.project(k,L),q=n.project(E,L);let K=Math.min(F.x,$.x,H.x,q.x),ne=Math.min(F.y,$.y,H.y,q.y),ue=Math.max(F.x,$.x,H.x,q.x),_e=Math.max(F.y,$.y,H.y,q.y);const de=l/16;function xe(we,Ve,Fe,Qe,pt,We){const st=(Fe+pt)/2,ot=(Qe+We)/2,ut=n.project(xo(st),Bi(ot)),xt=Math.max(0,K-ut.x,ne-ut.y,ut.x-ue,ut.y-_e);K=Math.min(K,ut.x),ue=Math.max(ue,ut.x),ne=Math.min(ne,ut.y),_e=Math.max(_e,ut.y),xt>de&&(xe(we,ut,Fe,Qe,st,ot),xe(ut,Ve,st,ot,pt,We))}xe(F,$,d,v,p,v),xe($,H,p,v,p,w),xe(H,q,p,w,d,w),xe(q,F,d,w,d,v),K-=de,ne-=de,ue+=de,_e+=de;const be=1/Math.max(ue-K,_e-ne);return{scale:be,x:K*be,y:ne*be,x2:ue*be,y2:_e*be,projection:n}}const R9=Ca(new Float32Array(16));class Kc{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,l){return{x:0,y:0,z:0}}unproject(n,l){return new un(0,0)}projectTilePoint(n,l,d){return{x:n,y:l,z:0}}locationPoint(n,l,d=!0){return n._coordinatePoint(n.locationCoordinate(l),d)}pixelsPerMeter(n,l){return ka(1,n)*l}pixelSpaceConversion(n,l,d){return 1}farthestPixelDistance(n){return _D(n,n.pixelsPerMeter)}pointCoordinate(n,l,d,p){const v=n.horizonLineFromTop(!1),w=new he(l,Math.max(v,d));return n.rayIntersectionCoordinate(n.pointRayIntersection(w,p))}pointCoordinate3D(n,l,d){const p=new he(l,d);if(n.elevation)return n.elevation.pointCoordinate(p);{const v=this.pointCoordinate(n,p.x,p.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(n,l){if(n.elevation)return!this.pointCoordinate3D(n,l.x,l.y);const d=n.horizonLineFromTop();return l.y<d}createInversionMatrix(n,l){return R9}createTileMatrix(n,l,d){let p,v,w;const E=d.canonical,k=Ca(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=$d(E,this);p=1,v=P.x+d.wrap*P.scale,w=P.y,Ld(k,k,[p/P.scale,p/P.scale,n.pixelsPerMeter/l])}else p=l/n.zoomScale(E.z),v=(E.x+Math.pow(2,E.z)*d.wrap)*p,w=E.y*p;return gg(k,k,[v,w,0]),Ld(k,k,[p/rr,p/rr,1]),k}upVector(n,l,d){return[0,0,1]}upVectorScale(n,l,d){return{metersToTile:1}}}class N9 extends Kc{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[l,d]=this.parallels=n.parallels||[29.5,45.5],p=Math.sin(Ie(l));this.n=(p+Math.sin(Ie(d)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(n,l){const{n:d,c:p,r0:v}=this,w=Ie(n-this.center[0]),E=Ie(l),k=Math.sqrt(p-2*d*Math.sin(E))/d;return{x:k*Math.sin(w*d),y:k*Math.cos(w*d)-v,z:0}}unproject(n,l){const{n:d,c:p,r0:v}=this,w=v+l;let E=Math.atan2(n,Math.abs(w))*Math.sign(w);w*d<0&&(E-=Math.PI*Math.sign(n)*Math.sign(w));const k=Ie(this.center[0])*d;E=Ge(E,-Math.PI-k,Math.PI-k);const P=Re(rt(E/d)+this.center[0],-180,180),L=Math.asin(Re((p-(n*n+w*w)*d*d)/(2*d),-1,1)),F=Re(rt(L),-Ui,Ui);return new un(P,F)}}const Bg=1.340264,Ug=-.081106,Vg=893e-6,$g=.003796,R_=Math.sqrt(3)/2;class j9 extends Kc{project(n,l){l=l/180*Math.PI,n=n/180*Math.PI;const d=Math.asin(R_*Math.sin(l)),p=d*d,v=p*p*p;return{x:.5*(n*Math.cos(d)/(R_*(Bg+3*Ug*p+v*(7*Vg+9*$g*p)))/Math.PI+.5),y:1-.5*(d*(Bg+Ug*p+v*(Vg+$g*p))/Math.PI+1),z:0}}unproject(n,l){n=(2*n-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=d*d,v=p*p*p;for(let L,F,$,H=0;H<12&&(F=d*(Bg+Ug*p+v*(Vg+$g*p))-l,$=Bg+3*Ug*p+v*(7*Vg+9*$g*p),L=F/$,d=Re(d-L,-Math.PI/3,Math.PI/3),p=d*d,v=p*p*p,!(Math.abs(L)<1e-12));++H);const w=R_*n*(Bg+3*Ug*p+v*(7*Vg+9*$g*p))/Math.cos(d),E=Math.asin(Math.sin(d)/R_),k=Re(180*w/Math.PI,-180,180),P=Re(180*E/Math.PI,-Ui,Ui);return new un(k,P)}}class L9 extends Kc{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,l){return{x:.5+n/360,y:.5-l/360,z:0}}unproject(n,l){const d=360*(n-.5),p=Re(360*(.5-l),-Ui,Ui);return new un(d,p)}}const Lf=Math.PI/2;function N_(o){return Math.tan((Lf+o)/2)}class O9 extends Kc{constructor(n){super(n),this.center=n.center||[0,30];const[l,d]=this.parallels=n.parallels||[30,30];let p=Ie(l),v=Ie(d);this.southernCenter=p+v<0,this.southernCenter&&(p=-p,v=-v);const w=Math.cos(p),E=N_(p);this.n=p===v?Math.sin(p):Math.log(w/Math.cos(v))/Math.log(N_(v)/E),this.f=w*Math.pow(N_(p),this.n)/this.n}project(n,l){l=Ie(l),this.southernCenter&&(l=-l),n=Ie(n-this.center[0]);const d=1e-6,{n:p,f:v}=this;v>0?l<-Lf+d&&(l=-Lf+d):l>Lf-d&&(l=Lf-d);const w=v/Math.pow(N_(l),p);let E=w*Math.sin(p*n),k=v-w*Math.cos(p*n);return E=.5*(E/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:E,y:this.southernCenter?k:1-k,z:0}}unproject(n,l){n=(2*n-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:d,f:p}=this,v=p-l,w=Math.sign(v),E=Math.sign(d)*Math.sqrt(n*n+v*v);let k=Math.atan2(n,Math.abs(v))*w;v*d<0&&(k-=Math.PI*Math.sign(n)*w);const P=Re(rt(k/d)+this.center[0],-180,180),L=Re(rt(2*Math.atan(Math.pow(p/E,1/d))-Lf),-Ui,Ui);return new un(P,this.southernCenter?-L:L)}}class wD extends Kc{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,l){return{x:nl(n),y:il(l),z:0}}unproject(n,l){const d=xo(n),p=Bi(l);return new un(d,p)}}const bD=Ie(Ui);class z9 extends Kc{project(n,l){const d=(l=Ie(l))*l,p=d*d;return{x:.5*((n=Ie(n))*(.8707-.131979*d+p*(p*(.003971*d-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+p*(.028874*d-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(n,l){n=(2*n-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=25,v=0,w=d*d;do{w=d*d;const P=w*w;v=(d*(1.007226+w*(.015085+P*(.028874*w-.044475-.005916*P)))-l)/(1.007226+w*(.045255+P*(.259866*w-.311325-.005916*11*P))),d=Re(d-v,-bD,bD)}while(Math.abs(v)>1e-6&&--p>0);w=d*d;const E=Re(rt(n/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),k=rt(d);return new un(E,k)}}const SD=Ie(Ui);class F9 extends Kc{project(n,l){l=Ie(l),n=Ie(n);const d=Math.cos(l),p=2/Math.PI,v=Math.acos(d*Math.cos(n/2)),w=Math.sin(v)/v,E=.5*(n*p+2*d*Math.sin(n/2)/w)||0,k=.5*(l+Math.sin(l)/w)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(n,l){let d=n=(2*n-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,v=25;const w=1e-6;let E=0,k=0;do{const P=Math.cos(p),L=Math.sin(p),F=2*L*P,$=L*L,H=P*P,q=Math.cos(d/2),K=Math.sin(d/2),ne=2*q*K,ue=K*K,_e=1-H*q*q,de=_e?1/_e:0,xe=_e?Math.acos(P*q)*Math.sqrt(1/_e):0,be=.5*(2*xe*P*K+2*d/Math.PI)-n,we=.5*(xe*L+p)-l,Ve=.5*de*(H*ue+xe*P*q*$)+1/Math.PI,Fe=de*(ne*F/4-xe*L*K),Qe=.125*de*(F*K-xe*L*H*ne),pt=.5*de*($*q+xe*ue*P)+.5,We=Fe*Qe-pt*Ve;E=(we*Fe-be*pt)/We,k=(be*Qe-we*Ve)/We,d=Re(d-E,-Math.PI,Math.PI),p=Re(p-k,-SD,SD)}while((Math.abs(E)>w||Math.abs(k)>w)&&--v>0);return new un(rt(d),rt(p))}}class ED extends Kc{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ie(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,l){const{scale:d,cosPhi:p}=this;return{x:Ie(n)*p*d+.5,y:-Math.sin(Ie(l))/p*d+.5,z:0}}unproject(n,l){const{scale:d,cosPhi:p}=this,v=-(l-.5)/d,w=Re(rt((n-.5)/d)/p,-180,180),E=Math.asin(Re(v*p,-1,1)),k=Re(rt(E),-Ui,Ui);return new un(w,k)}}class B9 extends wD{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,l,d){const p=Eg(n,l,d);return Gn(p,p,Tg(rl(d))),{x:p[0],y:p[1],z:p[2]}}locationPoint(n,l){const d=wf(l.lat,l.lng),p=ss([],d),v=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(l),n._centerAltitude):n._centerAltitude;_g(d,d,p,ka(1,0)*rr*v);const w=Ca(new Float64Array(16));return jd(w,n.pixelMatrix,n.globeMatrix),Gn(d,d,w),new he(d[0],d[1])}pixelsPerMeter(n,l){return ka(1,0)*l}pixelSpaceConversion(n,l,d){const p=ka(1,n)*l,v=Ur(ka(1,45)*l,p,d);return this.pixelsPerMeter(n,l)/v}createTileMatrix(n,l,d){const p=aS(rl(d.canonical));return jd(new Float64Array(16),n.globeMatrix,p)}createInversionMatrix(n,l){const{center:d}=n,p=Tg(rl(l));return l_(p,p,Ie(d.lng)),Kb(p,p,Ie(d.lat)),Ld(p,p,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(n,l,d,p){return KA(n,l,d,!0)||new Sf(0,0)}pointCoordinate3D(n,l,d){const p=this.pointCoordinate(n,l,d,0);return[p.x,p.y,p.z]}isPointAboveHorizon(n,l){return!KA(n,l.x,l.y,!1)}farthestPixelDistance(n){const l=function(p,v){const w=p.cameraToCenterDistance,E=p._centerAltitude*v,k=p._camera,P=p._camera.forward(),L=Gl([],vo([],P,-w),[0,0,E]),F=p.worldSize/(2*Math.PI),$=[0,0,-F],H=p.width/p.height,q=Math.tan(p.fovAboveCenter),K=vo([],k.up(),q),ne=vo([],k.right(),q*H),ue=ss([],Gl([],Gl([],P,K),ne)),_e=[];let de;if(new tS(L,ue).closestPointOnSphere($,F,_e)){const xe=Gl([],_e,$),be=Ma([],xe,L);de=Math.cos(p.fovAboveCenter)*yg(be)}else{const xe=Ma([],L,$),be=Ma([],$,L);ss(be,be);const we=yg(xe)-F;de=Math.sqrt(we*(we+2*F));const Ve=Math.acos(de/(F+we))-Math.acos(Go(P,be));de*=Math.cos(Ve)}return 1.01*de}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),d=bf(n.zoom);if(d>0){const p=_D(n,ka(1,n.center.lat)*n.worldSize),v=n.worldSize/(2*Math.PI),w=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Ur(l,p+v*(1-Math.cos(w)),Math.pow(d,10))}return l}upVector(n,l,d){return Eg(l,d,n,1)}upVectorScale(n){return{metersToTile:c_(d_(rl(n)))}}}function TD(o){const n=o.parallels,l=!!n&&Math.abs(n[0]+n[1])<.01;switch(o.name){case"mercator":return new wD(o);case"equirectangular":return new L9(o);case"naturalEarth":return new z9(o);case"equalEarth":return new j9(o);case"winkelTripel":return new F9(o);case"albers":return l?new ED(o):new N9(o);case"lambertConformalConic":return l?new ED(o):new O9(o);case"globe":return new B9(o)}throw new Error(`Invalid projection name: ${o.name}`)}const U9=w_.types,V9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function j_(o,n,l,d,p,v,w,E,k,P,L,F,$){const H=E?Math.min(Yc,Math.round(E[0])):0,q=E?Math.min(Yc,Math.round(E[1])):0;o.emplaceBack(n,l,Math.round(32*d),Math.round(32*p),v,w,(H<<1)+(k?1:0),q,16*P,16*L,256*F,256*$)}function L_(o,n,l,d,p,v,w){o.emplaceBack(n,l,d,p,v,w)}function O_(o,n,l,d,p){o.emplaceBack(n,l,d,p),o.emplaceBack(n,l,d,p),o.emplaceBack(n,l,d,p),o.emplaceBack(n,l,d,p)}function $9(o){for(const n of o.sections)if(Hb(n.text))return!0;return!1}class zS{constructor(n){this.layoutVertexArray=new at,this.indexArray=new qt,this.programConfigurations=n,this.segments=new Yn,this.dynamicLayoutVertexArray=new ht,this.opacityVertexArray=new Yt,this.placedSymbolArray=new Xn,this.globeExtVertexArray=new gt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,l,d,p){this.isEmpty()||(d&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,K2.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,J2.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,V9,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,Q2.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$t(zS,"SymbolBuffers");class FS{constructor(n,l,d){this.layoutVertexArray=new n,this.layoutAttributes=l,this.indexArray=new d,this.segments=new Yn,this.collisionVertexArray=new Nr,this.collisionVertexArrayExt=new Pr}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,e9.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,t9.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$t(FS,"CollisionBuffers");class Qc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(w=>w.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ca([]),this.placementViewportMatrix=Ca([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=MS(this.zoom,l["text-size"]),this.iconSizeData=MS(this.zoom,l["icon-size"]);const d=this.layers[0].layout,p=d.get("symbol-sort-key"),v=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(w=>_o[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new zS(new Nd(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new zS(new Nd(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new is,this.lineVertexArray=new gf,this.symbolInstances=new En}calculateGlyphDependencies(n,l,d,p,v){for(let w=0;w<n.length;w++)if(l[n.charCodeAt(w)]=!0,p&&v){const E=Lg[n.charAt(w)];E&&(l[E.charCodeAt(0)]=!0)}}populate(n,l,d,p){const v=this.layers[0],w=v.layout,E=this.projection.name==="globe",k=w.get("text-font"),P=w.get("text-field"),L=w.get("icon-image"),F=(P.value.kind!=="constant"||P.value.value instanceof ns&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),$=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,H=w.get("symbol-sort-key");if(this.features=[],!F&&!$)return;const q=l.iconDependencies,K=l.glyphDependencies,ne=l.availableImages,ue=new O(this.zoom);for(const{feature:_e,id:de,index:xe,sourceLayerIndex:be}of n){const we=v._featureFilter.needGeometry,Ve=Bd(_e,we);if(!v._featureFilter.filter(ue,Ve,d))continue;if(we||(Ve.geometry=Hl(_e,d,p)),E&&_e.type!==1&&d.z<=5){const We=Ve.geometry,st=.98078528056,ot=(ut,xt)=>Go(Eg(ut.x,ut.y,d,1),Eg(xt.x,xt.y,d,1))<st;for(let ut=0;ut<We.length;ut++)We[ut]=J$(We[ut],ot)}let Fe,Qe;if(F){const We=v.getValueAndResolveTokens("text-field",Ve,d,ne),st=ns.factory(We);$9(st)&&(this.hasRTLText=!0),(!this.hasRTLText||T()==="unavailable"||this.hasRTLText&&R.isParsed())&&(Fe=i9(st,v,Ve))}if($){const We=v.getValueAndResolveTokens("icon-image",Ve,d,ne);Qe=We instanceof Vs?We:Vs.fromString(We)}if(!Fe&&!Qe)continue;const pt=this.sortFeaturesByKey?H.evaluate(Ve,{},d):void 0;if(this.features.push({id:de,text:Fe,icon:Qe,index:xe,sourceLayerIndex:be,geometry:Ve.geometry,properties:_e.properties,type:U9[_e.type],sortKey:pt}),Qe&&(q[Qe.name]=!0),Fe){const We=k.evaluate(Ve,{},d).join(","),st=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_o.vertical)>=0;for(const ot of Fe.sections)if(ot.image)q[ot.image.name]=!0;else{const ut=cg(Fe.toString()),xt=ot.fontStack||We,Xe=K[xt]=K[xt]||{};this.calculateGlyphDependencies(ot.text,Xe,st,this.allowVerticalPlacement,ut)}}}w.get("symbol-placement")==="line"&&(this.features=function(_e){const de={},xe={},be=[];let we=0;function Ve(We){be.push(_e[We]),we++}function Fe(We,st,ot){const ut=xe[We];return delete xe[We],xe[st]=ut,be[ut].geometry[0].pop(),be[ut].geometry[0]=be[ut].geometry[0].concat(ot[0]),ut}function Qe(We,st,ot){const ut=de[st];return delete de[st],de[We]=ut,be[ut].geometry[0].shift(),be[ut].geometry[0]=ot[0].concat(be[ut].geometry[0]),ut}function pt(We,st,ot){const ut=ot?st[0][st[0].length-1]:st[0][0];return`${We}:${ut.x}:${ut.y}`}for(let We=0;We<_e.length;We++){const st=_e[We],ot=st.geometry,ut=st.text?st.text.toString():null;if(!ut){Ve(We);continue}const xt=pt(ut,ot),Xe=pt(ut,ot,!0);if(xt in xe&&Xe in de&&xe[xt]!==de[Xe]){const Rt=Qe(xt,Xe,ot),Ht=Fe(xt,Xe,be[Rt].geometry);delete de[xt],delete xe[Xe],xe[pt(ut,be[Ht].geometry,!0)]=Ht,be[Rt].geometry=null}else xt in xe?Fe(xt,Xe,ot):Xe in de?Qe(xt,Xe,ot):(Ve(We),de[xt]=we-1,xe[Xe]=we-1)}return be.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((_e,de)=>_e.sortKey-de.sortKey)}update(n,l,d,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,l,this.layers,d,p),this.icon.programConfigurations.updatePaintArrays(n,l,this.layers,d,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=TD(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,l){const d=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:p,y:v}of l)this.lineVertexArray.emplaceBack(p,v);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(n,l,d,p,v,w,E,k,P,L,F,$,H,q){const K=n.indexArray,ne=n.layoutVertexArray,ue=n.globeExtVertexArray,_e=n.segments.prepareSegment(4*l.length,ne,K,this.canOverlap?w.sortKey:void 0),de=this.glyphOffsetArray.length,xe=_e.vertexLength,be=this.allowVerticalPlacement&&E===_o.vertical?Math.PI/2:0,we=w.text&&w.text.sections;for(let Fe=0;Fe<l.length;Fe++){const{tl:Qe,tr:pt,bl:We,br:st,tex:ot,pixelOffsetTL:ut,pixelOffsetBR:xt,minFontScaleX:Xe,minFontScaleY:Rt,glyphOffset:Ht,isSDF:Lt,sectionIndex:mr}=l[Fe],_t=_e.vertexLength,Jt=Ht[1];if(j_(ne,P.x,P.y,Qe.x,Jt+Qe.y,ot.x,ot.y,d,Lt,ut.x,ut.y,Xe,Rt),j_(ne,P.x,P.y,pt.x,Jt+pt.y,ot.x+ot.w,ot.y,d,Lt,xt.x,ut.y,Xe,Rt),j_(ne,P.x,P.y,We.x,Jt+We.y,ot.x,ot.y+ot.h,d,Lt,ut.x,xt.y,Xe,Rt),j_(ne,P.x,P.y,st.x,Jt+st.y,ot.x+ot.w,ot.y+ot.h,d,Lt,xt.x,xt.y,Xe,Rt),k){const{x:gr,y:$r,z:yr}=k.anchor,[or,_n,wr]=k.up;L_(ue,gr,$r,yr,or,_n,wr),L_(ue,gr,$r,yr,or,_n,wr),L_(ue,gr,$r,yr,or,_n,wr),L_(ue,gr,$r,yr,or,_n,wr),O_(n.dynamicLayoutVertexArray,gr,$r,yr,be)}else O_(n.dynamicLayoutVertexArray,P.x,P.y,P.z,be);K.emplaceBack(_t,_t+1,_t+2),K.emplaceBack(_t+1,_t+2,_t+3),_e.vertexLength+=4,_e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ht[0]),Fe!==l.length-1&&mr===l[Fe+1].sectionIndex||n.programConfigurations.populatePaintArrays(ne.length,w,w.index,{},H,q,we&&we[mr])}const Ve=k?k.anchor:P;n.placedSymbolArray.emplaceBack(Ve.x,Ve.y,Ve.z,P.x,P.y,de,this.glyphOffsetArray.length-de,xe,L,F,P.segment,d?d[0]:0,d?d[1]:0,p[0],p[1],E,0,!1,0,$,0)}_commitLayoutVertex(n,l,d,p,v,w,E){n.emplaceBack(l,d,p,v,w,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,l,d,p,v,w,E){const k=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),P=k.vertexLength,L=E.tileAnchorX,F=E.tileAnchorY;for(let H=0;H<4;H++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(l,-n.padding,-n.padding),d.collisionVertexArrayExt.emplaceBack(l,n.padding,-n.padding),d.collisionVertexArrayExt.emplaceBack(l,n.padding,n.padding),d.collisionVertexArrayExt.emplaceBack(l,-n.padding,n.padding),this._commitLayoutVertex(d.layoutVertexArray,p,v,w,L,F,new he(n.x1,n.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,v,w,L,F,new he(n.x2,n.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,v,w,L,F,new he(n.x2,n.y2)),this._commitLayoutVertex(d.layoutVertexArray,p,v,w,L,F,new he(n.x1,n.y2)),k.vertexLength+=4;const $=d.indexArray;$.emplaceBack(P,P+1),$.emplaceBack(P+1,P+2),$.emplaceBack(P+2,P+3),$.emplaceBack(P+3,P),k.primitiveLength+=4}_addTextDebugCollisionBoxes(n,l,d,p,v,w){for(let E=p;E<v;E++){const k=d.get(E),P=this.getSymbolInstanceTextSize(n,w,l,E);this._addCollisionDebugVertices(k,P,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(n,l,d,p,v,w){for(let E=p;E<v;E++){const k=d.get(E),P=this.getSymbolInstanceIconSize(n,l,w.placedIconSymbolIndex);this._addCollisionDebugVertices(k,P,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,w)}}generateCollisionDebugBuffers(n,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new FS(Gt,WI.members,bi),this.iconCollisionBox=new FS(Gt,WI.members,bi);const d=kf(this.iconSizeData,n),p=kf(this.textSizeData,n);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(p,n,l,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(p,n,l,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,n,l,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,n,l,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(n,l,d,p){const v=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),w=T_(this.textSizeData,n,v)/Pi;return this.tilePixelRatio*w}getSymbolInstanceIconSize(n,l,d){const p=this.icon.placedSymbolArray.get(d),v=T_(this.iconSizeData,n,p);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(n,l,d){n.emplaceBack(l,-d,-d),n.emplaceBack(l,d,-d),n.emplaceBack(l,d,d),n.emplaceBack(l,-d,d)}_updateTextDebugCollisionBoxes(n,l,d,p,v,w){for(let E=p;E<v;E++){const k=d.get(E),P=this.getSymbolInstanceTextSize(n,w,l,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,P,k.padding)}}_updateIconDebugCollisionBoxes(n,l,d,p,v,w){for(let E=p;E<v;E++){const k=d.get(E),P=this.getSymbolInstanceIconSize(n,l,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,k.padding)}}updateCollisionDebugBuffers(n,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=kf(this.iconSizeData,n),p=kf(this.textSizeData,n);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(p,n,l,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(p,n,l,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(d,n,l,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,n,l,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,l,d,p,v,w,E,k,P){const L={};if(l<d){const{x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe,featureIndex:be}=n.get(l);L.textBox={x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe},L.textFeatureIndex=be}if(p<v){const{x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe,featureIndex:be}=n.get(p);L.verticalTextBox={x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe},L.verticalTextFeatureIndex=be}if(w<E){const{x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe,featureIndex:be}=n.get(w);L.iconBox={x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe},L.iconFeatureIndex=be}if(k<P){const{x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe,featureIndex:be}=n.get(k);L.verticalIconBox={x1:F,y1:$,x2:H,y2:q,padding:K,projectedAnchorX:ne,projectedAnchorY:ue,projectedAnchorZ:_e,tileAnchorX:de,tileAnchorY:xe},L.verticalIconFeatureIndex=be}return L}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,l){const d=n.placedSymbolArray.get(l),p=d.vertexStartIndex+4*d.numGlyphs;for(let v=d.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+1,v+2),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(n),d=Math.cos(n),p=[],v=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const k=this.symbolInstances.get(E);p.push(0|Math.round(l*k.tileAnchorX+d*k.tileAnchorY)),v.push(k.featureIndex)}return w.sort((E,k)=>p[E]-p[k]||v[k]-v[E]),w}addToSortKeyRanges(n,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:P}=d;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&v!==p&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&w!==v&&w!==p&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$t(Qc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Qc.MAX_GLYPHS=65535,Qc.addDynamicAttributes=O_;const W9=new ge({"symbol-placement":new Y(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Y(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Y(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ie(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Y(Ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Y(Ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Y(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Y(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Y(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new ie(Ye.layout_symbol["icon-size"]),"icon-text-fit":new Y(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Y(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new ie(Ye.layout_symbol["icon-image"]),"icon-rotate":new ie(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Y(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Y(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new ie(Ye.layout_symbol["icon-offset"]),"icon-anchor":new ie(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Y(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Y(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Y(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new ie(Ye.layout_symbol["text-field"]),"text-font":new ie(Ye.layout_symbol["text-font"]),"text-size":new ie(Ye.layout_symbol["text-size"]),"text-max-width":new ie(Ye.layout_symbol["text-max-width"]),"text-line-height":new ie(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new ie(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new ie(Ye.layout_symbol["text-justify"]),"text-radial-offset":new ie(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Y(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new ie(Ye.layout_symbol["text-anchor"]),"text-max-angle":new Y(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Y(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new ie(Ye.layout_symbol["text-rotate"]),"text-padding":new Y(Ye.layout_symbol["text-padding"]),"text-keep-upright":new Y(Ye.layout_symbol["text-keep-upright"]),"text-transform":new ie(Ye.layout_symbol["text-transform"]),"text-offset":new ie(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new Y(Ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Y(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new Y(Ye.layout_symbol["text-optional"])});var BS={paint:new ge({"icon-opacity":new ie(Ye.paint_symbol["icon-opacity"]),"icon-color":new ie(Ye.paint_symbol["icon-color"]),"icon-halo-color":new ie(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new ie(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ie(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Y(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Y(Ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new ie(Ye.paint_symbol["text-opacity"]),"text-color":new ie(Ye.paint_symbol["text-color"],{runtimeType:Ss,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new ie(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new ie(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new ie(Ye.paint_symbol["text-halo-blur"]),"text-translate":new Y(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new Y(Ye.paint_symbol["text-translate-anchor"])}),layout:W9};class CD{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:kc,this.defaultValue=n}evaluate(n){if(n.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(n.formattedSection))return l.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t(CD,"FormatSectionOverride",{omit:["defaultValue"]});class z_ extends Ta{constructor(n){super(n,BS)}recalculate(n,l){super.recalculate(n,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const p=[];for(const v of d)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,l,d,p){const v=this.layout.get(n).evaluate(l,{},d,p),w=this._unevaluatedLayout._values[n];return w.isDataDriven()||Bc(w.value)||!v?v:function(E,k){return k.replace(/{([^{}]+)}/g,(P,L)=>L in E?String(E[L]):"")}(l.properties,v)}createBucket(n){return new Qc(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of BS.paint.overridableProperties){if(!z_.hasPaintOverride(this.layout,n))continue;const l=this.paint.get(n),d=new CD(l),p=new lf(d,l.property.specification);let v=null;v=l.value.kind==="constant"||l.value.kind==="source"?new Qm("source",p):new Td("composite",p,l.value.zoomStops,l.value._interpolationType),this.paint._values[n]=new ae(l.property,v,l.parameters)}}_handleOverridablePaintPropertyUpdate(n,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&z_.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,l){const d=n.get("text-field"),p=BS.paint.properties[l];let v=!1;const w=E=>{for(const k of E)if(p.overrides&&p.overrides.hasOverride(k))return void(v=!0)};if(d.value.kind==="constant"&&d.value.value instanceof ns)w(d.value.value.sections);else if(d.value.kind==="source"){const E=P=>{v||(P instanceof Nl&&zn(P.value)===ld?w(P.value.sections):P instanceof Qa?w(P.sections):P.eachChild(E))},k=d.value;k._styleExpression&&E(k._styleExpression.expression)}return v}getProgramConfiguration(n){return new qc(this,n)}}var G9={paint:new ge({"background-color":new Y(Ye.paint_background["background-color"]),"background-pattern":new Y(Ye.paint_background["background-pattern"]),"background-opacity":new Y(Ye.paint_background["background-opacity"])})},H9={paint:new ge({"raster-opacity":new Y(Ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Y(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Y(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Y(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Y(Ye.paint_raster["raster-saturation"]),"raster-contrast":new Y(Ye.paint_raster["raster-contrast"]),"raster-resampling":new Y(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Y(Ye.paint_raster["raster-fade-duration"])})};class q9 extends Ta{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var Z9={paint:new ge({"sky-type":new Y(Ye.paint_sky["sky-type"]),"sky-atmosphere-sun":new Y(Ye.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Y(Ye.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Y(Ye.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Y(Ye.paint_sky["sky-gradient-radius"]),"sky-gradient":new fe(Ye.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Y(Ye.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Y(Ye.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Y(Ye.paint_sky["sky-opacity"])})};function US(o,n,l){const d=[0,0,1],p=GA([]);return qA(p,p,l?-Ie(o)+Math.PI:Ie(o)),HA(p,p,-Ie(n)),UA(d,d,p),ss(d,d)}const X9={circle:class extends Ta{constructor(o){super(o,o2)}createBucket(o){return new fS(o)}queryRadius(o){const n=o;return Ef("circle-radius",this,n)+Ef("circle-stroke-width",this,n)+p_(this.paint.get("circle-translate"))}queryIntersectsFeature(o,n,l,d,p,v,w,E){const k=mI(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,o.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l);return gI(o,d,v,w,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,P)}getProgramIds(){return["circle"]}getProgramConfiguration(o){return new qc(this,o)}},heatmap:class extends Ta{createBucket(o){return new vI(o)}constructor(o){super(o,u2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return Ef("heatmap-radius",this,o)}queryIntersectsFeature(o,n,l,d,p,v,w,E){const k=this.paint.get("heatmap-radius").evaluate(n,l);return gI(o,d,v,w,E,!0,!0,new he(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(o){return new qc(this,o)}},hillshade:class extends Ta{constructor(o){super(o,d2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ta{constructor(o){super(o,M2)}getProgramIds(){const o=this.paint.get("fill-pattern"),n=o&&o.constantOr(1),l=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(o){return new qc(this,o)}recalculate(o,n){super.recalculate(o,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new x_(o)}queryRadius(){return p_(this.paint.get("fill-translate"))}queryIntersectsFeature(o,n,l,d,p,v){return!o.queryGeometry.isAboveHorizon&&uI(pI(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,o.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Ta{constructor(o){super(o,$2)}createBucket(o){return new Rg(o)}queryRadius(){return p_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(o){return new qc(this,o)}queryIntersectsFeature(o,n,l,d,p,v,w,E,k){const P=mI(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,o.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(n,l),F=this.paint.get("fill-extrusion-base").evaluate(n,l),$=[0,0],H=E&&v.elevation,q=v.elevation?v.elevation.exaggeration():1,K=o.tile.getBucket(this);if(H&&K instanceof Rg){const xe=K.centroidVertexArray,be=k+1;be<xe.length&&($[0]=xe.geta_centroid_pos0(be),$[1]=xe.geta_centroid_pos1(be))}if($[0]===0&&$[1]===1)return!1;v.projection.name==="globe"&&(d=LI([d],[new he(0,0),new he(rr,rr)],o.tileID.canonical).map(xe=>xe.polygon).flat());const ne=H?E:null,[ue,_e]=function(xe,be,we,Ve,Fe,Qe,pt,We,st,ot,ut){return xe.projection.name==="globe"?function(xt,Xe,Rt,Ht,Lt,mr,_t,Jt,gr,$r,yr){const or=[],_n=[],wr=xt.projection.upVectorScale(yr,xt.center.lat,xt.worldSize).metersToTile,br=[0,0,0,1],dn=[0,0,0,1],yn=(hn,In,Fn,Qn)=>{hn[0]=In,hn[1]=Fn,hn[2]=Qn,hn[3]=1},vn=jI();Rt>0&&(Rt+=vn),Ht+=vn;for(const hn of Xe){const In=[],Fn=[];for(const Qn of hn){const fn=Qn.x+Lt.x,li=Qn.y+Lt.y,Jn=xt.projection.projectTilePoint(fn,li,yr),Nn=xt.projection.upVector(yr,Qn.x,Qn.y);let Gr=Rt,ei=Ht;if(_t){const xn=BI(fn,li,Rt,Ht,_t,Jt,gr,$r);Gr+=xn.base,ei+=xn.top}Rt!==0?yn(br,Jn.x+Nn[0]*wr*Gr,Jn.y+Nn[1]*wr*Gr,Jn.z+Nn[2]*wr*Gr):yn(br,Jn.x,Jn.y,Jn.z),yn(dn,Jn.x+Nn[0]*wr*ei,Jn.y+Nn[1]*wr*ei,Jn.z+Nn[2]*wr*ei),Gn(br,br,mr),Gn(dn,dn,mr),In.push(new Mf(br[0],br[1],br[2])),Fn.push(new Mf(dn[0],dn[1],dn[2]))}or.push(In),_n.push(Fn)}return[or,_n]}(xe,be,we,Ve,Fe,Qe,pt,We,st,ot,ut):pt?function(xt,Xe,Rt,Ht,Lt,mr,_t,Jt,gr){const $r=[],yr=[],or=[0,0,0,1];for(const _n of xt){const wr=[],br=[];for(const dn of _n){const yn=dn.x+Ht.x,vn=dn.y+Ht.y,hn=BI(yn,vn,Xe,Rt,mr,_t,Jt,gr);or[0]=yn,or[1]=vn,or[2]=hn.base,or[3]=1,Od(or,or,Lt),or[3]=Math.max(or[3],1e-5);const In=new Mf(or[0]/or[3],or[1]/or[3],or[2]/or[3]);or[0]=yn,or[1]=vn,or[2]=hn.top,or[3]=1,Od(or,or,Lt),or[3]=Math.max(or[3],1e-5);const Fn=new Mf(or[0]/or[3],or[1]/or[3],or[2]/or[3]);wr.push(In),br.push(Fn)}$r.push(wr),yr.push(br)}return[$r,yr]}(be,we,Ve,Fe,Qe,pt,We,st,ot):function(xt,Xe,Rt,Ht,Lt){const mr=[],_t=[],Jt=Lt[8]*Xe,gr=Lt[9]*Xe,$r=Lt[10]*Xe,yr=Lt[11]*Xe,or=Lt[8]*Rt,_n=Lt[9]*Rt,wr=Lt[10]*Rt,br=Lt[11]*Rt;for(const dn of xt){const yn=[],vn=[];for(const hn of dn){const In=hn.x+Ht.x,Fn=hn.y+Ht.y,Qn=Lt[0]*In+Lt[4]*Fn+Lt[12],fn=Lt[1]*In+Lt[5]*Fn+Lt[13],li=Lt[2]*In+Lt[6]*Fn+Lt[14],Jn=Lt[3]*In+Lt[7]*Fn+Lt[15],Nn=Qn+Jt,Gr=fn+gr,ei=li+$r,xn=Math.max(Jn+yr,1e-5),ls=Qn+or,ti=fn+_n,Ai=li+wr,Si=Math.max(Jn+br,1e-5);yn.push(new Mf(Nn/xn,Gr/xn,ei/xn)),vn.push(new Mf(ls/Si,ti/Si,Ai/Si))}mr.push(yn),_t.push(vn)}return[mr,_t]}(be,we,Ve,Fe,Qe)}(v,d,F,L,P,w,ne,$,q,v.center.lat,o.tileID.canonical),de=o.queryGeometry;return function(xe,be,we){let Ve=1/0;uI(we,be)&&(Ve=FI(we,be[0]));for(let Fe=0;Fe<be.length;Fe++){const Qe=be[Fe],pt=xe[Fe];for(let We=0;We<Qe.length-1;We++){const st=Qe[We],ot=[st,Qe[We+1],pt[We+1],pt[We],st];cI(we,ot)&&(Ve=Math.min(Ve,FI(we,ot)))}}return Ve!==1/0&&Ve}(ue,_e,de.isPointQuery()?de.screenBounds:de.screenGeometry)}},line:class extends Ta{constructor(o){super(o,UI),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if(o==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Fm,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,n){super.recalculate(o,n),this.paint._values["line-floorwidth"]=VI.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new E_(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(o){return new qc(this,o)}queryRadius(o){const n=o,l=$I(Ef("line-width",this,n),Ef("line-gap-width",this,n)),d=Ef("line-offset",this,n);return l/2+Math.abs(d)+p_(this.paint.get("line-translate"))}queryIntersectsFeature(o,n,l,d,p,v){if(o.queryGeometry.isAboveHorizon)return!1;const w=pI(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,o.pixelToTileUnitsFactor),E=o.pixelToTileUnitsFactor/2*$I(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),k=this.paint.get("line-offset").evaluate(n,l);return k&&(d=function(P,L){const F=[],$=new he(0,0);for(let H=0;H<P.length;H++){const q=P[H],K=[];for(let ne=0;ne<q.length;ne++){const ue=q[ne],_e=q[ne+1],de=ne===0?$:ue.sub(q[ne-1])._unit()._perp(),xe=ne===q.length-1?$:_e.sub(ue)._unit()._perp(),be=de._add(xe)._unit();be._mult(1/(be.x*xe.x+be.y*xe.y)),K.push(be._mult(L)._add(ue))}F.push(K)}return F}(d,k*o.pixelToTileUnitsFactor)),function(P,L,F){for(let $=0;$<L.length;$++){const H=L[$];if(P.length>=3){for(let q=0;q<H.length;q++)if(Ud(P,H[q]))return!0}if(r2(P,H,F))return!0}return!1}(w,d,E)}isTileClipped(){return!0}},symbol:z_,background:class extends Ta{constructor(o){super(o,G9)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ta{constructor(o){super(o,H9)}getProgramIds(){return["raster"]}},sky:class extends Ta{constructor(o){super(o,Z9),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="sky-gradient"?this._updateColorRamp():o!=="sky-atmosphere-sun"&&o!=="sky-atmosphere-halo-color"&&o!=="sky-atmosphere-color"&&o!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=yS({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(o,n){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),p=!d,v=o.style.light,w=v.properties.get("position");return p&&v.properties.get("anchor")==="viewport"&&Ir("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?US(w.azimuthal,90-w.polar,n):US(d[0],90-d[1],n)}const l=this.paint.get("sky-gradient-center");return US(l[0],90-l[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return o==="atmosphere"?["skyboxCapture","skybox"]:o==="gradient"?["skyboxGradient"]:null}}};class Wg{constructor(n,l,d,p){this.context=n,this.format=d,this.texture=n.gl.createTexture(),this.update(l,p)}update(n,l,d){const{width:p,height:v}=n,{context:w}=this,{gl:E}=w,{HTMLImageElement:k,HTMLCanvasElement:P,HTMLVideoElement:L,ImageData:F,ImageBitmap:$}=_;if(E.bindTexture(E.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!l||l.premultiply!==!1)),d||this.size&&this.size[0]===p&&this.size[1]===v){const{x:H,y:q}=d||{x:0,y:0};n instanceof k||n instanceof P||n instanceof L||n instanceof F||$&&n instanceof $?E.texSubImage2D(E.TEXTURE_2D,0,H,q,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,H,q,p,v,E.RGBA,E.UNSIGNED_BYTE,n.data)}else this.size=[p,v],n instanceof k||n instanceof P||n instanceof L||n instanceof F||$&&n instanceof $?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,p,v,0,this.format,E.UNSIGNED_BYTE,n.data);this.useMipmap=!!(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(n,l){const{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),n!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?n===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:n),this.filter=n),l!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class Y9{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class K9{constructor(){this.tasks={},this.taskQueue=[],lr(["process"],this),this.invoker=new Y9(this.process),this.nextId=0}add(n,l){const d=this.nextId++,p=function({type:v,isSymbolTile:w,zoom:E}){return E=E||0,v==="message"?0:v!=="maybePrepare"||w?v!=="parseTile"||w?v==="parseTile"&&w?300-E:v==="maybePrepare"&&w?400-E:500:200-E:100-E}(l);if(p===0){Oe();try{n()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:n,metadata:l,priority:p,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){Oe();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const l=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let n=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const v=this.tasks[this.taskQueue[p]];v.priority<l&&(l=v.priority,n=p)}if(n===null)return null;const d=this.taskQueue[n];return this.taskQueue.splice(n,1),d}remove(){this.invoker.remove()}}class MD{constructor(n){this._stringToNumber={},this._numberToString=[];for(let l=0;l<n.length;l++){const d=n[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const Q9=["tile","layer","source","sourceLayer","state"];class kD{constructor(n,l,d,p,v){this.type="Feature",this._vectorTileFeature=n,this._z=l,this._x=d,this._y=p,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const l of Q9)this[l]!==void 0&&(n[l]=this[l]);return n}}const Zo=32,sl=33,Jc=new Uint16Array(8184);for(let o=0;o<2046;o++){let n=o+2,l=0,d=0,p=0,v=0,w=0,E=0;for(1&n?p=v=w=Zo:l=d=E=Zo;(n>>=1)>1;){const P=l+p>>1,L=d+v>>1;1&n?(p=l,v=d,l=w,d=E):(l=p,d=v,p=w,v=E),w=P,E=L}const k=4*o;Jc[k+0]=l,Jc[k+1]=d,Jc[k+2]=p,Jc[k+3]=v}const ol=new Uint16Array(2178),eu=new Uint8Array(1089),F_=new Uint16Array(1089);function PD(o){return o===0?-.03125:o===32?.03125:0}var AD=De([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const ID={type:2,extent:rr,loadGeometry:()=>[[new he(0,0),new he(rr+1,0),new he(rr+1,rr+1),new he(0,rr+1),new he(0,0)]]};class VS{constructor(n,l,d,p,v){this.tileID=n,this.uid=Bt(),this.uses=0,this.tileSize=l,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(n){const l=n+this.timeAdded;l<fa.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=$d(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,l,d){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,v){const w={};if(!v)return w;for(const E of p){const k=E.layerIds.map(P=>v.getLayer(P)).filter(Boolean);if(k.length!==0){E.layers=k,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(P=>k.filter(L=>L.id===P)[0]));for(const P of k)w[P.id]=E}}return w}(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const v=this.buckets[p];if(v instanceof Qc){if(this.hasSymbolBuckets=!0,!d)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const v=this.buckets[p];if(v instanceof Qc&&v.hasRTLText){this.hasRTLText=!0,R.isLoading()||R.isLoaded()||T()!=="deferred"||I();break}}this.queryPadding=0;for(const p in this.buckets){const v=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(p).queryRadius(v))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new cn}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const d in this.buckets){const p=this.buckets[d];p.uploadPending()&&p.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Wg(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Wg(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Wg(n,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,d,p,v,w,E,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:E,transform:w,params:v,tileTransform:this.tileTransform},n,l,d):{}}querySourceFeatures(n,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const p=d.loadVTLayers(),v=l?l.sourceLayer:"",w=p._geojsonTileLayer||p[v];if(!w)return;const E=hf(l&&l.filter),{z:k,x:P,y:L}=this.tileID.canonical,F={z:k,x:P,y:L};for(let $=0;$<w.length;$++){const H=w.feature($);if(E.needGeometry){const ne=Bd(H,!0);if(!E.filter(new O(this.tileID.overscaledZ),ne,this.tileID.canonical))continue}else if(!E.filter(new O(this.tileID.overscaledZ),H))continue;const q=d.getId(H,v),K=new kD(H,k,P,L,q);K.tile=F,n.push(K)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const d=Ze(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let p=!1;if(this.expirationTime>d)p=!1;else if(l)if(this.expirationTime<l)p=!0;else{const v=this.expirationTime-l;v?this.expirationTime=d+Math.max(v,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!l)return;const d=this.latestFeatureIndex.loadVTLayers(),p=l.style.listImages();for(const v in this.buckets){if(!l.style.hasLayer(v))continue;const w=this.buckets[v],E=w.layers[0].sourceLayer||"_geojsonTileLayer",k=d[E],P=n[E];if(!k||!P||Object.keys(P).length===0)continue;if(w.update(P,k,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof E_||w instanceof x_){const F=l.style._getSourceCache(w.layers[0].source);l._terrain&&l._terrain.enabled&&F&&w.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(F.id,this.tileID)}const L=l&&l.style&&l.style.getLayer(v);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<fa.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=fa.now()+n}setTexture(n,l){const d=l.context,p=d.gl;this.texture=this.texture||l.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new Wg(d,n,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(n,l){const d={};for(const p of l)d[p]=!0;this.dependencies[n]=d}hasDependency(n,l){for(const d of n){const p=this.dependencies[d];if(p){for(const v of l)if(p[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const d=Hl(ID,this.tileID.canonical,this.tileTransform)[0],p=new ft,v=new Gs;for(let w=0;w<d.length;w++){const{x:E,y:k}=d[w];p.emplaceBack(E,k),v.emplaceBack(w)}v.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(v),this._tileDebugBuffer=n.createVertexBuffer(p,bg.members),this._tileDebugSegments=Yn.simpleSegment(0,0,p.length,v.length)}_makeTileBoundsBuffers(n,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const d=Hl(ID,this.tileID.canonical,this.tileTransform)[0];let p,v;if(this.isRaster){const w=function(E,k){const P=$d(E,k),L=Math.pow(2,E.z);for(let ne=0;ne<sl;ne++)for(let ue=0;ue<sl;ue++){const _e=xo((E.x+(ue+PD(ue))/Zo)/L),de=Bi((E.y+(ne+PD(ne))/Zo)/L),xe=k.project(_e,de),be=ne*sl+ue;ol[2*be+0]=Math.round((xe.x*P.scale-P.x)*rr),ol[2*be+1]=Math.round((xe.y*P.scale-P.y)*rr)}eu.fill(0),F_.fill(0);for(let ne=2045;ne>=0;ne--){const ue=4*ne,_e=Jc[ue+0],de=Jc[ue+1],xe=Jc[ue+2],be=Jc[ue+3],we=_e+xe>>1,Ve=de+be>>1,Fe=we+Ve-de,Qe=Ve+_e-we,pt=de*sl+_e,We=be*sl+xe,st=Ve*sl+we,ot=Math.hypot((ol[2*pt+0]+ol[2*We+0])/2-ol[2*st+0],(ol[2*pt+1]+ol[2*We+1])/2-ol[2*st+1])>=16;eu[st]=eu[st]||(ot?1:0),ne<1022&&(eu[st]=eu[st]||eu[(de+Qe>>1)*sl+(_e+Fe>>1)]||eu[(be+Qe>>1)*sl+(xe+Fe>>1)])}const F=new tt,$=new qt;let H=0;function q(ne,ue){const _e=ue*sl+ne;return F_[_e]===0&&(F.emplaceBack(ol[2*_e+0],ol[2*_e+1],ne*rr/Zo,ue*rr/Zo),F_[_e]=++H),F_[_e]-1}function K(ne,ue,_e,de,xe,be){const we=ne+_e>>1,Ve=ue+de>>1;if(Math.abs(ne-xe)+Math.abs(ue-be)>1&&eu[Ve*sl+we])K(xe,be,ne,ue,we,Ve),K(_e,de,xe,be,we,Ve);else{const Fe=q(ne,ue),Qe=q(_e,de),pt=q(xe,be);$.emplaceBack(Fe,Qe,pt)}}return K(0,0,Zo,Zo,Zo,0),K(Zo,Zo,0,0,0,Zo),{vertices:F,indices:$}}(this.tileID.canonical,l);p=w.vertices,v=w.indices}else{p=new tt,v=new qt;for(const{x:E,y:k}of d)p.emplaceBack(E,k,0,0);const w=bS(p.int16,void 0,4);for(let E=0;E<w.length;E+=3)v.emplaceBack(w[E],w[E+1],w[E+2])}this._tileBoundsBuffer=n.createVertexBuffer(p,AD.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(v),this._tileBoundsSegments=Yn.simpleSegment(0,0,p.length,v.length)}_makeGlobeTileDebugBuffers(n,l){const d=l.projection;if(!d||d.name!=="globe"||l.freezeTileCoverage)return;const p=this.tileID.canonical,v=Tg(QA(p,l)),w=bf(l.zoom);let E;w>0&&(E=Yb(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,p,l,v,E,w),this._makeGlobeTileDebugTextBuffer(n,p,l,v,E,w)}_globePoint(n,l,d,p,v,w,E){let k=Eg(n,l,d);if(w){const P=1<<d.z,L=nl(p.center.lng),F=il(p.center.lat),$=(d.x+.5)/P-L;let H=0;$>.5?H=-1:$<-.5&&(H=1);let q=(n/rr+d.x)/P+H,K=(l/rr+d.y)/P;q=(q-L)*p._pixelsPerMercatorPixel+L,K=(K-F)*p._pixelsPerMercatorPixel+F;const ne=[q*p.worldSize,K*p.worldSize,0];Gn(ne,ne,w),k=Fd(k,ne,E)}return Gn(k,k,v)}_makeGlobeTileDebugBorderBuffer(n,l,d,p,v,w){const E=new ft,k=new Gs,P=new ze,L=($,H,q,K,ne)=>{const ue=(q-$)/(ne-1),_e=(K-H)/(ne-1),de=E.length;for(let xe=0;xe<ne;xe++){const be=$+xe*ue,we=H+xe*_e;E.emplaceBack(be,we);const Ve=this._globePoint(be,we,l,d,p,v,w);P.emplaceBack(Ve[0],Ve[1],Ve[2]),k.emplaceBack(de+xe)}},F=rr;L(0,0,F,0,16),L(F,0,F,F,16),L(F,F,0,F,16),L(0,F,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(k),this._tileDebugBuffer=n.createVertexBuffer(E,bg.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(P,XA.members),this._tileDebugSegments=Yn.simpleSegment(0,0,E.length,k.length)}_makeGlobeTileDebugTextBuffer(n,l,d,p,v,w){const E=rr/4,k=new ft,P=new qt,L=new ze,F=25;P.reserve(32),k.reserve(F),L.reserve(F);const $=(H,q)=>F*H+q;for(let H=0;H<F;H++){const q=H*E;for(let K=0;K<F;K++){const ne=K*E;k.emplaceBack(ne,q);const ue=this._globePoint(ne,q,l,d,p,v,w);L.emplaceBack(ue[0],ue[1],ue[2])}}for(let H=0;H<4;H++)for(let q=0;q<4;q++){const K=$(H,q),ne=$(H,q+1),ue=$(H+1,q),_e=$(H+1,q+1);P.emplaceBack(K,ne,ue),P.emplaceBack(ue,ne,_e)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(P),this._tileDebugTextBuffer=n.createVertexBuffer(k,bg.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(L,XA.members),this._tileDebugTextSegments=Yn.simpleSegment(0,0,F,32)}}class J9{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,d){const p=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},dt(this.stateChanges[n][p],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==p&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const v in this.state[n][p])d[v]||(this.deletedStates[n][p][v]=null)}else for(const v in d)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][v]===null&&delete this.deletedStates[n][p][v]}removeFeatureState(n,l,d){if(this.deletedStates[n]===null)return;const p=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&l!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][d]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(d in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][d]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,l){const d=String(l),p=dt({},(this.state[n]||{})[d],(this.stateChanges[n]||{})[d]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const v=this.deletedStates[n][l];if(v===null)return{};for(const w in v)delete p[w]}return p}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const d={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const v={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),dt(this.state[p][w],this.stateChanges[p][w]),v[w]=this.state[p][w];d[p]=v}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const v={};if(this.deletedStates[p]===null)for(const w in this.state[p])v[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else if(this.state[p][w])for(const E of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][E];v[w]=this.state[p][w]}d[p]=d[p]||{},dt(d[p],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const p in n)n[p].setFeatureState(d,l)}}class DD{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,l){const d=this.toIdx(n,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(n,l){return this.leaves[this.toIdx(n,l)]}toIdx(n,l){return l*this.size+n}}function RD(o,n,l,d){let p=0,v=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(d[w])<1e-15){if(l[w]<o[w]||l[w]>n[w])return null}else{const E=1/d[w];let k=(o[w]-l[w])*E,P=(n[w]-l[w])*E;if(k>P){const L=k;k=P,P=L}if(k>p&&(p=k),P<v&&(v=P),p>v)return null}return p}function ND(o,n,l,d,p,v,w,E,k,P,L){const F=d-o,$=p-n,H=v-l,q=w-o,K=E-n,ne=k-l,ue=L[1]*ne-L[2]*K,_e=L[2]*q-L[0]*ne,de=L[0]*K-L[1]*q,xe=F*ue+$*_e+H*de;if(Math.abs(xe)<1e-15)return null;const be=1/xe,we=P[0]-o,Ve=P[1]-n,Fe=P[2]-l,Qe=(we*ue+Ve*_e+Fe*de)*be;if(Qe<0||Qe>1)return null;const pt=Ve*H-Fe*$,We=Fe*F-we*H,st=we*$-Ve*F,ot=(L[0]*pt+L[1]*We+L[2]*st)*be;return ot<0||Qe+ot>1?null:(q*pt+K*We+ne*st)*be}function jD(o,n,l){return(o-n)/(l-n)}function LD(o,n,l,d,p,v,w,E,k){const P=1<<l,L=v-d,F=w-p,$=(o+1)/P*L+d,H=(n+0)/P*F+p,q=(n+1)/P*F+p;E[0]=(o+0)/P*L+d,E[1]=H,k[0]=$,k[1]=q}class OD{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(v){const w=Math.ceil(Math.log2(v.dim/8)),E=[];let k=Math.ceil(Math.pow(2,w));const P=1/k,L=(H,q,K,ne,ue)=>{const _e=ne?1:0,de=(H+1)*K-_e,xe=q*K,be=(q+1)*K-_e;ue[0]=H*K,ue[1]=xe,ue[2]=de,ue[3]=be};let F=new DD(k);const $=[];for(let H=0;H<k*k;H++){L(H%k,Math.floor(H/k),P,!1,$);const q=tu($[0],$[1],v),K=tu($[2],$[1],v),ne=tu($[2],$[3],v),ue=tu($[0],$[3],v);F.minimums.push(Math.min(q,K,ne,ue)),F.maximums.push(Math.max(q,K,ne,ue)),F.leaves.push(1)}for(E.push(F),k/=2;k>=1;k/=2){const H=E[E.length-1];F=new DD(k);for(let q=0;q<k*k;q++){L(q%k,Math.floor(q/k),2,!0,$);const K=H.getElevation($[0],$[1]),ne=H.getElevation($[2],$[1]),ue=H.getElevation($[2],$[3]),_e=H.getElevation($[0],$[3]),de=H.isLeaf($[0],$[1]),xe=H.isLeaf($[2],$[1]),be=H.isLeaf($[2],$[3]),we=H.isLeaf($[0],$[3]),Ve=Math.min(K.min,ne.min,ue.min,_e.min),Fe=Math.max(K.max,ne.max,ue.max,_e.max),Qe=de&&xe&&be&&we;F.maximums.push(Fe),F.minimums.push(Ve),F.leaves.push(Fe-Ve<=5&&Qe?1:0)}E.push(F)}return E}(this.dem),d=l.length-1,p=l[d];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(n,l,d,p,v,w,E=1){return RD([n,l,-100],[d,p,this.maximums[0]*E],v,w)}raycast(n,l,d,p,v,w,E=1){if(!this.nodeCount)return null;const k=this.raycastRoot(n,l,d,p,v,w,E);if(k==null)return null;const P=[],L=[],F=[],$=[],H=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;H.length>0;){const{idx:q,t:K,nodex:ne,nodey:ue,depth:_e}=H.pop();if(this.leaves[q]){LD(ne,ue,_e,n,l,d,p,F,$);const xe=1<<_e,be=(ne+0)/xe,we=(ne+1)/xe,Ve=(ue+0)/xe,Fe=(ue+1)/xe,Qe=tu(be,Ve,this.dem)*E,pt=tu(we,Ve,this.dem)*E,We=tu(we,Fe,this.dem)*E,st=tu(be,Fe,this.dem)*E,ot=ND(F[0],F[1],Qe,$[0],F[1],pt,$[0],$[1],We,v,w),ut=ND($[0],$[1],We,F[0],$[1],st,F[0],F[1],Qe,v,w),xt=Math.min(ot!==null?ot:Number.MAX_VALUE,ut!==null?ut:Number.MAX_VALUE);if(xt!==Number.MAX_VALUE)return xt;{const Xe=_g([],v,w,K);if(zD(Qe,pt,st,We,jD(Xe[0],F[0],$[0]),jD(Xe[1],F[1],$[1]))>=Xe[2])return K}continue}let de=0;for(let xe=0;xe<this._siblingOffset.length;xe++){LD((ne<<1)+this._siblingOffset[xe][0],(ue<<1)+this._siblingOffset[xe][1],_e+1,n,l,d,p,F,$),F[2]=-100,$[2]=this.maximums[this.childOffsets[q]+xe]*E;const be=RD(F,$,v,w);if(be!=null){const we=be;P[xe]=we;let Ve=!1;for(let Fe=0;Fe<de&&!Ve;Fe++)we>=P[L[Fe]]&&(L.splice(Fe,0,xe),Ve=!0);Ve||(L[de]=xe),de++}}for(let xe=0;xe<de;xe++){const be=L[xe];H.push({idx:this.childOffsets[q]+be,t:P[be],nodex:(ne<<1)+this._siblingOffset[be][0],nodey:(ue<<1)+this._siblingOffset[be][1],depth:_e+1})}}return null}_addNode(n,l,d){return this.minimums.push(n),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(n,l,d,p,v){if(n[p].isLeaf(l,d)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const w=p-1,E=n[w];let k=0,P=0;for(let L=0;L<this._siblingOffset.length;L++){const F=2*l+this._siblingOffset[L][0],$=2*d+this._siblingOffset[L][1],H=E.getElevation(F,$),q=E.isLeaf(F,$),K=this._addNode(H.min,H.max,q);q&&(k|=1<<L),P||(P=K)}for(let L=0;L<this._siblingOffset.length;L++)k&1<<L||this._construct(n,2*l+this._siblingOffset[L][0],2*d+this._siblingOffset[L][1],w,P+L)}}function zD(o,n,l,d,p,v){return Ur(Ur(o,l,v),Ur(n,d,v),p)}function tu(o,n,l){const d=l.dim,p=Re(o*d-.5,0,d-1),v=Re(n*d-.5,0,d-1),w=Math.floor(p),E=Math.floor(v),k=Math.min(w+1,d-1),P=Math.min(E+1,d-1);return zD(l.get(w,E),l.get(k,E),l.get(w,P),l.get(k,P),p-w,v-E)}const FD={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function e7(o,n,l){return(256*o*256+256*n+l)/10-1e4}function t7(o,n,l){return 256*o+n+l/256-32768}class B_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,l,d,p=!1,v=!1){if(this.uid=n,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return Ir(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const w=this.dim=l.height-2,E=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=d||"mapbox",this.borderReady=p,!p){for(let k=0;k<w;k++)E[this._idx(-1,k)]=E[this._idx(0,k)],E[this._idx(w,k)]=E[this._idx(w-1,k)],E[this._idx(k,-1)]=E[this._idx(k,0)],E[this._idx(k,w)]=E[this._idx(k,w-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(w,-1)]=E[this._idx(w-1,0)],E[this._idx(-1,w)]=E[this._idx(0,w-1)],E[this._idx(w,w)]=E[this._idx(w-1,w-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new OD(this)}get(n,l,d=!1){d&&(n=Re(n,-1,this.dim),l=Re(l,-1,this.dim));const p=4*this._idx(n,l);return(this.encoding==="terrarium"?t7:e7)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(n){return FD[n]}get unpackVector(){return FD[this.encoding]}_idx(n,l){if(n<-1||n>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(n+1)}static pack(n,l){const d=[0,0,0,0],p=B_.getUnpackVector(l);let v=Math.floor((n+p[3])/p[2]);return d[2]=v%256,v=Math.floor(v/256),d[1]=v%256,v=Math.floor(v/256),d[0]=v,d}getPixels(){return new qs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,l,d){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,v=l*this.dim+this.dim,w=d*this.dim,E=d*this.dim+this.dim;switch(l){case-1:p=v-1;break;case 1:v=p+1}switch(d){case-1:w=E-1;break;case 1:E=w+1}const k=-l*this.dim,P=-d*this.dim;for(let L=w;L<E;L++)for(let F=p;F<v;F++){const $=4*this._idx(F,L),H=4*this._idx(F+k,L+P);this.pixels[$+0]=n.pixels[H+0],this.pixels[$+1]=n.pixels[H+1],this.pixels[$+2]=n.pixels[H+2],this.pixels[$+3]=n.pixels[H+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$t(B_,"DEMData"),$t(OD,"DemMinMaxQuadTree",{omit:["dem"]});class r7{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,d){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const v={value:l,timeout:void 0};if(d!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},d)),this.data[p].push(v),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const d=n.wrapped().key,p=l===void 0?0:this.data[d].indexOf(l),v=this.data[d][p];return this.data[d].splice(p,1),v.timeout&&clearTimeout(v.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(v.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const d in this.data)for(const p of this.data[d])n(p.value)||l.push(p);for(const d of l)this.remove(d.value.tileID,d)}}class Of{constructor(n,l,d){this.func=n,this.mask=l,this.range=d}}Of.ReadOnly=!1,Of.ReadWrite=!0,Of.disabled=new Of(519,Of.ReadOnly,[0,1]);const $S=7680;class WS{constructor(n,l,d,p,v,w){this.test=n,this.ref=l,this.mask=d,this.fail=p,this.depthFail=v,this.pass=w}}WS.disabled=new WS({func:519,mask:0},0,0,$S,$S,$S);class al{constructor(n,l,d){this.blendFunction=n,this.blendColor=l,this.mask=d}}al.Replace=[1,0],al.disabled=new al(al.Replace,Wn.transparent,[!1,!1,!1,!1]),al.unblended=new al(al.Replace,Wn.transparent,[!0,!0,!0,!0]),al.alphaBlended=new al([1,771],Wn.transparent,[!0,!0,!0,!0]);const GS=1029,HS=2305;class Ia{constructor(n,l,d){this.enable=n,this.mode=l,this.frontFace=d}}Ia.disabled=new Ia(!1,GS,HS),Ia.backCCW=new Ia(!0,GS,HS),Ia.backCW=new Ia(!0,GS,2304),Ia.frontCW=new Ia(!0,1028,2304),Ia.frontCCW=new Ia(!0,1028,HS);class Wd extends ad{constructor(n,l,d){super(),this.id=n,this._onlySymbols=d,l.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new r7(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new J9,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,l){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,l)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,()=>{})}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(n),d.prepare(this.map.style.imageManager)}}getIds(){return ct(this._tiles).map(n=>n.tileID).sort(BD).map(n=>n.key)}getRenderableIds(n){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,n)&&l.push(this._tiles[d]);return n?l.sort((d,p)=>{const v=d.tileID,w=p.tileID,E=new he(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),k=new he(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-w.overscaledZ||k.y-E.y||k.x-E.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(BD).map(d=>d.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,l){const d=this._tiles[n];d&&(d.state!=="loading"&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,n,l)))}_tileLoaded(n,l,d,p){if(p)if(n.state="errored",p.status!==404)this._source.fire(new pa(p,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=fa.now(),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new Dl("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const l=this.getRenderableIds();for(let p=0;p<l.length;p++){const v=l[p];if(n.neighboringTiles&&n.neighboringTiles[v]){const w=this.getTileByID(v);d(n,w),d(w,n)}}function d(p,v){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let w=v.tileID.canonical.x-p.tileID.canonical.x;const E=v.tileID.canonical.y-p.tileID.canonical.y,k=Math.pow(2,p.tileID.canonical.z),P=v.tileID.key;w===0&&E===0||Math.abs(E)>1||(Math.abs(w)>1&&(Math.abs(w+k)===1?w+=k:Math.abs(w-k)===1&&(w-=k)),v.dem&&p.dem&&(p.dem.backfillBorder(v.dem,w,E),p.neighboringTiles&&p.neighboringTiles[P]&&(p.neighboringTiles[P].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,d,p){for(const v in this._tiles){let w=this._tiles[v];if(p[v]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)continue;let E=w.tileID;for(;w&&w.tileID.overscaledZ>l+1;){const P=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[P.key],w&&w.hasData()&&(E=P)}let k=E;for(;k.overscaledZ>l;)if(k=k.scaledTo(k.overscaledZ-1),n[k.key]){p[E.key]=E;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const d=this._loadedParentTiles[n.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=n.overscaledZ-1;d>=l;d--){const p=n.scaledTo(d),v=this._getLoadedTile(p);if(v)return v}}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,l){l=l||this._source.tileSize;const d=Math.ceil(n.width/l)+1,p=Math.ceil(n.height/l)+1,v=Math.floor(d*p*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(E)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const d={};for(const p in this._tiles){const v=this._tiles[p];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+l),d[v.tileID.key]=v}this._tiles=d;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(n,l,d){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let p;this.updateCacheSize(n,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new as(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(p=n.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(E=>this._source.hasTile(E)))):p=[];const v=this._updateRetainedTiles(p);if(UD(this._source.type)&&p.length!==0){const E={},k={},P=Object.keys(v);for(const F of P){const $=v[F],H=this._tiles[F];if(!H||H.fadeEndTime&&H.fadeEndTime<=fa.now())continue;const q=this.findLoadedParent($,Math.max($.overscaledZ-Wd.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),E[q.tileID.key]=q.tileID),k[F]=$}const L=p[p.length-1].overscaledZ;for(const F in this._tiles){const $=this._tiles[F];if(v[F]||!$.hasData())continue;let H=$.tileID;for(;H.overscaledZ>L;){H=H.scaledTo(H.overscaledZ-1);const q=this._tiles[H.key];if(q&&q.hasData()&&k[H.key]){v[F]=$.tileID;break}}}for(const F in E)v[F]||(this._coveredTiles[F]=!0,v[F]=E[F])}for(const E in v)this._tiles[E].clearFadeHold();const w=function(E,k){const P=[];for(const L in E)L in k||P.push(L);return P}(this._tiles,v);for(const E of w){const k=this._tiles[E];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const l={};if(n.length===0)return l;const d={},p=n.reduce((P,L)=>Math.min(P,L.overscaledZ),1/0),v=n[0].overscaledZ,w=Math.max(v-Wd.maxOverzooming,this._source.minzoom),E=Math.max(v+Wd.maxUnderzooming,this._source.minzoom),k={};for(const P of n){const L=this._addTile(P);l[P.key]=P,L.hasData()||p<this._source.maxzoom&&(k[P.key]=P)}this._retainLoadedChildren(k,p,E,l);for(const P of n){let L=this._tiles[P.key];if(L.hasData())continue;if(P.canonical.z>=this._source.maxzoom){const $=P.children(this._source.maxzoom)[0],H=this.getTile($);if(H&&H.hasData()){l[$.key]=$;continue}}else{const $=P.children(this._source.maxzoom);if(l[$[0].key]&&l[$[1].key]&&l[$[2].key]&&l[$[3].key])continue}let F=L.wasRequested();for(let $=P.overscaledZ-1;$>=w;--$){const H=P.scaledTo($);if(d[H.key]||(d[H.key]=!0,L=this.getTile(H),!L&&F&&(L=this._addTile(H)),L&&(l[H.key]=H,F=L.wasRequested(),L.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let d,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){d=this._loadedParentTiles[p.key];break}l.push(p.key);const v=p.scaledTo(p.overscaledZ-1);if(d=this._getLoadedTile(v),d)break;p=v}for(const v of l)this._loadedParentTiles[v]=d}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const d=!!l;if(!d){const p=this.map?this.map.painter:null;l=new VS(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))}return l?(l.uses++,this._tiles[n.key]=l,d||this._source.fire(new Dl("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const d=l.getExpiryTimeout();d&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},d))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,l,d){const p=[],v=this.transform;if(!v)return p;const w=v.projection.name==="globe",E=nl(v.center.lng);for(const k in this._tiles){const P=this._tiles[k];if(d&&P.clearQueryDebugViz(),P.holdingForFade())continue;let L;if(w){const F=P.tileID.canonical;if(F.z===0){const $=[Math.abs(Re(E,...Gg(F,-1))-E),Math.abs(Re(E,...Gg(F,1))-E)];L=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(Re(E,...Gg(F,-1))-E),Math.abs(Re(E,...Gg(F,0))-E),Math.abs(Re(E,...Gg(F,1))-E)];L=[$.indexOf(Math.min(...$))-1]}}else L=[0];for(const F of L){const $=n.containsTile(P,v,l,F);$&&p.push($)}}return p}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(d=>this._tiles[d].tileID);for(const d of l)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(UD(this._source.type))for(const n in this._tiles){const l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=fa.now())return!0}return!1}setFeatureState(n,l,d){this._state.updateState(n=n||"_geojsonTileLayer",l,d)}removeFeatureState(n,l,d){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,d)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,d){const p=this._tiles[n];p&&p.setDependencies(l,d)}reloadTilesForDependencies(n,l){for(const d in this._tiles)this._tiles[d].hasDependency(n,l)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(n,l))}_preloadTiles(n,l){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(n,l))};return void this._source.on("data",E)}const d=new Map,p=Array.isArray(n)?n:[n],v=this.map.painter.terrain,w=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const E of p){const k=E.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const P of k)d.set(P.key,P);this.usedForTerrain&&E.updateElevation(!1)}wt(Array.from(d.values()),(E,k)=>{const P=new VS(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(P,L=>{this._source.type==="raster-dem"&&P.dem&&this._backfillDEM(P),k(L,P)})},l)}}function BD(o,n){const l=Math.abs(2*o.wrap)-+(o.wrap<0),d=Math.abs(2*n.wrap)-+(n.wrap<0);return o.overscaledZ-n.overscaledZ||d-l||n.canonical.y-o.canonical.y||n.canonical.x-o.canonical.x}function UD(o){return o==="raster"||o==="image"||o==="video"||o==="custom"}function Gg(o,n){const l=1<<o.z;return[o.x/l+n,(o.x+1)/l+n]}Wd.maxOverzooming=10,Wd.maxUnderzooming=3;class U_{constructor(n,l,d){this._demTile=n,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(n,l,d){const p=d||n.findDEMTileFor(l);if(!p||!p.dem)return;const v=p.dem,w=p.tileID,E=1<<l.canonical.z-w.canonical.z;return new U_(p,p.tileSize/rr/E,[(l.canonical.x/E-w.canonical.x)*v.dim,(l.canonical.y/E-w.canonical.y)*v.dim])}tileCoordToPixel(n,l){const d=l*this._scale+this._offset[1],p=Math.floor(n*this._scale+this._offset[0]),v=Math.floor(d);return new he(p,v)}getElevationAt(n,l,d,p){const v=n*this._scale+this._offset[0],w=l*this._scale+this._offset[1],E=Math.floor(v),k=Math.floor(w),P=this._dem;return p=!!p,d?Ur(Ur(P.get(E,k,p),P.get(E,k+1,p),w-k),Ur(P.get(E+1,k,p),P.get(E+1,k+1,p),w-k),v-E):P.get(E,k,p)}getElevationAtPixel(n,l,d){return this._dem.get(n,l,!!d)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*ka(1,n)*this._dem.stride}}class VD{constructor(n,l){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Fl(rr,16,0),this.featureIndexArray=new Dd,this.promoteId=l}insert(n,l,d,p,v,w=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,p,v,w);const k=this.grid;for(let P=0;P<l.length;P++){const L=l[P],F=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const H=L[$];F[0]=Math.min(F[0],H.x),F[1]=Math.min(F[1],H.y),F[2]=Math.max(F[2],H.x),F[3]=Math.max(F[3],H.y)}F[0]<rr&&F[1]<rr&&F[2]>=0&&F[3]>=0&&k.insert(E,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new CS(new M_(this.rawTileData)).layers,this.sourceLayerCoder=new MD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,l,d,p){this.loadVTLayers();const v=n.params||{},w=hf(v.filter),E=n.tileResult,k=n.transform,P=E.bufferedTilespaceBounds,L=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,(q,K,ne,ue)=>fI(E.bufferedTilespaceGeometry,q,K,ne,ue));L.sort(n7);let F=null;k.elevation&&L.length>0&&(F=U_.create(k.elevation,this.tileID));const $={};let H;for(let q=0;q<L.length;q++){const K=L[q];if(K===H)continue;H=K;const ne=this.featureIndexArray.get(K);let ue=null;this.loadMatchingFeature($,ne,w,v.layers,v.availableImages,l,d,p,(_e,de,xe,be=0)=>(ue||(ue=Hl(_e,this.tileID.canonical,n.tileTransform)),de.queryIntersectsFeature(E,_e,xe,ue,this.z,n.transform,n.pixelPosMatrix,F,be)))}return $}loadMatchingFeature(n,l,d,p,v,w,E,k,P){const{featureIndex:L,bucketIndex:F,sourceLayerIndex:$,layoutVertexArrayOffset:H}=l,q=this.bucketLayerIDs[F];if(p&&!function(_e,de){for(let xe=0;xe<_e.length;xe++)if(de.indexOf(_e[xe])>=0)return!0;return!1}(p,q))return;const K=this.sourceLayerCoder.decode($),ne=this.vtLayers[K].feature(L);if(d.needGeometry){const _e=Bd(ne,!0);if(!d.filter(new O(this.tileID.overscaledZ),_e,this.tileID.canonical))return}else if(!d.filter(new O(this.tileID.overscaledZ),ne))return;const ue=this.getId(ne,K);for(let _e=0;_e<q.length;_e++){const de=q[_e];if(p&&p.indexOf(de)<0)continue;const xe=w[de];if(!xe)continue;let be={};ue!==void 0&&k&&(be=k.getState(xe.sourceLayer||"_geojsonTileLayer",ue));const we=dt({},E[de]);we.paint=$D(we.paint,xe.paint,ne,be,v),we.layout=$D(we.layout,xe.layout,ne,be,v);const Ve=!P||P(ne,xe,be,H);if(!Ve)continue;const Fe=new kD(ne,this.z,this.x,this.y,ue);Fe.layer=we;let Qe=n[de];Qe===void 0&&(Qe=n[de]=[]),Qe.push({featureIndex:L,feature:Fe,intersectionZ:Ve})}}lookupSymbolFeatures(n,l,d,p,v,w,E,k){const P={};this.loadVTLayers();const L=hf(v);for(const F of n)this.loadMatchingFeature(P,{bucketIndex:d,sourceLayerIndex:p,featureIndex:F,layoutVertexArrayOffset:0},L,w,E,k,l);return P}loadFeature(n){const{featureIndex:l,sourceLayerIndex:d}=n;this.loadVTLayers();const p=this.sourceLayerCoder.decode(d),v=this.vtFeatures[p];if(v[l])return v[l];const w=this.vtLayers[p].feature(l);return v[l]=w,w}hasLayer(n){for(const l of this.bucketLayerIDs)for(const d of l)if(n===d)return!0;return!1}getId(n,l){let d=n.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[l];p!=null&&(d=n.properties[p]),typeof d=="boolean"&&(d=Number(d))}return d}}function $D(o,n,l,d,p){return Ut(o,(v,w)=>{const E=n instanceof ce?n.get(w):null;return E&&E.evaluate?E.evaluate(l,d,p):E})}function n7(o,n){return n-o}$t(VD,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class WD{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.image=new ql({width:n,height:l}),this.positions={},this.uploaded=!1}getDash(n,l){const d=this.getKey(n,l);return this.positions[d]}trim(){const n=this.width,l=this.height=nr(this.nextRow);this.image.resize({width:n,height:l})}getKey(n,l){return n.join(",")+l}getDashRanges(n,l,d){const p=[];let v=n.length%2==1?-n[n.length-1]*d:0,w=n[0]*d,E=!0;p.push({left:v,right:w,isDash:E,zeroLength:n[0]===0});let k=n[0];for(let P=1;P<n.length;P++){E=!E;const L=n[P];v=k*d,k+=L,w=k*d,p.push({left:v,right:w,isDash:E,zeroLength:L===0})}return p}addRoundDash(n,l,d){const p=l/2;for(let v=-d;v<=d;v++){const w=this.width*(this.nextRow+d+v);let E=0,k=n[E];for(let P=0;P<this.width;P++){P/k.right>1&&(k=n[++E]);const L=Math.abs(P-k.left),F=Math.abs(P-k.right),$=Math.min(L,F);let H;const q=v/d*(p+1);if(k.isDash){const K=p-Math.abs(q);H=Math.sqrt($*$+K*K)}else H=p-Math.sqrt($*$+q*q);this.image.data[w+P]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n,l){for(let k=n.length-1;k>=0;--k){const P=n[k],L=n[k+1];P.zeroLength?n.splice(k,1):L&&L.isDash===P.isDash&&(L.left=P.left,n.splice(k,1))}const d=n[0],p=n[n.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const v=this.width*this.nextRow;let w=0,E=n[w];for(let k=0;k<this.width;k++){k/E.right>1&&(E=n[++w]);const P=Math.abs(k-E.left),L=Math.abs(k-E.right),F=Math.min(P,L);this.image.data[v+k]=Math.max(0,Math.min(255,(E.isDash?F:-F)+l+128))}}addDash(n,l){const d=this.getKey(n,l);if(this.positions[d])return this.positions[d];const p=l==="round",v=p?7:0,w=2*v+1;if(this.nextRow+w>this.height)return Ir("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let L=0;L<n.length;L++)n[L]<0&&(Ir("Negative value is found in line dasharray, replacing values with 0"),n[L]=0),E+=n[L];if(E!==0){const L=this.width/E,F=this.getDashRanges(n,this.width,L);p?this.addRoundDash(F,L,v):this.addRegularDash(F,l==="square"?.5*L:0)}const k=this.nextRow+v;this.nextRow+=w;const P={tl:[k,v],br:[E,0]};return this.positions[d]=P,P}}$t(WD,"LineAtlas");const GD=1*Aa;class HD{constructor(n){const l={},d=[];for(const E in n){const k=n[E],P=l[E]={};for(const L in k.glyphs){const F=k.glyphs[+L];if(!F||F.bitmap.width===0||F.bitmap.height===0)continue;const $=F.metrics.localGlyph?GD:1,H={x:0,y:0,w:F.bitmap.width+2*$,h:F.bitmap.height+2*$};d.push(H),P[L]=H}}const{w:p,h:v}=AS(d),w=new ql({width:p||1,height:v||1});for(const E in n){const k=n[E];for(const P in k.glyphs){const L=k.glyphs[+P];if(!L||L.bitmap.width===0||L.bitmap.height===0)continue;const F=l[E][P],$=L.metrics.localGlyph?GD:1;ql.copy(L.bitmap,w,{x:0,y:0},{x:F.x+$,y:F.y+$},L.bitmap)}}this.image=w,this.positions=l}}$t(HD,"GlyphAtlas");class i7{constructor(n){this.tileID=new as(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=$d(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,l,d,p,v){this.status="parsing",this.data=n,this.collisionBoxArray=new cn;const w=new MD(Object.keys(n.layers).sort()),E=new VD(this.tileID,this.promoteId);E.bucketLayerIDs=[];const k={},P=new WD(256,256),L={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:P,availableImages:d},F=l.familiesBySource[this.source];for(const be in F){const we=n.layers[be];if(!we)continue;let Ve=!1,Fe=!1;for(const We of F[be])We[0].type==="symbol"?Ve=!0:Fe=!0;if(this.isSymbolTile===!0&&!Ve||this.isSymbolTile===!1&&!Fe)continue;we.version===1&&Ir(`Vector tile source "${this.source}" layer "${be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qe=w.encode(be),pt=[];for(let We=0;We<we.length;We++){const st=we.feature(We),ot=E.getId(st,be);pt.push({feature:st,id:ot,index:We,sourceLayerIndex:Qe})}for(const We of F[be]){const st=We[0];this.isSymbolTile!==void 0&&st.type==="symbol"!==this.isSymbolTile||st.minzoom&&this.zoom<Math.floor(st.minzoom)||st.maxzoom&&this.zoom>=st.maxzoom||st.visibility!=="none"&&(qS(We,this.zoom,d),(k[st.id]=st.createBucket({index:E.bucketLayerIDs.length,layers:We,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(pt,L,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(We.map(ot=>ot.id)))}}let $,H,q,K;P.trim();const ne={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ue=()=>{if($)return v($);if(H&&q&&K){const be=new HD(H),we=new JI(q,K);for(const Ve in k){const Fe=k[Ve];Fe instanceof Qc?(qS(Fe.layers,this.zoom,d),A9(Fe,H,be.positions,q,we.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):Fe.hasPattern&&(Fe instanceof E_||Fe instanceof x_||Fe instanceof Rg)&&(qS(Fe.layers,this.zoom,d),Fe.addFeatures(L,this.tileID.canonical,we.patternPositions,d,this.tileTransform))}this.status="done",v(null,{buckets:ct(k).filter(Ve=>!Ve.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:be.image,lineAtlas:P,imageAtlas:we,glyphMap:this.returnDependencies?H:null,iconMap:this.returnDependencies?q:null,glyphPositions:this.returnDependencies?be.positions:null})}},_e=Ut(L.glyphDependencies,be=>Object.keys(be).map(Number));Object.keys(_e).length?p.send("getGlyphs",{uid:this.uid,stacks:_e},(be,we)=>{$||($=be,H=we,ue())},void 0,!1,ne):H={};const de=Object.keys(L.iconDependencies);de.length?p.send("getImages",{icons:de,source:this.source,tileID:this.tileID,type:"icons"},(be,we)=>{$||($=be,q=we,ue())},void 0,!1,ne):q={};const xe=Object.keys(L.patternDependencies);xe.length?p.send("getImages",{icons:xe,source:this.source,tileID:this.tileID,type:"patterns"},(be,we)=>{$||($=be,K=we,ue())},void 0,!1,ne):K={},ue()}}function qS(o,n,l){const d=new O(n);for(const p of o)p.recalculate(d,l)}class qD{constructor(n){this.entries={},this.scheduler=n}request(n,l,d,p){const v=this.entries[n]=this.entries[n]||{callbacks:[]};if(v.result){const[w,E]=v.result;return this.scheduler?this.scheduler.add(()=>{p(w,E)},l):p(w,E),()=>{}}return v.callbacks.push(p),v.cancel||(v.cancel=d((w,E)=>{v.result=[w,E];for(const k of v.callbacks)this.scheduler?this.scheduler.add(()=>{k(w,E)},l):k(w,E);setTimeout(()=>delete this.entries[n],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(w=>w!==p),v.callbacks.length||(v.cancel(),delete this.entries[n]))}}}function ZD(o,n,l){const d=JSON.stringify(o.request);return o.data&&(this.deduped.entries[d]={result:[null,o.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},p=>{const v=vr(o.request,(w,E,k,P)=>{w?p(w):E&&p(null,{vectorTile:l?void 0:new CS(new M_(E)),rawData:E,cacheControl:k,expires:P})});return()=>{v.cancel(),p()}},n)}const XD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ZS{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,d]=new Uint8Array(n,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=d>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=XD[15&d];if(!v)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new ZS(E,w,v,n)}constructor(n,l=64,d=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=d,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=XD.indexOf(this.ArrayType),w=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-E%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${d}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+k,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+w+E+k),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+k,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=n)}add(n,l){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=n,this.coords[this._pos++]=l,d}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return XS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,l,d,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:w,nodeSize:E}=this,k=[0,v.length-1,0],P=[];for(;k.length;){const L=k.pop()||0,F=k.pop()||0,$=k.pop()||0;if(F-$<=E){for(let ne=$;ne<=F;ne++){const ue=w[2*ne],_e=w[2*ne+1];ue>=n&&ue<=d&&_e>=l&&_e<=p&&P.push(v[ne])}continue}const H=$+F>>1,q=w[2*H],K=w[2*H+1];q>=n&&q<=d&&K>=l&&K<=p&&P.push(v[H]),(L===0?n<=q:l<=K)&&(k.push($),k.push(H-1),k.push(1-L)),(L===0?d>=q:p>=K)&&(k.push(H+1),k.push(F),k.push(1-L))}return P}within(n,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:w}=this,E=[0,p.length-1,0],k=[],P=d*d;for(;E.length;){const L=E.pop()||0,F=E.pop()||0,$=E.pop()||0;if(F-$<=w){for(let ne=$;ne<=F;ne++)KD(v[2*ne],v[2*ne+1],n,l)<=P&&k.push(p[ne]);continue}const H=$+F>>1,q=v[2*H],K=v[2*H+1];KD(q,K,n,l)<=P&&k.push(p[H]),(L===0?n-d<=q:l-d<=K)&&(E.push($),E.push(H-1),E.push(1-L)),(L===0?n+d>=q:l+d>=K)&&(E.push(H+1),E.push(F),E.push(1-L))}return k}}function XS(o,n,l,d,p,v){if(p-d<=l)return;const w=d+p>>1;YD(o,n,w,d,p,v),XS(o,n,l,d,w-1,1-v),XS(o,n,l,w+1,p,1-v)}function YD(o,n,l,d,p,v){for(;p>d;){if(p-d>600){const P=p-d+1,L=l-d+1,F=Math.log(P),$=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*$*(P-$)/P)*(L-P/2<0?-1:1);YD(o,n,l,Math.max(d,Math.floor(l-L*$/P+H)),Math.min(p,Math.floor(l+(P-L)*$/P+H)),v)}const w=n[2*l+v];let E=d,k=p;for(Hg(o,n,d,l),n[2*p+v]>w&&Hg(o,n,d,p);E<k;){for(Hg(o,n,E,k),E++,k--;n[2*E+v]<w;)E++;for(;n[2*k+v]>w;)k--}n[2*d+v]===w?Hg(o,n,d,k):(k++,Hg(o,n,k,p)),k<=l&&(d=k+1),l<=k&&(p=k-1)}}function Hg(o,n,l,d){YS(o,l,d),YS(n,2*l,2*d),YS(n,2*l+1,2*d+1)}function YS(o,n,l){const d=o[n];o[n]=o[l],o[l]=d}function KD(o,n,l,d){const p=o-l,v=n-d;return p*p+v*v}s.ARRAY_TYPE=Hs,s.AUTH_ERR_MSG=Se,s.Aabb=os,s.Actor=class{constructor(o,n,l){this.target=o,this.parent=n,this.mapId=l,this.callbacks={},this.cancelCallbacks={},lr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Oe()?o:_,this.scheduler=new K9}send(o,n,l,d,p=!1,v){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=v,this.callbacks[w]=l);const E=jt(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:o,hasCallback:!!l,targetMapId:d,mustQueue:p,sourceMapId:this.mapId,data:Wc(n,E)},E),{cancel:()=>{l&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(o){const n=o.data,l=n.id;if(l&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(n.mustQueue||Oe()){const d=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,n),d&&d.metadata||{type:"message"})}else this.processTask(l,n)}processTask(o,n){if(n.type==="<response>"){const l=this.callbacks[o];delete this.callbacks[o],l&&(n.error?l(Bl(n.error)):l(null,Bl(n.data)))}else{const l=jt(this.globalScope)?void 0:[],d=n.hasCallback?(v,w)=>{delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:v?Wc(v):null,data:Wc(w,l)},l)}:v=>{},p=Bl(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,p,d);else if(this.parent.getWorkerSource){const v=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,v[0],p.source)[v[1]](p,d)}else d(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=S_,s.Color=Wn,s.ColorMode=al,s.CullFaceMode=Ia,s.DEMData=B_,s.DataConstantProperty=Y,s.DedupedRequest=qD,s.DepthMode=Of,s.EXTENT=rr,s.Elevation=class{isDataAvailableAtPoint(o){const n=this._source();if(this.isUsingMockSource()||!n||o.y<0||o.y>1)return!1;const l=n.getSource().maxzoom,d=1<<l,p=Math.floor(o.x),v=Math.floor((o.x-p)*d),w=Math.floor(o.y*d),E=this.findDEMTileFor(new as(l,p,l,v,w));return!(!E||!E.dem)}getAtPointOrZero(o,n=0){return this.getAtPoint(o,n)||0}getAtPoint(o,n,l=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const d=this._source();if(!d||o.y<0||o.y>1)return n;const p=d.getSource().maxzoom,v=1<<p,w=Math.floor(o.x),E=o.x-w,k=new as(p,w,p,Math.floor(E*v),Math.floor(o.y*v)),P=this.findDEMTileFor(k);if(!P||!P.dem)return n;const L=P.dem,F=1<<P.tileID.canonical.z,$=(E*F-P.tileID.canonical.x)*L.dim,H=(o.y*F-P.tileID.canonical.y)*L.dim,q=Math.floor($),K=Math.floor(H);return(l?this.exaggeration():1)*Ur(Ur(L.get(q,K),L.get(q,K+1),H-K),Ur(L.get(q+1,K),L.get(q+1,K+1),H-K),$-q)}getAtTileOffset(o,n,l){const d=1<<o.canonical.z;return this.getAtPointOrZero(new Sf(o.wrap+(o.canonical.x+n/rr)/d,(o.canonical.y+l/rr)/d))}getAtTileOffsetFunc(o,n,l,d){return p=>{const v=this.getAtTileOffset(o,p.x,p.y),w=d.upVector(o.canonical,p.x,p.y);return vo(w,w,v*d.upVectorScale(o.canonical,n,l).metersToTile),w}}getForTilePoints(o,n,l,d){if(this.isUsingMockSource())return!1;const p=U_.create(this,o,d);return!!p&&(n.forEach(v=>{v[2]=this.exaggeration()*p.getElevationAt(v[0],v[1],l)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(o);if(!n||!n.dem)return null;const l=n.dem.tree,d=n.tileID,p=1<<o.canonical.z-d.canonical.z;let v=o.canonical.x/p-d.canonical.x,w=o.canonical.y/p-d.canonical.y,E=0;for(let k=0;k<o.canonical.z-d.canonical.z&&!l.leaves[E];k++){v*=2,w*=2;const P=2*Math.floor(w)+Math.floor(v);E=l.childOffsets[E]+P,v%=1,w%=1}return{min:this.exaggeration()*l.minimums[E],max:this.exaggeration()*l.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,n,l){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=pa,s.EvaluationParameters=O,s.Event=Dl,s.Evented=ad,s.FillExtrusionBucket=Rg,s.Frustum=nS,s.FrustumCorners=rS,s.GLOBE_RADIUS=tl,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=YA,s.GLOBE_ZOOM_THRESHOLD_MIN=iS,s.GlobeSharedBuffers=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const o of this._poleSegments)o.destroy();for(const o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const o of this._wireframeSegments)o.destroy()}}_fillGridMeshWithLods(o,n){const l=new ft,d=new qt,p=[],v=o+1+2,w=n[0]+1,E=n[0]+1+(1+n.length),k=(P,L,F)=>{let $=P===v-1?P-2:P===0?P:P-1;return $+=F?24575:0,[$,L]};for(let P=0;P<v;++P)l.emplaceBack(...k(P,0,!0));for(let P=0;P<w;++P)for(let L=0;L<v;++L)l.emplaceBack(...k(L,P,(L===0||L===v-1)&&!0));for(let P=0;P<n.length;++P){const L=n[P];for(let F=0;F<v;++F)l.emplaceBack(...k(F,L,!0))}for(let P=0;P<n.length;++P){const L=d.length,F=n[P]+1+2,$=new qt;for(let K=0;K<F-1;K++){const ne=K===F-2,ue=ne?v*(E-n.length+P-K):v;for(let _e=0;_e<v-1;_e++){const de=K*v+_e;K===0||ne||_e===0||_e===v-2?($.emplaceBack(de+1,de,de+ue),$.emplaceBack(de+ue,de+ue+1,de+1)):(d.emplaceBack(de+1,de,de+ue),d.emplaceBack(de+ue,de+ue+1,de+1))}}const H=Yn.simpleSegment(0,L,l.length,d.length-L);for(let K=0;K<$.uint16.length;K+=3)d.emplaceBack($.uint16[K],$.uint16[K+1],$.uint16[K+2]);const q=Yn.simpleSegment(0,L,l.length,d.length-L);p.push({withoutSkirts:H,withSkirts:q})}return{vertices:l,indices:d,segments:p}}_createGrid(o){const n=this._fillGridMeshWithLods(zd,Sg);this._gridSegments=n.segments,this._gridBuffer=o.createVertexBuffer(n.vertices,bg.members),this._gridIndexBuffer=o.createIndexBuffer(n.indices,!0)}_createPoles(o){const n=new qt;for(let p=0;p<=zd;p++)n.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=o.createIndexBuffer(n,!0);const l=new ln,d=new ln;this._poleSegments=[];for(let p=0,v=0;p<iS;p++){const w=360/(1<<p);l.emplaceBack(0,-tl,0,.5,0),d.emplaceBack(0,-tl,0,.5,1);for(let E=0;E<=zd;E++){const k=E/zd,P=Ur(0,w,k),[L,F,$]=_f(K$,Q$,P,tl);l.emplaceBack(L,F,$,k,0),d.emplaceBack(L,F,$,k,1)}this._poleSegments.push(Yn.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(l,ZA,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(d,ZA,!1)}getGridBuffers(o,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}getWirefameBuffers(o,n){if(!this._wireframeSegments){const l=new bi,d=zd,p=d+1+2,v=1;this._wireframeSegments=[];for(let w=0,E=0;w<Sg.length;w++){const k=Sg[w];for(let L=v;L<k+v;L++)for(let F=v;F<d+v;F++){const $=L*p+F;l.emplaceBack($,$+1),l.emplaceBack($,$+p),l.emplaceBack($,$+p+1)}const P=k*d*3;this._wireframeSegments.push(Yn.simpleSegment(0,E,(k+1)*p,P)),E+=P}this._wireframeIndexBuffer=o.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[n]]}},s.GlyphManager=Df,s.ImagePosition=IS,s.KDBush=ZS,s.LivePerformanceUtils=Eb,s.LngLat=un,s.LngLatBounds=Zc,s.LocalGlyphMode=NS,s.MAX_MERCATOR_LATITUDE=Ui,s.MercatorCoordinate=Sf,s.ONE_EM=Pi,s.OverscaledTileID=as,s.PerformanceMarkers=Mc,s.Point=he,s.Properties=ge,s.RGBAImage=qs,s.Ray=tS,s.RequestManager=class{constructor(o,n,l){this._transformRequestFn=o,this._customAccessToken=n,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const o=function(){let n="";for(let l=0;l<10;l++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",U,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,n){return this._transformRequestFn&&this._transformRequestFn(o,n)||{url:o}}normalizeStyleURL(o,n){if(!Ae(o))return o;const l=Mt(o);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||n)}normalizeGlyphsURL(o,n){if(!Ae(o))return o;const l=Mt(o);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||n)}normalizeSourceURL(o,n,l,d){if(!Ae(o))return o;const p=Mt(o);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),l&&p.params.push(`language=${l}`),d&&p.params.push(`worldview=${d}`),this._makeAPIURL(p,this._customAccessToken||n)}normalizeSpriteURL(o,n,l,d){const p=Mt(o);return Ae(o)?(p.path=`/styles/v1${p.path}/sprite${n}${l}`,this._makeAPIURL(p,this._customAccessToken||d)):(p.path+=`${n}${l}`,yt(p))}normalizeTileURL(o,n,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!Ae(o))return o;const d=Mt(o);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||l&&d.authority!=="raster"&&l===512?"@2x":""}${D.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${M.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${M.TILE_URL_VERSION}${d.path}`);const p=this._customAccessToken||function(v){for(const w of v){const E=w.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(d.params)||M.ACCESS_TOKEN;return M.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,p)}canonicalizeTileURL(o,n){const l=Mt(o);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return o;let d="mapbox://";l.path.match(/^\/raster\/v1\//)?d+=`raster/${l.path.replace(`/${M.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${l.path.replace(`/${M.TILE_URL_VERSION}/`,"")}`;let p=l.params;return n&&(p=p.filter(v=>!v.match(/^access_token=/))),p.length&&(d+=`?${p.join("&")}`),d}canonicalizeTileset(o,n){const l=!!n&&Ae(n),d=[];for(const p of o.tiles||[])Le(p)?d.push(this.canonicalizeTileURL(p,l)):d.push(p);return d}_makeAPIURL(o,n){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=Mt(M.API_URL);if(o.protocol=d.protocol,o.authority=d.authority,o.protocol==="http"){const p=o.params.indexOf("secure");p>=0&&o.params.splice(p,1)}if(d.path!=="/"&&(o.path=`${d.path}${o.path}`),!M.REQUIRE_ACCESS_TOKEN)return yt(o);if(n=n||M.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return o.params=o.params.filter(p=>p.indexOf("access_token")===-1),o.params.push(`access_token=${n||""}`),yt(o)}},s.ResourceType=po,s.SegmentVector=Yn,s.SourceCache=Wd,s.StencilMode=WS,s.StructArrayLayout1ui2=Gs,s.StructArrayLayout2f1f2i16=ir,s.StructArrayLayout2i4=ft,s.StructArrayLayout2ui4=bi,s.StructArrayLayout3f12=Pr,s.StructArrayLayout3ui6=qt,s.StructArrayLayout4i8=tt,s.StructArrayLayout5f20=ln,s.Texture=Wg,s.Tile=VS,s.Transitionable=X,s.Uniform1f=o_,s.Uniform1i=class extends $l{constructor(o){super(o),this.current=0}set(o,n,l){this.fetchUniformLocation(o,n)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},s.Uniform2f=class extends $l{constructor(o){super(o),this.current=[0,0]}set(o,n,l){this.fetchUniformLocation(o,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},s.Uniform3f=class extends $l{constructor(o){super(o),this.current=[0,0,0]}set(o,n,l){this.fetchUniformLocation(o,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},s.Uniform4f=IA,s.UniformColor=DA,s.UniformMatrix2f=class extends $l{constructor(o){super(o),this.current=j$}set(o,n,l){if(this.fetchUniformLocation(o,n)){for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}},s.UniformMatrix3f=class extends $l{constructor(o){super(o),this.current=N$}set(o,n,l){if(this.fetchUniformLocation(o,n)){for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},s.UniformMatrix4f=class extends $l{constructor(o){super(o),this.current=R$}set(o,n,l){if(this.fetchUniformLocation(o,n)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},s.UnwrappedTileID=zI,s.ValidationError=Ft,s.VectorTileFeature=w_,s.VectorTileWorkerSource=class extends ad{constructor(o,n,l,d,p){super(),this.actor=o,this.layerIndex=n,this.availableImages=l,this.loadVectorData=p||ZD,this.loading={},this.loaded={},this.deduped=new qD(o.scheduler),this.isSpriteLoaded=d,this.scheduler=o.scheduler}loadTile(o,n){const l=o.uid,d=o&&o.request,p=d&&d.collectResourceTiming,v=this.loading[l]=new i7(o);v.abort=this.loadVectorData(o,(w,E)=>{const k=!this.loading[l];if(delete this.loading[l],k||w||!E)return v.status="done",k||(this.loaded[l]=v),n(w);const P=E.rawData,L={};E.expires&&(L.expires=E.expires),E.cacheControl&&(L.cacheControl=E.cacheControl),v.vectorTile=E.vectorTile||new CS(new M_(P));const F=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,($,H)=>{if($||!H)return n($);const q={};if(p){const K=xm(d);K.length>0&&(q.resourceTiming=JSON.parse(JSON.stringify(K)))}n(null,dt({rawTileData:P.slice(0)},H,L,q))})};this.isSpriteLoaded?F():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(F,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):F()}),this.loaded=this.loaded||{},this.loaded[l]=v})}reloadTile(o,n){const l=this.loaded,d=o.uid,p=this;if(l&&l[d]){const v=l[d];v.showCollisionBoxes=o.showCollisionBoxes,v.enableTerrain=!!o.enableTerrain,v.projection=o.projection,v.tileTransform=$d(o.tileID.canonical,o.projection);const w=(E,k)=>{const P=v.reloadCallback;P&&(delete v.reloadCallback,v.parse(v.vectorTile,p.layerIndex,this.availableImages,p.actor,P)),n(E,k)};v.status==="parsing"?v.reloadCallback=w:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(o,n){const l=o.uid,d=this.loading[l];d&&(d.abort&&d.abort(),delete this.loading[l]),n()}removeTile(o,n){const l=this.loaded,d=o.uid;l&&l[d]&&delete l[d],n()}},s.WritingMode=_o,s.ZoomDependentExpression=Td,s.add=Gl,s.addDynamicAttributes=O_,s.adjoint=function(o,n){var l=n[0],d=n[1],p=n[2],v=n[3],w=n[4],E=n[5],k=n[6],P=n[7],L=n[8];return o[0]=w*L-E*P,o[1]=p*P-d*L,o[2]=d*E-p*w,o[3]=E*k-v*L,o[4]=l*L-p*k,o[5]=p*v-l*E,o[6]=v*P-w*k,o[7]=d*k-l*P,o[8]=l*w-d*v,o},s.asyncAll=wt,s.bezier=Je,s.bindAll=lr,s.boundsAttributes=AD,s.bufferConvexPolygon=function(o,n){const l=[];for(let d=0;d<o.length;d++){const p=Ge(d-1,-1,o.length-1),v=Ge(d+1,-1,o.length-1),w=o[d],E=o[v],k=o[p].sub(w).unit(),P=E.sub(w).unit(),L=P.angleWithSep(k.x,k.y),F=k.add(P).unit().mult(-1*n/Math.sin(L/2));l.push(w.add(F))}return l},s.cacheEntryPossiblyAdded=function(o){fo++,fo>At&&(o.getActor().send("enforceCacheSizeLimit",mn),fo=0)},s.calculateGlobeLabelMatrix=function(o,n){const{x:l,y:d}=o.point,p=tI(l,d,o.worldSize/o._pixelsPerMercatorPixel,0,0);return jd(p,p,aS(rl(n)))},s.calculateGlobeMatrix=function(o){const{x:n,y:l}=o.point,{lng:d,lat:p}=o._center;return tI(n,l,o.worldSize,d,p)},s.calculateGlobeMercatorMatrix=function(o){const n=o.pixelsPerMeter,l=n/ka(1,o.center.lat),d=Ca(new Float64Array(16));return gg(d,d,[o.point.x,o.point.y,0]),Ld(d,d,[l,l,n]),Float32Array.from(d)},s.circumferenceAtLatitude=cS,s.clamp=Re,s.clearTileCache=function(o){if(!qi())return;const n=_.caches.delete(fr);o&&n.catch(o).then(()=>o())},s.clipLine=hD,s.clone=function(o){var n=new Hs(16);return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=o[11],n[12]=o[12],n[13]=o[13],n[14]=o[14],n[15]=o[15],n},s.clone$1=Zr,s.collisionCircleLayout=r9,s.config=M,s.conjugate=function(o,n){return o[0]=-n[0],o[1]=-n[1],o[2]=-n[2],o[3]=n[3],o},s.create=function(){var o=new Hs(16);return Hs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},s.create$1=jA,s.createExpression=Uc,s.createLayout=De,s.createStyleLayer=function(o){return o.type==="custom"?new q9(o):new X9[o.type](o)},s.cross=eS,s.degToRad=Ie,s.distance=function(o,n){return Math.hypot(n[0]-o[0],n[1]-o[1],n[2]-o[2])},s.div=function(o,n,l){return o[0]=n[0]/l[0],o[1]=n[1]/l[1],o[2]=n[2]/l[2],o},s.dot=Go,s.earthRadius=Cg,s.ease=Te,s.easeCubicInOut=it,s.ecefToLatLng=function([o,n,l]){const d=Math.hypot(o,n,l),p=Math.atan2(o,l),v=.5*Math.PI-Math.acos(-n/d);return new un(rt(p),rt(v))},s.emitValidationErrors=e_,s.endsWith=dr,s.enforceCacheSizeLimit=function(o){bs(),nn&&nn.then(n=>{n.keys().then(l=>{for(let d=0;d<l.length-o;d++)n.delete(l[d])})})},s.evaluateSizeForFeature=T_,s.evaluateSizeForZoom=kf,s.evaluateVariableOffset=yD,s.evented=S,s.exactEquals=function(o,n){return o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]&&o[3]===n[3]},s.exactEquals$1=function(o,n){return o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]},s.exported=fa,s.exported$1=D,s.extend=dt,s.extend$1=ma,s.fillExtrusionHeightLift=jI,s.filterObject=Kr,s.fromMat4=function(o,n){return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[4],o[4]=n[5],o[5]=n[6],o[6]=n[8],o[7]=n[9],o[8]=n[10],o},s.fromQuat=function(o,n){var l=n[0],d=n[1],p=n[2],v=n[3],w=l+l,E=d+d,k=p+p,P=l*w,L=d*w,F=d*E,$=p*w,H=p*E,q=p*k,K=v*w,ne=v*E,ue=v*k;return o[0]=1-F-q,o[1]=L+ue,o[2]=$-ne,o[3]=0,o[4]=L-ue,o[5]=1-P-q,o[6]=H+K,o[7]=0,o[8]=$+ne,o[9]=H-K,o[10]=1-P-F,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},s.fromRotation=function(o,n){var l=Math.sin(n),d=Math.cos(n);return o[0]=d,o[1]=l,o[2]=0,o[3]=-l,o[4]=d,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},s.fromScaling=OA,s.furthestTileCorner=function(o){const n=Math.round((o+45+360)%360/90)%4;return Pt[n]},s.getAABBPointSquareDist=function(o,n,l){let d=0;for(let p=0;p<2;++p){const v=l?l[p]:0;o[p]>v&&(d+=(o[p]-v)*(o[p]-v)),n[p]<v&&(d+=(v-n[p])*(v-n[p]))}return d},s.getAnchorAlignment=RS,s.getAnchorJustification=LS,s.getBounds=function(o){let n=1/0,l=1/0,d=-1/0,p=-1/0;for(const v of o)n=Math.min(n,v.x),l=Math.min(l,v.y),d=Math.max(d,v.x),p=Math.max(p,v.y);return{min:new he(n,l),max:new he(d,p)}},s.getColumn=Qt,s.getDefaultExportFromCjs=Z,s.getGridMatrix=function(o,n,l,d){const p=n.getNorth(),v=n.getSouth(),w=n.getWest(),E=n.getEast(),k=1<<o.z,P=E-w,L=p-v,F=P/zd,$=-L/Sg[l],H=[0,F,0,$,0,0,p,w,0];if(o.z>0){const q=180/d;LA(H,H,[q/P+1,0,0,0,q/L+1,0,-.5*q/F,.5*q/$,1])}return H[2]=k,H[5]=o.x,H[8]=o.y,H},s.getImage=ye,s.getJSON=function(o,n){return ha(dt(o,{type:"json"}),n)},s.getLatitudinalLod=function(o){const n=Ui-5;o=Re(o,-n,n)/n*90;const l=Math.pow(Math.abs(Math.sin(Ie(o))),3);return Math.round(l*(Sg.length-1))},s.getMapSessionAPI=xi,s.getPerformanceMeasurement=xm,s.getProjection=TD,s.getRTLTextPluginStatus=T,s.getReferrer=Li,s.getTilePoint=function(o,{x:n,y:l},d=0){return new he(((n-d)*o.scale-o.x)*rr,(l*o.scale-o.y)*rr)},s.getTileVec3=function(o,n,l=0){return xf(((n.x-l)*o.scale-o.x)*rr,(n.y*o.scale-o.y)*rr,sI(n.z,n.y))},s.getVideo=function(o,n){const l=_.document.createElement("video");l.muted=!0,l.onloadstart=function(){n(null,l)};for(let d=0;d<o.length;d++){const p=_.document.createElement("source");sn(o[d])||(l.crossOrigin="Anonymous"),p.src=o[d],l.appendChild(p)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(o){const n=[0,0,0],l=Ca(new Float64Array(16));return jd(l,o.pixelMatrix,o.globeMatrix),Gn(n,n,l),new he(n[0],n[1])},s.globeDenormalizeECEF=aS,s.globeECEFOrigin=function(o,n){const l=[0,0,0];return Gn(l,l,Tg(rl(n.canonical))),Gn(l,l,o),l},s.globeMetersToEcef=c_,s.globeNormalizeECEF=Tg,s.globePixelsToTileUnits=function(o,n){return rr/(512*Math.pow(2,o))*d_(rl(n))},s.globePoleMatrixForTile=function(o,n,l){const d=Ca(new Float64Array(16)),p=(n/(1<<o)-.5)*Math.PI*2;return l_(d,l.globeMatrix,p),Float32Array.from(d)},s.globeTileBounds=rl,s.globeTiltAtLngLat=rI,s.globeToMercatorTransition=bf,s.globeUseCustomAntiAliasing=function(o,n,l){const d=bf(l.zoom),p=o.style.map._antialias,v=!!n.extStandardDerivatives,w=n.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return d===0&&!p&&!w&&v},s.identity=Ca,s.identity$1=GA,s.invert=Yb,s.isFullscreen=function(){return!!_.document.fullscreenElement||!!_.document.webkitFullscreenElement},s.isLngLatBehindGlobe=lS,s.isMapAuthenticated=function(o){return Xi.has(o)},s.isMapboxURL=Ae,s.isSafariWithAntialiasingBug=function(o){const n=o.navigator?o.navigator.userAgent:null;return!!jt(o)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Bi,s.latLngToECEF=wf,s.len=W$,s.length=yg,s.length$1=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},s.lngFromMercatorX=xo,s.loadVectorTile=ZD,s.makeRequest=ha,s.mapValue=function(o,n,l,d,p){return Re((o-n)/(l-n)*(p-d)+d,d,p)},s.mercatorScale=oI,s.mercatorXfromLng=nl,s.mercatorYfromLat=il,s.mercatorZfromAltitude=ka,s.mul=V$,s.mul$1=$$,s.multiply=jd,s.multiply$1=LA,s.multiply$2=BA,s.nextPowerOfTwo=nr,s.normalize=ss,s.normalize$1=G$,s.normalize$2=$A,s.number=Ur,s.ortho=function(o,n,l,d,p,v,w){var E=1/(n-l),k=1/(d-p),P=1/(v-w);return o[0]=-2*E,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*k,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*P,o[11]=0,o[12]=(n+l)*E,o[13]=(p+d)*k,o[14]=(w+v)*P,o[15]=1,o},s.pbf=GI,s.perspective=function(o,n,l,d,p){var v,w=1/Math.tan(n/2);return o[0]=w/l,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=w,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,p!=null&&p!==1/0?(o[10]=(p+d)*(v=1/(d-p)),o[14]=2*p*d*v):(o[10]=-1,o[14]=-2*d),o},s.pick=function(o,n){const l={};for(let d=0;d<n.length;d++){const p=n[d];p in o&&(l[p]=o[p])}return l},s.plugin=R,s.pointGeometry=pe,s.polesInViewport=function(o){const n=Ca(new Float64Array(16));jd(n,o.pixelMatrix,o.globeMatrix);const l=[0,Ho,0],d=[0,qo,0];return Gn(l,l,n),Gn(d,d,n),[l[0]>0&&l[0]<=o.width&&l[1]>0&&l[1]<=o.height&&!lS(o,new un(o.center.lat,90)),d[0]>0&&d[0]<=o.width&&d[1]>0&&d[1]<=o.height&&!lS(o,new un(o.center.lat,-90))]},s.polygonContainsPoint=Ud,s.polygonIntersectsBox=fI,s.polygonIntersectsPolygon=cI,s.polygonizeBounds=function(o,n,l=0,d=!0){const p=new he(l,l),v=o.sub(p),w=n.add(p),E=[v,new he(w.x,v.y),w,new he(v.x,w.y)];return d&&E.push(v.clone()),E},s.posAttributes=bg,s.postMapLoadEvent=qn,s.postPerformanceEvent=ai,s.postTurnstileEvent=Lr,s.potpack=AS,s.prevPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},s.radToDeg=rt,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(o){return o({pluginStatus:y,pluginURL:c}),S.on("pluginStateChange",o),o},s.removeAuthState=function(o){Xi.delete(o)},s.renderColorRamp=yS,s.resample=aI,s.rotateX=Kb,s.rotateX$1=HA,s.rotateY=l_,s.rotateY$1=qA,s.rotateZ=function(o,n,l){var d=Math.sin(l),p=Math.cos(l),v=n[0],w=n[1],E=n[2],k=n[3],P=n[4],L=n[5],F=n[6],$=n[7];return n!==o&&(o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=n[11],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o[0]=v*p+P*d,o[1]=w*p+L*d,o[2]=E*p+F*d,o[3]=k*p+$*d,o[4]=P*p-v*d,o[5]=L*p-w*d,o[6]=F*p-E*d,o[7]=$*p-k*d,o},s.rotateZ$1=function(o,n,l){l*=.5;var d=n[0],p=n[1],v=n[2],w=n[3],E=Math.sin(l),k=Math.cos(l);return o[0]=d*k+p*E,o[1]=p*k-d*E,o[2]=v*k+w*E,o[3]=w*k-v*E,o},s.scale=Ld,s.scale$1=VA,s.scale$2=vo,s.scaleAndAdd=_g,s.set=function(o,n,l,d){return o[0]=n,o[1]=l,o[2]=d,o},s.setCacheLimits=function(o,n){mn=o,At=n},s.setColumn=function(o,n,l){o[4*n+0]=l[0],o[4*n+1]=l[1],o[4*n+2]=l[2],o[4*n+3]=l[3]},s.setRTLTextPlugin=function(o,n,l=!1){if(y===dg||y===hg||y===fg)throw new Error("setRTLTextPlugin cannot be called multiple times.");c=fa.resolveURL(o),y=dg,Gc=n,x(),l||I()},s.smoothstep=Tt,s.spec=Ye,s.squaredLength=function(o){var n=o[0],l=o[1],d=o[2];return n*n+l*l+d*d},s.storeAuthState=function(o,n){n?Xi.add(o):Xi.delete(o)},s.sub=Ma,s.subtract=Jb,s.symbolSize=n9,s.tileAABB=function(o,n,l,d,p,v,w,E,k){if(k.name==="globe")return Y$(o,n,new S_(l,d,p));const P=$d({z:l,x:d,y:p},k);return new os([(v+P.x/P.scale)*n,n*(P.y/P.scale),w],[(v+P.x2/P.scale)*n,n*(P.y2/P.scale),E])},s.tileCornersToBounds=u_,s.tileTransform=$d,s.transformMat3=function(o,n,l){var d=n[0],p=n[1],v=n[2];return o[0]=d*l[0]+p*l[3]+v*l[6],o[1]=d*l[1]+p*l[4]+v*l[7],o[2]=d*l[2]+p*l[5]+v*l[8],o},s.transformMat4=Gn,s.transformMat4$1=Od,s.transformQuat=UA,s.transitionTileAABBinECEF=QA,s.translate=gg,s.transpose=function(o,n){if(o===n){var l=n[1],d=n[2],p=n[5];o[1]=n[3],o[2]=n[6],o[3]=l,o[5]=n[7],o[6]=d,o[7]=p}else o[0]=n[0],o[1]=n[3],o[2]=n[6],o[3]=n[1],o[4]=n[4],o[5]=n[7],o[6]=n[2],o[7]=n[5],o[8]=n[8];return o},s.triggerPluginCompletionEvent=f,s.uniqueId=Bt,s.updateGlobeVertexNormal=function(o,n,l,d,p){const v=5*n+2;o.float32[v+0]=l,o.float32[v+1]=d,o.float32[v+2]=p},s.validateCustomStyleLayer=function(o){const n=[],l=o.id;return l===void 0&&n.push({message:`layers.${l}: missing required property "id"`}),o.render===void 0&&n.push({message:`layers.${l}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&n.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),n},s.validateFilter=o=>Ws(Ad(o)),s.validateFog=o=>Ws(Kx(o)),s.validateLayer=o=>Ws(qx(o)),s.validateLight=o=>Ws(Yx(o)),s.validateSource=o=>Ws(Xx(o)),s.validateStyle=Jx,s.validateTerrain=o=>Ws(og(o)),s.values=ct,s.vectorTile=__,s.version=b,s.warnOnce=Ir,s.window=_,s.wrap=Ge}),h(["./shared"],function(s){function _(me){if(typeof me=="number"||typeof me=="boolean"||typeof me=="string"||me==null)return JSON.stringify(me);if(Array.isArray(me)){let ee="[";for(const ye of me)ee+=`${_(ye)},`;return`${ee}]`}let J="{";for(const ee of Object.keys(me).sort())J+=`${ee}:${_(me[ee])},`;return`${J}}`}function b(me){let J="";for(const ee of s.refProperties)J+=`/${_(me[ee])}`;return J}class C{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,ee){for(const Se of J)this._layerConfigs[Se.id]=Se,(this._layers[Se.id]=s.createStyleLayer(Se)).compileFilter(),this.keyCache[Se.id]&&delete this.keyCache[Se.id];for(const Se of ee)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ye=function(Se,Ae){const Le={};for(let Pe=0;Pe<Se.length;Pe++){const He=Ae&&Ae[Se[Pe].id]||b(Se[Pe]);Ae&&(Ae[Se[Pe].id]=He);let bt=Le[He];bt||(bt=Le[He]=[]),bt.push(Se[Pe])}const je=[];for(const Pe in Le)je.push(Le[Pe]);return je}(s.values(this._layerConfigs),this.keyCache);for(const Se of ye){const Ae=Se.map(Mt=>this._layers[Mt.id]),Le=Ae[0];if(Le.visibility==="none")continue;const je=Le.source||"";let Pe=this.familiesBySource[je];Pe||(Pe=this.familiesBySource[je]={});const He=Le.sourceLayer||"_geojsonTileLayer";let bt=Pe[He];bt||(bt=Pe[He]=[]),bt.push(Ae)}}}class M{loadTile(J,ee){const{uid:ye,encoding:Se,rawImageData:Ae,padding:Le,buildQuadTree:je}=J,Pe=s.window.ImageBitmap&&Ae instanceof s.window.ImageBitmap?this.getImageData(Ae,Le):Ae;ee(null,new s.DEMData(ye,Pe,Se,Le<1,je))}getImageData(J,ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(J.width,J.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=J.width,this.offscreenCanvas.height=J.height,this.offscreenCanvasContext.drawImage(J,0,0,J.width,J.height);const ye=this.offscreenCanvasContext.getImageData(-ee,-ee,J.width+2*ee,J.height+2*ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}function D(me,J){if(me.length!==0){N(me[0],J);for(var ee=1;ee<me.length;ee++)N(me[ee],!J)}}function N(me,J){for(var ee=0,ye=0,Se=0,Ae=me.length,Le=Ae-1;Se<Ae;Le=Se++){var je=(me[Se][0]-me[Le][0])*(me[Le][1]+me[Se][1]),Pe=ee+je;ye+=Math.abs(ee)>=Math.abs(je)?ee-Pe+je:je-Pe+ee,ee=Pe}ee+ye>=0!=!!J&&me.reverse()}var j=s.getDefaultExportFromCjs(function me(J,ee){var ye,Se=J&&J.type;if(Se==="FeatureCollection")for(ye=0;ye<J.features.length;ye++)me(J.features[ye],ee);else if(Se==="GeometryCollection")for(ye=0;ye<J.geometries.length;ye++)me(J.geometries[ye],ee);else if(Se==="Feature")me(J.geometry,ee);else if(Se==="Polygon")D(J.coordinates,ee);else if(Se==="MultiPolygon")for(ye=0;ye<J.coordinates.length;ye++)D(J.coordinates[ye],ee);return J});const V=s.VectorTileFeature.prototype.toGeoJSON;var B={exports:{}},z=s.pointGeometry,U=s.vectorTile.VectorTileFeature,Z=Q;function Q(me,J){this.options=J||{},this.features=me,this.length=me.length}function re(me,J){this.id=typeof me.id=="number"?me.id:void 0,this.type=me.type,this.rawGeometry=me.type===1?[me.geometry]:me.geometry,this.properties=me.tags,this.extent=J||4096}Q.prototype.feature=function(me){return new re(this.features[me],this.options.extent)},re.prototype.loadGeometry=function(){var me=this.rawGeometry;this.geometry=[];for(var J=0;J<me.length;J++){for(var ee=me[J],ye=[],Se=0;Se<ee.length;Se++)ye.push(new z(ee[Se][0],ee[Se][1]));this.geometry.push(ye)}return this.geometry},re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var me=this.geometry,J=1/0,ee=-1/0,ye=1/0,Se=-1/0,Ae=0;Ae<me.length;Ae++)for(var Le=me[Ae],je=0;je<Le.length;je++){var Pe=Le[je];J=Math.min(J,Pe.x),ee=Math.max(ee,Pe.x),ye=Math.min(ye,Pe.y),Se=Math.max(Se,Pe.y)}return[J,ye,ee,Se]},re.prototype.toGeoJSON=U.prototype.toGeoJSON;var oe=s.pbf,pe=Z;function ve(me){var J=new oe;return function(ee,ye){for(var Se in ee.layers)ye.writeMessage(3,he,ee.layers[Se])}(me,J),J.finish()}function he(me,J){var ee;J.writeVarintField(15,me.version||1),J.writeStringField(1,me.name||""),J.writeVarintField(5,me.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<me.length;ee++)ye.feature=me.feature(ee),J.writeMessage(2,Ke,ye);var Se=ye.keys;for(ee=0;ee<Se.length;ee++)J.writeStringField(3,Se[ee]);var Ae=ye.values;for(ee=0;ee<Ae.length;ee++)J.writeMessage(4,it,Ae[ee])}function Ke(me,J){var ee=me.feature;ee.id!==void 0&&J.writeVarintField(1,ee.id),J.writeMessage(2,qe,me),J.writeVarintField(3,ee.type),J.writeMessage(4,Pt,ee)}function qe(me,J){var ee=me.feature,ye=me.keys,Se=me.values,Ae=me.keycache,Le=me.valuecache;for(var je in ee.properties){var Pe=ee.properties[je],He=Ae[je];if(Pe!==null){He===void 0&&(ye.push(je),Ae[je]=He=ye.length-1),J.writeVarint(He);var bt=typeof Pe;bt!=="string"&&bt!=="boolean"&&bt!=="number"&&(Pe=JSON.stringify(Pe));var Mt=bt+":"+Pe,yt=Le[Mt];yt===void 0&&(Se.push(Pe),Le[Mt]=yt=Se.length-1),J.writeVarint(yt)}}}function Ie(me,J){return(J<<3)+(7&me)}function rt(me){return me<<1^me>>31}function Pt(me,J){for(var ee=me.loadGeometry(),ye=me.type,Se=0,Ae=0,Le=ee.length,je=0;je<Le;je++){var Pe=ee[je],He=1;ye===1&&(He=Pe.length),J.writeVarint(Ie(1,He));for(var bt=ye===3?Pe.length-1:Pe.length,Mt=0;Mt<bt;Mt++){Mt===1&&ye!==1&&J.writeVarint(Ie(2,bt-1));var yt=Pe[Mt].x-Se,xr=Pe[Mt].y-Ae;J.writeVarint(rt(yt)),J.writeVarint(rt(xr)),Se+=yt,Ae+=xr}ye===3&&J.writeVarint(Ie(7,1))}}function it(me,J){var ee=typeof me;ee==="string"?J.writeStringField(1,me):ee==="boolean"?J.writeBooleanField(7,me):ee==="number"&&(me%1!=0?J.writeDoubleField(3,me):me<0?J.writeSVarintField(6,me):J.writeVarintField(5,me))}B.exports=ve,B.exports.fromVectorTileJs=ve,B.exports.fromGeojsonVt=function(me,J){J=J||{};var ee={};for(var ye in me)ee[ye]=new pe(me[ye].features,J),ee[ye].name=ye,ee[ye].version=J.version,ee[ye].extent=J.extent;return ve({layers:ee})},B.exports.GeoJSONWrapper=pe;var Je=s.getDefaultExportFromCjs(B.exports);const Te={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},Re=Math.fround||(Tt=new Float32Array(1),me=>(Tt[0]=+me,Tt[0]));var Tt;const Ge=3,wt=5,ct=6;class dt{constructor(J){this.options=Object.assign(Object.create(Te),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){const{log:ee,minZoom:ye,maxZoom:Se}=this.options;ee&&console.time("total time");const Ae=`prepare ${J.length} points`;ee&&console.time(Ae),this.points=J;const Le=[];for(let Pe=0;Pe<J.length;Pe++){const He=J[Pe];if(!He.geometry)continue;const[bt,Mt]=He.geometry.coordinates,yt=Re(St(bt)),xr=Re(nr(Mt));Le.push(yt,xr,1/0,Pe,-1,1),this.options.reduce&&Le.push(0)}let je=this.trees[Se+1]=this._createTree(Le);ee&&console.timeEnd(Ae);for(let Pe=Se;Pe>=ye;Pe--){const He=+Date.now();je=this.trees[Pe]=this._createTree(this._cluster(je,Pe)),ee&&console.log("z%d: %d clusters in %dms",Pe,je.numItems,+Date.now()-He)}return ee&&console.timeEnd("total time"),this}getClusters(J,ee){let ye=((J[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,J[1]));let Ae=J[2]===180?180:((J[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)ye=-180,Ae=180;else if(ye>Ae){const Mt=this.getClusters([ye,Se,180,Le],ee),yt=this.getClusters([-180,Se,Ae,Le],ee);return Mt.concat(yt)}const je=this.trees[this._limitZoom(ee)],Pe=je.range(St(ye),nr(Le),St(Ae),nr(Se)),He=je.data,bt=[];for(const Mt of Pe){const yt=this.stride*Mt;bt.push(He[yt+wt]>1?tr(He,yt,this.clusterProps):this.points[He[yt+Ge]])}return bt}getChildren(J){const ee=this._getOriginId(J),ye=this._getOriginZoom(J),Se="No cluster with the specified id.",Ae=this.trees[ye];if(!Ae)throw new Error(Se);const Le=Ae.data;if(ee*this.stride>=Le.length)throw new Error(Se);const je=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Pe=Ae.within(Le[ee*this.stride],Le[ee*this.stride+1],je),He=[];for(const bt of Pe){const Mt=bt*this.stride;Le[Mt+4]===J&&He.push(Le[Mt+wt]>1?tr(Le,Mt,this.clusterProps):this.points[Le[Mt+Ge]])}if(He.length===0)throw new Error(Se);return He}getLeaves(J,ee,ye){const Se=[];return this._appendLeaves(Se,J,ee=ee||10,ye=ye||0,0),Se}getTile(J,ee,ye){const Se=this.trees[this._limitZoom(J)],Ae=Math.pow(2,J),{extent:Le,radius:je}=this.options,Pe=je/Le,He=(ye-Pe)/Ae,bt=(ye+1+Pe)/Ae,Mt={features:[]};return this._addTileFeatures(Se.range((ee-Pe)/Ae,He,(ee+1+Pe)/Ae,bt),Se.data,ee,ye,Ae,Mt),ee===0&&this._addTileFeatures(Se.range(1-Pe/Ae,He,1,bt),Se.data,Ae,ye,Ae,Mt),ee===Ae-1&&this._addTileFeatures(Se.range(0,He,Pe/Ae,bt),Se.data,-1,ye,Ae,Mt),Mt.features.length?Mt:null}getClusterExpansionZoom(J){let ee=this._getOriginZoom(J)-1;for(;ee<=this.options.maxZoom;){const ye=this.getChildren(J);if(ee++,ye.length!==1)break;J=ye[0].properties.cluster_id}return ee}_appendLeaves(J,ee,ye,Se,Ae){const Le=this.getChildren(ee);for(const je of Le){const Pe=je.properties;if(Pe&&Pe.cluster?Ae+Pe.point_count<=Se?Ae+=Pe.point_count:Ae=this._appendLeaves(J,Pe.cluster_id,ye,Se,Ae):Ae<Se?Ae++:J.push(je),J.length===ye)break}return Ae}_createTree(J){const ee=new s.KDBush(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<J.length;ye+=this.stride)ee.add(J[ye],J[ye+1]);return ee.finish(),ee.data=J,ee}_addTileFeatures(J,ee,ye,Se,Ae,Le){for(const je of J){const Pe=je*this.stride,He=ee[Pe+wt]>1;let bt,Mt,yt;if(He)bt=Bt(ee,Pe,this.clusterProps),Mt=ee[Pe],yt=ee[Pe+1];else{const _r=this.points[ee[Pe+Ge]];bt=_r.properties;const[kr,Lr]=_r.geometry.coordinates;Mt=St(kr),yt=nr(Lr)}const xr={type:1,geometry:[[Math.round(this.options.extent*(Mt*Ae-ye)),Math.round(this.options.extent*(yt*Ae-Se))]],tags:bt};let Mr;Mr=He||this.options.generateId?ee[Pe+Ge]:this.points[ee[Pe+Ge]].id,Mr!==void 0&&(xr.id=Mr),Le.features.push(xr)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,ee){const{radius:ye,extent:Se,reduce:Ae,minPoints:Le}=this.options,je=ye/(Se*Math.pow(2,ee)),Pe=J.data,He=[],bt=this.stride;for(let Mt=0;Mt<Pe.length;Mt+=bt){if(Pe[Mt+2]<=ee)continue;Pe[Mt+2]=ee;const yt=Pe[Mt],xr=Pe[Mt+1],Mr=J.within(Pe[Mt],Pe[Mt+1],je),_r=Pe[Mt+wt];let kr=_r;for(const Lr of Mr){const An=Lr*bt;Pe[An+2]>ee&&(kr+=Pe[An+wt])}if(kr>_r&&kr>=Le){let Lr,An=yt*_r,qn=xr*_r,Oi=-1;const ai=((Mt/bt|0)<<5)+(ee+1)+this.points.length;for(const zo of Mr){const xi=zo*bt;if(Pe[xi+2]<=ee)continue;Pe[xi+2]=ee;const Xi=Pe[xi+wt];An+=Pe[xi]*Xi,qn+=Pe[xi+1]*Xi,Pe[xi+4]=ai,Ae&&(Lr||(Lr=this._map(Pe,Mt,!0),Oi=this.clusterProps.length,this.clusterProps.push(Lr)),Ae(Lr,this._map(Pe,xi)))}Pe[Mt+4]=ai,He.push(An/kr,qn/kr,1/0,ai,-1,kr),Ae&&He.push(Oi)}else{for(let Lr=0;Lr<bt;Lr++)He.push(Pe[Mt+Lr]);if(kr>1)for(const Lr of Mr){const An=Lr*bt;if(!(Pe[An+2]<=ee)){Pe[An+2]=ee;for(let qn=0;qn<bt;qn++)He.push(Pe[An+qn])}}}}return He}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,ee,ye){if(J[ee+wt]>1){const Le=this.clusterProps[J[ee+ct]];return ye?Object.assign({},Le):Le}const Se=this.points[J[ee+Ge]].properties,Ae=this.options.map(Se);return ye&&Ae===Se?Object.assign({},Ae):Ae}}function tr(me,J,ee){return{type:"Feature",id:me[J+Ge],properties:Bt(me,J,ee),geometry:{type:"Point",coordinates:[(ye=me[J],360*(ye-.5)),cr(me[J+1])]}};var ye}function Bt(me,J,ee){const ye=me[J+wt],Se=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Ae=me[J+ct],Le=Ae===-1?{}:Object.assign({},ee[Ae]);return Object.assign(Le,{cluster:!0,cluster_id:me[J+Ge],point_count:ye,point_count_abbreviated:Se})}function St(me){return me/360+.5}function nr(me){const J=Math.sin(me*Math.PI/180),ee=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return ee<0?0:ee>1?1:ee}function cr(me){const J=(180-360*me)*Math.PI/180;return 360*Math.atan(Math.exp(J))/Math.PI-90}function lr(me,J,ee,ye){for(var Se,Ae=ye,Le=ee-J>>1,je=ee-J,Pe=me[J],He=me[J+1],bt=me[ee],Mt=me[ee+1],yt=J+3;yt<ee;yt+=3){var xr=dr(me[yt],me[yt+1],Pe,He,bt,Mt);if(xr>Ae)Se=yt,Ae=xr;else if(xr===Ae){var Mr=Math.abs(yt-Le);Mr<je&&(Se=yt,je=Mr)}}Ae>ye&&(Se-J>3&&lr(me,J,Se,ye),me[Se+2]=Ae,ee-Se>3&&lr(me,Se,ee,ye))}function dr(me,J,ee,ye,Se,Ae){var Le=Se-ee,je=Ae-ye;if(Le!==0||je!==0){var Pe=((me-ee)*Le+(J-ye)*je)/(Le*Le+je*je);Pe>1?(ee=Se,ye=Ae):Pe>0&&(ee+=Le*Pe,ye+=je*Pe)}return(Le=me-ee)*Le+(je=J-ye)*je}function Ut(me,J,ee,ye){var Se={id:me===void 0?null:me,type:J,geometry:ee,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ae){var Le=Ae.geometry,je=Ae.type;if(je==="Point"||je==="MultiPoint"||je==="LineString")Kr(Ae,Le);else if(je==="Polygon"||je==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)Kr(Ae,Le[Pe]);else if(je==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var He=0;He<Le[Pe].length;He++)Kr(Ae,Le[Pe][He])}(Se),Se}function Kr(me,J){for(var ee=0;ee<J.length;ee+=3)me.minX=Math.min(me.minX,J[ee]),me.minY=Math.min(me.minY,J[ee+1]),me.maxX=Math.max(me.maxX,J[ee]),me.maxY=Math.max(me.maxY,J[ee+1])}function Zr(me,J,ee,ye){if(J.geometry){var Se=J.geometry.coordinates,Ae=J.geometry.type,Le=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),je=[],Pe=J.id;if(ee.promoteId?Pe=J.properties[ee.promoteId]:ee.generateId&&(Pe=ye||0),Ae==="Point")vi(Se,je);else if(Ae==="MultiPoint")for(var He=0;He<Se.length;He++)vi(Se[He],je);else if(Ae==="LineString")Ir(Se,je,Le,!1);else if(Ae==="MultiLineString"){if(ee.lineMetrics){for(He=0;He<Se.length;He++)Ir(Se[He],je=[],Le,!1),me.push(Ut(Pe,"LineString",je,J.properties));return}Rn(Se,je,Le,!1)}else if(Ae==="Polygon")Rn(Se,je,Le,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(He=0;He<J.geometry.geometries.length;He++)Zr(me,{id:Pe,geometry:J.geometry.geometries[He],properties:J.properties},ee,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(He=0;He<Se.length;He++){var bt=[];Rn(Se[He],bt,Le,!0),je.push(bt)}}me.push(Ut(Pe,Ae,je,J.properties))}}function vi(me,J){J.push(ke(me[0])),J.push(Oe(me[1])),J.push(0)}function Ir(me,J,ee,ye){for(var Se,Ae,Le=0,je=0;je<me.length;je++){var Pe=ke(me[je][0]),He=Oe(me[je][1]);J.push(Pe),J.push(He),J.push(0),je>0&&(Le+=ye?(Se*He-Pe*Ae)/2:Math.sqrt(Math.pow(Pe-Se,2)+Math.pow(He-Ae,2))),Se=Pe,Ae=He}var bt=J.length-3;J[2]=1,lr(J,0,bt,ee),J[bt+2]=1,J.size=Math.abs(Le),J.start=0,J.end=J.size}function Rn(me,J,ee,ye){for(var Se=0;Se<me.length;Se++){var Ae=[];Ir(me[Se],Ae,ee,ye),J.push(Ae)}}function ke(me){return me/360+.5}function Oe(me){var J=Math.sin(me*Math.PI/180),ee=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return ee<0?0:ee>1?1:ee}function Ze(me,J,ee,ye,Se,Ae,Le,je){if(ye/=J,Ae>=(ee/=J)&&Le<ye)return me;if(Le<ee||Ae>=ye)return null;for(var Pe=[],He=0;He<me.length;He++){var bt=me[He],Mt=bt.geometry,yt=bt.type,xr=Se===0?bt.minX:bt.minY,Mr=Se===0?bt.maxX:bt.maxY;if(xr>=ee&&Mr<ye)Pe.push(bt);else if(!(Mr<ee||xr>=ye)){var _r=[];if(yt==="Point"||yt==="MultiPoint")Vt(Mt,_r,ee,ye,Se);else if(yt==="LineString")jt(Mt,_r,ee,ye,Se,!1,je.lineMetrics);else if(yt==="MultiLineString")Qt(Mt,_r,ee,ye,Se,!1);else if(yt==="Polygon")Qt(Mt,_r,ee,ye,Se,!0);else if(yt==="MultiPolygon")for(var kr=0;kr<Mt.length;kr++){var Lr=[];Qt(Mt[kr],Lr,ee,ye,Se,!0),Lr.length&&_r.push(Lr)}if(_r.length){if(je.lineMetrics&&yt==="LineString"){for(kr=0;kr<_r.length;kr++)Pe.push(Ut(bt.id,yt,_r[kr],bt.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(_r.length===1?(yt="LineString",_r=_r[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=_r.length===3?"Point":"MultiPoint"),Pe.push(Ut(bt.id,yt,_r,bt.tags))}}}return Pe.length?Pe:null}function Vt(me,J,ee,ye,Se){for(var Ae=0;Ae<me.length;Ae+=3){var Le=me[Ae+Se];Le>=ee&&Le<=ye&&(J.push(me[Ae]),J.push(me[Ae+1]),J.push(me[Ae+2]))}}function jt(me,J,ee,ye,Se,Ae,Le){for(var je,Pe,He=Ct(me),bt=Se===0?mn:At,Mt=me.start,yt=0;yt<me.length-3;yt+=3){var xr=me[yt],Mr=me[yt+1],_r=me[yt+2],kr=me[yt+3],Lr=me[yt+4],An=Se===0?xr:Mr,qn=Se===0?kr:Lr,Oi=!1;Le&&(je=Math.sqrt(Math.pow(xr-kr,2)+Math.pow(Mr-Lr,2))),An<ee?qn>ee&&(Pe=bt(He,xr,Mr,kr,Lr,ee),Le&&(He.start=Mt+je*Pe)):An>ye?qn<ye&&(Pe=bt(He,xr,Mr,kr,Lr,ye),Le&&(He.start=Mt+je*Pe)):fr(He,xr,Mr,_r),qn<ee&&An>=ee&&(Pe=bt(He,xr,Mr,kr,Lr,ee),Oi=!0),qn>ye&&An<=ye&&(Pe=bt(He,xr,Mr,kr,Lr,ye),Oi=!0),!Ae&&Oi&&(Le&&(He.end=Mt+je*Pe),J.push(He),He=Ct(me)),Le&&(Mt+=je)}var ai=me.length-3;xr=me[ai],Mr=me[ai+1],_r=me[ai+2],(An=Se===0?xr:Mr)>=ee&&An<=ye&&fr(He,xr,Mr,_r),ai=He.length-3,Ae&&ai>=3&&(He[ai]!==He[0]||He[ai+1]!==He[1])&&fr(He,He[0],He[1],He[2]),He.length&&J.push(He)}function Ct(me){var J=[];return J.size=me.size,J.start=me.start,J.end=me.end,J}function Qt(me,J,ee,ye,Se,Ae){for(var Le=0;Le<me.length;Le++)jt(me[Le],J,ee,ye,Se,Ae,!1)}function fr(me,J,ee,ye){me.push(J),me.push(ee),me.push(ye)}function mn(me,J,ee,ye,Se,Ae){var Le=(Ae-J)/(ye-J);return me.push(Ae),me.push(ee+(Se-ee)*Le),me.push(1),Le}function At(me,J,ee,ye,Se,Ae){var Le=(Ae-ee)/(Se-ee);return me.push(J+(ye-J)*Le),me.push(Ae),me.push(1),Le}function nn(me,J){for(var ee=[],ye=0;ye<me.length;ye++){var Se,Ae=me[ye],Le=Ae.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")Se=Mn(Ae.geometry,J);else if(Le==="MultiLineString"||Le==="Polygon"){Se=[];for(var je=0;je<Ae.geometry.length;je++)Se.push(Mn(Ae.geometry[je],J))}else if(Le==="MultiPolygon")for(Se=[],je=0;je<Ae.geometry.length;je++){for(var Pe=[],He=0;He<Ae.geometry[je].length;He++)Pe.push(Mn(Ae.geometry[je][He],J));Se.push(Pe)}ee.push(Ut(Ae.id,Le,Se,Ae.tags))}return ee}function Mn(me,J){var ee=[];ee.size=me.size,me.start!==void 0&&(ee.start=me.start,ee.end=me.end);for(var ye=0;ye<me.length;ye+=3)ee.push(me[ye]+J,me[ye+1],me[ye+2]);return ee}function qi(me,J){if(me.transformed)return me;var ee,ye,Se,Ae=1<<me.z,Le=me.x,je=me.y;for(ee=0;ee<me.features.length;ee++){var Pe=me.features[ee],He=Pe.geometry,bt=Pe.type;if(Pe.geometry=[],bt===1)for(ye=0;ye<He.length;ye+=2)Pe.geometry.push(bs(He[ye],He[ye+1],J,Ae,Le,je));else for(ye=0;ye<He.length;ye++){var Mt=[];for(Se=0;Se<He[ye].length;Se+=2)Mt.push(bs(He[ye][Se],He[ye][Se+1],J,Ae,Le,je));Pe.geometry.push(Mt)}}return me.transformed=!0,me}function bs(me,J,ee,ye,Se,Ae){return[Math.round(ee*(me*ye-Se)),Math.round(ee*(J*ye-Ae))]}function ho(me,J,ee,ye,Se){for(var Ae=J===Se.maxZoom?0:Se.tolerance/((1<<J)*Se.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:ye,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},je=0;je<me.length;je++){Le.numFeatures++,fo(Le,me[je],Ae,Se);var Pe=me[je].minX,He=me[je].minY,bt=me[je].maxX,Mt=me[je].maxY;Pe<Le.minX&&(Le.minX=Pe),He<Le.minY&&(Le.minY=He),bt>Le.maxX&&(Le.maxX=bt),Mt>Le.maxY&&(Le.maxY=Mt)}return Le}function fo(me,J,ee,ye){var Se=J.geometry,Ae=J.type,Le=[];if(Ae==="Point"||Ae==="MultiPoint")for(var je=0;je<Se.length;je+=3)Le.push(Se[je]),Le.push(Se[je+1]),me.numPoints++,me.numSimplified++;else if(Ae==="LineString")po(Le,Se,me,ee,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for(je=0;je<Se.length;je++)po(Le,Se[je],me,ee,Ae==="Polygon",je===0);else if(Ae==="MultiPolygon")for(var Pe=0;Pe<Se.length;Pe++){var He=Se[Pe];for(je=0;je<He.length;je++)po(Le,He[je],me,ee,!0,je===0)}if(Le.length){var bt=J.tags||null;if(Ae==="LineString"&&ye.lineMetrics){for(var Mt in bt={},J.tags)bt[Mt]=J.tags[Mt];bt.mapbox_clip_start=Se.start/Se.size,bt.mapbox_clip_end=Se.end/Se.size}var yt={geometry:Le,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:bt};J.id!==null&&(yt.id=J.id),me.features.push(yt)}}function po(me,J,ee,ye,Se,Ae){var Le=ye*ye;if(ye>0&&J.size<(Se?Le:ye))ee.numPoints+=J.length/3;else{for(var je=[],Pe=0;Pe<J.length;Pe+=3)(ye===0||J[Pe+2]>Le)&&(ee.numSimplified++,je.push(J[Pe]),je.push(J[Pe+1])),ee.numPoints++;Se&&function(He,bt){for(var Mt=0,yt=0,xr=He.length,Mr=xr-2;yt<xr;Mr=yt,yt+=2)Mt+=(He[yt]-He[Mr])*(He[yt+1]+He[Mr+1]);if(Mt>0===bt)for(yt=0,xr=He.length;yt<xr/2;yt+=2){var _r=He[yt],kr=He[yt+1];He[yt]=He[xr-2-yt],He[yt+1]=He[xr-1-yt],He[xr-2-yt]=_r,He[xr-1-yt]=kr}}(je,Ae),me.push(je)}}function Zi(me,J){var ee=(J=this.options=function(Se,Ae){for(var Le in Ae)Se[Le]=Ae[Le];return Se}(Object.create(this.options),J)).debug;if(ee&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");var ye=function(Se,Ae){var Le=[];if(Se.type==="FeatureCollection")for(var je=0;je<Se.features.length;je++)Zr(Le,Se.features[je],Ae,je);else Zr(Le,Se.type==="Feature"?Se:{geometry:Se},Ae);return Le}(me,J);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(Se,Ae){var Le=Ae.buffer/Ae.extent,je=Se,Pe=Ze(Se,1,-1-Le,Le,0,-1,2,Ae),He=Ze(Se,1,1-Le,2+Le,0,-1,2,Ae);return(Pe||He)&&(je=Ze(Se,1,-Le,1+Le,0,-1,2,Ae)||[],Pe&&(je=nn(Pe,1).concat(je)),He&&(je=je.concat(nn(He,-1)))),je}(ye,J),ye.length&&this.splitTile(ye,0,0,0),ee&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Li(me,J,ee){return 32*((1<<me)*ee+J)+me}function ha(me,J){const ee=me.tileID.canonical;if(!this._geoJSONIndex)return J(null,null);const ye=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!ye)return J(null,null);const Se=new class{constructor(Le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Le.length,this._features=Le}feature(Le){return new class{constructor(je){this._feature=je,this.extent=s.EXTENT,this.type=je.type,this.properties=je.tags,"id"in je&&!isNaN(je.id)&&(this.id=parseInt(je.id,10))}loadGeometry(){if(this._feature.type===1){const je=[];for(const Pe of this._feature.geometry)je.push([new s.Point(Pe[0],Pe[1])]);return je}{const je=[];for(const Pe of this._feature.geometry){const He=[];for(const bt of Pe)He.push(new s.Point(bt[0],bt[1]));je.push(He)}return je}}toGeoJSON(je,Pe,He){return V.call(this,je,Pe,He)}}(this._features[Le])}}(ye.features);let Ae=Je(Se);Ae.byteOffset===0&&Ae.byteLength===Ae.buffer.byteLength||(Ae=new Uint8Array(Ae)),J(null,{vectorTile:Se,rawData:Ae.buffer})}Zi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zi.prototype.splitTile=function(me,J,ee,ye,Se,Ae,Le){for(var je=[me,J,ee,ye],Pe=this.options,He=Pe.debug;je.length;){ye=je.pop(),ee=je.pop(),J=je.pop(),me=je.pop();var bt=1<<J,Mt=Li(J,ee,ye),yt=this.tiles[Mt];if(!yt&&(He>1&&console.time("creation"),yt=this.tiles[Mt]=ho(me,J,ee,ye,Pe),this.tileCoords.push({z:J,x:ee,y:ye}),He)){He>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,ee,ye,yt.numFeatures,yt.numPoints,yt.numSimplified),console.timeEnd("creation"));var xr="z"+J;this.stats[xr]=(this.stats[xr]||0)+1,this.total++}if(yt.source=me,Se){if(J===Pe.maxZoom||J===Se)continue;var Mr=1<<Se-J;if(ee!==Math.floor(Ae/Mr)||ye!==Math.floor(Le/Mr))continue}else if(J===Pe.indexMaxZoom||yt.numPoints<=Pe.indexMaxPoints)continue;if(yt.source=null,me.length!==0){He>1&&console.time("clipping");var _r,kr,Lr,An,qn,Oi,ai=.5*Pe.buffer/Pe.extent,zo=.5-ai,xi=.5+ai,Xi=1+ai;_r=kr=Lr=An=null,qn=Ze(me,bt,ee-ai,ee+xi,0,yt.minX,yt.maxX,Pe),Oi=Ze(me,bt,ee+zo,ee+Xi,0,yt.minX,yt.maxX,Pe),me=null,qn&&(_r=Ze(qn,bt,ye-ai,ye+xi,1,yt.minY,yt.maxY,Pe),kr=Ze(qn,bt,ye+zo,ye+Xi,1,yt.minY,yt.maxY,Pe),qn=null),Oi&&(Lr=Ze(Oi,bt,ye-ai,ye+xi,1,yt.minY,yt.maxY,Pe),An=Ze(Oi,bt,ye+zo,ye+Xi,1,yt.minY,yt.maxY,Pe),Oi=null),He>1&&console.timeEnd("clipping"),je.push(_r||[],J+1,2*ee,2*ye),je.push(kr||[],J+1,2*ee,2*ye+1),je.push(Lr||[],J+1,2*ee+1,2*ye),je.push(An||[],J+1,2*ee+1,2*ye+1)}}},Zi.prototype.getTile=function(me,J,ee){var ye=this.options,Se=ye.extent,Ae=ye.debug;if(me<0||me>24)return null;var Le=1<<me,je=Li(me,J=(J%Le+Le)%Le,ee);if(this.tiles[je])return qi(this.tiles[je],Se);Ae>1&&console.log("drilling down to z%d-%d-%d",me,J,ee);for(var Pe,He=me,bt=J,Mt=ee;!Pe&&He>0;)He--,bt=Math.floor(bt/2),Mt=Math.floor(Mt/2),Pe=this.tiles[Li(He,bt,Mt)];return Pe&&Pe.source?(Ae>1&&console.log("found parent tile z%d-%d-%d",He,bt,Mt),Ae>1&&console.time("drilling down"),this.splitTile(Pe.source,He,bt,Mt,me,J,ee),Ae>1&&console.timeEnd("drilling down"),this.tiles[je]?qi(this.tiles[je],Se):null):null};class vr extends s.VectorTileWorkerSource{constructor(J,ee,ye,Se,Ae){super(J,ee,ye,Se,ha),Ae&&(this.loadGeoJSON=Ae)}loadData(J,ee){const ye=J&&J.request,Se=ye&&ye.collectResourceTiming;this.loadGeoJSON(J,(Ae,Le)=>{if(Ae||!Le)return ee(Ae);if(typeof Le!="object")return ee(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));{j(Le,!0);try{if(J.filter){const Pe=s.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(bt=>`${bt.key}: ${bt.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(bt=>Pe.value.evaluate({zoom:0},bt))}}this._geoJSONIndex=J.cluster?new dt(function({superclusterOptions:Pe,clusterProperties:He}){if(!He||!Pe)return Pe;const bt={},Mt={},yt={accumulated:null,zoom:0},xr={properties:null},Mr=Object.keys(He);for(const _r of Mr){const[kr,Lr]=He[_r],An=s.createExpression(Lr),qn=s.createExpression(typeof kr=="string"?[kr,["accumulated"],["get",_r]]:kr);bt[_r]=An.value,Mt[_r]=qn.value}return Pe.map=_r=>{xr.properties=_r;const kr={};for(const Lr of Mr)kr[Lr]=bt[Lr].evaluate(yt,xr);return kr},Pe.reduce=(_r,kr)=>{xr.properties=kr;for(const Lr of Mr)yt.accumulated=_r[Lr],_r[Lr]=Mt[Lr].evaluate(yt,xr)},Pe}(J)).load(Le.features):function(Pe,He){return new Zi(Pe,He)}(Le,J.geojsonVtOptions)}catch(Pe){return ee(Pe)}this.loaded={};const je={};if(Se){const Pe=s.getPerformanceMeasurement(ye);Pe&&(je.resourceTiming={},je.resourceTiming[J.source]=JSON.parse(JSON.stringify(Pe)))}ee(null,je)}})}reloadTile(J,ee){const ye=this.loaded;return ye&&ye[J.uid]?super.reloadTile(J,ee):this.loadTile(J,ee)}loadGeoJSON(J,ee){if(J.request)s.getJSON(J.request,ee);else{if(typeof J.data!="string")return ee(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`));try{return ee(null,JSON.parse(J.data))}catch{return ee(new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(J,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(J.clusterId))}catch(ye){ee(ye)}}getClusterChildren(J,ee){try{ee(null,this._geoJSONIndex.getChildren(J.clusterId))}catch(ye){ee(ye)}}getClusterLeaves(J,ee){try{ee(null,this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset))}catch(ye){ee(ye)}}}class sn{constructor(J){this.self=J,this.actor=new s.Actor(J,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:vr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,ye)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=ye},this.self.registerRTLTextPlugin=ee=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ee.applyArabicShaping,s.plugin.processBidirectionalText=ee.processBidirectionalText,s.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}clearCaches(J,ee,ye){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],ye()}checkIfReady(J,ee,ye){ye()}setReferrer(J,ee){this.referrer=ee}spriteLoaded(J,ee){this.isSpriteLoaded[J]=ee;for(const ye in this.workerSources[J]){const Se=this.workerSources[J][ye];for(const Ae in Se)Se[Ae]instanceof s.VectorTileWorkerSource&&(Se[Ae].isSpriteLoaded=ee,Se[Ae].fire(new s.Event("isSpriteLoaded")))}}setImages(J,ee,ye){this.availableImages[J]=ee;for(const Se in this.workerSources[J]){const Ae=this.workerSources[J][Se];for(const Le in Ae)Ae[Le].availableImages=ee}ye()}enableTerrain(J,ee,ye){this.terrain=ee,ye()}setProjection(J,ee){this.projections[J]=s.getProjection(ee)}setLayers(J,ee,ye){this.getLayerIndex(J).replace(ee),ye()}updateLayers(J,ee,ye){this.getLayerIndex(J).update(ee.layers,ee.removedIds),ye()}loadTile(J,ee,ye){const Se=this.enableTerrain?s.extend({enableTerrain:this.terrain},ee):ee;Se.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,ee.type,ee.source).loadTile(Se,ye)}loadDEMTile(J,ee,ye){const Se=this.enableTerrain?s.extend({buildQuadTree:this.terrain},ee):ee;this.getDEMWorkerSource(J,ee.source).loadTile(Se,ye)}reloadTile(J,ee,ye){const Se=this.enableTerrain?s.extend({enableTerrain:this.terrain},ee):ee;Se.projection=this.projections[J]||this.defaultProjection,this.getWorkerSource(J,ee.type,ee.source).reloadTile(Se,ye)}abortTile(J,ee,ye){this.getWorkerSource(J,ee.type,ee.source).abortTile(ee,ye)}removeTile(J,ee,ye){this.getWorkerSource(J,ee.type,ee.source).removeTile(ee,ye)}removeSource(J,ee,ye){if(!this.workerSources[J]||!this.workerSources[J][ee.type]||!this.workerSources[J][ee.type][ee.source])return;const Se=this.workerSources[J][ee.type][ee.source];delete this.workerSources[J][ee.type][ee.source],Se.removeSource!==void 0?Se.removeSource(ee,ye):ye()}loadWorkerSource(J,ee,ye){try{this.self.importScripts(ee.url),ye()}catch(Se){ye(Se.toString())}}syncRTLPluginState(J,ee,ye){try{s.plugin.setState(ee);const Se=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Se!=null){this.self.importScripts(Se);const Ae=s.plugin.isParsed();ye(Ae?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Se}`),Ae)}}catch(Se){ye(Se.toString())}}getAvailableImages(J){let ee=this.availableImages[J];return ee||(ee=[]),ee}getLayerIndex(J){let ee=this.layerIndexes[J];return ee||(ee=this.layerIndexes[J]=new C),ee}getWorkerSource(J,ee,ye){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][ee]||(this.workerSources[J][ee]={}),!this.workerSources[J][ee][ye]){const Se={send:(Ae,Le,je,Pe,He,bt)=>{this.actor.send(Ae,Le,je,J,He,bt)},scheduler:this.actor.scheduler};this.workerSources[J][ee][ye]=new this.workerSourceTypes[ee](Se,this.getLayerIndex(J),this.getAvailableImages(J),this.isSpriteLoaded[J])}return this.workerSources[J][ee][ye]}getDEMWorkerSource(J,ee){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][ee]||(this.demWorkerSources[J][ee]=new M),this.demWorkerSources[J][ee]}enforceCacheSizeLimit(J,ee){s.enforceCacheSizeLimit(ee)}getWorkerPerformanceMetrics(J,ee,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new sn(self)),sn}),h(["./shared"],function(s){function _(y,c){if(Array.isArray(y)){if(!Array.isArray(c)||y.length!==c.length)return!1;for(let f=0;f<y.length;f++)if(!_(y[f],c[f]))return!1;return!0}if(typeof y=="object"&&y!==null&&c!==null){if(typeof c!="object"||Object.keys(y).length!==Object.keys(c).length)return!1;for(const f in y)if(!_(y[f],c[f]))return!1;return!0}return y===c}var b=C;function C(y){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,S,T=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(T);try{S=new Worker(I),x=!0}catch{x=!1}return S&&S.terminate(),URL.revokeObjectURL(I),x}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var x=document.createElement("canvas");x.width=x.height=1;var S=x.getContext("2d");if(!S)return!1;var T=S.getImageData(0,0,1,1);return T&&T.width===x.width}()?(M[f=c&&c.failIfMajorPerformanceCaveat]===void 0&&(M[f]=function(x){var S,T=function(I){var R=document.createElement("canvas"),O=Object.create(C.webGLContextAttributes);return O.failIfMajorPerformanceCaveat=I,R.getContext("webgl",O)||R.getContext("experimental-webgl",O)}(x);if(!T)return!1;try{S=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!S||T.isContextLost())&&(T.shaderSource(S,"void main() {}"),T.compileShader(S),T.getShaderParameter(S,T.COMPILE_STATUS)===!0)}(f)),M[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(y)}var M={};function D(y,c,f){const x=s.window.document.createElement(y);return c!==void 0&&(x.className=c),f&&f.appendChild(x),x}function N(y,c,f){const x=s.window.document.createElementNS("http://www.w3.org/2000/svg",y);for(const S of Object.keys(c))x.setAttributeNS(null,S,c[S]);return f&&f.appendChild(x),x}C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const j=s.window.document&&s.window.document.documentElement.style,V=j&&j.userSelect!==void 0?"userSelect":"WebkitUserSelect";let B;function z(){j&&V&&(B=j[V],j[V]="none")}function U(){j&&V&&(j[V]=B)}function Z(y){y.preventDefault(),y.stopPropagation(),s.window.removeEventListener("click",Z,!0)}function Q(){s.window.addEventListener("click",Z,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Z,!0)},0)}function re(y,c){const f=y.getBoundingClientRect();return ve(y,f,c)}function oe(y,c){const f=y.getBoundingClientRect(),x=[];for(let S=0;S<c.length;S++)x.push(ve(y,f,c[S]));return x}function pe(y){return s.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function ve(y,c,f){const x=y.offsetWidth===c.width?1:y.offsetWidth/c.width;return new s.Point((f.clientX-c.left)*x,(f.clientY-c.top)*x)}function he(y,c){var f=c[0],x=c[1],S=c[2],T=c[3],I=f*T-S*x;return I?(y[0]=T*(I=1/I),y[1]=-x*I,y[2]=-S*I,y[3]=f*I,y):null}function Ke(y){const{userImage:c}=y;return!!(c&&c.render&&c.render())&&(y.data.replace(new Uint8Array(c.data.buffer)),!0)}class qe extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:f,callback:x}of this.requestors)this._notify(f,x);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,f){this._validate(c,f)&&(this.images[c]=f)}_validate(c,f){let x=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),x=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),x=!1),this._validateContent(f.content,f)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),x=!1),x}_validateStretch(c,f){if(!c)return!0;let x=0;for(const S of c){if(S[0]<x||S[1]<S[0]||f<S[1])return!1;x=S[1]}return!0}_validateContent(c,f){return!(c&&(c.length!==4||c[0]<0||f.data.width<c[0]||c[1]<0||f.data.height<c[1]||c[2]<0||f.data.width<c[2]||c[3]<0||f.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,f){f.version=this.images[c].version+1,this.images[c]=f,this.updatedImages[c]=!0}removeImage(c){const f=this.images[c];delete this.images[c],delete this.patterns[c],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,f){let x=!0;if(!this.isLoaded())for(const S of c)this.images[S]||(x=!1);this.isLoaded()||x?this._notify(c,f):this.requestors.push({ids:c,callback:f})}_notify(c,f){const x={};for(const S of c){this.images[S]||this.fire(new s.Event("styleimagemissing",{id:S}));const T=this.images[S];T?x[S]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!!(T.userImage&&T.userImage.render)}:s.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,x)}getPixelSize(){const{width:c,height:f}=this.atlasImage;return{width:c,height:f}}getPattern(c){const f=this.patterns[c],x=this.getImage(c);if(!x)return null;if(f&&f.position.version===x.version)return f.position;if(f)f.position.version=x.version;else{const S={w:x.data.width+2,h:x.data.height+2,x:0,y:0},T=new s.ImagePosition(S,x);this.patterns[c]={bin:S,position:T}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const f=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(c,this.atlasImage,f.RGBA),this.atlasTexture&&this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const T in this.patterns)c.push(this.patterns[T].bin);const{w:f,h:x}=s.potpack(c),S=this.atlasImage;S.resize({width:f||1,height:x||1});for(const T in this.patterns){const{bin:I}=this.patterns[T],R=I.x+1,O=I.y+1,G=this.images[T].data,W=G.width,X=G.height;s.RGBAImage.copy(G,S,{x:0,y:0},{x:R,y:O},{width:W,height:X}),s.RGBAImage.copy(G,S,{x:0,y:X-1},{x:R,y:O-1},{width:W,height:1}),s.RGBAImage.copy(G,S,{x:0,y:0},{x:R,y:O+X},{width:W,height:1}),s.RGBAImage.copy(G,S,{x:W-1,y:0},{x:R-1,y:O},{width:1,height:X}),s.RGBAImage.copy(G,S,{x:0,y:0},{x:R+W,y:O},{width:1,height:X})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const f of c){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const x=this.images[f];Ke(x)&&this.updateImage(f,x)}}}const Ie=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(y,c){return function([f,x,S]){const T=s.degToRad(x+90),I=s.degToRad(S);return{x:f*Math.cos(T)*Math.sin(I),y:f*Math.sin(T)*Math.sin(I),z:f*Math.cos(I),azimuthal:x,polar:S}}(y.expression.evaluate(c))}interpolate(y,c,f){return{x:s.number(y.x,c.x,f),y:s.number(y.y,c.y,f),z:s.number(y.z,c.z,f),azimuthal:s.number(y.azimuthal,c.azimuthal,f),polar:s.number(y.polar,c.polar,f)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class rt extends s.Evented{constructor(c){super(),this._transitionable=new s.Transitionable(Ie),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,f={}){if(!this._validate(s.validateLight,c,f))for(const x in c){const S=c[x];s.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),S):this._transitionable.setValue(x,S)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,x){return(!x||x.validate!==!1)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const Pt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let it=class extends s.Evented{constructor(y,c){super(),this._transitionable=new s.Transitionable(Pt),this.set(y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(y){for(const c in y){const f=y[c];s.endsWith(c,"-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}};function Je(y,c,f,x){const S=s.smoothstep(45,65,f),[T,I]=Te(y,x),R=s.length(c);let O=1-Math.min(1,Math.exp((R-T)/(I-T)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*S*y.alpha}function Te(y,c){const f=.5/Math.tan(.5*c);return[y.range[0]+f,y.range[1]+f]}const Re=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class Tt extends s.Evented{constructor(c,f){super(),this._transitionable=new s.Transitionable(Re),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){const c=this._transform,f=c.projection.name==="globe",x=s.globeToMercatorTransition(c.zoom),S=this.properties.get("range"),T=[.5,3];return{range:f?[s.number(T[0],S[0],x),s.number(T[1],S[1],x)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,f={}){if(!this._validate(s.validateFog,c,f)){for(const x of Object.keys(s.spec.fog))c&&c[x]===void 0&&(c[x]=s.spec.fog[x].default);for(const x in c){const S=c[x];s.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),S):this._transitionable.setValue(x,S)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,c))*f.a}getOpacityAtLatLng(c,f){return this._transform.projection.supportsFog?function(x,S,T){const I=s.MercatorCoordinate.fromLngLat(S),R=T.elevation?T.elevation.getAtPointOrZero(I):0,O=[I.x,I.y,R];return s.transformMat4(O,O,T.mercatorFogMatrix),Je(x,O,T.pitch,T._fov)}(this.state,c,f):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Te(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,x){return(!x||x.validate!==!1)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Ge{constructor(c,f){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const x=this.workerPool.acquire(this.id);for(let S=0;S<x.length;S++){const T=new Ge.Actor(x[S],f,this.id);T.name=`Worker ${S}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,f,x){s.asyncAll(this.actors,(S,T)=>{S.send(c,f,T)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function wt(y,c,f){return c*(s.EXTENT/(y.tileSize*Math.pow(2,f-y.tileID.overscaledZ)))}Ge.Actor=s.Actor;class ct{constructor(c,f,x,S){this.screenBounds=c,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(c,f){let x,S;if(c instanceof s.Point||typeof c[0]=="number"){const T=s.Point.convert(c);x=[T],S=f.isPointAboveHorizon(T)}else{const T=s.Point.convert(c[0]),I=s.Point.convert(c[1]);x=[T,I],S=s.polygonizeBounds(T,I).every(R=>f.isPointAboveHorizon(R))}return new ct(x,f.getCameraPoint(),S,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(c){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const f=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(f,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<x.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?S[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(S[3]=this.cameraPoint)),s.bufferConvexPolygon(S,c)}bufferedCameraGeometryGlobe(c){const f=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(f,x,c),T=this.cameraPoint.clone();switch(3*((T.y>f.y)+(T.y>x.y))+((T.x>f.x)+(T.x>x.x))){case 0:S[0]=T,S[4]=T.clone();break;case 1:S.splice(1,0,T);break;case 2:S[1]=T;break;case 3:S.splice(4,0,T);break;case 5:S.splice(2,0,T);break;case 6:S[3]=T;break;case 7:S.splice(3,0,T);break;case 8:S[2]=T}return S}containsTile(c,f,x,S=0){const T=c.queryPadding/f._pixelsPerMercatorPixel+1,I=x?this._bufferedCameraMercator(T,f):this._bufferedScreenMercator(T,f);let R=c.tileID.wrap+(I.unwrapped?S:0);const O=I.polygon.map(ce=>s.getTilePoint(c.tileTransform,ce,R));if(!s.polygonIntersectsBox(O,0,0,s.EXTENT,s.EXTENT))return;R=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const G=this.screenGeometryMercator.polygon.map(ce=>s.getTileVec3(c.tileTransform,ce,R)),W=G.map(ce=>new s.Point(ce[0],ce[1])),X=f.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),te=s.getTileVec3(c.tileTransform,X,R),se=G.map(ce=>{const Y=s.sub(ce,ce,te);return s.normalize(Y,Y),new s.Ray(te,Y)}),le=wt(c,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:se,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(ae=s.getBounds(O),ae.min.x=s.clamp(ae.min.x,0,s.EXTENT),ae.min.y=s.clamp(ae.min.y,0,s.EXTENT),ae.max.x=s.clamp(ae.max.x,0,s.EXTENT),ae.max.y=s.clamp(ae.max.y,0,s.EXTENT),ae),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:le};var ae}_bufferedScreenMercator(c,f){const x=Bt(c);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let S;return S=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(c),f):{polygon:this.bufferedScreenGeometry(c).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[x]=S,S}}_bufferedCameraMercator(c,f){const x=Bt(c);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let S;return S=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),f):{polygon:this.bufferedCameraGeometry(c).map(T=>f.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[x]=S,S}}_projectAndResample(c,f){const x=function(T,I){const R=s.multiply([],I.pixelMatrix,I.globeMatrix),O=[0,-s.GLOBE_RADIUS,0,1],G=[0,s.GLOBE_RADIUS,0,1],W=[0,0,0,1];s.transformMat4$1(O,O,R),s.transformMat4$1(G,G,R),s.transformMat4$1(W,W,R);const X=new s.Point(O[0]/O[3],O[1]/O[3]),te=new s.Point(G[0]/G[3],G[1]/G[3]),se=s.polygonContainsPoint(T,X)&&O[3]<W[3],le=s.polygonContainsPoint(T,te)&&G[3]<W[3];if(!se&&!le)return null;const ae=function(Ce,Ne,De){for(let Ue=1;Ue<Ce.length;Ue++){const ft=tr(Ne.pointCoordinate3D(Ce[Ue-1]).x),ze=tr(Ne.pointCoordinate3D(Ce[Ue]).x);if(De<0){if(ft<ze)return{idx:Ue,t:-ft/(ze-1-ft)}}else if(ze<ft)return{idx:Ue,t:(1-ft)/(ze+1-ft)}}return null}(T,I,se?-1:1);if(!ae)return null;const{idx:ce,t:Y}=ae;let ie=ce>1?dt(T.slice(0,ce),I):[],fe=ce<T.length?dt(T.slice(ce),I):[];ie=ie.map(Ce=>new s.Point(tr(Ce.x),Ce.y)),fe=fe.map(Ce=>new s.Point(tr(Ce.x),Ce.y));const ge=[...ie];ge.length===0&&ge.push(fe[fe.length-1]);const Ee=s.number(ge[ge.length-1].y,(fe.length===0?ie[0]:fe[0]).y,Y);let Me;return Me=se?[new s.Point(0,Ee),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Ee)]:[new s.Point(1,Ee),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Ee)],ge.push(...Me),fe.length===0?ge.push(ie[0]):ge.push(...fe),{polygon:ge.map(Ce=>new s.MercatorCoordinate(Ce.x,Ce.y)),unwrapped:!1}}(c,f);if(x)return x;const S=function(T,I){let R=!1,O=-1/0,G=0;for(let X=0;X<T.length-1;X++)T[X].x>O&&(O=T[X].x,G=X);for(let X=0;X<T.length-1;X++){const te=(G+X)%(T.length-1),se=T[te],le=T[te+1];Math.abs(se.x-le.x)>.5&&(se.x<le.x?(se.x+=1,te===0&&(T[T.length-1].x+=1)):(le.x+=1,te+1===T.length-1&&(T[0].x+=1)),R=!0)}const W=s.mercatorXfromLng(I.center.lng);return R&&W<Math.abs(W-1)&&T.forEach(X=>{X.x-=1}),{polygon:T,unwrapped:R}}(dt(c,f).map(T=>new s.Point(tr(T.x),T.y)),f);return{polygon:S.polygon.map(T=>new s.MercatorCoordinate(T.x,T.y)),unwrapped:S.unwrapped}}}function dt(y,c){return s.resample(y,f=>{const x=c.pointCoordinate3D(f);f.x=x.x,f.y=x.y},1/256)}function tr(y){return y<0?1+y%1:y%1}function Bt(y){return 100*y|0}function St(y,c,f,x,S){const T=function(I,R){if(I)return S(I);if(R){y.url&&R.tiles&&y.tiles&&delete y.tiles;const O=s.pick(s.extend(R,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(O.vectorLayers=R.vector_layers,O.vectorLayerIds=O.vectorLayers.map(G=>G.id)),O.tiles=c.canonicalizeTileset(O,y.url),S(null,O)}};return y.url?s.getJSON(c.transformRequest(c.normalizeSourceURL(y.url,null,f,x),s.ResourceType.Source),T):s.exported.frame(()=>T(null,y))}class nr{constructor(c,f,x){this.bounds=s.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=x||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const f=Math.pow(2,c.z),x=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*f),S=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*f),T=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*f),I=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*f);return c.x>=x&&c.x<T&&c.y>=S&&c.y<I}}class cr{constructor(c,f,x){this.context=c;const S=c.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const lr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dr{constructor(c,f,x,S){this.length=f.length,this.attributes=x,this.itemSize=f.bytesPerElement,this.dynamicDraw=S,this.context=c;const T=c.gl;this.buffer=T.createBuffer(),c.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,f){for(let x=0;x<this.attributes.length;x++){const S=f.attributes[this.attributes[x].name];S!==void 0&&c.enableVertexAttribArray(S)}}setVertexAttribPointers(c,f,x){for(let S=0;S<this.attributes.length;S++){const T=this.attributes[S],I=f.attributes[T.name];I!==void 0&&c.vertexAttribPointer(I,T.components,c[lr[T.type]],!1,this.itemSize,T.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ut{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Kr extends Ut{getDefault(){return s.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Zr extends Ut{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class vi extends Ut{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Ir extends Ut{getDefault(){return[!0,!0,!0,!0]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Rn extends Ut{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class ke extends Ut{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Oe extends Ut{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const f=this.current;(c.func!==f.func||c.ref!==f.ref||c.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class Ze extends Ut{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Vt extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=c,this.dirty=!1}}class jt extends Ut{getDefault(){return[0,1]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ct extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=c,this.dirty=!1}}class Qt extends Ut{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class fr extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.BLEND):f.disable(f.BLEND),this.current=c,this.dirty=!1}}class mn extends Ut{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class At extends Ut{getDefault(){return s.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class nn extends Ut{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Mn extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=c,this.dirty=!1}}class qi extends Ut{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class bs extends Ut{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let ho,fo=class extends Ut{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class po extends Ut{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Zi extends Ut{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Li extends Ut{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class ha extends Ut{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class vr extends Ut{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class sn extends Ut{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class me extends Ut{getDefault(){return null}set(c){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class J extends Ut{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class ee extends Ut{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class ye extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Se extends Ut{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Ae extends Ut{constructor(c,f){super(c),this.context=c,this.parent=f}getDefault(){return null}}class Le extends Ae{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class je extends Ae{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Pe extends je{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class He{constructor(c,f,x,S){this.context=c,this.width=f,this.height=x;const T=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Le(c,T),S&&(this.depthAttachment=new je(c,T))}destroy(){const c=this.context.gl,f=this.colorAttachment.get();if(f&&c.deleteTexture(f),this.depthAttachment){const x=this.depthAttachment.get();x&&c.deleteRenderbuffer(x)}c.deleteFramebuffer(this.framebuffer)}}class bt{constructor(c,f=!1){if(this.gl=c,this.isWebGL2=f,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),f){const x=c;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(c),deleteVertexArrayOES:x.deleteVertexArray.bind(c),bindVertexArrayOES:x.bindVertexArray.bind(c)}}this.clearColor=new Kr(this),this.clearDepth=new Zr(this),this.clearStencil=new vi(this),this.colorMask=new Ir(this),this.depthMask=new Rn(this),this.stencilMask=new ke(this),this.stencilFunc=new Oe(this),this.stencilOp=new Ze(this),this.stencilTest=new Vt(this),this.depthRange=new jt(this),this.depthTest=new Ct(this),this.depthFunc=new Qt(this),this.blend=new fr(this),this.blendFunc=new mn(this),this.blendColor=new At(this),this.blendEquation=new nn(this),this.cullFace=new Mn(this),this.cullFaceSide=new qi(this),this.frontFace=new bs(this),this.program=new fo(this),this.activeTexture=new po(this),this.viewport=new Zi(this),this.bindFramebuffer=new Li(this),this.bindRenderbuffer=new ha(this),this.bindTexture=new vr(this),this.bindVertexBuffer=new sn(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new J(this),this.pixelStoreUnpack=new ee(this),this.pixelStoreUnpackPremultiplyAlpha=new ye(this),this.pixelStoreUnpackFlipY=new Se(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),f||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(f||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=f||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,f){return new cr(this,c,f)}createVertexBuffer(c,f,x){return new dr(this,c,f,x)}createRenderbuffer(c,f,x){const S=this.gl,T=S.createRenderbuffer();return this.bindRenderbuffer.set(T),S.renderbufferStorage(S.RENDERBUFFER,c,f,x),this.bindRenderbuffer.set(null),T}createFramebuffer(c,f,x){return new He(this,c,f,x)}clear({color:c,depth:f,stencil:x}){const S=this.gl;let T=0;c&&(T|=S.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(T|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),x!==void 0&&(T|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),S.clear(T)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){_(c.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Mt extends s.Evented{constructor(c,f,x,S){if(super(),this.id=c,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(f,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=St(this._options,this.map._requestManager,f,x,(S,T)=>{this._tileJSONRequest=null,this._loaded=!0,S?(f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new s.ErrorEvent(S))):T&&(s.extend(this,T),T.bounds&&(this.tileBounds=new nr(T.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(S)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(c,f){const x=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(x,s.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired")c.state==="loading"?c.reloadCallback=f:c.request=c.actor.send("reloadTile",S,T.bind(this));else if(c.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",S,T.bind(this),void 0,!0);else{const I=s.loadVectorTile.call({deduped:this._deduped},S,(R,O)=>{R||!O?T.call(this,R):(S.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},c.actor&&c.actor.send("loadTile",S,T.bind(this),void 0,!0))},!0);c.request={cancel:I}}function T(I,R){return delete c.request,c.aborted?f(null):I&&I.status!==404?f(I):(R&&R.resourceTiming&&(c.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&c.setExpiryData(R),c.loadVectorData(R,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class yt extends s.Evented{constructor(c,f,x,S){super(),this.id=c,this.dispatcher=x,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},f),s.extend(this,s.pick(f,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=St(this._options,this.map._requestManager,null,null,(f,x)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new s.ErrorEvent(f)):x&&(s.extend(this,x),x.bounds&&(this.tileBounds=new nr(x.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(x.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(f)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,f){const x=s.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);c.request=s.getImage(this.map._requestManager.transformRequest(S,s.ResourceType.Tile),(T,I,R,O)=>(delete c.request,c.aborted?(c.state="unloaded",f(null)):T?(c.state="errored",f(T)):I?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:R,expires:O}),c.setTexture(I,this.map.painter),c.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void f(null)):f(null)))}static loadTileData(c,f,x){c.setTexture(f,x)}static unloadTileData(c,f){c.texture&&f.saveTileTexture(c.texture)}abortTile(c,f){c.request&&(c.request.cancel(),delete c.request),f()}unloadTile(c,f){c.texture&&this.map.painter.saveTileTexture(c.texture),f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function xr(y,c,f,x,S,T,I,R){const O=[y,f,S,c,x,T,1,1,1],G=[I,R,1],W=s.adjoint([],O),[X,te,se]=s.transformMat3(G,G,s.transpose(W,W));return s.multiply$1(O,[X,0,0,0,te,0,0,0,se],O)}class Mr extends s.Evented{constructor(c,f,x,S){super(),this.id=c,this.dispatcher=x,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=f,this._dirty=!1}load(c,f){this._loaded=f||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(x,S)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new s.ErrorEvent(x));else if(S){const{HTMLImageElement:T}=s.window;this.image=S instanceof T?s.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const f=c.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let S=1/0,T=1/0,I=-1/0,R=-1/0;for(const X of x)S=Math.min(S,X.x),T=Math.min(T,X.y),I=Math.max(I,X.x),R=Math.max(R,X.y);const O=Math.max(I-S,R-T),G=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),W=Math.pow(2,G);return new s.CanonicalTileID(G,Math.floor((S+I)/2*W),Math.floor((T+R)/2*W))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const O in this.tiles){const G=this.tiles[O];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const f=s.tileTransform(this.tileID,this.map.transform.projection),[x,S,T,I]=this.coordinates.map(O=>{const G=f.projection.project(O[0],O[1]);return s.getTilePoint(f,G)._round()});this.perspectiveTransform=function(O,G,W,X,te,se,le,ae,ce,Y){const ie=xr(0,0,O,0,0,G,O,G),fe=xr(W,X,te,se,le,ae,ce,Y);return s.multiply$1(fe,s.adjoint(ie,ie),fe),[fe[6]/fe[8]*O/s.EXTENT,fe[7]/fe[8]*G/s.EXTENT]}(this.width,this.height,x.x,x.y,S.x,S.y,I.x,I.y,T.x,T.y);const R=this._boundsArray=new s.StructArrayLayout4i8;R.emplaceBack(x.x,x.y,0,0),R.emplaceBack(S.x,S.y,s.EXTENT,0),R.emplaceBack(I.x,I.y,0,s.EXTENT),R.emplaceBack(T.x,T.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(R,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,f=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(c,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,f){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},f(null)):(c.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const _r={vector:Mt,raster:yt,"raster-dem":class extends yt{constructor(y,c,f,x){super(y,c,f,x),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(y,c){const f=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(S,T){S&&(y.state="errored",c(S)),T&&(y.dem=T,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",c(null))}y.request=s.getImage(this.map._requestManager.transformRequest(f,s.ResourceType.Tile),(function(S,T,I,R){if(delete y.request,y.aborted)y.state="unloaded",c(null);else if(S)y.state="errored",c(S);else if(T){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:I,expires:R});const O=s.window.ImageBitmap&&T instanceof s.window.ImageBitmap&&(ho==null&&(ho=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),ho),G=1-(T.width-s.prevPowerOfTwo(T.width))/2;G<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const W=O?T:s.exported.getImageData(T,G),X={uid:y.uid,coord:y.tileID,source:this.id,rawImageData:W,encoding:this.encoding,padding:G};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",X,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const c=y.canonical,f=Math.pow(2,c.z),x=(c.x-1+f)%f,S=c.x===0?y.wrap-1:y.wrap,T=(c.x+1+f)%f,I=c.x+1===f?y.wrap+1:y.wrap,R={};return R[new s.OverscaledTileID(y.overscaledZ,S,c.z,x,c.y).key]={backfilled:!1},R[new s.OverscaledTileID(y.overscaledZ,I,c.z,T,c.y).key]={backfilled:!1},c.y>0&&(R[new s.OverscaledTileID(y.overscaledZ,S,c.z,x,c.y-1).key]={backfilled:!1},R[new s.OverscaledTileID(y.overscaledZ,y.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},R[new s.OverscaledTileID(y.overscaledZ,I,c.z,T,c.y-1).key]={backfilled:!1}),c.y+1<f&&(R[new s.OverscaledTileID(y.overscaledZ,S,c.z,x,c.y+1).key]={backfilled:!1},R[new s.OverscaledTileID(y.overscaledZ,y.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},R[new s.OverscaledTileID(y.overscaledZ,I,c.z,T,c.y+1).key]={backfilled:!1}),R}unloadTile(y){y.demTexture&&this.map.painter.saveTileTexture(y.demTexture),y.fbo&&(y.fbo.destroy(),delete y.fbo),y.dem&&delete y.dem,delete y.neighboringTiles,y.state="unloaded"}},geojson:class extends s.Evented{constructor(y,c,f,x){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(x),this._data=c.data,this._options=s.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const S=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:s.EXTENT,radius:(c.clusterRadius!==void 0?c.clusterRadius:50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}getClusterExpansionZoom(y,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id},c),this}getClusterChildren(y,c){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id},c),this}getClusterLeaves(y,c,f,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:y,limit:c,offset:f},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const y=s.extend({},this.workerOptions),c=this._data;typeof c=="string"?(y.request=this.map._requestManager.transformRequest(s.exported.resolveURL(c),s.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,y,(f,x)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new s.ErrorEvent(f));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(S.resourceTiming=x.resourceTiming[this.id]),this.fire(new s.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,c){const f=y.actor?"reloadTile":"loadTile";y.actor=this.actor,y.request=this.actor.send(f,{type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,S)=>(delete y.request,y.unloadVectorData(),y.aborted?c(null):x?c(x):(y.loadVectorData(S,this.map.painter,f==="reloadTile"),c(null))),void 0,f==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y){y.unloadVectorData(),this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Mr{constructor(y,c,f,x){super(y,c,f,x),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const c of y.urls)this.urls.push(this.map._requestManager.transformRequest(c,s.ResourceType.Source).url);s.getVideo(this.urls,(c,f)=>{this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const c=this.video.seekable;y<c.start(0)||y>c.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,c=y.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(y,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Mr,canvas:class extends Mr{constructor(y,c,f,x){super(y,c,f,x),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(T=>typeof T!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context;this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends s.Evented{constructor(y,c,f,x){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=c,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new nr(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:c,y:f,z:x}=y.canonical;return this._implementation.hasTile({x:c,y:f,z:x})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,c){const{x:f,y:x,z:S}=y.tileID.canonical,T=new s.window.AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:f,y:x,z:S},{signal:T.signal})).then((function(I){return delete y.request,y.aborted?(y.state="unloaded",c(null)):I===void 0?(y.state="errored",c(null)):I===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",c(null)):function(R){return R instanceof s.window.ImageData||R instanceof s.window.HTMLCanvasElement||R instanceof s.window.ImageBitmap||R instanceof s.window.HTMLImageElement}(I)?(this.loadTileData(y,I),y.state="loaded",void c(null)):(y.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(I=>{I.code!==20&&(y.state="errored",c(I))}),y.request.cancel=()=>T.abort()}loadTileData(y,c){yt.loadTileData(y,c,this._map.painter)}unloadTileData(y){yt.unloadTileData(y,this._map.painter)}unloadTile(y,c){if(this.unloadTileData(y),this._implementation.unloadTile){const{x:f,y:x,z:S}=y.tileID.canonical;this._implementation.unloadTile({x:f,y:x,z:S})}c()}abortTile(y,c){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},kr=function(y,c,f,x){const S=new _r[c.type](y,c,f,x);if(S.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${S.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],S),S};function Lr(y,c){const f=s.identity([]);return s.scale(f,f,[.5*y.width,.5*-y.height,1]),s.translate(f,f,[1,-1,0]),s.multiply(f,f,y.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(f)}function An(y,c,f,x,S,T,I,R=!1){const O=y.tilesIn(x,I,R);O.sort(Oi);const G=[];for(const X of O)G.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(c,f,y._state,X,S,T,Lr(y.transform,X.tile.tileID),R)});const W=function(X){const te={},se={};for(const le of X){const ae=le.queryResults,ce=le.wrappedTileID,Y=se[ce]=se[ce]||{};for(const ie in ae){const fe=ae[ie],ge=Y[ie]=Y[ie]||{},Ee=te[ie]=te[ie]||[];for(const Me of fe)ge[Me.featureIndex]||(ge[Me.featureIndex]=!0,Ee.push(Me))}}return te}(G);for(const X in W)W[X].forEach(te=>{const se=te.feature,le=se.layer;le&&le.type!=="background"&&le.type!=="sky"&&(se.source=le.source,le["source-layer"]&&(se.sourceLayer=le["source-layer"]),se.state=se.id!==void 0?y.getFeatureState(le["source-layer"],se.id):{})});return W}function qn(y,c){const f=y.getRenderableIds().map(T=>y.getTileByID(T)),x=[],S={};for(let T=0;T<f.length;T++){const I=f[T],R=I.tileID.canonical.key;S[R]||(S[R]=!0,I.querySourceFeatures(x,c))}return x}function Oi(y,c){const f=y.tileID,x=c.tileID;return f.overscaledZ-x.overscaledZ||f.canonical.y-x.canonical.y||f.wrap-x.wrap||f.canonical.x-x.canonical.x}function ai(){return Gc.workerClass!=null?new Gc.workerClass:new s.window.Worker(Gc.workerUrl)}const zo="mapboxgl_preloaded_worker_pool";class xi{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<xi.workerCount;)this.workers.push(new ai);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[zo]}numActive(){return Object.keys(this.active).length}}let Xi;function Mc(){return Xi||(Xi=new xi),Xi}function Eb(y,c){const f={};for(const x in y)x!=="ref"&&(f[x]=y[x]);return s.refProperties.forEach(x=>{x in c&&(f[x]=c[x])}),f}function yx(y){y=y.slice();const c=Object.create(null);for(let f=0;f<y.length;f++)c[y[f].id]=y[f];for(let f=0;f<y.length;f++)"ref"in y[f]&&(y[f]=Eb(y[f],c[y[f].ref]));return y}xi.workerCount=2;const Xr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function xm(y,c,f){f.push({command:Xr.addSource,args:[y,c[y]]})}function od(y,c,f){c.push({command:Xr.removeSource,args:[y]}),f[y]=!0}function _m(y,c,f,x){od(y,f,x),xm(y,c,f)}function Uh(y,c,f){let x;for(x in y[f])if(y[f].hasOwnProperty(x)&&x!=="data"&&!_(y[f][x],c[f][x]))return!1;for(x in c[f])if(c[f].hasOwnProperty(x)&&x!=="data"&&!_(y[f][x],c[f][x]))return!1;return!0}function Fo(y,c,f,x,S,T){let I;for(I in c=c||{},y=y||{})y.hasOwnProperty(I)&&(_(y[I],c[I])||f.push({command:T,args:[x,I,c[I],S]}));for(I in c)c.hasOwnProperty(I)&&!y.hasOwnProperty(I)&&(_(y[I],c[I])||f.push({command:T,args:[x,I,c[I],S]}))}function fa(y){return y.id}function wm(y,c){return y[c.id]=c,y}class bm{constructor(c,f){this.reset(c,f)}reset(c,f){this.points=c||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=s.clamp(c,0,1);let f=1,x=this._distances[f];const S=c*this.paddedLength+this.padding;for(;x<S&&f<this._distances.length;)x=this._distances[++f];const T=f-1,I=this._distances[T],R=x-I,O=R>0?(S-I)/R:0;return this.points[T].mult(1-O).add(this.points[f].mult(O))}}class Dl{constructor(c,f,x){const S=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(c/x),this.yCellCount=Math.ceil(f/x);for(let I=0;I<this.xCellCount*this.yCellCount;I++)S.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,f,x,S,T){this._forEachCell(f,x,S,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(x),this.bboxes.push(S),this.bboxes.push(T)}insertCircle(c,f,x,S){this._forEachCell(f-S,x-S,f+S,x+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(x),this.circles.push(S)}_insertBoxCell(c,f,x,S,T,I){this.boxCells[T].push(I)}_insertCircleCell(c,f,x,S,T,I){this.circleCells[T].push(I)}_query(c,f,x,S,T,I){if(x<0||c>this.width||S<0||f>this.height)return!T&&[];const R=[];if(c<=0&&f<=0&&this.width<=x&&this.height<=S){if(T)return!0;for(let O=0;O<this.boxKeys.length;O++)R.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const G=this.circles[3*O],W=this.circles[3*O+1],X=this.circles[3*O+2];R.push({key:this.circleKeys[O],x1:G-X,y1:W-X,x2:G+X,y2:W+X})}return I?R.filter(I):R}return this._forEachCell(c,f,x,S,this._queryCell,R,{hitTest:T,seenUids:{box:{},circle:{}}},I),T?R.length>0:R}_queryCircle(c,f,x,S,T){const I=c-x,R=c+x,O=f-x,G=f+x;if(R<0||I>this.width||G<0||O>this.height)return!S&&[];const W=[];return this._forEachCell(I,O,R,G,this._queryCellCircle,W,{hitTest:S,circle:{x:c,y:f,radius:x},seenUids:{box:{},circle:{}}},T),S?W.length>0:W}query(c,f,x,S,T){return this._query(c,f,x,S,!1,T)}hitTest(c,f,x,S,T){return this._query(c,f,x,S,!0,T)}hitTestCircle(c,f,x,S){return this._queryCircle(c,f,x,!0,S)}_queryCell(c,f,x,S,T,I,R,O){const G=R.seenUids,W=this.boxCells[T];if(W!==null){const te=this.bboxes;for(const se of W)if(!G.box[se]){G.box[se]=!0;const le=4*se;if(c<=te[le+2]&&f<=te[le+3]&&x>=te[le+0]&&S>=te[le+1]&&(!O||O(this.boxKeys[se]))){if(R.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[se],x1:te[le],y1:te[le+1],x2:te[le+2],y2:te[le+3]})}}}const X=this.circleCells[T];if(X!==null){const te=this.circles;for(const se of X)if(!G.circle[se]){G.circle[se]=!0;const le=3*se;if(this._circleAndRectCollide(te[le],te[le+1],te[le+2],c,f,x,S)&&(!O||O(this.circleKeys[se]))){if(R.hitTest)return I.push(!0),!0;{const ae=te[le],ce=te[le+1],Y=te[le+2];I.push({key:this.circleKeys[se],x1:ae-Y,y1:ce-Y,x2:ae+Y,y2:ce+Y})}}}}}_queryCellCircle(c,f,x,S,T,I,R,O){const G=R.circle,W=R.seenUids,X=this.boxCells[T];if(X!==null){const se=this.bboxes;for(const le of X)if(!W.box[le]){W.box[le]=!0;const ae=4*le;if(this._circleAndRectCollide(G.x,G.y,G.radius,se[ae+0],se[ae+1],se[ae+2],se[ae+3])&&(!O||O(this.boxKeys[le])))return I.push(!0),!0}}const te=this.circleCells[T];if(te!==null){const se=this.circles;for(const le of te)if(!W.circle[le]){W.circle[le]=!0;const ae=3*le;if(this._circlesCollide(se[ae],se[ae+1],se[ae+2],G.x,G.y,G.radius)&&(!O||O(this.circleKeys[le])))return I.push(!0),!0}}}_forEachCell(c,f,x,S,T,I,R,O){const G=this._convertToXCellCoord(c),W=this._convertToYCellCoord(f),X=this._convertToXCellCoord(x),te=this._convertToYCellCoord(S);for(let se=G;se<=X;se++)for(let le=W;le<=te;le++)if(T.call(this,c,f,x,S,this.xCellCount*le+se,I,R,O))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,f,x,S,T,I){const R=S-c,O=T-f,G=x+I;return G*G>R*R+O*O}_circleAndRectCollide(c,f,x,S,T,I,R){const O=(I-S)/2,G=Math.abs(c-(S+O));if(G>O+x)return!1;const W=(R-T)/2,X=Math.abs(f-(T+W));if(X>W+x)return!1;if(G<=O||X<=W)return!0;const te=G-O,se=X-W;return te*te+se*se<=x*x}}const pa={unknown:0,flipRequired:1,flipNotRequired:2},ad=Math.tan(85*Math.PI/180);function Ye(y,c,f,x,S,T,I){const R=s.create();if(f)if(T.name==="globe"){const O=s.calculateGlobeLabelMatrix(S,c);s.multiply(R,R,O)}else{const O=he([],I);R[0]=O[0],R[1]=O[1],R[4]=O[2],R[5]=O[3],x||s.rotateZ(R,R,S.angle)}else s.multiply(R,S.labelPlaneMatrix,y);return R}function ma(y,c,f,x,S,T,I){const R=Ye(y,c,f,x,S,T,I);return T.name==="globe"&&f||(R[2]=R[6]=R[10]=R[14]=0),R}function Zn(y,c,f,x,S,T,I){if(f){if(T.name==="globe"){const R=Ye(y,c,f,x,S,T,I);return s.invert(R,R),s.multiply(R,y,R),R}{const R=s.clone(y),O=s.identity([]);return O[0]=I[0],O[1]=I[1],O[4]=I[2],O[5]=I[3],s.multiply(R,R,O),x||s.rotateZ(R,R,-S.angle),R}}return S.glCoordMatrix}function _i(y,c,f,x){const S=[y,c,f,1];f?s.transformMat4$1(S,S,x):Rr(S,S,x);const T=S[3];return S[0]/=T,S[1]/=T,S[2]/=T,S}function vx(y,c){return Math.min(.5+y/c*.5,1.5)}function Bo(y,c){const f=y[0]/y[3],x=y[1]/y[3];return f>=-c[0]&&f<=c[0]&&x>=-c[1]&&x<=c[1]}function Sm(y,c,f,x,S,T,I,R,O,G){const W=f.transform,X=x?y.textSizeData:y.iconSizeData,te=s.evaluateSizeForZoom(X,f.transform.zoom),se=W.projection.name==="globe",le=[256/f.width*2+1,256/f.height*2+1],ae=x?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ae.clear();let ce=null;se&&(ce=x?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const Y=y.lineVertexArray,ie=x?y.text.placedSymbolArray:y.icon.placedSymbolArray,fe=f.transform.width/f.transform.height;let ge,Ee=!1;for(let Me=0;Me<ie.length;Me++){const Ce=ie.get(Me),{numGlyphs:Ne,writingMode:De}=Ce;if(De!==s.WritingMode.vertical||Ee||ge===s.WritingMode.horizontal||(Ee=!0),ge=De,(Ce.hidden||De===s.WritingMode.vertical)&&!Ee){mo(Ne,ae);continue}Ee=!1;const Ue=new s.Point(Ce.tileAnchorX,Ce.tileAnchorY);let{x:ft,y:ze,z:tt}=W.projection.projectTilePoint(Ue.x,Ue.y,G.canonical);if(O){const[hr,Gt,ir]=O(Ue);ft+=hr,ze+=Gt,tt+=ir}const $e=[ft,ze,tt,1];if(s.transformMat4$1($e,$e,c),!Bo($e,le)){mo(Ne,ae);continue}const ht=vx(f.transform.cameraToCenterDistance,$e[3]),Be=s.evaluateSizeForFeature(X,te,Ce),et=I?Be/ht:Be*ht,mt=_i(ft,ze,tt,S);if(mt[3]<=0){mo(Ne,ae);continue}let at={};const gt=I?null:O,Yt=zt(Ce,et,!1,R,c,S,T,y.glyphOffsetArray,Y,ae,ce,mt,Ue,at,fe,gt,W.projection,G,I);Ee=Yt.useVertical,gt&&Yt.needsFlipping&&(at={}),(Yt.notEnoughRoom||Ee||Yt.needsFlipping&&zt(Ce,et,!0,R,c,S,T,y.glyphOffsetArray,Y,ae,ce,mt,Ue,at,fe,gt,W.projection,G,I).notEnoughRoom)&&mo(Ne,ae)}x?(y.text.dynamicLayoutVertexBuffer.updateData(ae),ce&&y.text.globeExtVertexBuffer.updateData(ce)):(y.icon.dynamicLayoutVertexBuffer.updateData(ae),ce&&y.icon.globeExtVertexBuffer.updateData(ce))}function xx(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae){const{lineStartIndex:ce,glyphStartIndex:Y,segment:ie}=R,fe=Y+R.numGlyphs,ge=ce+R.lineLength,Ee=c.getoffsetX(Y),Me=c.getoffsetX(fe-1),Ce=Ss(y*Ee,f,x,S,T,I,ie,ce,ge,O,G,W,X,te,!0,se,le,ae);if(!Ce)return null;const Ne=Ss(y*Me,f,x,S,T,I,ie,ce,ge,O,G,W,X,te,!0,se,le,ae);return Ne?{first:Ce,last:Ne}:null}function kc(y,c,f,x){return y===s.WritingMode.horizontal&&Math.abs(x)>Math.abs(f)?{useVertical:!0}:y===s.WritingMode.vertical?x>0?{needsFlipping:!0}:null:c!==pa.unknown&&function(S,T){return S===0||Math.abs(T/S)>ad}(f,x)?c===pa.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function zt(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae,ce,Y,ie){const fe=c/24,ge=y.lineOffsetX*fe,Ee=y.lineOffsetY*fe,{lineStartIndex:Me,glyphStartIndex:Ce,numGlyphs:Ne,segment:De,writingMode:Ue,flipState:ft}=y,ze=Me+y.lineLength,tt=$e=>{if(W){const[mt,at,gt]=$e.up,Yt=G.length;s.updateGlobeVertexNormal(W,Yt+0,mt,at,gt),s.updateGlobeVertexNormal(W,Yt+1,mt,at,gt),s.updateGlobeVertexNormal(W,Yt+2,mt,at,gt),s.updateGlobeVertexNormal(W,Yt+3,mt,at,gt)}const[ht,Be,et]=$e.point;s.addDynamicAttributes(G,ht,Be,et,$e.angle)};if(Ne>1){const $e=xx(fe,R,ge,Ee,f,X,te,y,O,T,se,ae,!1,ce,Y,ie);if(!$e)return{notEnoughRoom:!0};if(x&&!f){let[ht,Be,et]=$e.first.point,[mt,at,gt]=$e.last.point;[ht,Be]=_i(ht,Be,et,I),[mt,at]=_i(mt,at,gt,I);const Yt=kc(Ue,ft,(mt-ht)*le,at-Be);if(y.flipState=Yt&&Yt.needsFlipping?pa.flipRequired:pa.flipNotRequired,Yt)return Yt}tt($e.first);for(let ht=Ce+1;ht<Ce+Ne-1;ht++){const Be=Ss(fe*R.getoffsetX(ht),ge,Ee,f,X,te,De,Me,ze,O,T,se,ae,!1,!1,ce,Y,ie);if(!Be)return G.length-=4*(ht-Ce),{notEnoughRoom:!0};tt(Be)}tt($e.last)}else{if(x&&!f){const ht=_i(te.x,te.y,0,S),Be=Me+De+1,et=new s.Point(O.getx(Be),O.gety(Be)),mt=_i(et.x,et.y,0,S),at=mt[3]>0?mt:Dr(te,et,ht,1,S,void 0,ce,Y.canonical),gt=kc(Ue,ft,(at[0]-ht[0])*le,at[1]-ht[1]);if(y.flipState=gt&&gt.needsFlipping?pa.flipRequired:pa.flipNotRequired,gt)return gt}const $e=Ss(fe*R.getoffsetX(Ce),ge,Ee,f,X,te,De,Me,ze,O,T,se,ae,!1,!1,ce,Y,ie);if(!$e)return{notEnoughRoom:!0};tt($e)}return{}}function jr(y,c,f,x,S){const{x:T,y:I,z:R}=x.projectTilePoint(y.x,y.y,c);if(!S)return _i(T,I,R,f);const[O,G,W]=S(y);return _i(T+O,I+G,R+W,f)}function Dr(y,c,f,x,S,T,I,R){const O=jr(y.sub(c)._unit()._add(y),R,S,I,T);return s.sub(O,f,O),s.normalize(O,O),s.scaleAndAdd(O,f,O,x)}function Ss(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae,ce,Y){const ie=x?y-c:y+c;let fe=ie>0?1:-1,ge=0;x&&(fe*=-1,ge=Math.PI),fe<0&&(ge+=Math.PI);let Ee=R+I+(fe>0?0:1)|0,Me=S,Ce=S,Ne=0,De=0;const Ue=Math.abs(ie),ft=[],ze=[];let tt=T,$e=tt;const ht=()=>Dr($e,tt,Ce,Ue-Ne+1,W,te,ae,ce.canonical);for(;Ne+De<=Ue;){if(Ee+=fe,Ee<R||Ee>=O)return null;if(Ce=Me,$e=tt,ft.push(Ce),se&&ze.push($e),tt=new s.Point(G.getx(Ee),G.gety(Ee)),Me=X[Ee],!Me){const ir=jr(tt,ce.canonical,W,ae,te);Me=ir[3]>0?X[Ee]=ir:ht()}Ne+=De,De=s.distance(Ce,Me)}le&&te&&(X[Ee]&&(Me=ht(),De=s.distance(Ce,Me)),X[Ee]=Me);const Be=(Ue-Ne)/De,et=tt.sub($e)._mult(Be)._add($e),mt=s.sub([],Me,Ce),at=s.scaleAndAdd([],Ce,mt,Be);let gt=[0,0,1],Yt=mt[0],hr=mt[1];if(Y&&(gt=ae.upVector(ce.canonical,et.x,et.y),gt[0]!==0||gt[1]!==0||gt[2]!==1)){const ir=[gt[2],0,-gt[0]],Nr=s.cross([],gt,ir);s.normalize(ir,ir),s.normalize(Nr,Nr),Yt=s.dot(mt,ir),hr=s.dot(mt,Nr)}if(f){const ir=s.cross([],gt,mt);s.normalize(ir,ir),s.scaleAndAdd(at,at,ir,f*fe)}const Gt=ge+Math.atan2(hr,Yt);return ft.push(at),se&&ze.push(et),{point:at,angle:Gt,path:ft,tilePath:ze,up:gt}}function mo(y,c){const f=c.length,x=f+4*y;c.resize(x),c.float32.fill(-1/0,4*f,4*x)}function Rr(y,c,f){const x=c[0],S=c[1];return y[0]=f[0]*x+f[4]*S+f[12],y[1]=f[1]*x+f[5]*S+f[13],y[3]=f[3]*x+f[7]*S+f[15],y}const Es=100;class ld{constructor(c,f,x=new Dl(c.width+200,c.height+200,25),S=new Dl(c.width+200,c.height+200,25)){this.transform=c,this.grid=x,this.ignoredGrid=S,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Es,this.screenBottomBoundary=c.height+Es,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=f}placeCollisionBox(c,f,x,S,T,I,R,O){let G=x.projectedAnchorX,W=x.projectedAnchorY,X=x.projectedAnchorZ;const te=x.elevation,se=x.tileID,le=c.getProjection();if(te&&se){const[Me,Ce,Ne]=le.upVector(se.canonical,x.tileAnchorX,x.tileAnchorY),De=le.upVectorScale(se.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Me*te*De,W+=Ce*te*De,X+=Ne*te*De}const ae=this.projectAndGetPerspectiveRatio(R,G,W,X,x.tileID,le.name==="globe"||!!te||this.transform.pitch>0,le),ce=I*ae.perspectiveRatio,Y=(x.x1*f+S.x-x.padding)*ce+ae.point.x,ie=(x.y1*f+S.y-x.padding)*ce+ae.point.y,fe=(x.x2*f+S.x+x.padding)*ce+ae.point.x,ge=(x.y2*f+S.y+x.padding)*ce+ae.point.y,Ee=ae.perspectiveRatio<=.55||ae.occluded;return!this.isInsideGrid(Y,ie,fe,ge)||!T&&this.grid.hitTest(Y,ie,fe,ge,O)||Ee?{box:[],offscreen:!1,occluded:ae.occluded}:{box:[Y,ie,fe,ge],offscreen:this.isOffscreen(Y,ie,fe,ge),occluded:!1}}placeCollisionCircles(c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae){const ce=[],Y=this.transform.elevation,ie=c.getProjection(),fe=Y?Y.getAtTileOffsetFunc(ae,this.transform.center.lat,this.transform.worldSize,ie):null,ge=new s.Point(x.tileAnchorX,x.tileAnchorY);let{x:Ee,y:Me,z:Ce}=ie.projectTilePoint(ge.x,ge.y,ae.canonical);if(fe){const[et,mt,at]=fe(ge);Ee+=et,Me+=mt,Ce+=at}const Ne=ie.name==="globe",De=this.projectAndGetPerspectiveRatio(R,Ee,Me,Ce,ae,Ne||!!Y||this.transform.pitch>0,ie),{perspectiveRatio:Ue}=De,ft=(X?I/Ue:I*Ue)/s.ONE_EM,ze=_i(Ee,Me,Ce,O),tt=De.signedDistanceFromCamera>0?xx(ft,T,x.lineOffsetX*ft,x.lineOffsetY*ft,!1,ze,ge,x,S,O,{},Y&&!X?fe:null,X&&!!Y,ie,ae,X):null;let $e=!1,ht=!1,Be=!0;if(tt&&!De.occluded){const et=.5*se*Ue+le,mt=new s.Point(-100,-100),at=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),gt=new bm,{first:Yt,last:hr}=tt,Gt=Yt.path.length;let ir=[];for(let qt=Gt-1;qt>=1;qt--)ir.push(Yt.path[qt]);for(let qt=1;qt<hr.path.length;qt++)ir.push(hr.path[qt]);const Nr=2.5*et;G&&(ir=ir.map(([qt,Qr,on],an)=>(fe&&!Ne&&(on=fe(an<Gt-1?Yt.tilePath[Gt-1-an]:hr.tilePath[an-Gt+2])[2]),_i(qt,Qr,on,G))),ir.some(qt=>qt[3]<=0)&&(ir=[]));let Pr=[];if(ir.length>0){let qt=1/0,Qr=-1/0,on=1/0,an=-1/0;for(const ln of ir)qt=Math.min(qt,ln[0]),on=Math.min(on,ln[1]),Qr=Math.max(Qr,ln[0]),an=Math.max(an,ln[1]);Qr>=mt.x&&qt<=at.x&&an>=mt.y&&on<=at.y&&(Pr=[ir.map(ln=>new s.Point(ln[0],ln[1]))],(qt<mt.x||Qr>at.x||on<mt.y||an>at.y)&&(Pr=s.clipLine(Pr,mt.x,mt.y,at.x,at.y)))}for(const qt of Pr){gt.reset(qt,.25*et);let Qr=0;Qr=gt.length<=.5*et?1:Math.ceil(gt.paddedLength/Nr)+1;for(let on=0;on<Qr;on++){const an=on/Math.max(Qr-1,1),ln=gt.lerp(an),Fi=ln.x+Es,bi=ln.y+Es;ce.push(Fi,bi,et,0);const Gs=Fi-et,Wo=bi-et,Pn=Fi+et,cn=bi+et;if(Be=Be&&this.isOffscreen(Gs,Wo,Pn,cn),ht=ht||this.isInsideGrid(Gs,Wo,Pn,cn),!f&&this.grid.hitTestCircle(Fi,bi,et,te)&&($e=!0,!W))return{circles:[],offscreen:!1,collisionDetected:$e,occluded:!1}}}}return{circles:!W&&$e||!ht?[]:ce,offscreen:Be,collisionDetected:$e,occluded:De.occluded}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let x=1/0,S=1/0,T=-1/0,I=-1/0;for(const W of c){const X=new s.Point(W.x+Es,W.y+Es);x=Math.min(x,X.x),S=Math.min(S,X.y),T=Math.max(T,X.x),I=Math.max(I,X.y),f.push(X)}const R=this.grid.query(x,S,T,I).concat(this.ignoredGrid.query(x,S,T,I)),O={},G={};for(const W of R){const X=W.key;if(O[X.bucketInstanceId]===void 0&&(O[X.bucketInstanceId]={}),O[X.bucketInstanceId][X.featureIndex])continue;const te=[new s.Point(W.x1,W.y1),new s.Point(W.x2,W.y1),new s.Point(W.x2,W.y2),new s.Point(W.x1,W.y2)];s.polygonIntersectsPolygon(f,te)&&(O[X.bucketInstanceId][X.featureIndex]=!0,G[X.bucketInstanceId]===void 0&&(G[X.bucketInstanceId]=[]),G[X.bucketInstanceId].push(X.featureIndex))}return G}insertCollisionBox(c,f,x,S,T){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:S,collisionGroupID:T},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,f,x,S,T){const I=f?this.ignoredGrid:this.grid,R={bucketInstanceId:x,featureIndex:S,collisionGroupID:T};for(let O=0;O<c.length;O+=4)I.insertCircle(R,c[O],c[O+1],c[O+2])}projectAndGetPerspectiveRatio(c,f,x,S,T,I,R){const O=[f,x,S,1];let G=!1;S||this.transform.pitch>0?(s.transformMat4$1(O,O,c),this.fogState&&T&&R.name!=="globe"&&(G=function(te,se,le,ae,ce,Y){const ie=Y.calculateFogTileMatrix(ce),fe=[se,le,ae];return s.transformMat4(fe,fe,ie),Je(te,fe,Y.pitch,Y._fov)}(this.fogState,f,x,S,T.toUnwrapped(),this.transform)>.9)):Rr(O,O,c);const W=O[3];return{point:new s.Point((O[0]/W+1)/2*this.transform.width+Es,(-O[1]/W+1)/2*this.transform.height+Es),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/W*.5,1.5),signedDistanceFromCamera:W,occluded:I&&O[2]>W||G}}isOffscreen(c,f,x,S){return x<Es||c>=this.screenRightBoundary||S<Es||f>this.screenBottomBoundary}isInsideGrid(c,f,x,S){return x>=0&&c<this.gridRightBoundary&&S>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const c=s.identity([]);return s.translate(c,c,[-100,-100,0]),c}}function Rl(y,c,f){const x=c.createTileMatrix(y,y.worldSize,f.toUnwrapped());return s.multiply(new Float32Array(16),y.projMatrix,x)}function Us(y,c,f){if(c.projection.name===f.projection.name)return y.projMatrix;const x=f.clone();return x.setProjection(c.projection),Rl(x,c.getProjection(),y)}function kn(y,c,f){return c.name===f.projection.name?y.projMatrix:Rl(f,c,y)}class _x{constructor(c,f,x,S){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):S&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class ga{constructor(c,f,x,S,T,I=!1){this.text=new _x(c?c.text:null,f,x,T),this.icon=new _x(c?c.icon:null,f,S,T),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cd{constructor(c,f,x,S=!1){this.text=c,this.icon=f,this.skipFade=x,this.clipped=S}}class ud{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Em{constructor(c,f,x,S,T){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=x,this.bucketIndex=S,this.tileID=T}}class wx{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:x=>x.collisionGroupID===f}}return this.collisionGroups[c]}}function dd(y,c,f,x,S){const{horizontalAlign:T,verticalAlign:I}=s.getAnchorAlignment(y),R=-(T-.5)*c,O=-(I-.5)*f,G=s.evaluateVariableOffset(y,x);return new s.Point(R+G[0]*S,O+G[1]*S)}function hd(y,c,f,x,S){const T=new s.Point(y,c);return f&&T._rotate(x?S:-S),T}class Vh{constructor(c,f,x,S,T){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new ld(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new wx(x),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,f,x,S){const T=x.getBucket(f),I=x.latestFeatureIndex;if(!T||!I||f.id!==T.layerIds[0])return;const R=T.layers[0].layout,O=x.collisionBoxArray,G=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),W=x.tileSize/s.EXTENT,X=x.tileID.toUnwrapped();this.transform.setProjection(T.projection);const te=(se=x.tileID,le=T.getProjection(),ae=this.transform,le.name===this.projection?ae.calculateProjMatrix(se.toUnwrapped()):Rl(ae,le,se));var se,le,ae;const ce=R.get("text-pitch-alignment")==="map",Y=R.get("text-rotation-alignment")==="map";f.compileFilter();const ie=f.dynamicFilter(),fe=f.dynamicFilterNeedsFeature(),ge=this.transform.calculatePixelsToTileUnitsMatrix(x),Ee=ma(te,x.tileID.canonical,ce,Y,this.transform,T.getProjection(),ge);let Me=null;if(ce){const De=Zn(te,x.tileID.canonical,ce,Y,this.transform,T.getProjection(),ge);Me=s.multiply([],this.transform.labelPlaneMatrix,De)}let Ce=null;ie&&x.latestFeatureIndex&&(Ce={unwrappedTileID:X,dynamicFilter:ie,dynamicFilterNeedsFeature:fe,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Em(T.bucketInstanceId,I,T.sourceLayerIndex,T.index,x.tileID);const Ne={bucket:T,layout:R,posMatrix:te,textLabelPlaneMatrix:Ee,labelToScreenMatrix:Me,clippingData:Ce,scale:G,textPixelRatio:W,holdingForFade:x.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(S)for(const De of T.sortKeyRanges){const{sortKey:Ue,symbolInstanceStart:ft,symbolInstanceEnd:ze}=De;c.push({sortKey:Ue,symbolInstanceStart:ft,symbolInstanceEnd:ze,parameters:Ne})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Ne})}attemptAnchorPlacement(c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae,ce,Y,ie){const{textOffset0:fe,textOffset1:ge,crossTileID:Ee}=te,Me=[fe,ge],Ce=dd(c,x,S,Me,T),Ne=this.collisionIndex.placeCollisionBox(le,T,f,hd(Ce.x,Ce.y,I,R,this.transform.angle),X,O,G,W.predicate);if(ce){const De=le.getSymbolInstanceIconSize(ie,this.transform.zoom,te.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(le,De,ce,hd(Ce.x,Ce.y,I,R,this.transform.angle),X,O,G,W.predicate).box.length===0)return}if(Ne.box.length>0){let De;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ee]&&this.prevPlacement.placements[Ee]&&this.prevPlacement.placements[Ee].text&&(De=this.prevPlacement.variableOffsets[Ee].anchor),this.variableOffsets[Ee]={textOffset:Me,width:x,height:S,anchor:c,textScale:T,prevAnchor:De},this.markUsedJustification(le,c,te,ae),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ae,te),this.placedOrientations[Ee]=ae),{shift:Ce,placedGlyphBoxes:Ne}}}placeLayerBucketPart(c,f,x,S){const{bucket:T,layout:I,posMatrix:R,textLabelPlaneMatrix:O,labelToScreenMatrix:G,clippingData:W,textPixelRatio:X,holdingForFade:te,collisionBoxArray:se,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:ae,collisionGroup:ce}=c.parameters,Y=I.get("text-optional"),ie=I.get("icon-optional"),fe=I.get("text-allow-overlap"),ge=I.get("icon-allow-overlap"),Ee=I.get("text-rotation-alignment")==="map",Me=I.get("text-pitch-alignment")==="map",Ce=I.get("icon-text-fit")!=="none",Ne=I.get("symbol-z-order")==="viewport-y";this.transform.setProjection(T.projection);let De=fe&&(ge||!T.hasIconData()||ie),Ue=ge&&(fe||!T.hasTextData()||Y);!T.collisionArrays&&se&&T.deserializeCollisionBoxes(se),x&&S&&T.updateCollisionDebugBuffers(this.transform.zoom,se);const ft=(ze,tt,$e)=>{const{crossTileID:ht,numVerticalGlyphVertices:Be}=ze;if(W){const Pn={zoom:this.transform.zoom,pitch:this.transform.pitch};let cn=null;if(W.dynamicFilterNeedsFeature){const Wr=this.retainedQueryData[T.bucketInstanceId];cn=W.featureIndex.loadFeature({featureIndex:ze.featureIndex,bucketIndex:Wr.bucketIndex,sourceLayerIndex:Wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,W.dynamicFilter)(Pn,cn,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new s.Point(ze.tileAnchorX,ze.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[ht]=new cd(!1,!1,!1,!0),void f.add(ht)}if(f.has(ht))return;if(te)return void(this.placements[ht]=new cd(!1,!1,!1));let et=!1,mt=!1,at=!0,gt=!1,Yt=!1,hr=null,Gt={box:null,offscreen:null,occluded:null},ir={box:null,offscreen:null,occluded:null},Nr=null,Pr=null,qt=null,Qr=0,on=0,an=0;$e.textFeatureIndex?Qr=$e.textFeatureIndex:ze.useRuntimeCollisionCircles&&(Qr=ze.featureIndex),$e.verticalTextFeatureIndex&&(on=$e.verticalTextFeatureIndex);const ln=Pn=>{Pn.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const cn=this.transform.elevation;(cn||Pn.elevation)&&(Pn.elevation=cn?cn.getAtTileOffset(Pn.tileID,Pn.tileAnchorX,Pn.tileAnchorY):0)},Fi=$e.textBox;if(Fi){ln(Fi);const Pn=Wr=>{let Xn=s.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Wr&&this.prevPlacement){const Yi=this.prevPlacement.placedOrientations[ht];Yi&&(this.placedOrientations[ht]=Yi,Xn=Yi,this.markUsedOrientation(T,Xn,ze))}return Xn},cn=(Wr,Xn)=>{if(T.allowVerticalPlacement&&Be>0&&$e.verticalTextBox){for(const Yi of T.writingModes)if(Yi===s.WritingMode.vertical?(Gt=Xn(),ir=Gt):Gt=Wr(),Gt&&Gt.box&&Gt.box.length)break}else Gt=Wr()};if(I.get("text-variable-anchor")){let Wr=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){const En=this.prevPlacement.variableOffsets[ht];Wr.indexOf(En.anchor)>0&&(Wr=Wr.filter(is=>is!==En.anchor),Wr.unshift(En.anchor))}const Xn=(En,is,gf)=>{const Ul=T.getSymbolInstanceTextSize(le,ze,this.transform.zoom,tt),Dd=(En.x2-En.x1)*Ul+2*En.padding,Sa=(En.y2-En.y1)*Ul+2*En.padding,el=Ce&&!ge?is:null;el&&ln(el);let Vl={box:[],offscreen:!1,occluded:!1};const yf=fe?2*Wr.length:Wr.length;for(let Rd=0;Rd<yf;++Rd){const pg=this.attemptAnchorPlacement(Wr[Rd%Wr.length],En,Dd,Sa,Ul,Ee,Me,X,R,ce,Rd>=Wr.length,ze,tt,T,gf,el,le,ae);if(pg&&(Vl=pg.placedGlyphBoxes,Vl&&Vl.box&&Vl.box.length)){et=!0,hr=pg.shift;break}}return Vl};cn(()=>Xn(Fi,$e.iconBox,s.WritingMode.horizontal),()=>{const En=$e.verticalTextBox;return En&&ln(En),T.allowVerticalPlacement&&!(Gt&&Gt.box&&Gt.box.length)&&Be>0&&En?Xn(En,$e.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Gt&&(et=Gt.box,at=Gt.offscreen,gt=Gt.occluded);const Yi=Pn(!(!Gt||!Gt.box));if(!et&&this.prevPlacement){const En=this.prevPlacement.variableOffsets[ht];En&&(this.variableOffsets[ht]=En,this.markUsedJustification(T,En.anchor,ze,Yi))}}else{const Wr=(Xn,Yi)=>{const En=T.getSymbolInstanceTextSize(le,ze,this.transform.zoom,tt),is=this.collisionIndex.placeCollisionBox(T,En,Xn,new s.Point(0,0),fe,X,R,ce.predicate);return is&&is.box&&is.box.length&&(this.markUsedOrientation(T,Yi,ze),this.placedOrientations[ht]=Yi),is};cn(()=>Wr(Fi,s.WritingMode.horizontal),()=>{const Xn=$e.verticalTextBox;return T.allowVerticalPlacement&&Be>0&&Xn?(ln(Xn),Wr(Xn,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Pn(!!(Gt&&Gt.box&&Gt.box.length))}}if(Nr=Gt,et=Nr&&Nr.box&&Nr.box.length>0,at=Nr&&Nr.offscreen,gt=Nr&&Nr.occluded,ze.useRuntimeCollisionCircles){const Pn=T.text.placedSymbolArray.get(ze.centerJustifiedTextSymbolIndex>=0?ze.centerJustifiedTextSymbolIndex:ze.verticalPlacedTextSymbolIndex),cn=s.evaluateSizeForFeature(T.textSizeData,le,Pn),Wr=I.get("text-padding");Pr=this.collisionIndex.placeCollisionCircles(T,fe,Pn,T.lineVertexArray,T.glyphOffsetArray,cn,R,O,G,x,Me,ce.predicate,ze.collisionCircleDiameter*cn/s.ONE_EM,Wr,this.retainedQueryData[T.bucketInstanceId].tileID),et=fe||Pr.circles.length>0&&!Pr.collisionDetected,at=at&&Pr.offscreen,gt=Pr.occluded}if($e.iconFeatureIndex&&(an=$e.iconFeatureIndex),$e.iconBox){const Pn=cn=>{ln(cn);const Wr=Ce&&hr?hd(hr.x,hr.y,Ee,Me,this.transform.angle):new s.Point(0,0),Xn=T.getSymbolInstanceIconSize(ae,this.transform.zoom,ze.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,Xn,cn,Wr,ge,X,R,ce.predicate)};ir&&ir.box&&ir.box.length&&$e.verticalIconBox?(qt=Pn($e.verticalIconBox),mt=qt.box.length>0):(qt=Pn($e.iconBox),mt=qt.box.length>0),at=at&&qt.offscreen,Yt=qt.occluded}const bi=Y||ze.numHorizontalGlyphVertices===0&&Be===0,Gs=ie||ze.numIconVertices===0;if(bi||Gs?Gs?bi||(mt=mt&&et):et=mt&&et:mt=et=mt&&et,et&&Nr&&Nr.box&&this.collisionIndex.insertCollisionBox(Nr.box,I.get("text-ignore-placement"),T.bucketInstanceId,ir&&ir.box&&on?on:Qr,ce.ID),mt&&qt&&this.collisionIndex.insertCollisionBox(qt.box,I.get("icon-ignore-placement"),T.bucketInstanceId,an,ce.ID),Pr&&(et&&this.collisionIndex.insertCollisionCircles(Pr.circles,I.get("text-ignore-placement"),T.bucketInstanceId,Qr,ce.ID),x)){const Pn=T.bucketInstanceId;let cn=this.collisionCircleArrays[Pn];cn===void 0&&(cn=this.collisionCircleArrays[Pn]=new ud);for(let Wr=0;Wr<Pr.circles.length;Wr+=4)cn.circles.push(Pr.circles[Wr+0]),cn.circles.push(Pr.circles[Wr+1]),cn.circles.push(Pr.circles[Wr+2]),cn.circles.push(Pr.collisionDetected?1:0)}const Wo=T.projection.name!=="globe";De=De&&(Wo||!gt),Ue=Ue&&(Wo||!Yt),this.placements[ht]=new cd(et||De,mt||Ue,at||T.justReloaded),f.add(ht)};if(Ne){const ze=T.getSortedSymbolIndexes(this.transform.angle);for(let tt=ze.length-1;tt>=0;--tt){const $e=ze[tt];ft(T.symbolInstances.get($e),$e,T.collisionArrays[$e])}}else for(let ze=c.symbolInstanceStart;ze<c.symbolInstanceEnd;ze++)ft(T.symbolInstances.get(ze),ze,T.collisionArrays[ze]);if(x&&T.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[T.bucketInstanceId];s.invert(ze.invProjMatrix,R),ze.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(c,f,x,S){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:O,crossTileID:G}=x,W=s.getAnchorJustification(f),X=S===s.WritingMode.vertical?O:W==="left"?T:W==="center"?I:W==="right"?R:-1;T>=0&&(c.text.placedSymbolArray.get(T).crossTileID=X>=0&&T!==X?0:G),I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=X>=0&&I!==X?0:G),R>=0&&(c.text.placedSymbolArray.get(R).crossTileID=X>=0&&R!==X?0:G),O>=0&&(c.text.placedSymbolArray.get(O).crossTileID=X>=0&&O!==X?0:G)}markUsedOrientation(c,f,x){const S=f===s.WritingMode.horizontal||f===s.WritingMode.horizontalOnly?f:0,T=f===s.WritingMode.vertical?f:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:G}=x,W=c.text.placedSymbolArray;I>=0&&(W.get(I).placedOrientation=S),R>=0&&(W.get(R).placedOrientation=S),O>=0&&(W.get(O).placedOrientation=S),G>=0&&(W.get(G).placedOrientation=T)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let x=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const S=f?f.symbolFadeChange(c):1,T=f?f.opacities:{},I=f?f.variableOffsets:{},R=f?f.placedOrientations:{};for(const O in this.placements){const G=this.placements[O],W=T[O];W?(this.opacities[O]=new ga(W,S,G.text,G.icon,null,G.clipped),x=x||G.text!==W.text.placed||G.icon!==W.icon.placed):(this.opacities[O]=new ga(null,S,G.text,G.icon,G.skipFade,G.clipped),x=x||G.text||G.icon)}for(const O in T){const G=T[O];if(!this.opacities[O]){const W=new ga(G,S,!1,!1);W.isHidden()||(this.opacities[O]=W,x=x||G.text.placed||G.icon.placed)}}for(const O in I)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=I[O]);for(const O in R)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=R[O]);x?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)}updateLayerOpacities(c,f){const x=new Set;for(const S of f){const T=S.getBucket(c);T&&S.latestFeatureIndex&&c.id===T.layerIds[0]&&this.updateBucketOpacities(T,x,S.collisionBoxArray)}}updateBucketOpacities(c,f,x){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const S=c.layers[0].layout,T=!!c.layers[0].dynamicFilter(),I=new ga(null,0,!1,!1,!0),R=S.get("text-allow-overlap"),O=S.get("icon-allow-overlap"),G=S.get("text-variable-anchor"),W=S.get("text-rotation-alignment")==="map",X=S.get("text-pitch-alignment")==="map",te=S.get("icon-text-fit")!=="none",se=new ga(null,0,R&&(O||!c.hasIconData()||S.get("icon-optional")),O&&(R||!c.hasTextData()||S.get("text-optional")),!0);!c.collisionArrays&&x&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(x);const le=(ce,Y,ie)=>{for(let fe=0;fe<Y/4;fe++)ce.opacityVertexArray.emplaceBack(ie)};let ae=0;for(let ce=0;ce<c.symbolInstances.length;ce++){const Y=c.symbolInstances.get(ce),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:fe,crossTileID:ge,numIconVertices:Ee}=Y,Me=f.has(ge);let Ce=this.opacities[ge];Me?Ce=I:Ce||(Ce=se,this.opacities[ge]=Ce),f.add(ge);const Ne=ie>0||fe>0,De=Ee>0,Ue=this.placedOrientations[ge],ft=Ue===s.WritingMode.vertical,ze=Ue===s.WritingMode.horizontal||Ue===s.WritingMode.horizontalOnly;if(!Ne&&!De||Ce.isHidden()||ae++,Ne){const tt=fd(Ce.text);le(c.text,ie,ft?zn:tt),le(c.text,fe,ze?zn:tt);const $e=Ce.text.isHidden(),{leftJustifiedTextSymbolIndex:ht,centerJustifiedTextSymbolIndex:Be,rightJustifiedTextSymbolIndex:et,verticalPlacedTextSymbolIndex:mt}=Y,at=c.text.placedSymbolArray,gt=$e||ft?1:0;ht>=0&&(at.get(ht).hidden=gt),Be>=0&&(at.get(Be).hidden=gt),et>=0&&(at.get(et).hidden=gt),mt>=0&&(at.get(mt).hidden=$e||ze?1:0);const Yt=this.variableOffsets[ge];Yt&&this.markUsedJustification(c,Yt.anchor,Y,Ue);const hr=this.placedOrientations[ge];hr&&(this.markUsedJustification(c,"left",Y,hr),this.markUsedOrientation(c,hr,Y))}if(De){const tt=fd(Ce.icon),{placedIconSymbolIndex:$e,verticalPlacedIconSymbolIndex:ht}=Y,Be=c.icon.placedSymbolArray,et=Ce.icon.isHidden()?1:0;$e>=0&&(le(c.icon,Ee,ft?zn:tt),Be.get($e).hidden=et),ht>=0&&(le(c.icon,Y.numVerticalIconVertices,ze?zn:tt),Be.get(ht).hidden=et)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const tt=c.collisionArrays[ce];if(tt){let $e=new s.Point(0,0),ht=!0;if(tt.textBox||tt.verticalTextBox){if(G){const et=this.variableOffsets[ge];et?($e=dd(et.anchor,et.width,et.height,et.textOffset,et.textScale),W&&$e._rotate(X?this.transform.angle:-this.transform.angle)):ht=!1}T&&(ht=!Ce.clipped),tt.textBox&&Pc(c.textCollisionBox.collisionVertexArray,Ce.text.placed,!ht||ft,$e.x,$e.y),tt.verticalTextBox&&Pc(c.textCollisionBox.collisionVertexArray,Ce.text.placed,!ht||ze,$e.x,$e.y)}const Be=ht&&!!(!ze&&tt.verticalIconBox);tt.iconBox&&Pc(c.iconCollisionBox.collisionVertexArray,Ce.icon.placed,Be,te?$e.x:0,te?$e.y:0),tt.verticalIconBox&&Pc(c.iconCollisionBox.collisionVertexArray,Ce.icon.placed,!Be,te?$e.x:0,te?$e.y:0)}}}if(c.fullyClipped=ae===0,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ce.invProjMatrix,c.placementViewportMatrix=ce.viewportMatrix,c.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,f){const x=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*x>c}setStale(){this.stale=!0}}function Pc(y,c,f,x,S){y.emplaceBack(c?1:0,f?1:0,x||0,S||0),y.emplaceBack(c?1:0,f?1:0,x||0,S||0),y.emplaceBack(c?1:0,f?1:0,x||0,S||0),y.emplaceBack(c?1:0,f?1:0,x||0,S||0)}const rs=Math.pow(2,25),Wn=Math.pow(2,24),Tm=Math.pow(2,17),Cm=Math.pow(2,16),ns=Math.pow(2,9),Vs=Math.pow(2,8),bx=Math.pow(2,1);function fd(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const c=y.placed?1:0,f=Math.floor(127*y.opacity);return f*rs+c*Wn+f*Tm+c*Cm+f*ns+c*Vs+f*bx+c}const zn=0;class pd{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,f,x,S,T){const I=this._bucketParts;for(;this._currentTileIndex<c.length;)if(f.getBucketParts(I,S,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((R,O)=>R.sortKey-O.sortKey));this._currentPartIndex<I.length;){const R=I[this._currentPartIndex];if(f.placeLayerBucketPart(R,this._seenCrossTileIDs,x,R.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class Mm{constructor(c,f,x,S,T,I,R,O){this.placement=new Vh(c,T,I,R,O),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(c,f,x){const S=s.exported.now(),T=()=>{const I=s.exported.now()-S;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=f[c[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=R)&&(!I.maxzoom||I.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new pd(I)),this._inProgressLayer.continuePlacement(x[I.source],this.placement,this._showCollisionBoxes,I,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Nl=512/s.EXTENT/2;class ki{constructor(c,f,x){this.tileID=c,this.bucketInstanceId=x,this.index=new s.KDBush(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=c.canonical.x*s.EXTENT,T=c.canonical.y*s.EXTENT;for(let I=0;I<f.length;I++){const{key:R,crossTileID:O,tileAnchorX:G,tileAnchorY:W}=f.get(I),X=Math.floor((S+G)*Nl),te=Math.floor((T+W)*Nl);this.index.add(X,te),this.keys.push(R),this.crossTileIDs.push(O)}this.index.finish()}findMatches(c,f,x){const S=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),T=Nl/Math.pow(2,f.canonical.z-this.tileID.canonical.z),I=f.canonical.x*s.EXTENT,R=f.canonical.y*s.EXTENT;for(let O=0;O<c.length;O++){const G=c.get(O);if(G.crossTileID)continue;const{key:W,tileAnchorX:X,tileAnchorY:te}=G,se=Math.floor((I+X)*T),le=Math.floor((R+te)*T),ae=this.index.range(se-S,le-S,se+S,le+S);for(const ce of ae){const Y=this.crossTileIDs[ce];if(this.keys[ce]===W&&!x.has(Y)){x.add(Y),G.crossTileID=Y;break}}}}}class km{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const f=Math.round((c-this.lng)/360);if(f!==0)for(const x in this.indexes){const S=this.indexes[x],T={};for(const I in S){const R=S[I];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+f),T[R.tileID.key]=R}this.indexes[x]=T}this.lng=c}addBucket(c,f,x){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let T=0;T<f.symbolInstances.length;T++)f.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const S=this.usedCrossTileIDs[c.overscaledZ];for(const T in this.indexes){const I=this.indexes[T];if(Number(T)>c.overscaledZ)for(const R in I){const O=I[R];O.tileID.isChildOf(c)&&O.findMatches(f.symbolInstances,c,S)}else{const R=I[c.scaledTo(Number(T)).key];R&&R.findMatches(f.symbolInstances,c,S)}}for(let T=0;T<f.symbolInstances.length;T++){const I=f.symbolInstances.get(T);I.crossTileID||(I.crossTileID=x.generate(),S.add(I.crossTileID))}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new ki(c,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(c,f){for(const x of f.crossTileIDs)this.usedCrossTileIDs[c].delete(x)}removeStaleBuckets(c){let f=!1;for(const x in this.indexes){const S=this.indexes[x];for(const T in S)c[S[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,S[T]),delete S[T],f=!0)}return f}}class ya{constructor(){this.layerIndexes={},this.crossTileIDs=new km,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,f,x,S){let T=this.layerIndexes[c.id];T===void 0&&(T=this.layerIndexes[c.id]=new Pm);let I=!1;const R={};S.name!=="globe"&&T.handleWrapJump(x);for(const O of f){const G=O.getBucket(c);G&&c.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(O.tileID,G,this.crossTileIDs)&&(I=!0),R[G.bucketInstanceId]=!0)}return T.removeStaleBuckets(R)&&(I=!0),I}pruneUnusedLayers(c){const f={};c.forEach(x=>{f[x]=!0});for(const x in this.layerIndexes)f[x]||delete this.layerIndexes[x]}}const Qa=(y,c)=>s.emitValidationErrors(y,c&&c.filter(f=>f.identifier!=="source.canvas")),$h=s.pick(Xr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Tb=s.pick(Xr,["setCenter","setZoom","setBearing","setPitch"]),Am={version:8,layers:[],sources:{}},Ac={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Uo extends s.Evented{constructor(c,f={}){super(),this.map=c,this.dispatcher=new Ge(Mc(),this),this.imageManager=new qe,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(c._requestManager,f.localFontFamily?s.LocalGlyphMode.all:f.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.crossTileSymbolIndex=new ya,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const x=this;this._rtlTextPluginCallback=Uo.registerForPluginStateChange(S=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(T,I)=>{if(s.triggerPluginCompletionEvent(T),I&&I.every(R=>R))for(const R in x._sourceCaches){const O=x._sourceCaches[R],G=O.getSource().type;G!=="vector"&&G!=="geojson"||O.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const T=this.getSource(S.sourceId);if(T&&T.vectorLayerIds)for(const I in this._layers){const R=this._layers[I];R.source===T.id&&this._validateLayer(R)}})}loadURL(c,f={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const x=typeof f.validate=="boolean"?f.validate:!s.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,f.accessToken);const S=this.map._requestManager.transformRequest(c,s.ResourceType.Style);this._request=s.getJSON(S,(T,I)=>{this._request=null,T?this.fire(new s.ErrorEvent(T)):I&&this._load(I,x)})}loadJSON(c,f={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(c,f.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Am,!1)}_updateLayerCount(c,f){const x=f?1:-1;c.is3D()&&(this._num3DLayers+=x),c.type==="circle"&&(this._numCircleLayers+=x),c.type==="symbol"&&(this._numSymbolLayers+=x)}_load(c,f){if(f&&Qa(this,s.validateStyle(c)))return;this._loaded=!0,this.stylesheet=s.clone$1(c),this._updateMapProjection();for(const S in c.sources)this.addSource(S,c.sources[S],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const x=yx(this.stylesheet.layers);this._order=x.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of x){const T=s.createStyleLayer(S);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new rt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(f,x,S){let T,I,R;const O=s.exported.devicePixelRatio>1?"@2x":"";let G=s.getJSON(x.transformRequest(x.normalizeSpriteURL(f,O,".json"),s.ResourceType.SpriteJSON),(te,se)=>{G=null,R||(R=te,T=se,X())}),W=s.getImage(x.transformRequest(x.normalizeSpriteURL(f,O,".png"),s.ResourceType.SpriteImage),(te,se)=>{W=null,R||(R=te,I=se,X())});function X(){if(R)S(R);else if(T&&I){const te=s.exported.getImageData(I),se={};for(const le in T){const{width:ae,height:ce,x:Y,y:ie,sdf:fe,pixelRatio:ge,stretchX:Ee,stretchY:Me,content:Ce}=T[le],Ne=new s.RGBAImage({width:ae,height:ce});s.RGBAImage.copy(te,Ne,{x:Y,y:ie},{x:0,y:0},{width:ae,height:ce}),se[le]={data:Ne,pixelRatio:ge,sdf:fe,stretchX:Ee,stretchY:Me,content:Ce}}S(null,se)}}return{cancel(){G&&(G.cancel(),G=null),W&&(W.cancel(),W=null)}}}(c,this.map._requestManager,(f,x)=>{if(this._spriteRequest=null,f)this.fire(new s.ErrorEvent(f));else if(x)for(const S in x)this.imageManager.addImage(S,x[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(c){const f=this.getSource(c.source);if(!f)return;const x=c.sourceLayer;x&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(x)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${f.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const f=[];for(const x of c){const S=this._layers[x];S.type!=="custom"&&f.push(S.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&(typeof c.isLayerDraped=="function"?c.isLayerDraped():Ac[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const f=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(S.length||T.length)&&this._updateWorkerLayers(S,T);for(const I in this._updatedSources){const R=this._updatedSources[I];R==="reload"?this._reloadSource(I):R==="clear"&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const x={};for(const S in this._sourceCaches){const T=this._sourceCaches[S];x[S]=T.used,T.used=!1}for(const S of this._order){const T=this._layers[S];if(T.recalculate(c,this._availableImages),!T.isHidden(c.zoom)){const R=this._getLayerSourceCache(T);R&&(R.used=!0)}const I=this.map.painter;if(I){const R=T.getProgramIds();if(!R)continue;const O=T.getProgramConfiguration(c.zoom);for(const G of R)I.useProgram(G,O)}}for(const S in x){const T=this._sourceCaches[S];x[S]!==T.used&&T.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),Qa(this,s.validateStyle(c)))return!1;(c=s.clone$1(c)).layers=yx(c.layers);const f=function(S,T){if(!S)return[{command:Xr.setStyle,args:[T]}];let I=[];try{if(!_(S.version,T.version))return[{command:Xr.setStyle,args:[T]}];_(S.center,T.center)||I.push({command:Xr.setCenter,args:[T.center]}),_(S.zoom,T.zoom)||I.push({command:Xr.setZoom,args:[T.zoom]}),_(S.bearing,T.bearing)||I.push({command:Xr.setBearing,args:[T.bearing]}),_(S.pitch,T.pitch)||I.push({command:Xr.setPitch,args:[T.pitch]}),_(S.sprite,T.sprite)||I.push({command:Xr.setSprite,args:[T.sprite]}),_(S.glyphs,T.glyphs)||I.push({command:Xr.setGlyphs,args:[T.glyphs]}),_(S.transition,T.transition)||I.push({command:Xr.setTransition,args:[T.transition]}),_(S.light,T.light)||I.push({command:Xr.setLight,args:[T.light]}),_(S.fog,T.fog)||I.push({command:Xr.setFog,args:[T.fog]}),_(S.projection,T.projection)||I.push({command:Xr.setProjection,args:[T.projection]});const R={},O=[];(function(X,te,se,le){let ae;for(ae in te=te||{},X=X||{})X.hasOwnProperty(ae)&&(te.hasOwnProperty(ae)||od(ae,se,le));for(ae in te){if(!te.hasOwnProperty(ae))continue;const ce=te[ae];X.hasOwnProperty(ae)?_(X[ae],ce)||(X[ae].type==="geojson"&&ce.type==="geojson"&&Uh(X,te,ae)?se.push({command:Xr.setGeoJSONSourceData,args:[ae,ce.data]}):_m(ae,te,se,le)):xm(ae,te,se)}})(S.sources,T.sources,O,R);const G=[];S.layers&&S.layers.forEach(X=>{X.source&&R[X.source]?I.push({command:Xr.removeLayer,args:[X.id]}):G.push(X)});let W=S.terrain;W&&R[W.source]&&(I.push({command:Xr.setTerrain,args:[void 0]}),W=void 0),I=I.concat(O),_(W,T.terrain)||I.push({command:Xr.setTerrain,args:[T.terrain]}),function(X,te,se){te=te||[];const le=(X=X||[]).map(fa),ae=te.map(fa),ce=X.reduce(wm,{}),Y=te.reduce(wm,{}),ie=le.slice(),fe=Object.create(null);let ge,Ee,Me,Ce,Ne,De,Ue;for(ge=0,Ee=0;ge<le.length;ge++)Me=le[ge],Y.hasOwnProperty(Me)?Ee++:(se.push({command:Xr.removeLayer,args:[Me]}),ie.splice(ie.indexOf(Me,Ee),1));for(ge=0,Ee=0;ge<ae.length;ge++)Me=ae[ae.length-1-ge],ie[ie.length-1-ge]!==Me&&(ce.hasOwnProperty(Me)?(se.push({command:Xr.removeLayer,args:[Me]}),ie.splice(ie.lastIndexOf(Me,ie.length-Ee),1)):Ee++,De=ie[ie.length-ge],se.push({command:Xr.addLayer,args:[Y[Me],De]}),ie.splice(ie.length-ge,0,Me),fe[Me]=!0);for(ge=0;ge<ae.length;ge++)if(Me=ae[ge],Ce=ce[Me],Ne=Y[Me],!fe[Me]&&!_(Ce,Ne))if(_(Ce.source,Ne.source)&&_(Ce["source-layer"],Ne["source-layer"])&&_(Ce.type,Ne.type)){for(Ue in Fo(Ce.layout,Ne.layout,se,Me,null,Xr.setLayoutProperty),Fo(Ce.paint,Ne.paint,se,Me,null,Xr.setPaintProperty),_(Ce.filter,Ne.filter)||se.push({command:Xr.setFilter,args:[Me,Ne.filter]}),_(Ce.minzoom,Ne.minzoom)&&_(Ce.maxzoom,Ne.maxzoom)||se.push({command:Xr.setLayerZoomRange,args:[Me,Ne.minzoom,Ne.maxzoom]}),Ce)Ce.hasOwnProperty(Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?Fo(Ce[Ue],Ne[Ue],se,Me,Ue.slice(6),Xr.setPaintProperty):_(Ce[Ue],Ne[Ue])||se.push({command:Xr.setLayerProperty,args:[Me,Ue,Ne[Ue]]}));for(Ue in Ne)Ne.hasOwnProperty(Ue)&&!Ce.hasOwnProperty(Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?Fo(Ce[Ue],Ne[Ue],se,Me,Ue.slice(6),Xr.setPaintProperty):_(Ce[Ue],Ne[Ue])||se.push({command:Xr.setLayerProperty,args:[Me,Ue,Ne[Ue]]}))}else se.push({command:Xr.removeLayer,args:[Me]}),De=ie[ie.lastIndexOf(Me)+1],se.push({command:Xr.addLayer,args:[Ne,De]})}(G,T.layers,I)}catch(R){console.warn("Unable to compute style diff:",R),I=[{command:Xr.setStyle,args:[T]}]}return I}(this.serialize(),c).filter(S=>!(S.command in Tb));if(f.length===0)return!1;const x=f.filter(S=>!(S.command in $h));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);return f.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,f){return this.getImage(c)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,f),this._afterImageUpdated(c),this)}updateImage(c,f){this.imageManager.updateImage(c,f)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,f,x={}){if(this._checkLoaded(),this.getSource(c)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(s.validateSource,`sources.${c}`,f,null,x))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const S=kr(c,f,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:S.serialize(),sourceId:c}));const T=I=>{const R=(I?"symbol:":"other:")+c,O=this._sourceCaches[R]=new s.SourceCache(R,S,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[c]=O,O.style=this,O.onAdd(this.map)};T(!1),f.type!=="vector"&&f.type!=="geojson"||T(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const f=this.getSource(c);if(!f)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===c)return this.fire(new s.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new s.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(c);for(const S of x)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,f){this._checkLoaded(),this.getSource(c).setData(f),this._changed=!0}getSource(c){const f=this._getSourceCache(c);return f&&f.getSource()}_getSources(){const c=[];for(const f in this._otherSourceCaches){const x=this._getSourceCache(f);x&&c.push(x.getSource())}return c}addLayer(c,f,x={}){this._checkLoaded();const S=c.id;if(this.getLayer(S))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let T;if(c.type==="custom"){if(Qa(this,s.validateCustomStyleLayer(c)))return;T=s.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(S,c.source),c=s.clone$1(c),c=s.extend(c,{source:S})),this._validate(s.validateLayer,`layers.${S}`,c,{arrayIndex:-1},x))return;T=s.createStyleLayer(c),this._validateLayer(T),T.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const I=f?this._order.indexOf(f):this._order.length;if(f&&I===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(I,0,S),this._layerOrderChanged=!0,this._layers[S]=T;const R=this._getLayerSourceCache(T);if(this._removedLayers[S]&&T.source&&R&&T.type!=="custom"){const O=this._removedLayers[S];delete this._removedLayers[S],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",R.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,f){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===f)return;const x=this._order.indexOf(c);this._order.splice(x,1);const S=f?this._order.indexOf(f):this._order.length;f&&S===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(S,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const f=this._layers[c];if(!f)return void this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const x=this._order.indexOf(c);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=f,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const f in this._layers)if(this._layers[f].type===c)return!0;return!1}setLayerZoomRange(c,f,x){this._checkLoaded();const S=this.getLayer(c);S?S.minzoom===f&&S.maxzoom===x||(f!=null&&(S.minzoom=f),x!=null&&(S.maxzoom=x),this._updateLayer(S)):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,f,x={}){this._checkLoaded();const S=this.getLayer(c);if(S){if(!_(S.filter,f))return f==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(s.validateFilter,`layers.${S.id}.filter`,f,{layerType:S.type},x)||(S.filter=s.clone$1(f),this._updateLayer(S)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const f=this.getLayer(c);return f&&s.clone$1(f.filter)}setLayoutProperty(c,f,x,S={}){this._checkLoaded();const T=this.getLayer(c);T?_(T.getLayoutProperty(f),x)||(T.setLayoutProperty(f,x,S),this._updateLayer(T)):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,f){const x=this.getLayer(c);if(x)return x.getLayoutProperty(f);this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,f,x,S={}){this._checkLoaded();const T=this.getLayer(c);T?_(T.getPaintProperty(f),x)||(T.setPaintProperty(f,x,S)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,f){const x=this.getLayer(c);return x&&x.getPaintProperty(f)}setFeatureState(c,f){this._checkLoaded();const x=c.source,S=c.sourceLayer,T=this.getSource(x);if(!T)return void this.fire(new s.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const I=T.type;if(I==="geojson"&&S)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(I==="vector"&&!S)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));c.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const R=this._getSourceCaches(x);for(const O of R)O.setFeatureState(S,c.id,f)}removeFeatureState(c,f){this._checkLoaded();const x=c.source,S=this.getSource(x);if(!S)return void this.fire(new s.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const T=S.type,I=T==="vector"?c.sourceLayer:void 0;if(T==="vector"&&!I)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof c.id!="string"&&typeof c.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const R=this._getSourceCaches(x);for(const O of R)O.removeFeatureState(I,c.id,f)}getFeatureState(c){this._checkLoaded();const f=c.source,x=c.sourceLayer,S=this.getSource(f);if(S){if(S.type!=="vector"||x)return c.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(x,c.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const f in this._sourceCaches){const x=this._sourceCaches[f].getSource();c[x.id]||(c[x.id]=x.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0;const f=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",f.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const f=I=>this._layers[I].type==="fill-extrusion",x={},S=[];for(let I=this._order.length-1;I>=0;I--){const R=this._order[I];if(f(R)){x[R]=I;for(const O of c){const G=O[R];if(G)for(const W of G)S.push(W)}}}S.sort((I,R)=>R.intersectionZ-I.intersectionZ);const T=[];for(let I=this._order.length-1;I>=0;I--){const R=this._order[I];if(f(R))for(let O=S.length-1;O>=0;O--){const G=S[O].feature;if(x[G.layer.id]<I)break;T.push(G),S.pop()}else for(const O of c){const G=O[R];if(G)for(const W of G)T.push(W.feature)}}return T}queryRenderedFeatures(c,f,x){f&&f.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",f.filter,null,f);const S={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const O of f.layers){const G=this._layers[O];if(!G)return this.fire(new s.ErrorEvent(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];S[G.source]=!0}}const T=[];f.availableImages=this._availableImages;const I=f&&f.layers?f.layers.some(O=>{const G=this.getLayer(O);return G&&G.is3D()}):this.has3DLayers(),R=ct.createFromScreenPoints(c,x);for(const O in this._sourceCaches){const G=this._sourceCaches[O].getSource().id;f.layers&&!S[G]||T.push(An(this._sourceCaches[O],this._layers,this._serializedLayers,R,f,x,I,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(O,G,W,X,te,se,le){const ae={},ce=se.queryRenderedSymbols(X),Y=[];for(const ie of Object.keys(ce).map(Number))Y.push(le[ie]);Y.sort(Oi);for(const ie of Y){const fe=ie.featureIndex.lookupSymbolFeatures(ce[ie.bucketInstanceId],G,ie.bucketIndex,ie.sourceLayerIndex,te.filter,te.layers,te.availableImages,O);for(const ge in fe){const Ee=ae[ge]=ae[ge]||[],Me=fe[ge];Me.sort((Ce,Ne)=>{const De=ie.featureSortOrder;if(De){const Ue=De.indexOf(Ce.featureIndex);return De.indexOf(Ne.featureIndex)-Ue}return Ne.featureIndex-Ce.featureIndex});for(const Ce of Me)Ee.push(Ce)}}for(const ie in ae)ae[ie].forEach(fe=>{const ge=fe.feature,Ee=W(O[ie]);if(!Ee)return;const Me=Ee.getFeatureState(ge.layer["source-layer"],ge.id);ge.source=ge.layer.source,ge.layer["source-layer"]&&(ge.sourceLayer=ge.layer["source-layer"]),ge.state=Me});return ae}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),R.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(c,f){f&&f.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",f.filter,null,f);const x=this._getSourceCaches(c);let S=[];for(const T of x)S=S.concat(qn(T,f));return S}addSourceType(c,f,x){return Uo.getSourceType(c)?x(new Error(`A source type called "${c}" already exists.`)):(Uo.setSourceType(c,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:f.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(c,f={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const I in c)if(!_(c[I],x[I])){S=!0;break}if(!S)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,f),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,f=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=c;if(f===1){if(typeof x.source=="object"){const S="terrain-dem-src";this.addSource(S,x.source),x=s.clone$1(x),x=s.extend(x,{source:S})}if(this._validate(s.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,f)}else{const S=this.terrain,T=S.get();for(const I of Object.keys(s.spec.terrain))!x.hasOwnProperty(I)&&s.spec.terrain[I].default&&(x[I]=s.spec.terrain[I].default);for(const I in x)if(!_(x[I],T[I])){S.set(x),this.stylesheet.terrain=x;const R=this._setTransitionParameters({duration:0});S.updateTransitions(R);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const f=this.fog=new Tt(c,this.map.transform);this.stylesheet.fog=c;const x=this._setTransitionParameters({duration:0});f.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,x=f.get();Object.keys(c).length===0&&f.set(c);for(const S in c)if(!_(c[S],x[S])){f.set(c),this.stylesheet.fog=c;const T=this._setTransitionParameters({duration:0});f.updateTransitions(T);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:s.exported.now(),transition:s.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(x=>this.isLayerDraped(this._layers[x])),f=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...f)}_createTerrain(c,f){const x=this.terrain=new it(c,f);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});x.updateTransitions(S)}_force3DLayerUpdate(){for(const c in this._layers){const f=this._layers[c];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const f=this._layers[c];f.type==="symbol"&&this._updateLayer(f)}}_validate(c,f,x,S,T={}){return(!T||T.validate!==!1)&&Qa(this,c.call(s.validateStyle,s.extend({key:f,style:this.serialize(),value:x,styleSpec:s.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const f=this._getSourceCaches(c);for(const x of f)x.clearTiles()}_reloadSource(c){const f=this._getSourceCaches(c);for(const x of f)x.resume(),x.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const f in this._sourceCaches)this._sourceCaches[f].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const f=this._sourceCaches[c];f.resume(),f.reload()}}_updatePlacement(c,f,x,S,T=!1){let I=!1,R=!1;const O={};for(const G of this._order){const W=this._layers[G];if(W.type!=="symbol")continue;if(!O[W.source]){const te=this._getLayerSourceCache(W);if(!te)continue;O[W.source]=te.getRenderableIds(!0).map(se=>te.getTileByID(se)).sort((se,le)=>le.tileID.overscaledZ-se.tileID.overscaledZ||(se.tileID.isLessThan(le.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(W,O[W.source],c.center.lng,c.projection);I=I||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),c.zoom))&&(this.pauseablePlacement=new Mm(c,this._order,T,f,x,S,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),R=!0),I&&this.pauseablePlacement.placement.setStale()),R||I)for(const G of this._order){const W=this._layers[G];W.type==="symbol"&&this.placement.updateLayerOpacities(W,O[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,f,x){this.imageManager.getImages(f.icons,x),this._updateTilesForChangedImages();const S=T=>{T&&T.setDependencies(f.tileID.key,f.type,f.icons)};S(this._otherSourceCaches[f.source]),S(this._symbolSourceCaches[f.source])}getGlyphs(c,f,x){this.glyphManager.getGlyphs(f.stacks,x)}getResource(c,f,x){return s.makeRequest(f,x)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return c.type==="symbol"?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const f=[];return this._otherSourceCaches[c]&&f.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&f.push(this._symbolSourceCaches[c]),f}_isSourceCacheLoaded(c){const f=this._getSourceCaches(c);return f.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):f.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Uo.getSourceType=function(y){return _r[y]},Uo.setSourceType=function(y,c){_r[y]=c},Uo.registerForPluginStateChange=s.registerForPluginStateChange;var Im=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,jl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",va=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,md=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,xa=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Wh={},Ic={};const gd=[];Dc(Im,gd),Dc(va,gd),Dc(md,gd),Dc(xa,gd),Wh=Yr("",va),Ic=Yr(xa,md);const Sx=Yr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Gh=Im,Dm=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Rm={background:Yr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Yr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Yr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Yr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Yr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Yr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Yr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Yr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Yr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Yr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Yr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Yr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Yr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Yr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Yr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Yr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Yr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Yr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Yr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Yr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Yr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Yr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Yr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Yr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Yr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,jl),skyboxGradient:Yr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,jl),skyboxCapture:Yr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Yr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Yr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Dc(y,c){const f=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of f)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=x.split(" ");for(const T of S)c.includes(T)||c.push(T)}}function Yr(y,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},T=[...gd];return Dc(y,T),Dc(c,T),{fragmentSource:y=y.replace(f,(I,R,O,G,W)=>(S[W]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${O} ${G} ${W};
#else
uniform ${O} ${G} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${O} ${G} ${W} = u_${W};
#endif
`)),vertexSource:c=c.replace(f,(I,R,O,G,W)=>{const X=G==="float"?"vec2":"vec4",te=W.match(/color/)?"color":X;return S[W]?R==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${O} ${X} a_${W};
varying ${O} ${G} ${W};
#else
uniform ${O} ${G} u_${W};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${O} ${G} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${te}(a_${W}, u_${W}_t);
#else
    ${O} ${G} ${W} = u_${W};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${O} ${X} a_${W};
#else
uniform ${O} ${G} u_${W};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${O} ${G} ${W} = a_${W};
#else
    ${O} ${G} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${O} ${G} ${W} = unpack_mix_${te}(a_${W}, u_${W}_t);
#else
    ${O} ${G} ${W} = u_${W};
#endif
`}),staticAttributes:x,usedDefines:T}}class Cb{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,f,x,S,T,I,R){this.context=c;let O=this.boundPaintVertexBuffers.length!==S.length;for(let W=0;!O&&W<S.length;W++)this.boundPaintVertexBuffers[W]!==S[W]&&(O=!0);let G=this.boundDynamicVertexBuffers.length!==R.length;for(let W=0;!G&&W<R.length;W++)this.boundDynamicVertexBuffers[W]!==R[W]&&(G=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==x||O||G||this.boundIndexBuffer!==T||this.boundVertexOffset!==I)this.freshBind(f,x,S,T,I,R);else{c.bindVertexArrayOES.set(this.vao);for(const W of R)W&&W.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(c,f,x,S,T,I){let R;const O=c.numAttributes,G=this.context,W=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),R=0,this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=S,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=I;else{R=G.currentNumAttributes||0;for(let X=O;X<R;X++)W.disableVertexAttribArray(X)}f.enableAttributes(W,c),f.bind(),f.setVertexAttribPointers(W,c,T);for(const X of x)X.enableAttributes(W,c),X.bind(),X.setVertexAttribPointers(W,c,T);for(const X of I)X&&(X.enableAttributes(W,c),X.bind(),X.setVertexAttribPointers(W,c,T));S&&S.bind(),G.currentNumAttributes=O}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Nm(y,c){const f=Math.pow(2,c.canonical.z),x=c.canonical.y;return[new s.MercatorCoordinate(0,x/f).toLngLat().lat,new s.MercatorCoordinate(0,(x+1)/f).toLngLat().lat]}function Ex(y,c,f,x,S,T,I){const R=y.context,O=R.gl,G=f.fbo;if(!G)return;y.prepareDrawTile();const W=y.useProgram("hillshade");R.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,G.colorAttachment.get());const X=((ae,ce,Y,ie)=>{const fe=Y.paint.get("hillshade-shadow-color"),ge=Y.paint.get("hillshade-highlight-color"),Ee=Y.paint.get("hillshade-accent-color");let Me=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(Me-=ae.transform.angle);const Ce=!ae.options.moving;return{u_matrix:ie||ae.transform.calculateProjMatrix(ce.tileID.toUnwrapped(),Ce),u_image:0,u_latrange:Nm(0,ce.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),Me],u_shadow:fe,u_highlight:ge,u_accent:Ee}})(y,f,x,y.terrain?c.projMatrix:null);y.prepareDrawProgram(R,W,c.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:se,tileBoundsSegments:le}=y.getTileBoundsBuffers(f);W.draw(R,O.TRIANGLES,S,T,I,s.CullFaceMode.disabled,X,x.id,te,se,le)}function jm(y,c,f){if(!c.needsDEMTextureUpload)return;const x=y.context,S=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||y.getTileTexture(f.stride);const T=f.getPixels();c.demTexture?c.demTexture.update(T,{premultiply:!1}):c.demTexture=new s.Texture(x,T,S.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Tx(y,c,f,x,S,T){const I=y.context,R=I.gl;if(!c.dem)return;const O=c.dem;if(I.activeTexture.set(R.TEXTURE1),jm(y,c,O),!c.demTexture)return;c.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);const G=O.dim;I.activeTexture.set(R.TEXTURE0);let W=c.fbo;if(!W){const le=new s.Texture(I,{width:G,height:G,data:null},R.RGBA);le.bind(R.LINEAR,R.CLAMP_TO_EDGE),W=c.fbo=I.createFramebuffer(G,G,!0),W.colorAttachment.set(le.texture)}I.bindFramebuffer.set(W.framebuffer),I.viewport.set([0,0,G,G]);const{tileBoundsBuffer:X,tileBoundsIndexBuffer:te,tileBoundsSegments:se}=y.getMercatorTileBoundsBuffers();y.useProgram("hillshadePrepare").draw(I,R.TRIANGLES,x,S,T,s.CullFaceMode.disabled,((le,ae)=>{const ce=ae.stride,Y=s.create();return s.ortho(Y,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(Y,Y,[0,-s.EXTENT,0]),{u_matrix:Y,u_image:1,u_dimension:[ce,ce],u_zoom:le.overscaledZ,u_unpack:ae.unpackVector}})(c.tileID,O),f.id,X,te,se),c.needsHillshadePrepare=!1}const Lm=y=>({u_matrix:new s.UniformMatrix4f(y),u_image0:new s.Uniform1i(y),u_skirt_height:new s.Uniform1f(y)}),Rc=(y,c)=>({u_matrix:y,u_image0:0,u_skirt_height:c}),Hh=(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:f,u_zoom_transition:S,u_merc_center:T,u_image0:0,u_frustum_tl:I,u_frustum_tr:R,u_frustum_br:O,u_frustum_bl:G,u_globe_pos:W,u_globe_radius:X,u_viewport:te,u_grid_matrix:le?Float32Array.from(le):new Float32Array(9),u_skirt_height:se});function Nc(y,c){return y!=null&&c!=null&&!(!y.hasData()||!c.hasData())&&y.demTexture!=null&&c.demTexture!=null&&y.tileID.key!==c.tileID.key}const _a=new class{constructor(){this.operations={}}newMorphing(y,c,f,x,S){if(y in this.operations){const T=this.operations[y];T.to.tileID.key!==f.tileID.key&&(T.queued=f)}else this.operations[y]={startTime:x,phase:0,duration:S,from:c,to:f,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const c=this.operations[y];return{from:c.from,to:c.to,phase:c.phase}}update(y){for(const c in this.operations){const f=this.operations[c];for(f.phase=(y-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,y)){delete this.operations[c];break}}}_nextOp(y,c){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=c,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Ll={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function qh(y){return 6*Math.pow(1.5,22-y)}function Cx(y,c){const f=1<<y.z;return!c&&(y.x===0||y.x===f-1)||y.y===0||y.y===f-1}const yd=y=>({u_matrix:y});function Om(y,c,f,x,S){if(S>0){const T=s.exported.now(),I=(T-y.timeAdded)/S,R=c?(T-c.timeAdded)/S:-1,O=f.getSource(),G=x.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),W=!c||Math.abs(c.tileID.overscaledZ-G)>Math.abs(y.tileID.overscaledZ-G),X=W&&y.refreshedUponExpiration?1:s.clamp(W?I:1-R,0,1);return y.refreshedUponExpiration&&I>=1&&(y.refreshedUponExpiration=!1),c?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class zm extends s.SourceCache{constructor(c){const f={type:"raster-dem",maxzoom:c.transform.maxZoom},x=new Ge(Mc(),null),S=kr("mock-dem",f,x,c.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,f){c.state="loaded",f(null)}}class Zh extends s.SourceCache{constructor(c){const f=kr("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new Ge(Mc(),null),c.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,f,x){if(c.freezeTileCoverage)return;this.transform=c;const S=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,I)=>{if(T[I.key]="",!this._tiles[I.key]){const R=new s.Tile(I,this._source.tileSize*I.overscaleFactor(),c.tileZoom);R.state="loaded",this._tiles[I.key]=R}return T},{});for(const T in this._tiles)T in S||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(c){const f=this.proxyCachedFBO[c];if(f!==void 0){const x=Object.values(f);this.renderCachePool.push(...x),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Xh extends s.OverscaledTileID{constructor(c,f,x){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=f,this.projMatrix=x}}class Fm extends s.Elevation{constructor(c,f){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,S,T]=function(O){const G=new s.StructArrayLayout2i4,W=new s.StructArrayLayout3ui6,X=131;G.reserve(17161),W.reserve(33800);const te=s.EXTENT/128,se=s.EXTENT+te/2,le=se+te;for(let ce=-te;ce<le;ce+=te)for(let Y=-te;Y<le;Y+=te){const ie=Y<0||Y>se||ce<0||ce>se?24575:0,fe=s.clamp(Math.round(Y),0,s.EXTENT),ge=s.clamp(Math.round(ce),0,s.EXTENT);G.emplaceBack(fe+ie,ge)}const ae=(ce,Y)=>{const ie=Y*X+ce;W.emplaceBack(ie+1,ie,ie+X),W.emplaceBack(ie+X,ie+X+1,ie+1)};for(let ce=1;ce<129;ce++)for(let Y=1;Y<129;Y++)ae(Y,ce);return[0,129].forEach(ce=>{for(let Y=0;Y<130;Y++)ae(Y,ce),ae(ce,Y)}),[G,W,32768]}(),I=c.context;this.gridBuffer=I.createVertexBuffer(x,s.posAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(S),this.gridSegments=s.SegmentVector.simpleSegment(0,0,x.length,S.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,x.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zh(f.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const R=I.gl;this._overlapStencilMode=new s.StencilMode({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new zm(f.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,f,x){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const S=c.terrain.properties;this.sourceCache=c.terrain.drapeRenderMode===0?this._mockSourceCache:c._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const T=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(f,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),f.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||c.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&c.dataType==="source"?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):c.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=f.getIds().map(O=>{const G=f.getTileByID(O).tileID;return G.projMatrix=x.calculateProjMatrix(G.toUnwrapped()),G});(function(O,G){const W=G.transform.pointCoordinate(G.transform.getCameraPoint()),X=new s.Point(W.x,W.y);O.sort((te,se)=>{if(se.overscaledZ-te.overscaledZ)return se.overscaledZ-te.overscaledZ;const le=new s.Point(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ae=new s.Point(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),ce=X.mult(1<<te.canonical.z);return ce.x-=.5,ce.y-=.5,ce.distSqr(le)-ce.distSqr(ae)})})(S,this.painter),this._previousZoom=x.zoom;const T=this.proxyToSource||{};this.proxyToSource={},S.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const O in I){const G=I[O];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,c[O],T),G.usedForTerrain))continue;const W=c[O];G.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[f.id]=S.map(O=>new Xh(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const R={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const G=this.terrainTileForTile[O.key];if(!G)continue;const W=G.tileID.key;W in R||(this._visibleDemTiles.push(G),R[W]=W)}}_assignTerrainTiles(c){this._initializing||c.forEach(f=>{if(this.terrainTileForTile[f.key])return;const x=this._findTileCoveringTileID(f,this.sourceCache);x&&(this.terrainTileForTile[f.key]=x)})}_prepareDEMTextures(){const c=this.painter.context,f=c.gl;for(const x in this.terrainTileForTile){const S=this.terrainTileForTile[x],T=S.dem;!T||S.demTexture&&!S.needsDEMTextureUpload||(c.activeTexture.set(f.TEXTURE1),jm(this.painter,S,T))}}_prepareDemTileUniforms(c,f,x,S){if(!f||f.demTexture==null)return!1;const T=c.tileID.canonical,I=Math.pow(2,f.tileID.canonical.z-T.z),R=S||"";return x[`u_dem_tl${R}`]=[T.x*I%1,T.y*I%1],x[`u_dem_scale${R}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,f=c.gl;if(!this._emptyDepthBufferTexture){const x=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(c,x,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const f=this._visibleDemTiles.reduce((x,S)=>{if(!S.dem)return x;const T=S.dem.tree.minimums[0];return T>0&&c++,x+T},0);return c?f/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,f=c.gl;c.activeTexture.set(f.TEXTURE2);const x=this._getLoadedAreaMinimum(),S=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(S,{premultiply:!1}):T=this._emptyDEMTexture=new s.Texture(c,S,f.RGBA,{premultiply:!1}),T}setupElevationDraw(c,f,x){const S=this.painter.context,T=S.gl,I=(R=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(R),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var R;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();let O=null,G=null,W=1;if(x&&x.morphing&&this._useVertexMorphing){const X=x.morphing.srcDemTile,te=x.morphing.dstDemTile;W=x.morphing.phase,X&&te&&(this._prepareDemTileUniforms(c,X,I,"_prev")&&(G=X),this._prepareDemTileUniforms(c,te,I)&&(O=te))}if(G&&O?(S.activeTexture.set(T.TEXTURE2),O.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),S.activeTexture.set(T.TEXTURE4),G.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),I.u_dem_lerp=W):(O=this.terrainTileForTile[c.tileID.key],S.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(c,O,I)?O.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),S.activeTexture.set(T.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&O){const X=(1<<O.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=X}if(x&&x.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),f.setTerrainUniformValues(S,I),this.painter.transform.projection.name==="globe"){const X=this.globeUniformValues(this.painter.transform,c.tileID.canonical,x&&x.useDenormalizedUpVectorScale);f.setGlobeUniformValues(S,X)}}globeUniformValues(c,f,x){const S=c.projection;return{u_tile_tl_up:S.upVector(f,0,0),u_tile_tr_up:S.upVector(f,s.EXTENT,0),u_tile_br_up:S.upVector(f,s.EXTENT,s.EXTENT),u_tile_bl_up:S.upVector(f,0,s.EXTENT),u_tile_up_scale:x?s.globeMetersToEcef(1):S.upVectorScale(f,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const f=this.painter,x=this.painter.context;c.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,T,I,R,O){if(S.transform.projection.name==="globe")(function(G,W,X,te,se){const le=G.context,ae=le.gl;let ce,Y;const ie=G.options.showTerrainWireframe?2:0,fe=G.transform,ge=s.globeUseCustomAntiAliasing(G,le,fe),Ee=(ht,Be)=>{if(Y===ht)return;const et=[Ll[ht],"PROJECTION_GLOBE_VIEW"];ge&&et.push("CUSTOM_ANTIALIASING"),Be&&et.push(Ll[ie]),ce=G.useProgram("globeRaster",null,et),Y=ht},Me=G.colorModeForRenderPass(),Ce=new s.DepthMode(ae.LEQUAL,s.DepthMode.ReadWrite,G.depthRangeFor3D);_a.update(se);const Ne=s.calculateGlobeMercatorMatrix(fe),De=[s.mercatorXfromLng(fe.center.lng),s.mercatorYfromLat(fe.center.lat)],Ue=ie?[!1,!0]:[!1],ft=G.globeSharedBuffers,ze=[fe.width*s.exported.devicePixelRatio,fe.height*s.exported.devicePixelRatio],tt=Float32Array.from(fe.globeMatrix),$e={useDenormalizedUpVectorScale:!0};if(Ue.forEach(ht=>{const Be=G.transform,et=qh(Be.zoom)*W.exaggeration();Y=-1;const mt=ht?ae.LINES:ae.TRIANGLES;for(const at of te){const gt=X.getTile(at),Yt=s.StencilMode.disabled,hr=W.prevTerrainTileForTile[at.key],Gt=W.terrainTileForTile[at.key];Nc(hr,Gt)&&_a.newMorphing(at.key,hr,Gt,se,250),le.activeTexture.set(ae.TEXTURE0),gt.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const ir=_a.getMorphValuesForProxy(at.key),Nr=ir?1:0;ir&&s.extend$1($e,{morphing:{srcDemTile:ir.from,dstDemTile:ir.to,phase:s.easeCubicInOut(ir.phase)}});const Pr=s.tileCornersToBounds(at.canonical),qt=s.getLatitudinalLod(Pr.getCenter().lat),Qr=s.getGridMatrix(at.canonical,Pr,qt,Be.worldSize/Be._pixelsPerMercatorPixel),on=s.globeNormalizeECEF(s.globeTileBounds(at.canonical)),an=Hh(Be.projMatrix,tt,Ne,on,s.globeToMercatorTransition(Be.zoom),De,Be.frustumCorners.TL,Be.frustumCorners.TR,Be.frustumCorners.BR,Be.frustumCorners.BL,Be.globeCenterInViewSpace,Be.globeRadius,ze,et,Qr);if(Ee(Nr,ht),W.setupElevationDraw(gt,ce,$e),G.prepareDrawProgram(le,ce,at.toUnwrapped()),ft){const[ln,Fi,bi]=ht?ft.getWirefameBuffers(G.context,qt):ft.getGridBuffers(qt,et!==0);ce.draw(le,mt,Ce,Yt,Me,s.CullFaceMode.backCCW,an,"globe_raster",ln,Fi,bi)}}}),ft){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ge&&ht.push("CUSTOM_ANTIALIASING"),ce=G.useProgram("globeRaster",null,ht);for(const Be of te){const{x:et,y:mt,z:at}=Be.canonical,gt=mt===0,Yt=mt===(1<<at)-1,[hr,Gt,ir,Nr]=ft.getPoleBuffers(at);if(Nr&&(gt||Yt)){const Pr=X.getTile(Be);le.activeTexture.set(ae.TEXTURE0),Pr.texture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);let qt=s.globePoleMatrixForTile(at,et,fe);const Qr=s.globeNormalizeECEF(s.globeTileBounds(Be.canonical)),on=(an,ln)=>an.draw(le,ae.TRIANGLES,Ce,s.StencilMode.disabled,Me,s.CullFaceMode.disabled,Hh(fe.projMatrix,qt,qt,Qr,0,De,fe.frustumCorners.TL,fe.frustumCorners.TR,fe.frustumCorners.BR,fe.frustumCorners.BL,fe.globeCenterInViewSpace,fe.globeRadius,ze,0),"globe_pole_raster",ln,ir,Nr);W.setupElevationDraw(Pr,ce,$e),G.prepareDrawProgram(le,ce,Be.toUnwrapped()),gt&&on(ce,hr),Yt&&(qt=s.scale(s.create(),qt,[1,-1,1]),on(ce,Gt))}}}})(S,T,I,R,O);else{const G=S.context,W=G.gl;let X,te;const se=S.options.showTerrainWireframe?2:0,le=(fe,ge)=>{if(te===fe)return;const Ee=[Ll[fe]];ge&&Ee.push(Ll[se]),X=S.useProgram("terrainRaster",null,Ee),te=fe},ae=S.colorModeForRenderPass(),ce=new s.DepthMode(W.LEQUAL,s.DepthMode.ReadWrite,S.depthRangeFor3D);_a.update(O);const Y=S.transform,ie=qh(Y.zoom)*T.exaggeration();(se?[!1,!0]:[!1]).forEach(fe=>{te=-1;const ge=fe?W.LINES:W.TRIANGLES,[Ee,Me]=fe?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Ce of R){const Ne=I.getTile(Ce),De=s.StencilMode.disabled,Ue=T.prevTerrainTileForTile[Ce.key],ft=T.terrainTileForTile[Ce.key];Nc(Ue,ft)&&_a.newMorphing(Ce.key,Ue,ft,O,250),G.activeTexture.set(W.TEXTURE0),Ne.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);const ze=_a.getMorphValuesForProxy(Ce.key),tt=ze?1:0;let $e;ze&&($e={morphing:{srcDemTile:ze.from,dstDemTile:ze.to,phase:s.easeCubicInOut(ze.phase)}});const ht=Rc(Ce.projMatrix,Cx(Ce.canonical,Y.renderWorldCopies)?ie/10:ie);le(tt,fe),T.setupElevationDraw(Ne,X,$e),S.prepareDrawProgram(G,X,Ce.toUnwrapped()),X.draw(G,ge,ce,De,ae,s.CullFaceMode.backCCW,ht,"terrain_raster",T.gridBuffer,Ee,Me)}})}}(f,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(this._drapedRenderBatches.length===0)return c+1;this.renderingToTexture=!0;const f=this.painter,x=this.painter.context,S=this.proxySourceCache,T=this.proxiedCoords[S.id],I=this._drapedRenderBatches.shift(),R=[],O=f.style.order;let G=0;for(const W of T){const X=S.getTileByID(W.proxyTileKey),te=S.proxyCachedFBO[W.key]?S.proxyCachedFBO[W.key][c]:void 0,se=te!==void 0?S.renderCache[te]:this.pool[G++],le=te!==void 0;if(X.texture=se.tex,le&&!se.dirty){R.push(X.tileID);continue}let ae;x.bindFramebuffer.set(se.fb.framebuffer),this.renderedToTile=!1,se.dirty&&(x.clear({color:s.Color.transparent,stencil:0}),se.dirty=!1);for(let ce=I.start;ce<=I.end;++ce){const Y=f.style._layers[O[ce]];if(Y.isHidden(f.transform.zoom))continue;const ie=f.style._getLayerSourceCache(Y),fe=ie?this.proxyToSource[W.key][ie.id]:[W];if(!fe)continue;const ge=fe;x.viewport.set([0,0,se.fb.width,se.fb.height]),ae!==(ie?ie.id:null)&&(this._setupStencil(se,fe,Y,ie),ae=ie?ie.id:null),f.renderLayer(f,ie,Y,ge)}this.renderedToTile?(se.dirty=!0,R.push(X.tileID)):le||--G,G===5&&(G=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,f.width,f.height]),I.end+1}postRender(){}renderCacheEfficiency(c){const f=c.order.length;if(f===0)return{efficiency:100};let x,S=0,T=0,I=!1;for(let R=0;R<f;++R){const O=c._layers[c.order[R]];this._style.isLayerDraped(O)?(I&&++S,++T):I||(I=!0,x=O.id)}return T===0?{efficiency:100}:{efficiency:100*(1-S/T),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{c=Math.min(c,f.dem.tree.minimums[0])}),c===0?c:(c-30)*this._exaggeration}raycast(c,f,x){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const I=T.tileID,R=1<<I.overscaledZ,{x:O,y:G}=I.canonical,W=O/R,X=(O+1)/R,te=G/R,se=(G+1)/R;return{minx:W,miny:te,maxx:X,maxy:se,t:T.dem.tree.raycastRoot(W,te,X,se,c,f,x),tile:T}});S.sort((T,I)=>(T.t!==null?T.t:Number.MAX_VALUE)-(I.t!==null?I.t:Number.MAX_VALUE));for(const T of S){if(T.t==null)return null;const I=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,c,f,x);if(I!=null)return I}return null}_createFBO(){const c=this.painter.context,f=c.gl,x=this.drapeBufferSize;c.activeTexture.set(f.TEXTURE0);const S=new s.Texture(c,{width:x[0],height:x[1],data:null},f.RGBA);S.bind(f.LINEAR,f.CLAMP_TO_EDGE);const T=c.createFramebuffer(x[0],x[1],!1);return T.colorAttachment.set(S.texture),T.depthAttachment=new Pe(c,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:T,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const f=this._style._layers[c],x=f.isHidden(this.painter.transform.zoom);return f.type==="custom"?!x&&f.shouldRedrape():!x&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const x of this._style._getSources())if(x instanceof Mt){c=!0;break}if(!c)return;const f={};for(let x=0;x<this._style.order.length;++x){const S=this._style._layers[this._style.order[x]],T=this._style._getLayerSourceCache(S);if(T&&!f[T.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof s.ZoomDependentExpression){f[T.id]=!0;for(const I of this.proxyCoords){const R=this.proxyToSource[I.key][T.id];if(R)for(const O of R)this._clearRenderCacheForTile(T.id,O)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof yt){c=!0;break}if(!c)return;const f={};for(let x=0;x<this._style.order.length;++x){const S=this._style._layers[this._style.order[x]],T=this._style._getLayerSourceCache(S);if(!T||f[T.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const I=S.paint.get("raster-fade-duration");for(const R of this.proxyCoords){const O=this.proxyToSource[R.key][T.id];if(O)for(const G of O){const W=Om(T.getTile(G),T.findLoadedParent(G,0),T,this.painter.transform,I);(W.opacity!==1||W.mix!==0)&&this._clearRenderCacheForTile(T.id,G)}}}}_setupDrapedRenderBatches(){const c=this._style.order,f=c.length;if(f===0)return;const x=[];let S,T=0,I=this._style._layers[c[T]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++T<f;)I=this._style._layers[c[T]];for(;T<f;++T){const R=this._style._layers[c[T]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?S===void 0&&(S=T):S!==void 0&&(x.push({start:S,end:T-1}),S=void 0))}S!==void 0&&x.push({start:S,end:T-1}),this._drapedRenderBatches=x}_setupRenderCache(c){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const I=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let R=0;R<I.length;++R){const O=Object.values(I[R]);f.renderCachePool.push(...O)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,S=this._tilesDirty;for(let I=x.length-1;I>=0;I--){const R=x[I];if(f.getTileByID(R.key),f.proxyCachedFBO[R.key]!==void 0){const O=c[R.key],G=this.proxyToSource[R.key];let W=0;for(const X in G){const te=G[X],se=O[X];if(!se||se.length!==te.length||te.some((le,ae)=>le!==se[ae]||S[X]&&S[X].hasOwnProperty(le.key))){W=-1;break}++W}for(const X in f.proxyCachedFBO[R.key])f.renderCache[f.proxyCachedFBO[R.key][X]].dirty=W<0||W!==Object.values(O).length}}const T=[...this._drapedRenderBatches];T.sort((I,R)=>R.end-R.start-(I.end-I.start));for(const I of T)for(const R of x){if(f.proxyCachedFBO[R.key])continue;let O=f.renderCachePool.pop();O===void 0&&f.renderCache.length<50&&(O=f.renderCache.length,f.renderCache.push(this._createFBO())),O!==void 0&&(f.proxyCachedFBO[R.key]={},f.proxyCachedFBO[R.key][I.start]=O,f.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(c,f,x,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,I=T.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let R;if(x.isTileClipped())R=f.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(c,f){const x=this.painter,S=this.painter.context,T=S.gl;x._tileClippingMaskIDs={},S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const I=x.useProgram("clippingMask");for(const R of c){const O=x._tileClippingMaskIDs[R.key]=--f;I.draw(S,T.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:T.ALWAYS,mask:0},O,255,T.KEEP,T.KEEP,T.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,yd(R.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(c){const f=this.painter.transform;if(c.x<0||c.x>f.width||c.y<0||c.y>f.height)return null;const x=[c.x,c.y,1,1];s.transformMat4$1(x,x,f.pixelMatrixInverse),s.scale$1(x,x,1/x[3]),x[0]/=f.worldSize,x[1]/=f.worldSize;const S=f._camera.position,T=s.mercatorZfromAltitude(1,f.center.lat),I=[S[0],S[1],S[2]/T,0],R=s.subtract([],x.slice(0,3),I);s.normalize(R,R);const O=this.raycast(I,R,this._exaggeration);return O!==null&&O?(s.scaleAndAdd(I,I,R,O),I[3]=I[2],I[2]*=T,I):null}drawDepth(){const c=this.painter,f=c.context,x=this.proxySourceCache,S=Math.ceil(c.width),T=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=f.gl,R=f.createFramebuffer(S,T,!0);f.activeTexture.set(I.TEXTURE0);const O=new s.Texture(f,{width:S,height:T,data:null},I.RGBA);O.bind(I.NEAREST,I.CLAMP_TO_EDGE),R.colorAttachment.set(O.texture);const G=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,S,T);R.depthAttachment.set(G),this._depthFBO=R,this._depthTexture=O}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,S,T]),function(I,R,O,G){if(I.transform.projection.name==="globe")return;const W=I.context,X=W.gl;W.clear({depth:1});const te=I.useProgram("terrainDepth"),se=new s.DepthMode(X.LESS,s.DepthMode.ReadWrite,I.depthRangeFor3D);for(const le of G){const ae=O.getTile(le),ce=Rc(le.projMatrix,0);R.setupElevationDraw(ae,te),te.draw(W,X.TRIANGLES,se,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,ce,"terrain_depth",R.gridBuffer,R.gridIndexBuffer,R.gridNoSkirtSegments)}}(c,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,f,x){if(c.getSource()instanceof Mr)return this._setupProxiedCoordsForImageSource(c,f,x);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const S=this.proxiedCoords[c.id]=[],T=this.proxyCoords;for(let R=0;R<T.length;R++){const O=T[R],G=this._findTileCoveringTileID(O,c);if(G){const W=this._createProxiedId(O,G,x[O.key]&&x[O.key][c.id]);S.push(W),this.proxyToSource[O.key][c.id]=[W]}}let I=!1;for(let R=0;R<f.length;R++){const O=c.getTile(f[R]);if(!O||!O.hasData())continue;const G=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==O.tileID.canonical.z){const W=this.proxyToSource[G.tileID.key][c.id],X=this._createProxiedId(G.tileID,O,x[G.tileID.key]&&x[G.tileID.key][c.id]);W?W.splice(W.length-1,0,X):this.proxyToSource[G.tileID.key][c.id]=[X],S.push(X),I=!0}}this._sourceTilesOverlap[c.id]=I}_setupProxiedCoordsForImageSource(c,f,x){if(!c.getSource().loaded())return;const S=this.proxiedCoords[c.id]=[],T=this.proxyCoords,I=c.getSource(),R=new s.Point(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),O=I.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((W,X)=>(W.min.x=Math.min(W.min.x,X.x-R.x),W.min.y=Math.min(W.min.y,X.y-R.y),W.max.x=Math.max(W.max.x,X.x-R.x),W.max.y=Math.max(W.max.y,X.y-R.y),W),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(W,X)=>{const te=W.wrap+W.canonical.x/(1<<W.canonical.z),se=W.canonical.y/(1<<W.canonical.z),le=s.EXTENT/(1<<W.canonical.z),ae=X.wrap+X.canonical.x/(1<<X.canonical.z),ce=X.canonical.y/(1<<X.canonical.z);return te+le<ae+O.min.x||te>ae+O.max.x||se+le<ce+O.min.y||se>ce+O.max.y};for(let W=0;W<T.length;W++){const X=T[W];for(let te=0;te<f.length;te++){const se=c.getTile(f[te]);if(!se||!se.hasData()||G(X,se.tileID))continue;const le=this._createProxiedId(X,se,x[X.key]&&x[X.key][c.id]),ae=this.proxyToSource[X.key][c.id];ae?ae.push(le):this.proxyToSource[X.key][c.id]=[le],S.push(le)}}}_createProxiedId(c,f,x){let S=this.orthoMatrix;if(x){const T=x.find(I=>I.key===f.tileID.key);if(T)return T}if(f.tileID.key!==c.key){const T=c.canonical.z-f.tileID.canonical.z;let I,R,O;S=s.create();const G=f.tileID.wrap-c.wrap<<c.overscaledZ;T>0?(I=s.EXTENT>>T,R=I*((f.tileID.canonical.x<<T)-c.canonical.x+G),O=I*((f.tileID.canonical.y<<T)-c.canonical.y)):(I=s.EXTENT<<-T,R=s.EXTENT*(f.tileID.canonical.x-(c.canonical.x+G<<-T)),O=s.EXTENT*(f.tileID.canonical.y-(c.canonical.y<<-T))),s.ortho(S,0,I,0,I,0,1),s.translate(S,S,[R,O,0])}return new Xh(f.tileID,c.key,S)}_findTileCoveringTileID(c,f){let x=f.getTile(c);if(x&&x.hasData())return x;const S=this._findCoveringTileCache[f.id],T=S[c.key];if(x=T?f.getTileByID(T):null,x&&x.hasData()||T===null)return x;let I=x?x.tileID:c,R=I.overscaledZ;const O=f.getSource().minzoom,G=[];if(!T){const X=f.getSource().maxzoom;if(c.canonical.z>=X){const te=c.canonical.z-X;f.getSource().reparseOverscaled?(R=Math.max(c.canonical.z+2,f.transform.tileZoom),I=new s.OverscaledTileID(R,c.wrap,X,c.canonical.x>>te,c.canonical.y>>te)):te!==0&&(R=X,I=new s.OverscaledTileID(R,c.wrap,X,c.canonical.x>>te,c.canonical.y>>te))}I.key!==c.key&&(G.push(I.key),x=f.getTile(I))}const W=X=>{G.forEach(te=>{S[te]=X}),G.length=0};for(R-=1;R>=O&&(!x||!x.hasData());R--){x&&W(x.tileID.key);const X=I.calculateScaledKey(R);if(x=f.getTileByID(X),x&&x.hasData())break;const te=S[X];if(te===null)break;te===void 0?G.push(X):x=f.getTileByID(te)}return W(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,f){let x=this._tilesDirty[c];x||(x=this._tilesDirty[c]={}),x[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(f){let x=0;const S=new s.StructArrayLayout2ui4,T=131;for(let I=1;I<129;I++){for(let R=1;R<129;R++)x=I*T+R,S.emplaceBack(x,x+1),S.emplaceBack(x,x+T),S.emplaceBack(x+1,x+T),I===128&&S.emplaceBack(x+T,x+T+1);S.emplaceBack(x+1,x+1+T)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ur{static cacheKey(c,f,x,S){let T=`${f}${S?S.cacheKey:""}`;for(const I of x)c.usedDefines.includes(I)&&(T+=`/${I}`);return T}constructor(c,f,x,S,T,I){const R=c.gl;this.program=R.createProgram();const O=function(Y){const ie=[];for(let fe=0;fe<Y.length;fe++){if(Y[fe]===null)continue;const ge=Y[fe].split(" ");ie.push(ge.pop())}return ie}(x.staticAttributes),G=S?S.getBinderAttributes():[],W=O.concat(G);let X=S?S.defines():[];X=X.concat(I.map(Y=>`#define ${Y}`));const te=c.isWebGL2?`#version 300 es
`:"",se=te+X.concat(c.extStandardDerivatives&&te.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Dm):Dm,Dm,Gh,Sx.fragmentSource,Ic.fragmentSource,x.fragmentSource).join(`
`),le=te+X.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Gh,Sx.vertexSource,Ic.vertexSource,Wh.vertexSource,x.vertexSource).join(`
`),ae=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(ae,se),R.compileShader(ae),R.attachShader(this.program,ae);const ce=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(ce,le),R.compileShader(ce),R.attachShader(this.program,ce),this.attributes={},this.numAttributes=W.length;for(let Y=0;Y<this.numAttributes;Y++)W[Y]&&(R.bindAttribLocation(this.program,Y,W[Y]),this.attributes[W[Y]]=Y);R.linkProgram(this.program),R.deleteShader(ce),R.deleteShader(ae),this.fixedUniforms=T(c),this.binderUniforms=S?S.getUniforms(c):[],I.includes("TERRAIN")&&(this.terrainUniforms=(Y=>({u_dem:new s.Uniform1i(Y),u_dem_prev:new s.Uniform1i(Y),u_dem_unpack:new s.Uniform4f(Y),u_dem_tl:new s.Uniform2f(Y),u_dem_scale:new s.Uniform1f(Y),u_dem_tl_prev:new s.Uniform2f(Y),u_dem_scale_prev:new s.Uniform1f(Y),u_dem_size:new s.Uniform1f(Y),u_dem_lerp:new s.Uniform1f(Y),u_exaggeration:new s.Uniform1f(Y),u_depth:new s.Uniform1i(Y),u_depth_size_inv:new s.Uniform2f(Y),u_meter_to_dem:new s.Uniform1f(Y),u_label_plane_matrix_inv:new s.UniformMatrix4f(Y)}))(c)),I.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new s.Uniform3f(Y),u_tile_tr_up:new s.Uniform3f(Y),u_tile_br_up:new s.Uniform3f(Y),u_tile_bl_up:new s.Uniform3f(Y),u_tile_up_scale:new s.Uniform1f(Y)}))(c)),I.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new s.UniformMatrix4f(Y),u_fog_range:new s.Uniform2f(Y),u_fog_color:new s.Uniform4f(Y),u_fog_horizon_blend:new s.Uniform1f(Y),u_fog_temporal_offset:new s.Uniform1f(Y),u_frustum_tl:new s.Uniform3f(Y),u_frustum_tr:new s.Uniform3f(Y),u_frustum_br:new s.Uniform3f(Y),u_frustum_bl:new s.Uniform3f(Y),u_globe_pos:new s.Uniform3f(Y),u_globe_radius:new s.Uniform1f(Y),u_globe_transition:new s.Uniform1f(Y),u_is_globe:new s.Uniform1i(Y),u_viewport:new s.Uniform2f(Y)}))(c))}}setTerrainUniformValues(c,f){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in f)x[S]&&x[S].set(this.program,S,f[S])}}setGlobeUniformValues(c,f){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in f)x[S]&&x[S].set(this.program,S,f[S])}}setFogUniformValues(c,f){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const S in f)x[S].set(this.program,S,f[S])}}draw(c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae){const ce=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(x),c.setStencilMode(S),c.setColorMode(T),c.setCullFace(I);for(const ie of Object.keys(this.fixedUniforms))this.fixedUniforms[ie].set(this.program,ie,R[ie]);le&&le.setUniforms(this.program,c,this.binderUniforms,te,{zoom:se});const Y={[ce.LINES]:2,[ce.TRIANGLES]:3,[ce.LINE_STRIP]:1}[f];for(const ie of X.get()){const fe=ie.vaos||(ie.vaos={});(fe[O]||(fe[O]=new Cb)).bind(c,this,G,le?le.getPaintVertexBuffers():[],W,ie.vertexOffset,ae||[]),ce.drawElements(f,ie.primitiveLength*Y,ce.UNSIGNED_SHORT,ie.primitiveOffset*Y*2)}}}function vd(y,c){const f=Math.pow(2,c.tileID.overscaledZ),x=c.tileSize*Math.pow(2,y.transform.tileZoom)/f,S=x*(c.tileID.canonical.x+c.tileID.wrap*f),T=x*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/wt(c,1,y.transform.tileZoom),u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}const Mx=s.create(),Bm=(y,c,f,x,S,T,I,R,O,G,W)=>{const X=c.style.light,te=X.properties.get("position"),se=[te.x,te.y,te.z],le=s.create$1();X.properties.get("anchor")==="viewport"&&(s.fromRotation(le,-c.transform.angle),s.transformMat3(se,se,le));const ae=X.properties.get("color"),ce=c.transform,Y={u_matrix:y,u_lightpos:se,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[ae.r,ae.g,ae.b],u_vertical_gradient:+f,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Mx,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:T};return ce.projection.name==="globe"&&(Y.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],Y.u_zoom_transition=O,Y.u_inv_rot_matrix=W,Y.u_merc_center=G,Y.u_up_dir=ce.projection.upVector(new s.CanonicalTileID(0,0,0),G[0]*s.EXTENT,G[1]*s.EXTENT),Y.u_height_lift=R),Y},kx=(y,c,f,x,S,T,I,R,O,G,W,X)=>{const te=Bm(y,c,f,x,S,T,I,O,G,W,X),se={u_height_factor:-Math.pow(2,I.overscaledZ)/R.tileSize/8};return s.extend(te,vd(c,R),se)},Ol=y=>({u_matrix:y}),Um=(y,c,f)=>s.extend(Ol(y),vd(c,f)),Mb=(y,c)=>({u_matrix:y,u_world:c}),kb=(y,c,f,x)=>s.extend(Um(y,c,f),{u_world:x}),Pb=s.create(),Vm=(y,c,f,x,S,T)=>{const I=y.transform,R=I.projection.name==="globe";let O;if(T.paint.get("circle-pitch-alignment")==="map")if(R){const W=s.globePixelsToTileUnits(I.zoom,c.canonical)*I._pixelsPerMercatorPixel;O=Float32Array.from([W,0,0,W])}else O=I.calculatePixelsToTileUnitsMatrix(f);else O=new Float32Array([I.pixelsToGLUnits[0],0,0,I.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:I.cameraToCenterDistance,u_matrix:y.translatePosMatrix(c.projMatrix,f,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:Pb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){G.u_inv_rot_matrix=x,G.u_merc_center=S,G.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],G.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const W=S[0]*s.EXTENT,X=S[1]*s.EXTENT;G.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),W,X)}return G},$m=y=>{const c=[];return y.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),y.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c},Wm=(y,c,f,x)=>{const S=s.EXTENT/f.tileSize;return{u_matrix:y,u_camera_to_center_distance:c.getCameraToCenterDistance(x),u_extrude_scale:[c.pixelsToGLUnits[0]/S,c.pixelsToGLUnits[1]/S]}},Yh=(y,c,f=1)=>({u_matrix:y,u_color:c,u_overlay:0,u_overlay_scale:f}),Px=s.create(),Ax=(y,c,f,x,S,T,I)=>{const R=y.transform,O=R.projection.name==="globe",G=O?s.globePixelsToTileUnits(R.zoom,c.canonical)*R._pixelsPerMercatorPixel:wt(f,1,T),W={u_matrix:c.projMatrix,u_extrude_scale:G,u_intensity:I,u_inv_rot_matrix:Px,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){W.u_inv_rot_matrix=x,W.u_merc_center=S,W.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],W.u_zoom_transition=s.globeToMercatorTransition(R.zoom);const X=S[0]*s.EXTENT,te=S[1]*s.EXTENT;W.u_up_dir=R.projection.upVector(new s.CanonicalTileID(0,0,0),X,te)}return W},Ab=(y,c,f,x,S,T,I)=>{const R=y.transform,O=R.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:Gm(y,c,f,x),u_pixels_to_tile_units:O,u_device_pixel_ratio:T,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:_d(f)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:jc(c,y.transform),u_alpha_discard_threshold:0,u_trim_offset:I}},xd=(y,c,f,x,S)=>{const T=y.transform;return{u_matrix:Gm(y,c,f,x),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:jc(c,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function jc(y,c){return 1/wt(y,1,c.tileZoom)}function Gm(y,c,f,x){return y.translatePosMatrix(x||c.tileID.projMatrix,c,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function _d(y){const c=y.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}const Hm=(y,c,f,x,S,T)=>{return{u_matrix:y,u_tl_parent:c,u_scale_parent:f,u_fade_t:x.mix,u_opacity:x.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(R=S.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(I=S.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Vo(S.paint.get("raster-hue-rotate")),u_perspective_transform:T};var I,R};function Vo(y){y*=Math.PI/180;const c=Math.sin(y),f=Math.cos(y);return[(2*f+1)/3,(-Math.sqrt(3)*c-f+1)/3,(Math.sqrt(3)*c-f+1)/3]}const Kh=s.create(),qm=(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae)=>{const ce=S.transform,Y={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_rotate_symbol:+f,u_aspect_ratio:ce.width/ce.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:I,u_coord_matrix:R,u_is_text:+O,u_pitch_with_map:+x,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Kh,u_up_vector:[0,-1,0]};return ae.name==="globe"&&(Y.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],Y.u_zoom_transition=X,Y.u_inv_rot_matrix=se,Y.u_merc_center=te,Y.u_camera_forward=ce._camera.forward(),Y.u_ecef_origin=s.globeECEFOrigin(ce.globeMatrix,W.toUnwrapped()),Y.u_tile_matrix=Float32Array.from(ce.globeMatrix),Y.u_up_vector=le),Y},Qh=(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae,ce)=>s.extend(qm(y,c,f,x,S,T,I,R,O,G,X,te,se,le,ae,ce),{u_gamma_scale:x?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+W}),Ix=(y,c,f,x,S,T,I,R,O,G,W,X,te,se,le,ae)=>s.extend(Qh(y,c,f,x,S,T,I,R,!0,O,!0,W,X,te,se,le,ae),{u_texsize_icon:G,u_texture_icon:1}),Zm=(y,c,f)=>({u_matrix:y,u_opacity:c,u_color:f}),Ib=(y,c,f,x,S)=>s.extend(function(T,I,R){const O=I.imageManager.getPattern(T.toString()),{width:G,height:W}=I.imageManager.getPixelSize(),X=Math.pow(2,R.tileID.overscaledZ),te=R.tileSize*Math.pow(2,I.transform.tileZoom)/X,se=te*(R.tileID.canonical.x+R.tileID.wrap*X),le=te*R.tileID.canonical.y;return{u_image:0,u_pattern_tl:O.tl,u_pattern_br:O.br,u_texsize:[G,W],u_pattern_size:O.displaySize,u_tile_units_to_pixels:1/wt(R,1,I.transform.tileZoom),u_pixel_coord_upper:[se>>16,le>>16],u_pixel_coord_lower:[65535&se,65535&le]}}(x,f,S),{u_matrix:y,u_opacity:c}),Xm={fillExtrusion:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y)}),fillExtrusionPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_height_factor:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y)}),fill:y=>({u_matrix:new s.UniformMatrix4f(y)}),fillPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),fillOutline:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y)}),fillOutlinePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),circle:y=>({u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),collisionBox:y=>({u_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.Uniform2f(y)}),collisionCircle:y=>({u_matrix:new s.UniformMatrix4f(y),u_inv_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_viewport_size:new s.Uniform2f(y)}),debug:y=>({u_color:new s.UniformColor(y),u_matrix:new s.UniformMatrix4f(y),u_overlay:new s.Uniform1i(y),u_overlay_scale:new s.Uniform1f(y)}),clippingMask:y=>({u_matrix:new s.UniformMatrix4f(y)}),heatmap:y=>({u_extrude_scale:new s.Uniform1f(y),u_intensity:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),heatmapTexture:y=>({u_image:new s.Uniform1i(y),u_color_ramp:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y)}),hillshade:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_latrange:new s.Uniform2f(y),u_light:new s.Uniform2f(y),u_shadow:new s.UniformColor(y),u_highlight:new s.UniformColor(y),u_accent:new s.UniformColor(y)}),hillshadePrepare:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_dimension:new s.Uniform2f(y),u_zoom:new s.Uniform1f(y),u_unpack:new s.Uniform4f(y)}),line:y=>({u_matrix:new s.UniformMatrix4f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_units_to_pixels:new s.Uniform2f(y),u_dash_image:new s.Uniform1i(y),u_gradient_image:new s.Uniform1i(y),u_image_height:new s.Uniform1f(y),u_texsize:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y),u_trim_offset:new s.Uniform2f(y)}),linePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_texsize:new s.Uniform2f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_units_to_pixels:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y)}),raster:y=>({u_matrix:new s.UniformMatrix4f(y),u_tl_parent:new s.Uniform2f(y),u_scale_parent:new s.Uniform1f(y),u_fade_t:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_image0:new s.Uniform1i(y),u_image1:new s.Uniform1i(y),u_brightness_low:new s.Uniform1f(y),u_brightness_high:new s.Uniform1f(y),u_saturation_factor:new s.Uniform1f(y),u_contrast_factor:new s.Uniform1f(y),u_spin_weights:new s.Uniform3f(y),u_perspective_transform:new s.Uniform2f(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_texture:new s.Uniform1i(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_is_halo:new s.Uniform1i(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texsize_icon:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_texture_icon:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_is_halo:new s.Uniform1i(y)}),background:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_color:new s.UniformColor(y)}),backgroundPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_pattern_tl:new s.Uniform2f(y),u_pattern_br:new s.Uniform2f(y),u_texsize:new s.Uniform2f(y),u_pattern_size:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),terrainRaster:Lm,terrainDepth:Lm,skybox:y=>({u_matrix:new s.UniformMatrix4f(y),u_sun_direction:new s.Uniform3f(y),u_cubemap:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxGradient:y=>({u_matrix:new s.UniformMatrix4f(y),u_color_ramp:new s.Uniform1i(y),u_center_direction:new s.Uniform3f(y),u_radius:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxCapture:y=>({u_matrix_3f:new s.UniformMatrix3f(y),u_sun_direction:new s.Uniform3f(y),u_sun_intensity:new s.Uniform1f(y),u_color_tint_r:new s.Uniform4f(y),u_color_tint_m:new s.Uniform4f(y),u_luminance:new s.Uniform1f(y)}),globeRaster:y=>({u_proj_matrix:new s.UniformMatrix4f(y),u_globe_matrix:new s.UniformMatrix4f(y),u_normalize_matrix:new s.UniformMatrix4f(y),u_merc_matrix:new s.UniformMatrix4f(y),u_zoom_transition:new s.Uniform1f(y),u_merc_center:new s.Uniform2f(y),u_image0:new s.Uniform1i(y),u_grid_matrix:new s.UniformMatrix3f(y),u_skirt_height:new s.Uniform1f(y),u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_globe_pos:new s.Uniform3f(y),u_globe_radius:new s.Uniform1f(y),u_viewport:new s.Uniform2f(y)}),globeAtmosphere:y=>({u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_horizon:new s.Uniform1f(y),u_transition:new s.Uniform1f(y),u_fadeout_range:new s.Uniform1f(y),u_color:new s.Uniform4f(y),u_high_color:new s.Uniform4f(y),u_space_color:new s.Uniform4f(y),u_star_intensity:new s.Uniform1f(y),u_star_density:new s.Uniform1f(y),u_star_size:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y),u_horizon_angle:new s.Uniform1f(y),u_rotation_matrix:new s.UniformMatrix4f(y)})};let Jh;function wd(y,c,f,x,S,T,I){const R=y.context,O=R.gl,G=y.transform,W=y.useProgram("collisionBox"),X=[];let te=0,se=0;for(let ge=0;ge<x.length;ge++){const Ee=x[ge],Me=c.getTile(Ee),Ce=Me.getBucket(f);if(!Ce)continue;const Ne=Us(Ee,Ce,G);let De=Ne;S[0]===0&&S[1]===0||(De=y.translatePosMatrix(Ne,Me,S,T));const Ue=I?Ce.textCollisionBox:Ce.iconCollisionBox,ft=Ce.collisionCircleArray;if(ft.length>0){const ze=s.create(),tt=De;s.mul(ze,Ce.placementInvProjMatrix,G.glCoordMatrix),s.mul(ze,ze,Ce.placementViewportMatrix),X.push({circleArray:ft,circleOffset:se,transform:tt,invTransform:ze,projection:Ce.getProjection()}),te+=ft.length/4,se=te}Ue&&(y.terrain&&y.terrain.setupElevationDraw(Me,W),W.draw(R,O.LINES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,Wm(De,G,Me,Ce.getProjection()),f.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,null,G.zoom,null,[Ue.collisionVertexBuffer,Ue.collisionVertexBufferExt]))}if(!I||!X.length)return;const le=y.useProgram("collisionCircle"),ae=new s.StructArrayLayout2f1f2i16;ae.resize(4*te),ae._trim();let ce=0;for(const ge of X)for(let Ee=0;Ee<ge.circleArray.length/4;Ee++){const Me=4*Ee,Ce=ge.circleArray[Me+0],Ne=ge.circleArray[Me+1],De=ge.circleArray[Me+2],Ue=ge.circleArray[Me+3];ae.emplace(ce++,Ce,Ne,De,Ue,0),ae.emplace(ce++,Ce,Ne,De,Ue,1),ae.emplace(ce++,Ce,Ne,De,Ue,2),ae.emplace(ce++,Ce,Ne,De,Ue,3)}(!Jh||Jh.length<2*te)&&(Jh=function(ge){const Ee=2*ge,Me=new s.StructArrayLayout3ui6;Me.resize(Ee),Me._trim();for(let Ce=0;Ce<Ee;Ce++){const Ne=6*Ce;Me.uint16[Ne+0]=4*Ce+0,Me.uint16[Ne+1]=4*Ce+1,Me.uint16[Ne+2]=4*Ce+2,Me.uint16[Ne+3]=4*Ce+2,Me.uint16[Ne+4]=4*Ce+3,Me.uint16[Ne+5]=4*Ce+0}return Me}(te));const Y=R.createIndexBuffer(Jh,!0),ie=R.createVertexBuffer(ae,s.collisionCircleLayout.members,!0);for(const ge of X){const Ee={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(fe=G).getCameraToCenterDistance(ge.projection),u_viewport_size:[fe.width,fe.height]};le.draw(R,O.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,Ee,f.id,ie,Y,s.SegmentVector.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,G.zoom)}var fe;ie.destroy(),Y.destroy()}const Dx=s.create();function Ym({width:y,height:c,anchor:f,textOffset:x,textScale:S},T){const{horizontalAlign:I,verticalAlign:R}=s.getAnchorAlignment(f),O=-(I-.5)*y,G=-(R-.5)*c,W=s.evaluateVariableOffset(f,x);return new s.Point((O/S+W[0])*T,(G/S+W[1])*T)}function Db(y,c,f,x,S,T,I,R,O,G,W){const X=y.text.placedSymbolArray,te=y.text.dynamicLayoutVertexArray,se=y.icon.dynamicLayoutVertexArray,le={},ae=y.getProjection(),ce=kn(R,ae,T),Y=T.elevation,ie=ae.upVectorScale(R.canonical,T.center.lat,T.worldSize).metersToTile;te.clear();for(let fe=0;fe<X.length;fe++){const ge=X.get(fe),{tileAnchorX:Ee,tileAnchorY:Me,numGlyphs:Ce}=ge,Ne=ge.hidden||!ge.crossTileID||y.allowVerticalPlacement&&!ge.placedOrientation?null:x[ge.crossTileID];if(Ne){let De=0,Ue=0,ft=0;if(Y){const gt=Y?Y.getAtTileOffset(R,Ee,Me):0,[Yt,hr,Gt]=ae.upVector(R.canonical,Ee,Me);De=gt*Yt*ie,Ue=gt*hr*ie,ft=gt*Gt*ie}let[ze,tt,$e,ht]=_i(ge.projectedAnchorX+De,ge.projectedAnchorY+Ue,ge.projectedAnchorZ+ft,f?ce:I);const Be=vx(T.getCameraToCenterDistance(ae),ht);let et=S.evaluateSizeForFeature(y.textSizeData,G,ge)*Be/s.ONE_EM;f&&(et*=y.tilePixelRatio/O);const mt=Ym(Ne,et);f?({x:ze,y:tt,z:$e}=ae.projectTilePoint(Ee+mt.x,Me+mt.y,R.canonical),[ze,tt,$e]=_i(ze+De,tt+Ue,$e+ft,I)):(c&&mt._rotate(-T.angle),ze+=mt.x,tt+=mt.y,$e=0);const at=y.allowVerticalPlacement&&ge.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let gt=0;gt<Ce;gt++)s.addDynamicAttributes(te,ze,tt,$e,at);W&&ge.associatedIconIndex>=0&&(le[ge.associatedIconIndex]={x:ze,y:tt,z:$e,angle:at})}else mo(Ce,te)}if(W){se.clear();const fe=y.icon.placedSymbolArray;for(let ge=0;ge<fe.length;ge++){const Ee=fe.get(ge),{numGlyphs:Me}=Ee,Ce=le[ge];if(Ee.hidden||!Ce)mo(Me,se);else{const{x:Ne,y:De,z:Ue,angle:ft}=Ce;for(let ze=0;ze<Me;ze++)s.addDynamicAttributes(se,Ne,De,Ue,ft)}}y.icon.dynamicLayoutVertexBuffer.updateData(se)}y.text.dynamicLayoutVertexBuffer.updateData(te)}function Km(y,c,f){return f.iconsInText&&c?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Rx(y,c,f,x,S,T,I,R,O,G,W,X){const te=y.context,se=te.gl,le=y.transform,ae=R==="map",ce=O==="map",Y=ae&&f.layout.get("symbol-placement")!=="point",ie=ae&&!ce&&!Y,fe=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ge=!1;const Ee=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),Me=[s.mercatorXfromLng(le.center.lng),s.mercatorYfromLat(le.center.lat)],Ce=f.layout.get("text-variable-anchor"),Ne=le.projection.name==="globe",De=[],Ue=[0,-1,0];let ft=Ue;!Ne&&!le.mercatorFromTransition||ae||(ft=function(ze){const tt=ze._camera.getWorldToCamera(ze.worldSize,1),$e=s.multiply([],tt,ze.globeMatrix);s.invert($e,$e);const ht=[0,0,0],Be=[0,1,0,0];return s.transformMat4$1(Be,Be,$e),ht[0]=Be[0],ht[1]=Be[1],ht[2]=Be[2],s.normalize(ht,ht),ht}(le));for(const ze of x){const tt=c.getTile(ze),$e=tt.getBucket(f);if(!$e||$e.projection.name==="mercator"&&Ne)continue;const ht=S?$e.text:$e.icon;if(!ht||$e.fullyClipped||!ht.segments.get().length)continue;const Be=ht.programConfigurations.get(f.id),et=S||$e.sdfIcons,mt=S?$e.textSizeData:$e.iconSizeData,at=ce||le.pitch!==0,gt=s.evaluateSizeForZoom(mt,le.zoom);let Yt,hr,Gt,ir,Nr=[0,0],Pr=null;if(S)hr=tt.glyphAtlasTexture,Gt=se.LINEAR,Yt=tt.glyphAtlasTexture.size,$e.iconsInText&&(Nr=tt.imageAtlasTexture.size,Pr=tt.imageAtlasTexture,ir=at||y.options.rotating||y.options.zooming||mt.kind==="composite"||mt.kind==="camera"?se.LINEAR:se.NEAREST);else{const Sa=f.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;hr=tt.imageAtlasTexture,Gt=et||y.options.rotating||y.options.zooming||Sa||at?se.LINEAR:se.NEAREST,Yt=tt.imageAtlasTexture.size}const qt=$e.projection.name==="globe",Qr=qt?ft:Ue,on=qt?s.globeToMercatorTransition(le.zoom):0,an=kn(ze,$e.getProjection(),le),ln=le.calculatePixelsToTileUnitsMatrix(tt),Fi=Ye(an,tt.tileID.canonical,ce,ae,le,$e.getProjection(),ln),bi=y.terrain&&ce&&Y?s.invert(s.create(),Fi):Dx,Gs=Zn(an,tt.tileID.canonical,ce,ae,le,$e.getProjection(),ln),Wo=Ce&&$e.hasTextData(),Pn=f.layout.get("icon-text-fit")!=="none"&&Wo&&$e.hasIconData();if(Y){const Sa=le.elevation,el=Sa?Sa.getAtTileOffsetFunc(ze,le.center.lat,le.worldSize,$e.getProjection()):null,Vl=ma(an,tt.tileID.canonical,ce,ae,le,$e.getProjection(),ln);Sm($e,an,y,S,Vl,Gs,ce,G,el,ze)}const cn=Y||S&&Ce||Pn,Wr=y.translatePosMatrix(an,tt,T,I),Xn=cn?Dx:Fi,Yi=y.translatePosMatrix(Gs,tt,T,I,!0),En=$e.getProjection().createInversionMatrix(le,ze.canonical),is=[];y.terrainRenderModeElevated()&&ce&&is.push("PITCH_WITH_MAP_TERRAIN"),qt&&is.push("PROJECTION_GLOBE_VIEW"),cn&&is.push("PROJECTED_POS_ON_VIEWPORT");const gf=et&&f.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ul;Ul=et?$e.iconsInText?Ix(mt.kind,gt,ie,ce,y,Wr,Xn,Yi,Yt,Nr,ze,on,Me,En,Qr,$e.getProjection()):Qh(mt.kind,gt,ie,ce,y,Wr,Xn,Yi,S,Yt,!0,ze,on,Me,En,Qr,$e.getProjection()):qm(mt.kind,gt,ie,ce,y,Wr,Xn,Yi,S,Yt,ze,on,Me,En,Qr,$e.getProjection());const Dd={program:y.useProgram(Km(et,S,$e),Be,is),buffers:ht,uniformValues:Ul,atlasTexture:hr,atlasTextureIcon:Pr,atlasInterpolation:Gt,atlasInterpolationIcon:ir,isSDF:et,hasHalo:gf,tile:tt,labelPlaneMatrixInv:bi};if(fe&&$e.canOverlap){ge=!0;const Sa=ht.segments.get();for(const el of Sa)De.push({segments:new s.SegmentVector([el]),sortKey:el.sortKey,state:Dd})}else De.push({segments:ht.segments,sortKey:0,state:Dd})}ge&&De.sort((ze,tt)=>ze.sortKey-tt.sortKey);for(const ze of De){const tt=ze.state;if(y.terrain&&y.terrain.setupElevationDraw(tt.tile,tt.program,{useDepthForOcclusion:!Ne,labelPlaneMatrixInv:tt.labelPlaneMatrixInv}),te.activeTexture.set(se.TEXTURE0),tt.atlasTexture.bind(tt.atlasInterpolation,se.CLAMP_TO_EDGE),tt.atlasTextureIcon&&(te.activeTexture.set(se.TEXTURE1),tt.atlasTextureIcon&&tt.atlasTextureIcon.bind(tt.atlasInterpolationIcon,se.CLAMP_TO_EDGE)),tt.isSDF){const $e=tt.uniformValues;tt.hasHalo&&($e.u_is_halo=1,bd(tt.buffers,ze.segments,f,y,tt.program,Ee,W,X,$e)),$e.u_is_halo=0}bd(tt.buffers,ze.segments,f,y,tt.program,Ee,W,X,tt.uniformValues)}}function bd(y,c,f,x,S,T,I,R,O){const G=x.context,W=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.globeExtVertexBuffer];S.draw(G,G.gl.TRIANGLES,T,I,R,s.CullFaceMode.disabled,O,f.id,y.layoutVertexBuffer,y.indexBuffer,c,f.paint,x.transform.zoom,y.programConfigurations.get(f.id),W)}function Nx(y,c,f,x,S,T,I){const R=y.context.gl,O=f.paint.get("fill-pattern"),G=O&&O.constantOr(1);let W,X,te,se,le;I?(X=G&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=R.LINES):(X=G?"fillPattern":"fill",W=R.TRIANGLES);for(const ae of x){const ce=c.getTile(ae);if(G&&!ce.patternsLoaded())continue;const Y=ce.getBucket(f);if(!Y)continue;y.prepareDrawTile();const ie=Y.programConfigurations.get(f.id),fe=y.useProgram(X,ie);G&&(y.context.activeTexture.set(R.TEXTURE0),ce.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ie.updatePaintBuffers());const ge=O.constantOr(null);if(ge&&ce.imageAtlas){const Me=ce.imageAtlas.patternPositions[ge.toString()];Me&&ie.setConstantPatternPositions(Me)}const Ee=y.translatePosMatrix(ae.projMatrix,ce,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(I){se=Y.indexBuffer2,le=Y.segments2;const Me=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[R.drawingBufferWidth,R.drawingBufferHeight];te=X==="fillOutlinePattern"&&G?kb(Ee,y,ce,Me):Mb(Ee,Me)}else se=Y.indexBuffer,le=Y.segments,te=G?Um(Ee,y,ce):Ol(Ee);y.prepareDrawProgram(y.context,fe,ae.toUnwrapped()),fe.draw(y.context,W,S,y.stencilModeForClipping(ae),T,s.CullFaceMode.disabled,te,f.id,Y.layoutVertexBuffer,se,le,f.paint,y.transform.zoom,ie)}}function ef(y,c,f,x,S,T,I){const R=y.context,O=R.gl,G=y.transform,W=f.paint.get("fill-extrusion-pattern"),X=W.constantOr(1),te=f.paint.get("fill-extrusion-opacity"),se=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),f.paint.get("fill-extrusion-ambient-occlusion-radius")],le=f.layout.get("fill-extrusion-edge-radius"),ae=le>0&&!f.paint.get("fill-extrusion-rounded-roof"),ce=ae?0:le,Y=G.projection.name==="globe"?s.fillExtrusionHeightLift():0,ie=G.projection.name==="globe",fe=ie?s.globeToMercatorTransition(G.zoom):0,ge=[s.mercatorXfromLng(G.center.lng),s.mercatorYfromLat(G.center.lat)],Ee=[];ie&&Ee.push("PROJECTION_GLOBE_VIEW"),se[0]>0&&Ee.push("FAUX_AO"),ae&&Ee.push("ZERO_ROOF_RADIUS");for(const Me of x){const Ce=c.getTile(Me),Ne=Ce.getBucket(f);if(!Ne||Ne.projection.name!==G.projection.name)continue;const De=Ne.programConfigurations.get(f.id),Ue=y.useProgram(X?"fillExtrusionPattern":"fillExtrusion",De,Ee);if(y.terrain){const et=y.terrain;if(y.style.terrainSetForDrapingOnly())et.setupElevationDraw(Ce,Ue,{useMeterToDem:!0});else{if(!Ne.enableTerrain)continue;if(et.setupElevationDraw(Ce,Ue,{useMeterToDem:!0}),jx(R,c,Me,Ne,f,et),!Ne.centroidVertexBuffer){const mt=Ue.attributes.a_centroid_pos;mt!==void 0&&O.vertexAttrib2f(mt,0,0)}}}X&&(y.context.activeTexture.set(O.TEXTURE0),Ce.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),De.updatePaintBuffers());const ft=W.constantOr(null);if(ft&&Ce.imageAtlas){const et=Ce.imageAtlas.patternPositions[ft.toString()];et&&De.setConstantPatternPositions(et)}const ze=y.translatePosMatrix(Me.projMatrix,Ce,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),tt=G.projection.createInversionMatrix(G,Me.canonical),$e=f.paint.get("fill-extrusion-vertical-gradient"),ht=X?kx(ze,y,$e,te,se,ce,Me,Ce,Y,fe,ge,tt):Bm(ze,y,$e,te,se,ce,Me,Y,fe,ge,tt);y.prepareDrawProgram(R,Ue,Me.toUnwrapped());const Be=[];y.terrain&&Be.push(Ne.centroidVertexBuffer),ie&&Be.push(Ne.layoutVertexExtBuffer),Ue.draw(R,R.gl.TRIANGLES,S,T,I,s.CullFaceMode.backCCW,ht,f.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,f.paint,y.transform.zoom,De,Be)}}function jx(y,c,f,x,S,T){const I=[Y=>{let ie=Y.canonical.x-1,fe=Y.wrap;return ie<0&&(ie=(1<<Y.canonical.z)-1,fe--),new s.OverscaledTileID(Y.overscaledZ,fe,Y.canonical.z,ie,Y.canonical.y)},Y=>{let ie=Y.canonical.x+1,fe=Y.wrap;return ie===1<<Y.canonical.z&&(ie=0,fe++),new s.OverscaledTileID(Y.overscaledZ,fe,Y.canonical.z,ie,Y.canonical.y)},Y=>new s.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,(Y.canonical.y===0?1<<Y.canonical.z:Y.canonical.y)-1),Y=>new s.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y===(1<<Y.canonical.z)-1?0:Y.canonical.y+1)],R=Y=>{const ie=c.getSource().minzoom,fe=Ee=>{const Me=c.getTileByID(Ee);if(Me&&Me.hasData())return Me.getBucket(S)},ge=[0,-1,1];for(const Ee of ge){if(Y.overscaledZ+Ee<ie)continue;const Me=fe(Y.calculateScaledKey(Y.overscaledZ+Ee));if(Me)return Me}},O=[0,0,0],G=(Y,ie)=>(O[0]=Math.min(Y.min.y,ie.min.y),O[1]=Math.max(Y.max.y,ie.max.y),O[2]=s.EXTENT-ie.min.x>Y.max.x?ie.min.x-s.EXTENT:Y.max.x,O),W=(Y,ie)=>(O[0]=Math.min(Y.min.x,ie.min.x),O[1]=Math.max(Y.max.x,ie.max.x),O[2]=s.EXTENT-ie.min.y>Y.max.y?ie.min.y-s.EXTENT:Y.max.y,O),X=[(Y,ie)=>G(Y,ie),(Y,ie)=>G(ie,Y),(Y,ie)=>W(Y,ie),(Y,ie)=>W(ie,Y)],te=new s.Point(0,0);let se,le,ae;const ce=(Y,ie,fe,ge,Ee)=>{const Me=[[ge?fe:Y,ge?Y:fe,0],[ge?fe:ie,ge?ie:fe,0]],Ce=Ee<0?s.EXTENT+Ee:Ee,Ne=[ge?Ce:(Y+ie)/2,ge?(Y+ie)/2:Ce,0];return fe===0&&Ee<0||fe!==0&&Ee>0?T.getForTilePoints(ae,[Ne],!0,le):Me.push(Ne),T.getForTilePoints(f,Me,!0,se),Math.max(Me[0][2],Me[1][2],Ne[2])/T.exaggeration()};for(let Y=0;Y<4;Y++){const ie=(Y<2?1:5)-Y,fe=x.borders[Y];if(fe.length===0)continue;const ge=ae=I[Y](f),Ee=R(ge);if(!(Ee&&Ee instanceof s.FillExtrusionBucket&&Ee.enableTerrain)||x.borderDoneWithNeighborZ[Y]===Ee.canonical.z&&Ee.borderDoneWithNeighborZ[ie]===x.canonical.z||(le=T.findDEMTileFor(ge),!le||!le.dem))continue;if(!se){const De=T.findDEMTileFor(f);if(!De||!De.dem)return;se=De}const Me=Ee.borders[ie];let Ce=0;const Ne=Ee.borderDoneWithNeighborZ[ie]!==x.canonical.z;if(x.canonical.z===Ee.canonical.z){for(let De=0;De<fe.length;De++){const Ue=x.featuresOnBorder[fe[De]],ft=Ue.borders[Y];let ze;for(;Ce<Me.length&&(ze=Ee.featuresOnBorder[Me[Ce]],!(ze.borders[ie][1]>ft[0]+3));)Ne&&Ee.encodeCentroid(void 0,ze,!1),Ce++;if(ze&&Ce<Me.length){const tt=Ce;let $e=0;for(;!(ze.borders[ie][0]>ft[1]-3)&&($e++,++Ce!==Me.length);)ze=Ee.featuresOnBorder[Me[Ce]];if(ze=Ee.featuresOnBorder[Me[tt]],Ue.intersectsCount()>1||ze.intersectsCount()>1||$e!==1){$e!==1&&(Ce=tt),x.encodeCentroid(void 0,Ue,!1),Ne&&Ee.encodeCentroid(void 0,ze,!1);continue}const ht=X[Y](Ue,ze),Be=Y%2?s.EXTENT-1:0;te.x=ce(ht[0],Math.min(s.EXTENT-1,ht[1]),Be,Y<2,ht[2]),te.y=0,x.encodeCentroid(te,Ue,!1),Ne&&Ee.encodeCentroid(te,ze,!1)}else x.encodeCentroid(void 0,Ue,!1)}x.borderDoneWithNeighborZ[Y]=Ee.canonical.z,x.needsCentroidUpdate=!0,Ne&&(Ee.borderDoneWithNeighborZ[ie]=x.canonical.z,Ee.needsCentroidUpdate=!0)}else{for(const De of fe)x.encodeCentroid(void 0,x.featuresOnBorder[De],!1);if(Ne){for(const De of Me)Ee.encodeCentroid(void 0,Ee.featuresOnBorder[De],!1);Ee.borderDoneWithNeighborZ[ie]=x.canonical.z,Ee.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[Y]=Ee.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(y)}const Lc=new s.Color(1,0,0,1),Rb=new s.Color(0,1,0,1),Nb=new s.Color(0,0,1,1),jb=new s.Color(1,0,1,1),Lb=new s.Color(0,1,1,1);function Ob(y,c,f){const x=y.context,S=y.transform,T=x.gl,I=S.projection.name==="globe",R=I?["PROJECTION_GLOBE_VIEW"]:null;let O=f.projMatrix;if(I&&s.globeToMercatorTransition(S.zoom)>0){const Ue=s.transitionTileAABBinECEF(f.canonical,S),ft=s.globeDenormalizeECEF(Ue);O=s.multiply(new Float32Array(16),S.globeMatrix,ft),s.multiply(O,S.projMatrix,O)}const G=y.useProgram("debug",null,R),W=c.getTileByID(f.key);y.terrain&&y.terrain.setupElevationDraw(W,G);const X=s.DepthMode.disabled,te=s.StencilMode.disabled,se=y.colorModeForRenderPass(),le="$debug";x.activeTexture.set(T.TEXTURE0),y.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),I?W._makeGlobeTileDebugBuffers(y.context,S):W._makeDebugTileBoundsBuffers(y.context,S.projection);const ae=W._tileDebugBuffer||y.debugBuffer,ce=W._tileDebugIndexBuffer||y.debugIndexBuffer,Y=W._tileDebugSegments||y.debugSegments;G.draw(x,T.LINE_STRIP,X,te,se,s.CullFaceMode.disabled,Yh(O,s.Color.red),le,ae,ce,Y,null,null,null,[W._globeTileDebugBorderBuffer]);const ie=W.latestRawTileData,fe=Math.floor((ie&&ie.byteLength||0)/1024),ge=c.getTile(f).tileSize,Ee=512/Math.min(ge,512)*(f.overscaledZ/S.zoom)*.5;let Me=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Me+=` => ${f.overscaledZ}`),Me+=` ${fe}kb`,function(Ue,ft){Ue.initDebugOverlayCanvas();const ze=Ue.debugOverlayCanvas,tt=Ue.context.gl,$e=Ue.debugOverlayCanvas.getContext("2d");$e.clearRect(0,0,ze.width,ze.height),$e.shadowColor="white",$e.shadowBlur=2,$e.lineWidth=1.5,$e.strokeStyle="white",$e.textBaseline="top",$e.font="bold 36px Open Sans, sans-serif",$e.fillText(ft,5,5),$e.strokeText(ft,5,5),Ue.debugOverlayTexture.update(ze),Ue.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(y,Me);const Ce=W._tileDebugTextBuffer||y.debugBuffer,Ne=W._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,De=W._tileDebugTextSegments||y.debugSegments;G.draw(x,T.TRIANGLES,X,te,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Yh(O,s.Color.transparent,Ee),le,Ce,Ne,De,null,null,null,[W._globeTileDebugTextBuffer])}function Lx(y,c,f,x){Oc(y,0,c+f/2,y.transform.width,f,x)}function tf(y,c,f,x){Oc(y,c-f/2,0,f,y.transform.height,x)}function Oc(y,c,f,x,S,T){const I=y.context,R=I.gl;R.enable(R.SCISSOR_TEST),R.scissor(c*s.exported.devicePixelRatio,f*s.exported.devicePixelRatio,x*s.exported.devicePixelRatio,S*s.exported.devicePixelRatio),I.clear({color:T}),R.disable(R.SCISSOR_TEST)}const Ox=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:zx}=Ox;function wa(y,c,f,x){y.emplaceBack(c,f,x)}class rf{constructor(c){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,wa(this.vertexArray,-1,-1,1),wa(this.vertexArray,1,-1,1),wa(this.vertexArray,-1,1,1),wa(this.vertexArray,1,1,1),wa(this.vertexArray,-1,-1,-1),wa(this.vertexArray,1,-1,-1),wa(this.vertexArray,-1,1,-1),wa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,zx),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function $s(y,c,f,x,S,T){const I=y.gl,R=c.paint.get("sky-atmosphere-color"),O=c.paint.get("sky-atmosphere-halo-color"),G=c.paint.get("sky-atmosphere-sun-intensity"),W=((X,te,se,le,ae)=>({u_matrix_3f:X,u_sun_direction:te,u_sun_intensity:se,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[ae.r,ae.g,ae.b,ae.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),x),S,G,R,O);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+T,c.skyboxTexture,0),f.draw(y,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,W,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Sd=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Fx{constructor(c){const f=new s.StructArrayLayout5f20;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const x=new s.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(f,Sd.members),this.indexBuffer=c.createIndexBuffer(x),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const zl={symbol:function(y,c,f,x,S){if(y.renderPass!=="translucent")return;const T=s.StencilMode.disabled,I=y.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(R,O,G,W,X,te,se){const le=O.transform,ae=X==="map",ce=te==="map";for(const Y of R){const ie=W.getTile(Y),fe=ie.getBucket(G);if(!fe||!fe.text||!fe.text.segments.get().length)continue;const ge=s.evaluateSizeForZoom(fe.textSizeData,le.zoom),Ee=kn(Y,fe.getProjection(),le),Me=le.calculatePixelsToTileUnitsMatrix(ie),Ce=Ye(Ee,ie.tileID.canonical,ce,ae,le,fe.getProjection(),Me),Ne=G.layout.get("icon-text-fit")!=="none"&&fe.hasIconData();if(ge){const De=Math.pow(2,le.zoom-ie.tileID.overscaledZ);Db(fe,ae,ce,se,s.symbolSize,le,Ce,Y,De,ge,Ne)}}}(x,y,f,c,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),S),f.paint.get("icon-opacity").constantOr(1)!==0&&Rx(y,c,f,x,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),T,I),f.paint.get("text-opacity").constantOr(1)!==0&&Rx(y,c,f,x,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),T,I),c.map.showCollisionBoxes&&(wd(y,c,f,x,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),wd(y,c,f,x,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(y,c,f,x){if(y.renderPass!=="translucent")return;const S=f.paint.get("circle-opacity"),T=f.paint.get("circle-stroke-width"),I=f.paint.get("circle-stroke-opacity"),R=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(T.constantOr(1)===0||I.constantOr(1)===0))return;const O=y.context,G=O.gl,W=y.transform,X=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),te=s.StencilMode.disabled,se=y.colorModeForRenderPass(),le=W.projection.name==="globe",ae=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],ce=[];for(let ie=0;ie<x.length;ie++){const fe=x[ie],ge=c.getTile(fe),Ee=ge.getBucket(f);if(!Ee||Ee.projection.name!==W.projection.name)continue;const Me=Ee.programConfigurations.get(f.id),Ce=$m(f);le&&Ce.push("PROJECTION_GLOBE_VIEW");const Ne=y.useProgram("circle",Me,Ce),De=Ee.layoutVertexBuffer,Ue=Ee.globeExtVertexBuffer,ft=Ee.indexBuffer,ze=W.projection.createInversionMatrix(W,fe.canonical),tt={programConfiguration:Me,program:Ne,layoutVertexBuffer:De,globeExtVertexBuffer:Ue,indexBuffer:ft,uniformValues:Vm(y,fe,ge,ze,ae,f),tile:ge};if(R){const $e=Ee.segments.get();for(const ht of $e)ce.push({segments:new s.SegmentVector([ht]),sortKey:ht.sortKey,state:tt})}else ce.push({segments:Ee.segments,sortKey:0,state:tt})}R&&ce.sort((ie,fe)=>ie.sortKey-fe.sortKey);const Y={useDepthForOcclusion:!le};for(const ie of ce){const{programConfiguration:fe,program:ge,layoutVertexBuffer:Ee,globeExtVertexBuffer:Me,indexBuffer:Ce,uniformValues:Ne,tile:De}=ie.state,Ue=ie.segments;y.terrain&&y.terrain.setupElevationDraw(De,ge,Y),y.prepareDrawProgram(O,ge,De.tileID.toUnwrapped()),ge.draw(O,G.TRIANGLES,X,te,se,s.CullFaceMode.disabled,Ne,f.id,Ee,Ce,Ue,f.paint,W.zoom,fe,[Me])}},heatmap:function(y,c,f,x){if(f.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const S=y.context,T=S.gl,I=s.StencilMode.disabled,R=new s.ColorMode([T.ONE,T.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(se,le,ae,ce){const Y=se.gl,ie=le.width*ce,fe=le.height*ce;se.activeTexture.set(Y.TEXTURE1),se.viewport.set([0,0,ie,fe]);let ge=ae.heatmapFbo;if(!ge||ge&&(ge.width!==ie||ge.height!==fe)){ge&&ge.destroy();const Ee=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,Ee),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ge=ae.heatmapFbo=se.createFramebuffer(ie,fe,!1),function(Me,Ce,Ne,De,Ue,ft){const ze=Me.gl;ze.texImage2D(ze.TEXTURE_2D,0,Me.isWebGL2&&Me.extRenderToTextureHalfFloat?ze.RGBA16F:ze.RGBA,Ue,ft,0,ze.RGBA,Me.extRenderToTextureHalfFloat?Me.isWebGL2?ze.HALF_FLOAT:Me.extTextureHalfFloat.HALF_FLOAT_OES:ze.UNSIGNED_BYTE,null),De.colorAttachment.set(Ne)}(se,0,Ee,ge,ie,fe)}else Y.bindTexture(Y.TEXTURE_2D,ge.colorAttachment.get()),se.bindFramebuffer.set(ge.framebuffer)})(S,y,f,y.transform.projection.name==="globe"?.5:.25),S.clear({color:s.Color.transparent});const O=y.transform,G=O.projection.name==="globe",W=G?["PROJECTION_GLOBE_VIEW"]:null,X=G?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,te=[s.mercatorXfromLng(O.center.lng),s.mercatorYfromLat(O.center.lat)];for(let se=0;se<x.length;se++){const le=x[se];if(c.hasRenderableParent(le))continue;const ae=c.getTile(le),ce=ae.getBucket(f);if(!ce||ce.projection.name!==O.projection.name)continue;const Y=ce.programConfigurations.get(f.id),ie=y.useProgram("heatmap",Y,W),{zoom:fe}=y.transform;y.terrain&&y.terrain.setupElevationDraw(ae,ie),y.prepareDrawProgram(S,ie,le.toUnwrapped());const ge=O.projection.createInversionMatrix(O,le.canonical);ie.draw(S,T.TRIANGLES,s.DepthMode.disabled,I,R,X,Ax(y,le,ae,ge,te,fe,f.paint.get("heatmap-intensity")),f.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,f.paint,y.transform.zoom,Y,G?[ce.globeExtVertexBuffer]:null)}S.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(S,T){const I=S.context,R=I.gl,O=T.heatmapFbo;if(!O)return;I.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,O.colorAttachment.get()),I.activeTexture.set(R.TEXTURE1);let G=T.colorRampTexture;G||(G=T.colorRampTexture=new s.Texture(I,T.colorRamp,R.RGBA)),G.bind(R.LINEAR,R.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(I,R.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,S.colorModeForRenderPass(),s.CullFaceMode.disabled,((W,X,te,se)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,T),T.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,T.paint,S.transform.zoom)}(y,f))},line:function(y,c,f,x){if(y.renderPass!=="translucent")return;const S=f.paint.get("line-opacity"),T=f.paint.get("line-width");if(S.constantOr(1)===0||T.constantOr(1)===0)return;const I=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),R=y.colorModeForRenderPass(),O=y.terrain&&y.terrain.renderingToTexture?1:s.exported.devicePixelRatio,G=f.paint.get("line-dasharray"),W=G.constantOr(1),X=f.layout.get("line-cap"),te=f.paint.get("line-pattern"),se=te.constantOr(1),le=f.paint.get("line-gradient"),ae=se?"linePattern":"line",ce=y.context,Y=ce.gl,ie=(ge=>{const Ee=[];_d(ge)&&Ee.push("RENDER_LINE_DASH"),ge.paint.get("line-gradient")&&Ee.push("RENDER_LINE_GRADIENT");const Me=ge.paint.get("line-trim-offset");Me[0]===0&&Me[1]===0||Ee.push("RENDER_LINE_TRIM_OFFSET");const Ce=ge.paint.get("line-pattern").constantOr(1),Ne=ge.paint.get("line-opacity").constantOr(1)!==1;return!Ce&&Ne&&Ee.push("RENDER_LINE_ALPHA_DISCARD"),Ee})(f);let fe=ie.includes("RENDER_LINE_ALPHA_DISCARD");y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(fe=!1);for(const ge of x){const Ee=c.getTile(ge);if(se&&!Ee.patternsLoaded())continue;const Me=Ee.getBucket(f);if(!Me)continue;y.prepareDrawTile();const Ce=Me.programConfigurations.get(f.id),Ne=y.useProgram(ae,Ce,ie),De=te.constantOr(null);if(De&&Ee.imageAtlas){const et=Ee.imageAtlas.patternPositions[De.toString()];et&&Ce.setConstantPatternPositions(et)}const Ue=G.constantOr(null),ft=X.constantOr(null);if(!se&&Ue&&ft&&Ee.lineAtlas){const et=Ee.lineAtlas.getDash(Ue,ft);et&&Ce.setConstantPatternPositions(et)}let[ze,tt]=f.paint.get("line-trim-offset");(ft==="round"||ft==="square")&&ze!==tt&&(ze===0&&(ze-=1),tt===1&&(tt+=1));const $e=y.terrain?ge.projMatrix:null,ht=se?xd(y,Ee,f,$e,O):Ab(y,Ee,f,$e,Me.lineClipsArray.length,O,[ze,tt]);if(le){const et=Me.gradients[f.id];let mt=et.texture;if(f.gradientVersion!==et.version){let at=256;if(f.stepInterpolant){const gt=c.getSource().maxzoom,Yt=ge.canonical.z===gt?Math.ceil(1<<y.transform.maxZoom-ge.canonical.z):1;at=s.clamp(s.nextPowerOfTwo(Me.maxLineLength/s.EXTENT*1024*Yt),256,ce.maxTextureSize)}et.gradient=s.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:at,image:et.gradient||void 0,clips:Me.lineClipsArray}),et.texture?et.texture.update(et.gradient):et.texture=new s.Texture(ce,et.gradient,Y.RGBA),et.version=f.gradientVersion,mt=et.texture}ce.activeTexture.set(Y.TEXTURE1),mt.bind(f.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}W&&(ce.activeTexture.set(Y.TEXTURE0),Ee.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),Ce.updatePaintBuffers()),se&&(ce.activeTexture.set(Y.TEXTURE0),Ee.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Ce.updatePaintBuffers()),y.prepareDrawProgram(ce,Ne,ge.toUnwrapped());const Be=et=>{Ne.draw(ce,Y.TRIANGLES,I,et,R,s.CullFaceMode.disabled,ht,f.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,f.paint,y.transform.zoom,Ce,[Me.layoutVertexBuffer2])};if(fe){const et=y.stencilModeForClipping(ge).ref;et===0&&y.terrain&&ce.clear({stencil:0});const mt={func:Y.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Be(new s.StencilMode(mt,et,255,Y.KEEP,Y.KEEP,Y.INVERT)),ht.u_alpha_discard_threshold=0,Be(new s.StencilMode(mt,et,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Be(y.stencilModeForClipping(ge))}fe&&(y.resetStencilClippingMasks(),y.terrain&&ce.clear({stencil:0}))},fill:function(y,c,f,x){const S=f.paint.get("fill-color"),T=f.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const I=y.colorModeForRenderPass(),R=f.paint.get("fill-pattern"),O=y.opaquePassEnabledForLayer()&&!R.constantOr(1)&&S.constantOr(s.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===O){const G=y.depthModeForSublayer(1,y.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Nx(y,c,f,x,G,I,!1)}if(y.renderPass==="translucent"&&f.paint.get("fill-antialias")){const G=y.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Nx(y,c,f,x,G,I,!0)}},"fill-extrusion":function(y,c,f,x){const S=f.paint.get("fill-extrusion-opacity");if(S!==0&&y.renderPass==="translucent"){const T=new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);if(S!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))ef(y,c,f,x,T,s.StencilMode.disabled,s.ColorMode.disabled),ef(y,c,f,x,T,y.stencilModeFor3D(),y.colorModeForRenderPass()),y.resetStencilClippingMasks();else{const I=y.colorModeForRenderPass();ef(y,c,f,x,T,s.StencilMode.disabled,I)}}},hillshade:function(y,c,f,x){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const S=y.context,T=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=y.colorModeForRenderPass(),R=y.terrain&&y.terrain.renderingToTexture,[O,G]=y.renderPass!=="translucent"||R?[{},x]:y.stencilConfigForOverlap(x);for(const W of G){const X=c.getTile(W);if(X.needsHillshadePrepare&&y.renderPass==="offscreen")Tx(y,X,f,T,s.StencilMode.disabled,I);else if(y.renderPass==="translucent"){const te=R&&y.terrain?y.terrain.stencilModeForRTTOverlap(W):O[W.overscaledZ];Ex(y,W,X,f,T,te,I)}}S.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,c,f,x,S,T){if(y.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!x.length)return;const I=y.context,R=I.gl,O=c.getSource(),G=y.useProgram("raster"),W=y.colorModeForRenderPass(),X=y.terrain&&y.terrain.renderingToTexture,[te,se]=O instanceof Mr||X?[{},x]:y.stencilConfigForOverlap(x),le=se[se.length-1].overscaledZ,ae=!y.options.moving;for(const ce of se){const Y=X?s.DepthMode.disabled:y.depthModeForSublayer(ce.overscaledZ-le,f.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,R.LESS),ie=ce.toUnwrapped(),fe=c.getTile(ce);if(X&&(!fe||!fe.hasData()))continue;const ge=X?ce.projMatrix:y.transform.calculateProjMatrix(ie,ae),Ee=y.terrain&&X?y.terrain.stencilModeForRTTOverlap(ce):te[ce.overscaledZ],Me=T?0:f.paint.get("raster-fade-duration");fe.registerFadeDuration(Me);const Ce=c.findLoadedParent(ce,0),Ne=Om(fe,Ce,c,y.transform,Me);let De,Ue;y.terrain&&y.terrain.prepareDrawTile();const ft=f.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;I.activeTexture.set(R.TEXTURE0),fe.texture.bind(ft,R.CLAMP_TO_EDGE),I.activeTexture.set(R.TEXTURE1),Ce?(Ce.texture.bind(ft,R.CLAMP_TO_EDGE),De=Math.pow(2,Ce.tileID.overscaledZ-fe.tileID.overscaledZ),Ue=[fe.tileID.canonical.x*De%1,fe.tileID.canonical.y*De%1]):fe.texture.bind(ft,R.CLAMP_TO_EDGE),fe.texture.useMipmap&&I.extTextureFilterAnisotropic&&y.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const ze=Hm(ge,Ue||[0,0],De||1,Ne,f,O instanceof Mr?O.perspectiveTransform:[0,0]);if(y.prepareDrawProgram(I,G,ie),O instanceof Mr)O.boundsBuffer&&O.boundsSegments&&G.draw(I,R.TRIANGLES,Y,s.StencilMode.disabled,W,s.CullFaceMode.disabled,ze,f.id,O.boundsBuffer,y.quadTriangleIndexBuffer,O.boundsSegments);else{const{tileBoundsBuffer:tt,tileBoundsIndexBuffer:$e,tileBoundsSegments:ht}=y.getTileBoundsBuffers(fe);G.draw(I,R.TRIANGLES,Y,Ee,W,s.CullFaceMode.disabled,ze,f.id,tt,$e,ht)}}y.resetStencilClippingMasks()},background:function(y,c,f,x){const S=f.paint.get("background-color"),T=f.paint.get("background-opacity");if(T===0)return;const I=y.context,R=I.gl,O=y.transform,G=O.tileSize,W=f.paint.get("background-pattern");if(y.isPatternMissing(W))return;const X=!W&&S.a===1&&T===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==X)return;const te=s.StencilMode.disabled,se=y.depthModeForSublayer(0,X==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),le=y.colorModeForRenderPass(),ae=y.useProgram(W?"backgroundPattern":"background");let ce,Y=x;Y||(ce=y.getBackgroundTiles(),Y=Object.values(ce).map(ie=>ie.tileID)),W&&(I.activeTexture.set(R.TEXTURE0),y.imageManager.bind(y.context));for(const ie of Y){const fe=ie.toUnwrapped(),ge=x?ie.projMatrix:y.transform.calculateProjMatrix(fe);y.prepareDrawTile();const Ee=c?c.getTile(ie):ce?ce[ie.key]:new s.Tile(ie,G,O.zoom,y),Me=W?Ib(ge,T,y,W,{tileID:ie,tileSize:G}):Zm(ge,T,S);y.prepareDrawProgram(I,ae,fe);const{tileBoundsBuffer:Ce,tileBoundsIndexBuffer:Ne,tileBoundsSegments:De}=y.getTileBoundsBuffers(Ee);ae.draw(I,R.TRIANGLES,se,te,le,s.CullFaceMode.disabled,Me,f.id,Ce,Ne,De)}},sky:function(y,c,f){const x=y.transform,S=x.projection.name==="mercator"||x.projection.name==="globe"?1:s.smoothstep(7,8,x.zoom),T=f.paint.get("sky-opacity")*S;if(T===0)return;const I=y.context,R=f.paint.get("sky-type"),O=new s.DepthMode(I.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),G=y.frameCounter/1e3%1;R==="atmosphere"?y.renderPass==="offscreen"?f.needsSkyboxCapture(y)&&(function(W,X,te,se){const le=W.context,ae=le.gl;let ce=X.skyboxFbo;if(!ce){ce=X.skyboxFbo=le.createFramebuffer(32,32,!1),X.skyboxGeometry=new rf(le),X.skyboxTexture=le.gl.createTexture(),ae.bindTexture(ae.TEXTURE_CUBE_MAP,X.skyboxTexture),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_MAG_FILTER,ae.LINEAR);for(let ge=0;ge<6;++ge)ae.texImage2D(ae.TEXTURE_CUBE_MAP_POSITIVE_X+ge,0,ae.RGBA,32,32,0,ae.RGBA,ae.UNSIGNED_BYTE,null)}le.bindFramebuffer.set(ce.framebuffer),le.viewport.set([0,0,32,32]);const Y=X.getCenter(W,!0),ie=W.useProgram("skyboxCapture"),fe=new Float64Array(16);s.identity(fe),s.rotateY(fe,fe,.5*-Math.PI),$s(le,X,ie,fe,Y,0),s.identity(fe),s.rotateY(fe,fe,.5*Math.PI),$s(le,X,ie,fe,Y,1),s.identity(fe),s.rotateX(fe,fe,.5*-Math.PI),$s(le,X,ie,fe,Y,2),s.identity(fe),s.rotateX(fe,fe,.5*Math.PI),$s(le,X,ie,fe,Y,3),s.identity(fe),$s(le,X,ie,fe,Y,4),s.identity(fe),s.rotateY(fe,fe,Math.PI),$s(le,X,ie,fe,Y,5),le.viewport.set([0,0,W.width,W.height])}(y,f),f.markSkyboxValid(y)):y.renderPass==="sky"&&function(W,X,te,se,le){const ae=W.context,ce=ae.gl,Y=W.transform,ie=W.useProgram("skybox");ae.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,X.skyboxTexture);const fe=((ge,Ee,Me,Ce,Ne)=>({u_matrix:ge,u_sun_direction:Ee,u_cubemap:0,u_opacity:Ce,u_temporal_offset:Ne}))(Y.skyboxMatrix,X.getCenter(W,!1),0,se,le);W.prepareDrawProgram(ae,ie),ie.draw(ae,ce.TRIANGLES,te,s.StencilMode.disabled,W.colorModeForRenderPass(),s.CullFaceMode.backCW,fe,"skybox",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(y,f,O,T,G):R==="gradient"&&y.renderPass==="sky"&&function(W,X,te,se,le){const ae=W.context,ce=ae.gl,Y=W.transform,ie=W.useProgram("skyboxGradient");X.skyboxGeometry||(X.skyboxGeometry=new rf(ae)),ae.activeTexture.set(ce.TEXTURE0);let fe=X.colorRampTexture;fe||(fe=X.colorRampTexture=new s.Texture(ae,X.colorRamp,ce.RGBA)),fe.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const ge=((Ee,Me,Ce,Ne,De)=>({u_matrix:Ee,u_color_ramp:0,u_center_direction:Me,u_radius:s.degToRad(Ce),u_opacity:Ne,u_temporal_offset:De}))(Y.skyboxMatrix,X.getCenter(W,!1),X.paint.get("sky-gradient-radius"),se,le);W.prepareDrawProgram(ae,ie),ie.draw(ae,ce.TRIANGLES,te,s.StencilMode.disabled,W.colorModeForRenderPass(),s.CullFaceMode.backCW,ge,"skyboxGradient",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(y,f,O,T,G)},debug:function(y,c,f){for(let x=0;x<f.length;x++)Ob(y,c,f[x])},custom:function(y,c,f,x){const S=y.context,T=f.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&f.isLayerDraped()){if(y.renderPass==="offscreen"){const I=T.prerender;if(I){if(y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const R=y.transform.pointMerc;I.call(T,S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(y.transform.zoom),[R.x,R.y],y.transform.pixelsPerMeterRatio)}else I.call(T,S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const R=T.renderToTile;if(R){const O=x[0].canonical,G=new s.MercatorCoordinate(O.x+x[0].wrap*(1<<O.z),O.y,O.z);S.setDepthMode(s.DepthMode.disabled),S.setStencilMode(s.StencilMode.disabled),S.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),R.call(T,S.gl,G),S.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),S.setStencilMode(s.StencilMode.disabled);const I=T.renderingMode==="3d"?new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(S.setDepthMode(I),y.transform.projection.name==="globe"){const R=y.transform.pointMerc;T.render(S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(y.transform.zoom),[R.x,R.y],y.transform.pixelsPerMeterRatio)}else T.render(S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState(),S.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class zc{constructor(c,f,x=!1){this.context=new bt(c,x),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,f){const x=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Fm(this,c));const S=this._terrain;this.transform.elevation=x?S:null,S.update(c,this.transform,f)}_updateFog(c){const f=c.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,S]=f.getFovAdjustedRange(this.transform._fov);if(x>S)return void(this.transform.fogCullDistSq=null);const T=x+.78*(S-x);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,f){if(this.width=c*s.exported.devicePixelRatio,this.height=f*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const c=this.context,f=new s.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(f,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const x=new s.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(s.EXTENT,0),x.emplaceBack(0,s.EXTENT),x.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=c.createVertexBuffer(x,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const S=new s.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(S,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const T=new s.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(s.EXTENT,0,s.EXTENT,0),T.emplaceBack(0,s.EXTENT,0,s.EXTENT),T.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(T,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const I=new s.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(I);const R=new s.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])R.emplaceBack(G);this.debugIndexBuffer=c.createIndexBuffer(R),this.emptyTexture=new s.Texture(c,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=s.create();const O=this.context.gl;this.stencilClearMode=new s.StencilMode({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new Fx(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,f=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,f.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,yd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,f,x){if(!f||this.currentStencilSource===f.id||!c.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(const O of x)if(this._tileClippingMaskIDs[O.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=f.id;const S=this.context,T=S.gl;this.nextStencilID+x.length>256&&this.clearStencil(),S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of x){const O=f.getTile(R),G=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:X,tileBoundsSegments:te}=this.getTileBoundsBuffers(O);I.draw(S,T.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:T.ALWAYS,mask:0},G,255,T.KEEP,T.KEEP,T.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,yd(R.projMatrix),"$clipping",W,X,te)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,f=this.context.gl;return new s.StencilMode({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const f=this.context.gl;return new s.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(c){const f=this.context.gl,x=c.sort((I,R)=>R.overscaledZ-I.overscaledZ),S=x[x.length-1].overscaledZ,T=x[0].overscaledZ-S+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const I={};for(let R=0;R<T;R++)I[R+S]=new s.StencilMode({func:f.GEQUAL,mask:255},R+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=T,[I,x]}return[{[S]:s.StencilMode.disabled},x]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([c.CONSTANT_COLOR,c.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(c,f,x){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new s.DepthMode(x||this.context.gl.LEQUAL,f,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,f){this.style=c,this.options=f,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const x=this.style.order,S=this.style._sourceCaches;for(const G in S){const W=S[G];W.used&&W.prepare(this.context)}const T={},I={},R={};for(const G in S){const W=S[G];T[G]=W.getVisibleCoordinates(),I[G]=T[G].slice().reverse(),R[G]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<x.length;G++)if(this.style._layers[x[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(R),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of x){const W=this.style._layers[G],X=c._getLayerSourceCache(W);if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const te=X?I[X.id]:void 0;(W.type==="custom"||W.isSky()||te&&te.length)&&this.renderLayer(this,X,W,te)}this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon];const O=this.terrain;if(O&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&O.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:f.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[x[this.currentLayer]],W=c._getLayerSourceCache(G);if(G.isSky())continue;const X=W?I[W.id]:void 0;this._renderTileClippingMasks(G,W,X),this.renderLayer(this,W,G,X)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,W){const X=G.context,te=X.gl,se=G.transform,le=new s.DepthMode(te.LEQUAL,s.DepthMode.ReadOnly,[0,1]),ae=G.useProgram("globeAtmosphere",null,se.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ce=s.globeToMercatorTransition(se.zoom),Y=W.properties.get("color").toArray01(),ie=W.properties.get("high-color").toArray01(),fe=W.properties.get("space-color").toArray01PremultipliedAlpha(),ge=s.identity$1([]);s.rotateY$1(ge,ge,-s.degToRad(se._center.lng)),s.rotateX$1(ge,ge,s.degToRad(se._center.lat)),s.rotateZ$1(ge,ge,se.angle),s.rotateX$1(ge,ge,-se._pitch);const Ee=s.fromQuat(new Float32Array(16),ge),Me=s.mapValue(W.properties.get("star-intensity"),0,1,0,.25),Ce=5e-4,Ne=s.mapValue(W.properties.get("horizon-blend"),0,1,Ce,.25),De=s.globeUseCustomAntiAliasing(G,X,se)&&Ne===Ce?se.worldSize/(2*Math.PI*1.025)-1:se.globeRadius,Ue=G.frameCounter/1e3%1,ft=s.length(se.globeCenterInViewSpace),ze=Math.sqrt(Math.pow(ft,2)-Math.pow(De,2)),tt=Math.acos(ze/ft),$e=((Be,et,mt,at,gt,Yt,hr,Gt,ir,Nr,Pr,qt,Qr,on)=>({u_frustum_tl:Be,u_frustum_tr:et,u_frustum_br:mt,u_frustum_bl:at,u_horizon:gt,u_transition:Yt,u_fadeout_range:hr,u_color:Gt,u_high_color:ir,u_space_color:Nr,u_star_intensity:Pr,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:qt,u_horizon_angle:Qr,u_rotation_matrix:on}))(se.frustumCorners.TL,se.frustumCorners.TR,se.frustumCorners.BR,se.frustumCorners.BL,se.frustumCorners.horizon,ce,Ne,Y,ie,fe,Me,Ue,tt,Ee);G.prepareDrawProgram(X,ae);const ht=G.atmosphereBuffer;ht&&ae.draw(X,te.TRIANGLES,le,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,$e,"skybox",ht.vertexBuffer,ht.indexBuffer,ht.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const G=this.style._layers[x[this.currentLayer]],W=c._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,W,G,W?I[W.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const G=this.style._layers[x[this.currentLayer]],W=c._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const X=W?(G.type==="symbol"?R:I)[W.id]:void 0;this._renderTileClippingMasks(G,W,W?T[W.id]:void 0),this.renderLayer(this,W,G,X),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;s.values(this.style._layers).forEach(W=>{const X=c._getLayerSourceCache(W);X&&!W.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<X.getSource().maxzoom)&&(G=X)}),G&&this.options.showTileBoundaries&&zl.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const W=G.transform.padding;Lx(G,G.transform.height-(W.top||0),3,Lc),Lx(G,W.bottom||0,3,Rb),tf(G,W.left||0,3,Nb),tf(G,G.transform.width-(W.right||0),3,jb);const X=G.transform.centerPoint;(function(te,se,le,ae){Oc(te,se-1,le-10,2,20,ae),Oc(te,se-10,le-1,20,2,ae)})(G,X.x,G.transform.height-X.y,Lb)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(c,f,x,S){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||S&&S.length)&&(this.id=x.id,this.gpuTimingStart(x),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(x.type)||c.terrain&&x.type==="custom")&&zl[x.type](c,f,x,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let x=this.gpuTimers[c.id];x||(x=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),x.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,f=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(f),c.beginQueryEXT(c.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const f={};for(const x in c){const S=c[x],T=this.context.extTimerQuery,I=T.getQueryObjectEXT(S.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(S.query),f[x]=I}return f}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.extTimerQuery;let x=0;for(const S of c)x+=f.getQueryObjectEXT(S,f.QUERY_RESULT_EXT)/1e6,f.deleteQueryEXT(S);return x}translatePosMatrix(c,f,x,S,T){if(!x[0]&&!x[1])return c;const I=T?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(I){const G=Math.sin(I),W=Math.cos(I);x=[x[0]*W-x[1]*G,x[0]*G+x[1]*W]}const R=[T?x[0]:wt(f,x[0],this.transform.zoom),T?x[1]:wt(f,x[1],this.transform.zoom),0],O=new Float32Array(16);return s.translate(O,c,R),O}saveTileTexture(c){const f=this._tileTextures[c.size[0]];f?f.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const f=this._tileTextures[c];return f&&f.length>0?f.pop():null}isPatternMissing(c){return c===null||c!==void 0&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,f=this.terrain&&this.terrain.exaggeration()===0,x=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),f&&S.push("ZERO_EXAGGERATION"),x&&!c&&x.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),c&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(c,f,x){this.cache=this.cache||{};const S=x||[],T=this.currentGlobalDefines().concat(S),I=Ur.cacheKey(Rm[c],c,T,f);return this.cache[I]||(this.cache[I]=new Ur(this.context,c,Rm[c],f,Xm[c],T)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,f,x){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const T=S.getOpacity(this.transform.pitch),I=((R,O,G,W,X,te,se,le,ae,ce,Y)=>{const ie=R.transform,fe=O.properties.get("color").toArray01();fe[3]=W;const ge=R.frameCounter/1e3%1;return{u_fog_matrix:G?ie.calculateFogTileMatrix(G):R.identityMat,u_fog_range:O.getFovAdjustedRange(ie._fov),u_fog_color:fe,u_fog_horizon_blend:O.properties.get("horizon-blend"),u_fog_temporal_offset:ge,u_frustum_tl:X,u_frustum_tr:te,u_frustum_br:se,u_frustum_bl:le,u_globe_pos:ae,u_globe_radius:ce,u_viewport:Y,u_globe_transition:s.globeToMercatorTransition(ie.zoom),u_is_globe:+(ie.projection.name==="globe")}})(this,S,x,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);f.setFogUniformValues(c,I)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,f=c.createTexture();return c.bindTexture(c.TEXTURE_2D,f),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&c.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const c=this._backgroundTiles,f=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const S of x)f[S.key]=c[S.key]||new s.Tile(S,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class nf{constructor(c=0,f=0,x=0,S=0){if(isNaN(c)||c<0||isNaN(f)||f<0||isNaN(x)||x<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=x,this.right=S}interpolate(c,f,x){return f.top!=null&&c.top!=null&&(this.top=s.number(c.top,f.top,x)),f.bottom!=null&&c.bottom!=null&&(this.bottom=s.number(c.bottom,f.bottom,x)),f.left!=null&&c.left!=null&&(this.left=s.number(c.left,f.left,x)),f.right!=null&&c.right!=null&&(this.right=s.number(c.right,f.right,x)),this}getCenter(c,f){const x=s.clamp((this.left+c-this.right)/2,0,c),S=s.clamp((this.top+f-this.bottom)/2,0,f);return new s.Point(x,S)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new nf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function sf(y,c){const f=s.getColumn(y,3);s.fromQuat(y,c),s.setColumn(y,3,f)}function Vr(y,c){const f=s.identity$1([]);return s.rotateZ$1(f,f,-c),s.rotateX$1(f,f,-y),f}function Ed(y,c){const f=[y[0],y[1],0],x=[c[0],c[1],0];if(s.length(f)>=1e-15){const I=s.normalize([],f);s.scale$2(x,I,s.dot(x,I)),c[0]=x[0],c[1]=x[1]}const S=s.cross([],c,y);if(s.len(S)<1e-15)return null;const T=Math.atan2(-S[1],S[0]);return Vr(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),T)}class Bx{constructor(c,f){this.position=c,this.orientation=f}get position(){return this._position}set position(c){if(c){const f=c instanceof s.MercatorCoordinate?c:new s.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(f.x=s.wrap(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(c,f){if(this.orientation=null,!this.position)return;const x=this.position,S=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(c)):0,T=s.MercatorCoordinate.fromLngLat(c,S),I=[T.x-x.x,T.y-x.y,T.z-x.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=Ed(I,f)}setPitchBearing(c,f){this.orientation=Vr(s.degToRad(c),s.degToRad(-f))}}class of{constructor(c,f){this._transform=s.identity([]),this.orientation=f,this.position=c}get mercatorPosition(){const c=this.position;return new s.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=s.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var f;c&&s.setColumn(this._transform,3,[(f=c)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||s.identity$1([]),c&&sf(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,f){this._orientation=Vr(c,f),sf(this._transform,this._orientation)}forward(){const c=s.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=s.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=s.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,f){const x=new Float64Array(16);return s.invert(x,this.getWorldToCamera(c,f)),x}getWorldToCameraPosition(c,f,x){const S=this.position;s.scale$2(S,S,-c);const T=new Float64Array(16);return s.fromScaling(T,[x,x,x]),s.translate(T,T,S),T[10]*=f,T}getWorldToCamera(c,f){const x=new Float64Array(16),S=new Float64Array(4),T=this.position;return s.conjugate(S,this._orientation),s.scale$2(T,T,-c),s.fromQuat(x,S),s.translate(x,x,T),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=f,x[9]*=f,x[10]*=f,x[11]*=f,x}getCameraToClipPerspective(c,f,x,S){const T=new Float64Array(16);return s.perspective(T,c,f,x,S),T}getDistanceToElevation(c,f=!1){const x=c===0?0:s.mercatorZfromAltitude(c,f?s.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(x-this.position[2])/S[2]}clone(){return new of([...this.position],[...this.orientation])}}function Fc(y,c){const f=af(y.projection,y.zoom,y.width,y.height),x=function(T,I,R,O,G){const W=new s.LngLat(R.lng-180*ba,R.lat),X=new s.LngLat(R.lng+180*ba,R.lat),te=T.project(W.lng,W.lat),se=T.project(X.lng,X.lat),le=-Math.atan2(se.y-te.y,se.x-te.x),ae=s.MercatorCoordinate.fromLngLat(R);ae.y=s.clamp(ae.y,-1+ba,1-ba);const ce=ae.toLngLat(),Y=T.project(ce.lng,ce.lat),ie=s.MercatorCoordinate.fromLngLat(ce);ie.x+=ba;const fe=ie.toLngLat(),ge=T.project(fe.lng,fe.lat),Ee=lf(ge.x-Y.x,ge.y-Y.y,le),Me=s.MercatorCoordinate.fromLngLat(ce);Me.y+=ba;const Ce=Me.toLngLat(),Ne=T.project(Ce.lng,Ce.lat),De=lf(Ne.x-Y.x,Ne.y-Y.y,le),Ue=Math.abs(Ee.x)/Math.abs(De.y),ft=s.identity([]);s.rotateZ(ft,ft,-le*(1-(G?0:O)));const ze=s.identity([]);return s.scale(ze,ze,[1,1-(1-Ue)*O,1]),ze[4]=-De.x/De.y*O,s.rotateZ(ze,ze,le),s.multiply(ze,ft,ze),ze}(y.projection,0,y.center,f,c),S=Ux(y);return s.scale(x,x,[S,S,1]),x}function Ux(y){const c=y.projection,f=af(y.projection,y.zoom,y.width,y.height),x=Vx(c,y.center),S=Vx(c,s.LngLat.convert(c.center));return Math.pow(2,x*f+(1-f)*S)}function af(y,c,f,x,S=1/0){const T=y.range;if(!T)return 0;const I=Math.min(S,Math.max(f,x)),R=Math.log(I/1024)/Math.LN2;return s.smoothstep(T[0]+R,T[1]+R,c)}const ba=1/4e4;function Vx(y,c){const f=s.clamp(c.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),x=new s.LngLat(c.lng-180*ba,f),S=new s.LngLat(c.lng+180*ba,f),T=y.project(x.lng,f),I=y.project(S.lng,f),R=s.MercatorCoordinate.fromLngLat(x),O=s.MercatorCoordinate.fromLngLat(S),G=I.x-T.x,W=I.y-T.y,X=O.x-R.x,te=O.y-R.y,se=Math.sqrt((X*X+te*te)/(G*G+W*W));return Math.log(se)/Math.LN2}function lf(y,c,f){const x=Math.cos(f),S=Math.sin(f);return{x:y*x-c*S,y:y*S+c*x}}class Bc{constructor(c,f,x,S,T,I,R){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=x??0,this._maxPitch=S??60,this.setProjection(I),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new nf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new of,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new Bc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,f=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(c||x)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const x=!_(f,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const f=c!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const f=-c*Math.PI/180;var x;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(x=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),function(S,T,I){var R=T[0],O=T[1],G=T[2],W=T[3],X=Math.sin(I),te=Math.cos(I);S[0]=R*te+G*X,S[1]=O*te+W*X,S[2]=R*-X+G*te,S[3]=O*-X+W*te}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const f=s.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=s.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let S=0,T=0;for(let I=0;I<f.length;I++){const R=new s.Point(f[I][0]*this.width,x+f[I][1]*(this.height-x)),O=c.pointCoordinate(R);if(!O)continue;const G=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);S+=O[3]*G,T+=G}return T===0?NaN:S/T}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const c=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*f,S=this._mercatorZfromZoom(c),T=this._mercatorZfromZoom(this._maxZoom),I=Math.max(S-x,T);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let x;x=c.z<this._camera.position[2]?[f.x,f.y,f.z]:[c.x,c.y,c.z];const S=s.length(s.sub([],this._camera.position,x));return s.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let f=!1;if(c.orientation&&!s.exactEquals(c.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(c.orientation)),c.position){const x=[c.position.x,c.position.y,c.position.z];s.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,f=new Bx;return f.position=new s.MercatorCoordinate(c[0],c[1],c[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(c){if(!s.length$1(c))return!1;s.normalize$1(c,c);const f=s.transformQuat([],[0,0,-1],c),x=s.transformQuat([],[0,-1,0],c);if(x[2]<0)return!1;const S=Ed(f,x);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(c){const f=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;c[2]=s.clamp(c[2],S/x,S/f),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,f,x){this._unmodified=!1,this._edgeInsets.interpolate(c,f,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(c){const f=[new s.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const x=this.pointCoordinate(new s.Point(0,0)),S=this.pointCoordinate(new s.Point(this.width,0)),T=this.pointCoordinate(new s.Point(this.width,this.height)),I=this.pointCoordinate(new s.Point(0,this.height)),R=Math.floor(Math.min(x.x,S.x,T.x,I.x)),O=Math.floor(Math.max(x.x,S.x,T.x,I.x)),G=1;for(let W=R-G;W<=O+G;W++)W!==0&&f.push(new s.UnwrappedTileID(W,c))}return f}coveringTiles(c){let f=this.coveringZoomLevel(c);const x=f,S=this.elevation&&!c.isTerrainDEM,T=this.projection.name==="mercator";if(c.minzoom!==void 0&&f<c.minzoom)return[];c.maxzoom!==void 0&&f>c.maxzoom&&(f=c.maxzoom);const I=this.locationCoordinate(this.center),R=this.center.lat,O=1<<f,G=[O*I.x,O*I.y,0],W=this.projection.name==="globe",X=!W,te=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,X),se=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=O*s.mercatorZfromAltitude(1,this.center.lat),ae=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),ce=[O*se.x,O*se.y,ae*(X?1:le)],Y=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),ie=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,fe=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ge=c.isTerrainDEM?-fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ee=this.projection.isReprojectedInTileSpace?Ux(this):1,Me=Be=>{const mt=new s.MercatorCoordinate(Be.x+25e-6,Be.y,Be.z),at=new s.MercatorCoordinate(Be.x,Be.y+25e-6,Be.z),gt=Be.toLngLat(),Yt=mt.toLngLat(),hr=at.toLngLat(),Gt=this.locationCoordinate(gt),ir=this.locationCoordinate(Yt),Nr=this.locationCoordinate(hr),Pr=Math.hypot(ir.x-Gt.x,ir.y-Gt.y),qt=Math.hypot(Nr.x-Gt.x,Nr.y-Gt.y);return Math.sqrt(Pr*qt)*Ee/25e-6},Ce=Be=>{const et=fe,mt=ge;return{aabb:s.tileAABB(this,O,0,0,0,Be,mt,et,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:et,wrap:Be,fullyVisible:!1}},Ne=[];let De=[];const Ue=f,ft=c.reparseOverscaled?x:f,ze=Be=>Be*Be,tt=ze((ae-this._centerAltitude)*le),$e=Be=>{if(!this._elevation||!Be.tileID||!T)return;const et=this._elevation.getMinMaxForTile(Be.tileID),mt=Be.aabb;et?(mt.min[2]=et.min,mt.max[2]=et.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(Be.shouldSplit=ht(Be),Be.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},ht=Be=>{if(Be.zoom<ie)return!0;if(Be.zoom===Ue)return!1;if(Be.shouldSplit!=null)return Be.shouldSplit;const et=Be.aabb.distanceX(ce),mt=Be.aabb.distanceY(ce);let at=tt,gt=1;if(W){at=ze(Be.aabb.distanceZ(ce));const Gt=Math.pow(2,Be.zoom),ir=s.latFromMercatorY((Be.y+1)/Gt),Nr=s.latFromMercatorY(Be.y/Gt),Pr=Math.min(Math.max(R,ir),Nr),qt=s.circumferenceAtLatitude(Pr)/s.circumferenceAtLatitude(R);if(gt=Pr===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,qt/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&Be.zoom===Ue-1&&qt>=.9)return!0}else if(S&&(at=ze(Be.aabb.distanceZ(ce)*le)),this.projection.isReprojectedInTileSpace&&x<=5){const Gt=Math.pow(2,Be.zoom),ir=Me(new s.MercatorCoordinate((Be.x+.5)/Gt,(Be.y+.5)/Gt));gt=ir>.85?1:ir}const Yt=et*et+mt*mt+at,hr=ze((1<<Ue-Be.zoom)*Y*gt*((Gt,ir)=>{if(ir*ze(.707)<Gt)return 1;const Nr=Math.sqrt(ir/Gt);return Nr/(1.4144271570014144+(Math.pow(1.1,Nr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(at,tt),Yt));return Yt<hr};if(this.renderWorldCopies)for(let Be=1;Be<=3;Be++)Ne.push(Ce(-Be)),Ne.push(Ce(Be));for(Ne.push(Ce(0));Ne.length>0;){const Be=Ne.pop(),et=Be.x,mt=Be.y;let at=Be.fullyVisible;if(!at){const gt=Be.aabb.intersects(te);if(gt===0)continue;at=gt===2}if(Be.zoom!==Ue&&ht(Be))for(let gt=0;gt<4;gt++){const Yt=(et<<1)+gt%2,hr=(mt<<1)+(gt>>1),Gt={aabb:T?Be.aabb.quadrant(gt):s.tileAABB(this,O,Be.zoom+1,Yt,hr,Be.wrap,Be.minZ,Be.maxZ,this.projection),zoom:Be.zoom+1,x:Yt,y:hr,wrap:Be.wrap,fullyVisible:at,tileID:void 0,shouldSplit:void 0,minZ:Be.minZ,maxZ:Be.maxZ};S&&!W&&(Gt.tileID=new s.OverscaledTileID(Be.zoom+1===Ue?ft:Be.zoom+1,Be.wrap,Be.zoom+1,Yt,hr),$e(Gt)),Ne.push(Gt)}else{const gt=Be.zoom===Ue?ft:Be.zoom;if(c.minzoom&&c.minzoom>gt)continue;const Yt=G[0]-(.5+et+(Be.wrap<<Be.zoom))*(1<<f-Be.zoom),hr=G[1]-.5-mt,Gt=Be.tileID?Be.tileID:new s.OverscaledTileID(gt,Be.wrap,Be.zoom,et,mt);De.push({tileID:Gt,distanceSq:Yt*Yt+hr*hr})}}if(this.fogCullDistSq){const Be=this.fogCullDistSq,et=this.horizonLineFromTop();De=De.filter(mt=>{const at=[0,0,0,1],gt=[s.EXTENT,s.EXTENT,0,1],Yt=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());s.transformMat4$1(at,at,Yt),s.transformMat4$1(gt,gt,Yt);const hr=s.getAABBPointSquareDist(at,gt);if(hr===0)return!0;let Gt=!1;const ir=this._elevation;if(ir&&hr>Be&&et!==0){const Nr=this.calculateProjMatrix(mt.tileID.toUnwrapped());let Pr;c.isTerrainDEM||(Pr=ir.getMinMaxForTile(mt.tileID)),Pr||(Pr={min:ge,max:fe});const qt=s.furthestTileCorner(this.rotation),Qr=[qt[0]*s.EXTENT,qt[1]*s.EXTENT,Pr.max];s.transformMat4(Qr,Qr,Nr),Gt=(1-Qr[1])*this.height*.5<et}return hr<Be||Gt})}return De.sort((Be,et)=>Be.distanceSq-et.distanceSq).map(Be=>Be.tileID)}resize(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const f=s.clamp(c.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),x=this.projection.project(c.lng,f);return new s.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,f){let x,S;const T=this.centerPoint;if(this.projection.name==="globe"){const R=this.worldSize;x=(f.x-T.x)/R,S=(f.y-T.y)/R}else{const R=this.pointCoordinate(f),O=this.pointCoordinate(T);x=R.x-O.x,S=R.y-O.y}const I=this.locationCoordinate(c);this.setLocation(new s.MercatorCoordinate(I.x-x,I.y-S))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,f){const x=f?s.mercatorZfromAltitude(f,c.lat):void 0,S=this.projection.project(c.lng,c.lat);return new s.MercatorCoordinate(S.x,S.y,x)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,f){const x=f??this._centerAltitude,S=[c.x,c.y,0,1],T=[c.x,c.y,1,1];s.transformMat4$1(S,S,this.pixelMatrixInverse),s.transformMat4$1(T,T,this.pixelMatrixInverse);const I=T[3];s.scale$1(S,S,1/S[3]),s.scale$1(T,T,1/I);const R=S[2],O=T[2];return{p0:S,p1:T,t:R===O?0:(x-R)/(O-R)}}screenPointToMercatorRay(c){const f=[c.x,c.y,0,1],x=[c.x,c.y,1,1];return s.transformMat4$1(f,f,this.pixelMatrixInverse),s.transformMat4$1(x,x,this.pixelMatrixInverse),s.scale$1(f,f,1/f[3]),s.scale$1(x,x,1/x[3]),f[2]=s.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,x[2]=s.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,s.scale$1(f,f,1/this.worldSize),s.scale$1(x,x,1/this.worldSize),new s.Ray([f[0],f[1],f[2]],s.normalize([],s.sub([],x,f)))}rayIntersectionCoordinate(c){const{p0:f,p1:x,t:S}=c,T=s.mercatorZfromAltitude(f[2],this._center.lat),I=s.mercatorZfromAltitude(x[2],this._center.lat);return new s.MercatorCoordinate(s.number(f[0],x[0],S)/this.worldSize,s.number(f[1],x[1],S)/this.worldSize,s.number(T,I,S))}pointCoordinate(c,f=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,f)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let f=this.projection.pointCoordinate3D(this,c.x,c.y);if(f)return new s.MercatorCoordinate(f[0],f[1],f[2]);let x=0,S=this.horizonLineFromTop();if(c.y>S)return this.pointCoordinate(c);const T=.02*S,I=c.clone();for(let R=0;R<10&&S-x>T;R++){I.y=s.number(x,S,.66);const O=this.projection.pointCoordinate3D(this,I.x,I.y);O?(S=I.y,f=O):x=I.y}return f?new s.MercatorCoordinate(f[0],f[1],f[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(c);const f=this.pointCoordinate(c);return f.y>=0&&f.y<=1}_coordinatePoint(c,f){const x=f&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,S=[c.x*this.worldSize,c.y*this.worldSize,x+c.toAltitude(),1];return s.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new s.Point(S[0]/S[3],S[1]/S[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:f}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,T=this.pointLocation3D(new s.Point(f,c)),I=this.pointLocation3D(new s.Point(S,c)),R=this.pointLocation3D(new s.Point(S,x)),O=this.pointLocation3D(new s.Point(f,x));let G=Math.min(T.lng,I.lng,R.lng,O.lng),W=Math.max(T.lng,I.lng,R.lng,O.lng),X=Math.min(T.lat,I.lat,R.lat,O.lat),te=Math.max(T.lat,I.lat,R.lat,O.lat);const se=Math.pow(2,-this.zoom)/16*270,le=this.projection.name==="globe"?1:4,ae=(ce,Y,ie,fe,ge)=>{const Ee=(ce+ie)/2,Me=(Y+fe)/2,Ce=new s.Point(Ee,Me),{lng:Ne,lat:De}=this.pointLocation3D(Ce),Ue=Math.max(0,G-Ne,X-De,Ne-W,De-te);G=Math.min(G,Ne),W=Math.max(W,Ne),X=Math.min(X,De),te=Math.max(te,De),(ge<le||Ue>se)&&(ae(ce,Y,Ee,Me,ge+1),ae(Ee,Me,ie,fe,ge+1))};if(ae(f,c,S,c,1),ae(S,c,S,x,1),ae(S,x,f,x,1),ae(f,x,f,c,1),this.projection.name==="globe"){const[ce,Y]=s.polesInViewport(this);ce?(te=90,W=180,G=-180):Y&&(X=-90,W=180,G=-180)}return new s.LngLatBounds(new s.LngLat(G,X),new s.LngLat(W,te))}_getBoundsRectangular(c,f){const{top:x,left:S}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,R=new s.Point(S,x),O=new s.Point(I,x),G=new s.Point(I,T),W=new s.Point(S,T);let X=this.pointCoordinate(R,c),te=this.pointCoordinate(O,c);const se=this.pointCoordinate(G,f),le=this.pointCoordinate(W,f),ae=(ce,Y)=>(Y.y-ce.y)/(Y.x-ce.x);return X.y>1&&te.y>=0?X=new s.MercatorCoordinate((1-le.y)/ae(le,X)+le.x,1):X.y<0&&te.y<=1&&(X=new s.MercatorCoordinate(-le.y/ae(le,X)+le.x,0)),te.y>1&&X.y>=0?te=new s.MercatorCoordinate((1-se.y)/ae(se,te)+se.x,1):te.y<0&&X.y<=1&&(te=new s.MercatorCoordinate(-se.y/ae(se,te)+se.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(se))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=c.visibleDemTiles.reduce((x,S)=>{if(S.dem){const T=S.dem.tree;x.min=Math.min(x.min,T.minimums[0]),x.max=Math.max(x.max,T.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*c.exaggeration(),f.max*c.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-f*(1-this._horizonShift);return c?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,f){return this.projection.createTileMatrix(this,f,c)}calculateDistanceTileData(c){const f=c.key,x=this._distanceTileDataCache;if(x[f])return x[f];const S=c.canonical,T=1/this.height,I=this.cameraWorldSize,R=I/this.zoomScale(S.z),O=(S.x+Math.pow(2,S.z)*c.wrap)*R,G=S.y*R,W=this.point;W.x*=I/this.worldSize,W.y*=I/this.worldSize;const X=this.angle,te=Math.sin(-X),se=-Math.cos(-X);return x[f]={bearing:[te,se],center:[(W.x-O)*T,(W.y-G)*T],scale:R/s.EXTENT*T},x[f]}calculateFogTileMatrix(c){const f=c.key,x=this._fogTileMatrixCache;if(x[f])return x[f];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return s.multiply(S,this.worldToFogMatrix,S),x[f]=new Float32Array(S),x[f]}calculateProjMatrix(c,f=!1){const x=c.key,S=f?this._alignedProjMatrixCache:this._projMatrixCache;if(S[x])return S[x];const T=this.calculatePosMatrix(c,this.worldSize);return s.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,T),S[x]=new Float32Array(T),S[x]}calculatePixelsToTileUnitsMatrix(c){const f=c.tileID.key,x=this._pixelsToTileUnitsCache;if(x[f])return x[f];const S=function(T,I){const{scale:R}=T.tileTransform,O=R*s.EXTENT/(T.tileSize*Math.pow(2,I.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return G=new Float32Array(4),te=(W=I.inverseAdjustmentMatrix)[1],se=W[2],le=W[3],ce=(X=[O,O])[1],G[0]=W[0]*(ae=X[0]),G[1]=te*ae,G[2]=se*ce,G[3]=le*ce,G;var G,W,X,te,se,le,ae,ce}(c,this);return x[f]=S,x[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const c=1/this.worldSize,f=s.fromScaling([],[c,c,c]);return s.multiply(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const c=this._elevation;this._updateCameraState();const f=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(f),S=this._camera.forward(),T=s.mercatorZfromAltitude(1,this._center.lat);x[2]/=T,S[2]/=T,s.normalize(S,S);const I=c.raycast(x,S,c.exaggeration());if(I){const R=s.scaleAndAdd([],x,S,I),O=new s.MercatorCoordinate(R[0],R[1],s.mercatorZfromAltitude(R[2],s.latFromMercatorY(R[1]))),G=(O.z+s.length([O.x-x[0],O.y-x[1],O.z-x[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const f=this._elevation,x=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(x),T=f.getAtPointOrZero(new s.MercatorCoordinate(...S)),I=this.pixelsPerMeter/this.worldSize*T,R=this._minimumHeightOverTerrain(),O=S[2]-I;if(O<=R)if(O<0||c){const G=this.locationCoordinate(this._center,this._centerAltitude),W=[S[0],S[1],G.z-S[2]],X=s.length(W);W[2]-=(R-O)/this._pixelsPerMercatorPixel;const te=s.length(W);if(te===0)return;s.scale$2(W,W,X/te*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],G.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const te=this.center;return te.lat=s.clamp(te.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(te.lng=s.clamp(te.lng,this.minLng,this.maxLng)),this.center=te,void(this._constraining=!1)}const f=this._unmodified,{x,y:S}=this.point;let T=0,I=x,R=S;const O=this.width/2,G=this.height/2,W=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(S-G<W&&(R=W+G),S+G>X&&(R=X-G),X-W<this.height&&(T=Math.max(T,this.height/(X-W)),R=(X+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const te=this.worldMinX*this.scale,se=this.worldMaxX*this.scale,le=this.worldSize/2-(te+se)/2;I=(x+le+this.worldSize)%this.worldSize-le,I-O<te&&(I=te+O),I+O>se&&(I=se-O),se-te<this.width&&(T=Math.max(T,this.width/(se-te)),I=(se+te)/2)}I===x&&R===S||(this.center=this.unproject(new s.Point(I,R))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const x=af(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?f:1,T=this._camera.getWorldToCamera(this.worldSize,S),I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);I[8]=2*-c.x/this.width,I[9]=2*c.y/this.height;let R=s.mul([],I,T);if(this.projection.isReprojectedInTileSpace){const Me=this.locationCoordinate(this.center),Ce=s.identity([]);s.translate(Ce,Ce,[Me.x*this.worldSize,Me.y*this.worldSize,0]),s.multiply(Ce,Ce,Fc(this)),s.translate(Ce,Ce,[-Me.x*this.worldSize,-Me.y*this.worldSize,0]),s.multiply(R,R,Ce),this.inverseAdjustmentMatrix=function(Ne){const De=Fc(Ne,!0);return he([],[De[0],De[1],De[4],De[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],R,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=R,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const O=s.invert([],I);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(O,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);s.identity(G),s.scale(G,G,[1,-1,1]),s.rotateX(G,G,this._pitch),s.rotateZ(G,G,this.angle);const W=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-c.x/this.width,W[9]=2*(c.y+X)/this.height,this.skyboxMatrix=s.multiply(G,W,G);const te=this.point,se=te.x,le=te.y,ae=this.width%2/2,ce=this.height%2/2,Y=Math.cos(this.angle),ie=Math.sin(this.angle),fe=se-Math.round(se)+Y*ae+ie*ce,ge=le-Math.round(le)+Y*ce+ie*ae,Ee=new Float64Array(R);if(s.translate(Ee,Ee,[fe>.5?fe-1:fe,ge>.5?ge-1:ge,0]),this.alignedProjMatrix=Ee,R=s.create(),s.scale(R,R,[this.width/2,-this.height/2,1]),s.translate(R,R,[1,-1,0]),this.labelPlaneMatrix=R,R=s.create(),s.scale(R,R,[1,-1,1]),s.translate(R,R,[-1,-1,0]),s.scale(R,R,[2/this.width,2/this.height,1]),this.glCoordMatrix=R,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},R=s.invert(new Float64Array(16),this.pixelMatrix),!R)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=R,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Me=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Me,Me,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=R;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,x=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,T=[c,c,f];s.scale$2(T,T,S),s.scale$2(x,x,-1),s.multiply$2(x,x,T);const I=s.create();s.translate(I,I,x),s.scale(I,I,T),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,f,S)}_computeCameraPosition(c){const f=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),S=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-c/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-x[0]*T,S.y/this.worldSize-x[1]*T,c/this.worldSize*this._centerAltitude-x[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],S=c[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(T=Math.min((f-x)/S,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,c,T),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,f=this._camera.forward(),{pitch:x,bearing:S}=this._camera.getPitchBearing(),T=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),R=Math.max((c[2]-T)/Math.cos(x),I),O=this._zoomFromMercatorZ(R);s.scaleAndAdd(c,c,f,R),this._pitch=s.clamp(x,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(S,-Math.PI,Math.PI),this._setZoom(s.clamp(O,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let f=0,x=s.GLOBE_ZOOM_THRESHOLD_MAX,S=0,T=1/0;for(;x-f>1e-6&&x>f;){const I=f+.5*(x-f),R=this.tileSize*Math.pow(2,I),O=this.getCameraToCenterDistance(this.projection,I,R),G=this.scaleZoom(O/(c*this.tileSize)),W=Math.abs(I-G);W<T&&(T=W,S=I),I<G?f=I:x=I}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,f){const x=Math.min(c.x,f.x),S=Math.max(c.x,f.x),T=Math.min(c.y,f.y),I=Math.max(c.y,f.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const R=[new s.Point(x,T),new s.Point(S,I),new s.Point(x,I),new s.Point(S,T)],O=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const W of R){const X=this.pointRayIntersection(W);if(X.t<0)return!0;const te=this.rayIntersectionCoordinate(X);if(te.x<O||te.y<0||te.x>G||te.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(c,f){const x=s.length(s.sub([],this._camera.position,c)),S=this._zoomFromMercatorZ(x)+f;return x-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const c=function([f,x,S],T){const I=[f,x,S,1];s.transformMat4$1(I,I,T);const R=I[3]=Math.max(I[3],1e-6);return I[0]/=R,I[1]/=R,I[2]/=R,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,c))}}getCameraToCenterDistance(c,f=this.zoom,x=this.worldSize){const S=af(c,f,this.width,this.height,1024),T=c.pixelSpaceConversion(this.center.lat,x,S);return .5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(c,c,this.globeMatrix),c}}function Uc(y,c){let f=!1,x=null;const S=()=>{x=null,f&&(y(),x=setTimeout(S,c),f=!1)};return()=>(f=!0,x||S(),x)}class Qm{constructor(c){this._hashName=c&&encodeURIComponent(c),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Uc(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,s.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const f=Td(c);if(this._hashName){const x=this._hashName;let S=!1;const T=s.window.location.hash.slice(1).split("&").map(I=>{const R=I.split("=")[0];return R===x?(S=!0,`${R}=${f}`):I}).filter(I=>I);return S||T.push(`${x}=${f}`),`#${T.join("&")}`}return`#${f}`}_getCurrentHash(){const c=s.window.location.hash.replace("#","");if(this._hashName){let f;return c.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(f=x)}),(f&&f[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(x=>isNaN(x))){const x=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(f[3]||0):c.getBearing();return c.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:x,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,c)}}function Td(y,c){const f=y.getCenter(),x=Math.round(100*y.getZoom())/100,S=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,S),I=Math.round(f.lng*T)/T,R=Math.round(f.lat*T)/T,O=y.getBearing(),G=y.getPitch();let W=c?`/${I}/${R}/${x}`:`${x}/${R}/${I}`;return(O||G)&&(W+="/"+Math.round(10*O)/10),G&&(W+=`/${Math.round(G)}`),W}const Cd={linearity:.3,easing:s.bezier(0,0,.3,1)},cf=s.extend({deceleration:2500,maxSpeed:1400},Cd),uf=s.extend({deceleration:20,maxSpeed:1400},Cd),Ft=s.extend({deceleration:1e3,maxSpeed:360},Cd),go=s.extend({deceleration:1e3,maxSpeed:90},Cd);class $x{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,f=s.exported.now();for(;c.length>0&&f-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)f.zoom+=T.zoomDelta||0,f.bearing+=T.bearingDelta||0,f.pitch+=T.pitchDelta||0,T.panDelta&&f.pan._add(T.panDelta),T.around&&(f.around=T.around),T.pinchAround&&(f.pinchAround=T.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(f.pan.mag()){const T=kd(f.pan.mag(),x,s.extend({},cf,c||{}));S.offset=f.pan.mult(T.amount/f.pan.mag()),S.center=this._map.transform.center,Md(S,T)}if(f.zoom){const T=kd(f.zoom,x,uf);S.zoom=this._map.transform.zoom+T.amount,Md(S,T)}if(f.bearing){const T=kd(f.bearing,x,Ft);S.bearing=this._map.transform.bearing+s.clamp(T.amount,-179,179),Md(S,T)}if(f.pitch){const T=kd(f.pitch,x,go);S.pitch=this._map.transform.pitch+T.amount,Md(S,T)}if(S.zoom||S.bearing){const T=f.pinchAround===void 0?f.around:f.pinchAround;S.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Md(y,c){(!y.duration||y.duration<c.duration)&&(y.duration=c.duration,y.easing=c.easing)}function kd(y,c,f){const{maxSpeed:x,linearity:S,deceleration:T}=f,I=s.clamp(y*S/(c/1e3),-x,x),R=Math.abs(I)/(T*S);return{easing:f.easing,duration:1e3*R,amount:I*(R/2)}}class wi extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,x,S={}){const T=re(f.getCanvasContainer(),x),I=f.unproject(T);super(c,s.extend({point:T,lngLat:I,originalEvent:x},S)),this._defaultPrevented=!1,this.target=f}}class Pd extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,x){const S=c==="touchend"?x.changedTouches:x.touches,T=oe(f.getCanvasContainer(),S),I=T.map(O=>f.unproject(O)),R=T.reduce((O,G,W,X)=>O.add(G.div(X.length)),new s.Point(0,0));super(c,{points:T,point:R,lngLats:I,lngLat:f.unproject(R),originalEvent:x}),this._defaultPrevented=!1}}class df extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,f,x){super(c,{originalEvent:x}),this._defaultPrevented=!1}}class Jm{constructor(c,f){this._map=c,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new df(c.type,this._map,c))}mousedown(c,f){return this._mousedownPos=f,this._firePreventable(new wi(c.type,this._map,c))}mouseup(c){this._map.fire(new wi(c.type,this._map,c))}preclick(c){const f=s.extend({},c);f.type="preclick",this._map.fire(new wi(f.type,this._map,f))}click(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(c),this._map.fire(new wi(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new wi(c.type,this._map,c))}mouseover(c){this._map.fire(new wi(c.type,this._map,c))}mouseout(c){this._map.fire(new wi(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Pd(c.type,this._map,c))}touchmove(c){this._map.fire(new Pd(c.type,this._map,c))}touchend(c){this._map.fire(new Pd(c.type,this._map,c))}touchcancel(c){this._map.fire(new Pd(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hf{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new wi(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new wi(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wx{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,f){this.isEnabled()&&c.shiftKey&&c.button===0&&(z(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(c,f){if(!this._active)return;const x=f,S=this._startPos,T=this._lastPos;if(!S||!T||T.equals(x)||!this._box&&x.dist(S)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=D("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const I=Math.min(S.x,x.x),R=Math.max(S.x,x.x),O=Math.min(S.y,x.y),G=Math.max(S.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${O}px)`,this._box.style.width=R-I+"px",this._box.style.height=G-O+"px")})}mouseupWindow(c,f){if(!this._active)return;const x=this._startPos,S=f;if(x&&c.button===0){if(this.reset(),Q(),x.x!==S.x||x.y!==S.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:T=>T.fitScreenCoordinates(x,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),U(),delete this._startPos,delete this._lastPos}_fireEvent(c,f){return this._map.fire(new s.Event(c,{originalEvent:f}))}}function ff(y,c){const f={};for(let x=0;x<y.length;x++)f[y[x].identifier]=c[x];return f}class Vc{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,f,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=c.timeStamp),x.length===this.numTouches&&(this.centroid=function(S){const T=new s.Point(0,0);for(const I of S)T._add(I);return T.div(S.length)}(f),this.touches=ff(x,f)))}touchmove(c,f,x){if(this.aborted||!this.centroid)return;const S=ff(x,f);for(const T in this.touches){const I=S[T];(!I||I.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(c,f,x){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class eg{constructor(c){this.singleTap=new Vc(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,f,x){this.singleTap.touchstart(c,f,x)}touchmove(c,f,x){this.singleTap.touchmove(c,f,x)}touchend(c,f,x){const S=this.singleTap.touchend(c,f,x);if(S){const T=c.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(S)<30;if(T&&I||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class zb{constructor(){this._zoomIn=new eg({numTouches:1,numTaps:2}),this._zoomOut=new eg({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,f,x){this._zoomIn.touchstart(c,f,x),this._zoomOut.touchstart(c,f,x)}touchmove(c,f,x){this._zoomIn.touchmove(c,f,x),this._zoomOut.touchmove(c,f,x)}touchend(c,f,x){const S=this._zoomIn.touchend(c,f,x),T=this._zoomOut.touchend(c,f,x);return S?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(S)},{originalEvent:c})}):T?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(T)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Gx={0:1,2:2};class $c{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,f){return!1}_move(c,f){return{}}mousedown(c,f){if(this._lastPoint)return;const x=pe(c);this._correctButton(c,x)&&(this._lastPoint=f,this._eventButton=x)}mousemoveWindow(c,f){const x=this._lastPoint;if(x){if(c.preventDefault(),this._eventButton!=null&&function(S,T){const I=Gx[T];return S.buttons===void 0||(S.buttons&I)!==I}(c,this._eventButton))this.reset();else if(this._moved||!(f.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(x,f)}}mouseupWindow(c){this._lastPoint&&pe(c)===this._eventButton&&(this._moved&&Q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tg extends $c{mousedown(c,f){super.mousedown(c,f),this._lastPoint&&(this._active=!0)}_correctButton(c,f){return f===0&&!c.ctrlKey}_move(c,f){return{around:f,panDelta:f.sub(c)}}}class rg extends $c{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const x=.8*(f.x-c.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(c){c.preventDefault()}}class ng extends $c{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const x=-.5*(f.y-c.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(c){c.preventDefault()}}class pf{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(c,f,x){return this._calculateTransform(c,f,x)}touchmove(c,f,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,f,x)}}touchend(c,f,x){this._calculateTransform(c,f,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,f,x){x.length>0&&(this._active=!0);const S=ff(x,f),T=new s.Point(0,0),I=new s.Point(0,0);let R=0;for(const G in S){const W=S[G],X=this._touches[G];X&&(T._add(W),I._add(W.sub(X)),R++,S[G]=W)}if(this._touches=S,R<this._minTouches||!I.mag())return;const O=I.div(R);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(R),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ad{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,f,x){return{}}touchstart(c,f,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([f[0],f[1]]))}touchmove(c,f,x){const S=this._firstTwoTouches;if(!S)return;c.preventDefault();const[T,I]=S,R=Id(x,f,T),O=Id(x,f,I);if(!R||!O)return;const G=this._aroundCenter?null:R.add(O).div(2);return this._move([R,O],G,c)}touchend(c,f,x){if(!this._firstTwoTouches)return;const[S,T]=this._firstTwoTouches,I=Id(x,f,S),R=Id(x,f,T);I&&R||(this._active&&Q(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Id(y,c,f){for(let x=0;x<y.length;x++)if(y[x].identifier===f)return c[x]}function ig(y,c){return Math.log(y/c)/Math.LN2}class Hx extends Ad{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,f){const x=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(ig(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ig(this._distance,x),pinchAround:f}}}function sg(y,c){return 180*y.angleWith(c)/Math.PI}class qx extends Ad{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,f){const x=this._vector;if(this._vector=c[0].sub(c[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:sg(this._vector,x),pinchAround:f}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const f=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const S=sg(c,x);return Math.abs(S)<f}}function Ja(y){return Math.abs(y.y)>Math.abs(y.x)}class Zx extends Ad{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,Ja(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,f,x){const S=this._lastPoints;if(!S)return;const T=c[0].sub(S[0]),I=c[1].sub(S[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(T,I,x.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(T.y+I.y)/2*-.5})}gestureBeginsVertically(c,f,x){if(this._valid!==void 0)return this._valid;const S=c.mag()>=2,T=f.mag()>=2;if(!S&&!T)return;if(!S||!T)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const I=c.y>0==f.y>0;return Ja(c)&&Ja(f)&&I}}const Xx={panStep:100,bearingStep:15,pitchStep:10};class Fb{constructor(){const c=Xx;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let f=0,x=0,S=0,T=0,I=0;switch(c.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:c.shiftKey?x=-1:(c.preventDefault(),T=-1);break;case 39:c.shiftKey?x=1:(c.preventDefault(),T=1);break;case 38:c.shiftKey?S=1:(c.preventDefault(),I=-1);break;case 40:c.shiftKey?S=-1:(c.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(x=0,S=0),{cameraAnimation:R=>{const O=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:Yx,zoom:f?Math.round(O)+f*(c.shiftKey?2:1):O,bearing:R.getBearing()+x*this._bearingStep,pitch:R.getPitch()+S*this._pitchStep,offset:[-T*this._panStep,-I*this._panStep],center:R.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yx(y){return y*(2-y)}const og=4.000244140625;class Kx{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=c.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const x=s.exported.now(),S=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,f!==0&&f%og==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(S*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=re(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;this._type==="wheel"&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>og?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&G!==0&&(G=1/G);const W=f(),X=Math.pow(2,W),te=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(te*G))),this._type==="wheel"&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:f(),S=this._startZoom,T=this._easing;let I,R=!1;if(this._type==="wheel"&&S&&T){const O=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),G=T(O);I=s.number(S,x,G),O<1?this._frameId||(this._frameId=!0):R=!0}else I=x,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:I-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let f=s.ease;if(this._prevEase){const x=this._prevEase,S=(s.exported.now()-x.start)/x.duration,T=x.easing(S+.01)-x.easing(S),I=.27/Math.sqrt(T*T+1e-4)*.01,R=Math.sqrt(.0729-I*I);f=s.bezier(I,R,.25,1)}return this._prevEase={start:s.exported.now(),duration:c,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Qx{constructor(c,f){this._clickZoom=c,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class zi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,f){return c.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(c.shiftKey?-1:1),around:x.unproject(f)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bb{constructor(){this._tap=new eg({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,f,x){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=f[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(c,f,x))}touchmove(c,f,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const S=f[0],T=S.y-this._swipePoint.y;return this._swipePoint=S,c.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(c,f,x)}touchend(c,f,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(c,f,x)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jx{constructor(c,f,x){this._el=c,this._mousePan=f,this._touchPan=x}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ub{constructor(c,f,x){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vb{constructor(c,f,x,S){this._el=c,this._touchZoom=f,this._touchRotate=x,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ws=y=>y.zoom||y.drag||y.pitch||y.rotate;class e_ extends s.Event{}class $b{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,f){const x=s.sub([],f,c);this.radius=s.length(x[2]<0?s.div([],x,this.constants):[x[0],x[1],0])}projectRay(c){s.div(c,c,this.constants),s.normalize(c,c),s.mul$1(c,c,this.constants);const f=s.scale$2([],c,this.radius);if(f[2]>0){const x=s.scale$2([],[0,0,1],s.dot(f,[0,0,1])),S=s.scale$2([],s.normalize([],[f[0],f[1],0]),this.radius),T=s.add([],f,s.scale$2([],s.sub([],s.add([],S,x),f),2));f[0]=T[0],f[1]=T[1]}return f}}function yo(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class $o{constructor(c,f){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $x(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $b,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),s.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[S,T,I]of this._listeners)S.addEventListener(T,S===s.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[c,f,x]of this._listeners)c.removeEventListener(f,c===s.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(c){const f=this._map,x=f.getCanvasContainer();this._add("mapEvent",new Jm(f,c));const S=f.boxZoom=new Wx(f,c);this._add("boxZoom",S);const T=new zb,I=new zi;f.doubleClickZoom=new Qx(I,T),this._add("tapZoom",T),this._add("clickZoom",I);const R=new Bb;this._add("tapDragZoom",R);const O=f.touchPitch=new Zx(f);this._add("touchPitch",O);const G=new rg(c),W=new ng(c);f.dragRotate=new Ub(c,G,W),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const X=new tg(c),te=new pf(f,c);f.dragPan=new Jx(x,X,te),this._add("mousePan",X),this._add("touchPan",te,["touchZoom","touchRotate"]);const se=new qx,le=new Hx;f.touchZoomRotate=new Vb(x,le,se,R),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new hf(f));const ae=f.scrollZoom=new Kx(f,this);this._add("scrollZoom",ae,["mousePan"]);const ce=f.keyboard=new Fb;this._add("keyboard",ce);for(const Y of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[Y]&&f[Y].enable(c[Y])}_add(c,f,x){this._handlers.push({handlerName:c,handler:f,allowed:x}),this._handlersById[c]=f}stop(c){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ws(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,f,x){for(const S in c)if(S!==x&&(!f||f.indexOf(S)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const f=[];for(const x of c)this._el.contains(x.target)&&f.push(x);return f}handleEvent(c,f){this._updatingCamera=!0;const x=c.type==="renderFrame",S=x?void 0:c,T={needsRenderFrame:!1},I={},R={},O=c.touches?this._getMapTouches(c.touches):void 0,G=O?oe(this._el,O):x?void 0:re(this._el,c);for(const{handlerName:te,handler:se,allowed:le}of this._handlers){if(!se.isEnabled())continue;let ae;this._blockedByActive(R,le,te)?se.reset():se[f||c.type]&&(ae=se[f||c.type](c,G,O),this.mergeHandlerResult(T,I,ae,te,S),ae&&ae.needsRenderFrame&&this._triggerRenderFrame()),(ae||se.isActive())&&(R[te]=se)}const W={};for(const te in this._previousActiveHandlers)R[te]||(W[te]=S);this._previousActiveHandlers=R,(Object.keys(W).length||yo(T))&&(this._changes.push([T,I,W]),this._triggerRenderFrame()),(Object.keys(R).length||yo(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=T;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(c,f,x,S,T){if(!x)return;s.extend(c,x);const I={handlerName:S,originalEvent:x.originalEvent||T};x.zoomDelta!==void 0&&(f.zoom=I),x.panDelta!==void 0&&(f.drag=I),x.pitchDelta!==void 0&&(f.pitch=I),x.bearingDelta!==void 0&&(f.rotate=I)}_applyChanges(){const c={},f={},x={};for(const[S,T,I]of this._changes)S.panDelta&&(c.panDelta=(c.panDelta||new s.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(c.around=S.around),S.aroundCoord!==void 0&&(c.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(c.pinchAround=S.pinchAround),S.noInertia&&(c.noInertia=S.noInertia),s.extend(f,T),s.extend(x,I);this._updateMapTransform(c,f,x),this._changes=[]}_updateMapTransform(c,f,x){const S=this._map,T=S.transform,I=ie=>[ie.x,ie.y,ie.z];if((ie=>{const fe=this._eventsInProgress.drag;return fe&&!this._handlersById[fe.handlerName].isActive()})()&&!yo(c)){const ie=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",ie!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&S._stop(!0),!yo(c))return void this._fireEvents(f,x,!0);let{panDelta:R,zoomDelta:O,bearingDelta:G,pitchDelta:W,around:X,aroundCoord:te,pinchAround:se}=c;T._isCameraConstrained&&(O>0&&(O=0),T._isCameraConstrained=!1),se!==void 0&&(X=se),(O||(ie=>f[ie]&&!this._eventsInProgress[ie])("drag"))&&X&&(this._dragOrigin=I(T.pointCoordinate3D(X)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",S._stop(!0),X=X||S.transform.centerPoint,G&&(T.bearing+=G),W&&(T.pitch+=W),T._updateCameraState();const le=[0,0,0];if(R)if(T.projection.name==="mercator"){const ie=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(X).dir),fe=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(X.sub(R)).dir);le[0]=fe[0]-ie[0],le[1]=fe[1]-ie[1]}else{const ie=T.pointCoordinate(X);if(T.projection.name==="globe"){R=R.rotate(-T.angle);const fe=T._pixelsPerMercatorPixel/T.worldSize;le[0]=-R.x*s.mercatorScale(s.latFromMercatorY(ie.y))*fe,le[1]=-R.y*s.mercatorScale(T.center.lat)*fe}else{const fe=T.pointCoordinate(X.sub(R));ie&&fe&&(le[0]=fe.x-ie.x,le[1]=fe.y-ie.y)}}const ae=T.zoom,ce=[0,0,0];if(O){const ie=I(te||T.pointCoordinate3D(X)),fe={dir:s.normalize([],s.sub([],ie,T._camera.position))};if(fe.dir[2]<0){const ge=T.zoomDeltaToMovement(ie,O);s.scale$2(ce,fe.dir,ge)}}const Y=s.add(le,le,ce);T._translateCameraConstrained(Y),O&&Math.abs(T.zoom-ae)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,x,!0)}_fireEvents(c,f,x){const S=Ws(this._eventsInProgress),T=Ws(c),I={};for(const W in c){const{originalEvent:X}=c[W];this._eventsInProgress[W]||(I[`${W}start`]=X),this._eventsInProgress[W]=c[W]}!S&&T&&this._fireEvent("movestart",T.originalEvent);for(const W in I)this._fireEvent(W,I[W]);T&&this._fireEvent("move",T.originalEvent);for(const W in c){const{originalEvent:X}=c[W];this._fireEvent(W,X)}const R={};let O;for(const W in this._eventsInProgress){const{handlerName:X,originalEvent:te}=this._eventsInProgress[W];this._handlersById[X].isActive()||(delete this._eventsInProgress[W],O=f[X]||te,R[`${W}end`]=O)}for(const W in R)this._fireEvent(W,R[W]);const G=Ws(this._eventsInProgress);if(x&&(S||T)&&!G){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;W?(X(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:O})):(this._map.fire(new s.Event("moveend",{originalEvent:O})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,f){this._map.fire(new s.Event(c,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new e_("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Fl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class mf extends s.Evented{constructor(c,f){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,f){return this.jumpTo({center:c},f)}panBy(c,f,x){return c=s.Point.convert(c).mult(-1),this.panTo(this.transform.center,s.extend({offset:c},f),x)}panTo(c,f,x){return this.easeTo(s.extend({center:c},f),x)}getZoom(){return this.transform.zoom}setZoom(c,f){return this.jumpTo({zoom:c},f),this}zoomTo(c,f,x){return this.easeTo(s.extend({zoom:c},f),x)}zoomIn(c,f){return this.zoomTo(this.getZoom()+1,c,f),this}zoomOut(c,f){return this.zoomTo(this.getZoom()-1,c,f),this}getBearing(){return this.transform.bearing}setBearing(c,f){return this.jumpTo({bearing:c},f),this}getPadding(){return this.transform.padding}setPadding(c,f){return this.jumpTo({padding:c},f),this}rotateTo(c,f,x){return this.easeTo(s.extend({bearing:c},f),x)}resetNorth(c,f){return this.rotateTo(0,s.extend({duration:1e3},c),f),this}resetNorthPitch(c,f){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},c),f),this}snapToNorth(c,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,f):this}getPitch(){return this.transform.pitch}setPitch(c,f){return this.jumpTo({pitch:c},f),this}cameraForBounds(c,f){c=s.LngLatBounds.convert(c);const x=f&&f.bearing||0,S=f&&f.pitch||0,T=c.getNorthWest(),I=c.getSouthEast();return this._cameraForBounds(this.transform,T,I,x,S,f)}_extendCameraOptions(c){const f={top:0,bottom:0,right:0,left:0};if(typeof(c=s.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const x=c.padding;c.padding={top:x,bottom:x,right:x,left:x}}return c.padding=s.extend(f,c.padding),c}_minimumAABBFrustumDistance(c,f){const x=f.max[0]-f.min[0],S=f.max[1]-f.min[1];return x/S>c.aspect?x/(2*Math.tan(.5*c.fovX)*c.aspect):S/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,f,x,S,T,I){const R=c.clone(),O=this._extendCameraOptions(I);R.bearing=S,R.pitch=T;const G=s.LngLat.convert(f),W=s.LngLat.convert(x),X=.5*(G.lat+W.lat),te=.5*(G.lng+W.lng),se=s.latLngToECEF(X,te),le=s.normalize([],se),ae=s.normalize([],s.cross([],le,[0,1,0])),ce=s.cross([],ae,le),Y=[ae[0],ae[1],ae[2],0,ce[0],ce[1],ce[2],0,le[0],le[1],le[2],0,0,0,0,1],ie=[se,s.latLngToECEF(G.lat,G.lng),s.latLngToECEF(W.lat,G.lng),s.latLngToECEF(W.lat,W.lng),s.latLngToECEF(G.lat,W.lng),s.latLngToECEF(X,G.lng),s.latLngToECEF(X,W.lng),s.latLngToECEF(G.lat,te),s.latLngToECEF(W.lat,te)];let fe=s.Aabb.fromPoints(ie.map(at=>[s.dot(ae,at),s.dot(ce,at),s.dot(le,at)]));const ge=s.transformMat4([],fe.center,Y);s.squaredLength(ge)===0&&s.set(ge,0,0,1),s.normalize(ge,ge),s.scale$2(ge,ge,s.GLOBE_RADIUS),R.center=s.ecefToLatLng(ge);const Ee=R.getWorldToCameraMatrix(),Me=s.invert(new Float64Array(16),Ee);fe=s.Aabb.applyTransform(fe,s.multiply([],Ee,Y)),s.transformMat4(ge,ge,Ee);const Ce=.5*(fe.max[2]-fe.min[2]),Ne=this._minimumAABBFrustumDistance(R,fe),De=s.scale$2([],[0,0,1],Ce),Ue=s.add(De,ge,De),ft=Ne+(R.pitch===0?0:s.distance(ge,Ue)),ze=R.globeCenterInViewSpace,tt=s.sub([],ge,[ze[0],ze[1],ze[2]]);s.normalize(tt,tt),s.scale$2(tt,tt,ft);const $e=s.add([],ge,tt);s.transformMat4($e,$e,Me);const ht=s.earthRadius/s.GLOBE_RADIUS,Be=s.length($e),et=s.mercatorZfromAltitude(Math.max(Be*ht-s.earthRadius,Number.EPSILON),0),mt=Math.min(R.zoomFromMercatorZAdjusted(et),O.maxZoom);return mt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"mercator"}),R.zoom=mt,this._cameraForBounds(R,f,x,S,T,I)):{center:R.center,zoom:mt,bearing:S,pitch:T}}queryTerrainElevation(c,f){const x=this.transform.elevation;return x?(f=s.extend({},{exaggerated:!0},f),x.getAtPoint(s.MercatorCoordinate.fromLngLat(c),null,f.exaggerated)):null}_cameraForBounds(c,f,x,S,T,I){if(c.projection.name==="globe")return this._cameraForBoundsOnGlobe(c,f,x,S,T,I);const R=c.clone(),O=this._extendCameraOptions(I),G=R.padding;R.bearing=S,R.pitch=T;const W=s.LngLat.convert(f),X=s.LngLat.convert(x),te=new s.LngLat(W.lng,X.lat),se=new s.LngLat(X.lng,W.lat),le=R.project(W),ae=R.project(X),ce=this.queryTerrainElevation(W),Y=this.queryTerrainElevation(X),ie=this.queryTerrainElevation(te),fe=this.queryTerrainElevation(se),ge=[[le.x,le.y,Math.min(ce||0,Y||0,ie||0,fe||0)],[ae.x,ae.y,Math.max(ce||0,Y||0,ie||0,fe||0)]];let Ee=s.Aabb.fromPoints(ge);const Me=R.getWorldToCameraMatrix(),Ce=s.invert(new Float64Array(16),Me);Ee=s.Aabb.applyTransform(Ee,Me);const Ne=s.sub([],Ee.max,Ee.min),De=G.left||0,Ue=G.right||0,ft=G.bottom||0,ze=G.top||0,{left:tt,right:$e,top:ht,bottom:Be}=O.padding,et=.5*(De+Ue),mt=.5*(ze+ft),at=Math.min(R.scaleZoom(R.scale*Math.min((R.width-(De+Ue+tt+$e))/Ne[0],(R.height-(ft+ze+Be+ht))/Ne[1])),O.maxZoom),gt=R.scale/R.zoomScale(at);Ee=new s.Aabb([Ee.min[0]-(tt+et)*gt,Ee.min[1]-(Be+mt)*gt,Ee.min[2]],[Ee.max[0]+($e+et)*gt,Ee.max[1]+(ht+mt)*gt,Ee.max[2]]);const Yt=.5*Ne[2],hr=this._minimumAABBFrustumDistance(R,Ee),Gt=[0,0,1,0];s.transformMat4$1(Gt,Gt,Me),s.normalize$2(Gt,Gt);const ir=s.scale$2([],Gt,hr+Yt),Nr=s.add([],Ee.center,ir),Pr=(typeof O.offset.x=="number"&&typeof O.offset.y=="number"?new s.Point(O.offset.x,O.offset.y):s.Point.convert(O.offset)).rotate(-s.degToRad(S));Ee.center[0]-=Pr.x*gt,Ee.center[1]+=Pr.y*gt,s.transformMat4(Ee.center,Ee.center,Ce),s.transformMat4(Nr,Nr,Ce);const qt=[Ee.center[0],Ee.center[1],Nr[2]*R.pixelsPerMeter];s.scale$2(qt,qt,1/R.worldSize);const Qr=s.lngFromMercatorX(qt[0]),on=s.latFromMercatorY(qt[1]),an=Math.min(R._zoomFromMercatorZ(qt[2]),O.maxZoom),ln=new s.LngLat(Qr,on);return R.mercatorFromTransition&&an<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"globe"}),R.zoom=an,this._cameraForBounds(R,f,x,S,T,I)):{center:ln,zoom:an,bearing:S,pitch:T}}fitBounds(c,f,x){const S=this.cameraForBounds(c,f);return this._fitInternal(S,f,x)}fitScreenCoordinates(c,f,x,S,T){const I=s.Point.convert(c),R=s.Point.convert(f),O=new s.Point(Math.min(I.x,R.x),Math.min(I.y,R.y)),G=new s.Point(Math.max(I.x,R.x),Math.max(I.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(I,R))return this;const W=this.transform.pointLocation3D(O),X=this.transform.pointLocation3D(G),te=this.transform.pointLocation3D(new s.Point(O.x,G.y)),se=this.transform.pointLocation3D(new s.Point(G.x,O.y)),le=[Math.min(W.lng,X.lng,te.lng,se.lng),Math.min(W.lat,X.lat,te.lat,se.lat)],ae=[Math.max(W.lng,X.lng,te.lng,se.lng),Math.max(W.lat,X.lat,te.lat,se.lat)],ce=S&&S.pitch?S.pitch:this.getPitch(),Y=this._cameraForBounds(this.transform,le,ae,x,ce,S);return this._fitInternal(Y,S,T)}_fitInternal(c,f,x){return c?(delete(f=s.extend(c,f)).padding,f.linear?this.easeTo(f,x):this.flyTo(f,x)):this}jumpTo(c,f){this.stop();const x=c.preloadOnly?this.transform.clone():this.transform;let S=!1,T=!1,I=!1;return"zoom"in c&&x.zoom!==+c.zoom&&(S=!0,x.zoom=+c.zoom),c.center!==void 0&&(x.center=s.LngLat.convert(c.center)),"bearing"in c&&x.bearing!==+c.bearing&&(T=!0,x.bearing=+c.bearing),"pitch"in c&&x.pitch!==+c.pitch&&(I=!0,x.pitch=+c.pitch),c.padding==null||x.isPaddingEqual(c.padding)||(x.padding=c.padding),c.preloadOnly?(this._preloadTiles(x),this):(this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),S&&this.fire(new s.Event("zoomstart",f)).fire(new s.Event("zoom",f)).fire(new s.Event("zoomend",f)),T&&this.fire(new s.Event("rotatestart",f)).fire(new s.Event("rotate",f)).fire(new s.Event("rotateend",f)),I&&this.fire(new s.Event("pitchstart",f)).fire(new s.Event("pitch",f)).fire(new s.Event("pitchend",f)),this.fire(new s.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Fl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,f){const x=this.transform;if(!x.projection.supportsFreeCamera)return s.warnOnce(Fl),this;this.stop();const S=x.zoom,T=x.pitch,I=x.bearing;x.setFreeCameraOptions(c);const R=S!==x.zoom,O=T!==x.pitch,G=I!==x.bearing;return this.fire(new s.Event("movestart",f)).fire(new s.Event("move",f)),R&&this.fire(new s.Event("zoomstart",f)).fire(new s.Event("zoom",f)).fire(new s.Event("zoomend",f)),G&&this.fire(new s.Event("rotatestart",f)).fire(new s.Event("rotate",f)).fire(new s.Event("rotateend",f)),O&&this.fire(new s.Event("pitchstart",f)).fire(new s.Event("pitch",f)).fire(new s.Event("pitchend",f)),this.fire(new s.Event("moveend",f)),this}easeTo(c,f){this._stop(!1,c.easeId),((c=s.extend({offset:[0,0],duration:500,easing:s.ease},c)).animate===!1||this._prefersReducedMotion(c))&&(c.duration=0);const x=this.transform,S=this.getZoom(),T=this.getBearing(),I=this.getPitch(),R=this.getPadding(),O="zoom"in c?+c.zoom:S,G="bearing"in c?this._normalizeBearing(c.bearing,T):T,W="pitch"in c?+c.pitch:I,X="padding"in c?c.padding:x.padding,te=s.Point.convert(c.offset);let se,le,ae;if(x.projection.name==="globe"){const De=s.MercatorCoordinate.fromLngLat(x.center),Ue=te.rotate(-x.angle);De.x+=Ue.x/x.worldSize,De.y+=Ue.y/x.worldSize;const ft=De.toLngLat(),ze=s.LngLat.convert(c.center||ft);this._normalizeCenter(ze),se=x.centerPoint.add(Ue),le=new s.Point(De.x,De.y).mult(x.worldSize),ae=new s.Point(s.mercatorXfromLng(ze.lng),s.mercatorYfromLat(ze.lat)).mult(x.worldSize).sub(le)}else{se=x.centerPoint.add(te);const De=x.pointLocation(se),Ue=s.LngLat.convert(c.center||De);this._normalizeCenter(Ue),le=x.project(De),ae=x.project(Ue).sub(le)}const ce=x.zoomScale(O-S);let Y,ie;c.around&&(Y=s.LngLat.convert(c.around),ie=x.locationPoint(Y));const fe=this._zooming||O!==S,ge=this._rotating||T!==G,Ee=this._pitching||W!==I,Me=!x.isPaddingEqual(X),Ce=De=>Ue=>{if(fe&&(De.zoom=s.number(S,O,Ue)),ge&&(De.bearing=s.number(T,G,Ue)),Ee&&(De.pitch=s.number(I,W,Ue)),Me&&(De.interpolatePadding(R,X,Ue),se=De.centerPoint.add(te)),Y)De.setLocationAtPoint(Y,ie);else{const ft=De.zoomScale(De.zoom-S),ze=O>S?Math.min(2,ce):Math.max(.5,ce),tt=Math.pow(ze,1-Ue),$e=De.unproject(le.add(ae.mult(Ue*tt)).mult(ft));De.setLocationAtPoint(De.renderWorldCopies?$e.wrap():$e,se)}return c.preloadOnly||this._fireMoveEvents(f),De};if(c.preloadOnly){const De=this._emulate(Ce,c.duration,x);return this._preloadTiles(De),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=fe,this._rotating=ge,this._pitching=Ee,this._padding=Me,this._easeId=c.easeId,this._prepareEase(f,c.noMoveStart,Ne),this._ease(Ce(x),De=>{x.recenterOnTerrain(),this._afterEase(f,De)},c),this}_prepareEase(c,f,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||x.moving||this.fire(new s.Event("movestart",c)),this._zooming&&!x.zooming&&this.fire(new s.Event("zoomstart",c)),this._rotating&&!x.rotating&&this.fire(new s.Event("rotatestart",c)),this._pitching&&!x.pitching&&this.fire(new s.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new s.Event("move",c)),this._zooming&&this.fire(new s.Event("zoom",c)),this._rotating&&this.fire(new s.Event("rotate",c)),this._pitching&&this.fire(new s.Event("pitch",c))}_afterEase(c,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,S=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new s.Event("zoomend",c)),S&&this.fire(new s.Event("rotateend",c)),T&&this.fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c))}flyTo(c,f){if(this._prefersReducedMotion(c)){const at=s.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(at,f)}this.stop(),c=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},c);const x=this.transform,S=this.getZoom(),T=this.getBearing(),I=this.getPitch(),R=this.getPadding(),O="zoom"in c?s.clamp(+c.zoom,x.minZoom,x.maxZoom):S,G="bearing"in c?this._normalizeBearing(c.bearing,T):T,W="pitch"in c?+c.pitch:I,X="padding"in c?c.padding:x.padding,te=x.zoomScale(O-S),se=s.Point.convert(c.offset);let le=x.centerPoint.add(se);const ae=x.pointLocation(le),ce=s.LngLat.convert(c.center||ae);this._normalizeCenter(ce);const Y=x.project(ae),ie=x.project(ce).sub(Y);let fe=c.curve;const ge=Math.max(x.width,x.height),Ee=ge/te,Me=ie.mag();if("minZoom"in c){const at=s.clamp(Math.min(c.minZoom,S,O),x.minZoom,x.maxZoom),gt=ge/x.zoomScale(at-S);fe=Math.sqrt(gt/Me*2)}const Ce=fe*fe;function Ne(at){const gt=(Ee*Ee-ge*ge+(at?-1:1)*Ce*Ce*Me*Me)/(2*(at?Ee:ge)*Ce*Me);return Math.log(Math.sqrt(gt*gt+1)-gt)}function De(at){return(Math.exp(at)-Math.exp(-at))/2}function Ue(at){return(Math.exp(at)+Math.exp(-at))/2}const ft=Ne(0);let ze=function(at){return Ue(ft)/Ue(ft+fe*at)},tt=function(at){return ge*((Ue(ft)*(De(gt=ft+fe*at)/Ue(gt))-De(ft))/Ce)/Me;var gt},$e=(Ne(1)-ft)/fe;if(Math.abs(Me)<1e-6||!isFinite($e)){if(Math.abs(ge-Ee)<1e-6)return this.easeTo(c,f);const at=Ee<ge?-1:1;$e=Math.abs(Math.log(Ee/ge))/fe,tt=function(){return 0},ze=function(gt){return Math.exp(at*fe*gt)}}c.duration="duration"in c?+c.duration:1e3*$e/("screenSpeed"in c?+c.screenSpeed/fe:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const ht=T!==G,Be=W!==I,et=!x.isPaddingEqual(X),mt=at=>gt=>{const Yt=gt*$e,hr=1/ze(Yt);at.zoom=gt===1?O:S+at.scaleZoom(hr),ht&&(at.bearing=s.number(T,G,gt)),Be&&(at.pitch=s.number(I,W,gt)),et&&(at.interpolatePadding(R,X,gt),le=at.centerPoint.add(se));const Gt=gt===1?ce:at.unproject(Y.add(ie.mult(tt(Yt))).mult(hr));return at.setLocationAtPoint(at.renderWorldCopies?Gt.wrap():Gt,le),at._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(f),at};if(c.preloadOnly){const at=this._emulate(mt,c.duration,x);return this._preloadTiles(at),this}return this._zooming=!0,this._rotating=ht,this._pitching=Be,this._padding=et,this._prepareEase(f,!1),this._ease(mt(x),()=>this._afterEase(f),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,f)}if(!c){const x=this.handlers;x&&x.stop(!1)}return this}_ease(c,f,x){x.animate===!1||x.duration===0?(c(1),f()):(this._easeStart=s.exported.now(),this._easeOptions=x,this._onEaseFrame=c,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,f){c=s.wrap(c,-180,180);const x=Math.abs(c-f);return Math.abs(c-360-f)<x&&(c-=360),Math.abs(c+360-f)<x&&(c+=360),c}_normalizeCenter(c){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const x=c.lng-f.center.lng;c.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,f,x){const S=Math.ceil(15*f/1e3),T=[],I=c(x.clone());for(let R=0;R<=S;R++){const O=I(R/S);T.push(O.clone())}return T}}class $t{constructor(c={}){this.options=c,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const f=this.options&&this.options.compact;return this._map=c,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D("button","mapboxgl-ctrl-attrib-button",this._container),D("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,f){const x=this._map._getUIString(`AttributionControl.${f}`);c.setAttribute("aria-label",x),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(c){const x=f.reduce((S,T,I)=>(T.value&&(S+=`${T.key}=${T.value}${I<f.length-1?"&":""}`),S),"?");c.href=`${s.config.FEEDBACK_URL}/${x}#${Td(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const f=this._map.style._sourceCaches;for(const S in f){const T=f[S];if(T.used){const I=T.getSource();I.attribution&&c.indexOf(I.attribution)<0&&c.push(I.attribution)}}c.sort((S,T)=>S.length-T.length),c=c.filter((S,T)=>{for(let I=T+1;I<c.length;I++)if(c[I].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const x=c.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,c.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ag{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=D("div","mapboxgl-ctrl");const f=D("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(Object.entries(c).length===0)return!0;for(const f in c){const x=c[f].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const f=c[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class lg{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f}remove(c){const f=this._currentlyRunning,x=f?this._queue.concat(f):this._queue;for(const S of x)if(S.id===c)return void(S.cancelled=!0)}run(c=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const x of f)if(!x.cancelled&&(x.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Wc(y,c,f){if(y=new s.LngLat(y.lng,y.lat),c){const x=new s.LngLat(y.lng-360,y.lat),S=new s.LngLat(y.lng+360,y.lat),T=360*Math.ceil(Math.abs(y.lng-f.center.lng)/360),I=f.locationPoint(y).distSqr(c),R=c.x<0||c.y<0||c.x>f.width||c.y>f.height;f.locationPoint(x).distSqr(c)<I&&(R||Math.abs(x.lng-f.center.lng)<T)?y=x:f.locationPoint(S).distSqr(c)<I&&(R||Math.abs(S.lng-f.center.lng)<T)&&(y=S)}for(;Math.abs(y.lng-f.center.lng)>180;){const x=f.locationPoint(y);if(x.x>=0&&x.y>=0&&x.x<=f.width&&x.y<=f.height)break;y.lng>f.center.lng?y.lng-=360:y.lng+=360}return y}const Bl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ot extends s.Evented{constructor(c,f){if(super(),(c instanceof s.window.HTMLElement||f)&&(c=s.extend({element:c},f)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=s.Point.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=D("div");const S=41,T=27,I=N("svg",{display:"block",height:S*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${S}`},this._element),R=N("radialGradient",{id:"shadowGradient"},N("defs",{},I));N("stop",{offset:"10%","stop-opacity":.4},R),N("stop",{offset:"100%","stop-opacity":.05},R),N("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),N("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),N("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),N("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=s.Point.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const x=this._element.classList;for(const S in Bl)x.remove(`mapboxgl-marker-anchor-${S}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const f=c.code,x=c.charCode||c.keyCode;f!=="Space"&&f!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(c){const f=c.originalEvent.target,x=this._element;this._popup&&(f===x||x.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,f=this._pos;if(!c||!f)return!1;const x=c.unproject(f),S=c.getFreeCameraOptions();if(!S.position)return!1;const T=S.position.toLngLat();return T.distanceTo(x)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const f=this._pos;if(!f||f.x<0||f.x>c.transform.width||f.y<0||f.y>c.transform.height)return void this._clearFadeTimer();const x=c.unproject(f);let S;c._showingGlobe()&&s.isLngLatBehindGlobe(c.transform,this._lngLat)?S=0:(S=1-c._queryFogOpacity(x),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${c.x}px,${c.y}px)
            ${Bl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const c=this._pos,f=this._map,x=this.getPitchAlignment();if(!f||!c||x!=="map")return"";if(!f._showingGlobe()){const O=f.getPitch();return O?`rotateX(${O}deg)`:""}const S=s.radToDeg(s.globeTiltAtLngLat(f.transform,this._lngLat)),T=c.sub(s.globeCenterToScreenPoint(f.transform)),I=Math.abs(T.x)+Math.abs(T.y);if(I===0)return"";const R=S/I;return`rotateX(${-T.y*R}deg) rotateY(${T.x*R}deg)`}_calculateZTransform(){const c=this._pos,f=this._map;if(!f||!c)return"";let x=0;const S=this.getRotationAlignment();if(S==="map")if(f._showingGlobe()){const T=f.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),I=f.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);x=s.radToDeg(Math.atan2(I.y,I.x))-90}else x=-f.getBearing();else if(S==="horizon"){const T=s.smoothstep(4,6,f.getZoom()),I=s.globeCenterToScreenPoint(f.transform);I.y+=T*f.transform.height;const R=c.sub(I),O=s.radToDeg(Math.atan2(R.y,R.x));x=(O>90?O-270:O+90)*(1-T)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(c){s.window.cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=Wc(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat),c===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=s.Point.convert(c),this._update(),this}_onMove(c){const f=this._map;if(!f)return;const x=this._pointerdownPos,S=this._positionDelta;if(x&&S){if(!this._isDragging){const T=this._clickTolerance||f._clickTolerance;if(c.point.dist(x)<T)return;this._isDragging=!0}this._pos=c.point.sub(S),this._lngLat=f.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(c){const f=this._map,x=this._pos;f&&x&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(x),this._pointerdownPos=c.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const f=this._map;return f&&(c?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const cg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wb=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function t_(y=new s.Point(0,0),c="bottom"){if(typeof y=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(c){case"top":return new s.Point(0,y);case"top-left":return new s.Point(f,f);case"top-right":return new s.Point(-f,f);case"bottom":return new s.Point(0,-y);case"bottom-left":return new s.Point(f,-f);case"bottom-right":return new s.Point(-f,-f);case"left":return new s.Point(y,0);case"right":return new s.Point(-y,0)}return new s.Point(0,0)}return y instanceof s.Point||Array.isArray(y)?s.Point.convert(y):s.Point.convert(y[c]||[0,0])}class ug{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const f=s.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,f,x){this._start=this.getValue(f),this._end=c,this._startTime=f,this._endTime=f+x}}const r_={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},n_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Gb={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hb{constructor(c,f,x=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new rg({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,x&&(this.mousePitch=new ng({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(c,f){this.mouseRotate.mousedown(c,f),this.mousePitch&&this.mousePitch.mousedown(c,f),z()}move(c,f){const x=this.map,S=this.mouseRotate.mousemoveWindow(c,f),T=S&&S.bearingDelta;if(T&&x.setBearing(x.getBearing()+T),this.mousePitch){const I=this.mousePitch.mousemoveWindow(c,f),R=I&&I.pitchDelta;R&&x.setPitch(x.getPitch()+R)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){U(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(s.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),re(this.element,c)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,re(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=oe(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const dg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},hg={maxWidth:100,unit:"metric"},fg={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Gc={version:s.version,supported:b,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends mf{constructor(y){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(y=s.extend({},n_,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(y.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Bc(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._useWebGL2=y.useWebGL2,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._optimizeForTerrain=y.optimizeForTerrain,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new lg,this._domRenderTaskQueue=new lg,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},r_,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ug(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,typeof y.container=="string"){if(this._container=s.window.document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new $o(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this._hash=y.hash&&new Qm(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,s.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),y.attributionControl&&this.addControl(new $t({customAttribution:y.customAttribution})),this._logoControl=new ag,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new s.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new s.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(y,c){if(c===void 0&&(c=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=y.onAdd(this);this._controls.push(y);const x=this._controlPositions[c];return c.indexOf("bottom")!==-1?x.insertBefore(f,x.firstChild):x.appendChild(f),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(y);return c>-1&&this._controls.splice(c,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new s.Event("movestart",y)).fire(new s.Event("move",y)),this.fire(new s.Event("resize",y)),c&&this.fire(new s.Event("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(s.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?s.window.navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(c=>c==="auto"?s.window.navigator.language:c):y}setLanguage(y){const c=this._parseLanguage(y);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,c=y.projection.name;let f;c==="globe"&&y.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(y.setMercatorFromTransition(),f=!0):c==="mercator"&&y.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(y.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,c){return this._updateProjection(y||c||{name:"mercator"})}_updateProjection(y){let c;if(c=y.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const f in this.style._sourceCaches)this.style._sourceCaches[f].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(y){return this.transform.locationPoint3D(s.LngLat.convert(y))}unproject(y){return this.transform.pointLocation3D(s.Point.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,c,f){if(y==="mouseenter"||y==="mouseover"){let x=!1;const S=I=>{const R=c.filter(G=>this.getLayer(G)),O=R.length?this.queryRenderedFeatures(I.point,{layers:R}):[];O.length?x||(x=!0,f.call(this,new wi(y,this,I.originalEvent,{features:O}))):x=!1},T=()=>{x=!1};return{layers:new Set(c),listener:f,delegates:{mousemove:S,mouseout:T}}}if(y==="mouseleave"||y==="mouseout"){let x=!1;const S=I=>{const R=c.filter(O=>this.getLayer(O));(R.length?this.queryRenderedFeatures(I.point,{layers:R}):[]).length?x=!0:x&&(x=!1,f.call(this,new wi(y,this,I.originalEvent)))},T=I=>{x&&(x=!1,f.call(this,new wi(y,this,I.originalEvent)))};return{layers:new Set(c),listener:f,delegates:{mousemove:S,mouseout:T}}}{const x=S=>{const T=c.filter(R=>this.getLayer(R)),I=T.length?this.queryRenderedFeatures(S.point,{layers:T}):[];I.length&&(S.features=I,f.call(this,S),delete S.features)};return{layers:new Set(c),listener:f,delegates:{[y]:x}}}}on(y,c,f){if(f===void 0)return super.on(y,c);Array.isArray(c)||(c=[c]);const x=this._createDelegatedListener(y,c,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(x);for(const S in x.delegates)this.on(S,x.delegates[S]);return this}once(y,c,f){if(f===void 0)return super.once(y,c);Array.isArray(c)||(c=[c]);const x=this._createDelegatedListener(y,c,f);for(const S in x.delegates)this.once(S,x.delegates[S]);return this}off(y,c,f){if(f===void 0)return super.off(y,c);c=new Set(Array.isArray(c)?c:[c]);const x=(T,I)=>{if(T.size!==I.size)return!1;for(const R of T)if(!I.has(R))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[y]:void 0;return S&&(T=>{for(let I=0;I<T.length;I++){const R=T[I];if(R.listener===f&&x(R.layers,c)){for(const O in R.delegates)this.off(O,R.delegates[O]);return T.splice(I,1),this}}})(S),this}queryRenderedFeatures(y,c){return this.style?(c!==void 0||y===void 0||y instanceof s.Point||Array.isArray(y)||(c=y,y=void 0),this.style.queryRenderedFeatures(y=y||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(y,c){return this.style.querySourceFeatures(y,c)}isPointOnSurface(y){const{name:c}=this.transform.projection;return c!=="globe"&&c!=="mercator"&&s.warnOnce(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(y))}setStyle(y,c){return(c=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&y?(this._diffStyle(y,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(y,c))}_getUIString(y){const c=this._locale[y];if(c==null)throw new Error(`Missing UI string '${y}'`);return c}_updateStyle(y,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y&&(this.style=new Uo(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Uo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,c){if(typeof y=="string"){const f=this._requestManager.normalizeStyleURL(y),x=this._requestManager.transformRequest(f,s.ResourceType.Style);s.getJSON(x,(S,T)=>{S?this.fire(new s.ErrorEvent(S)):T&&this._updateDiff(T,c)})}else typeof y=="object"&&this._updateDiff(y,c)}_updateDiff(y,c){try{this.style.setState(y)&&this._update(!0)}catch(f){s.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(y,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(y,c){return this._lazyInitEmptyStyle(),this.style.addSource(y,c),this._update(!0)}isSourceLoaded(y){return!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){const y=this.style&&this.style._sourceCaches;for(const c in y){const f=y[c]._tiles;for(const x in f){const S=f[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(y,c,f){this._lazyInitEmptyStyle(),this.style.addSourceType(y,c,f)}removeSource(y){return this.style.removeSource(y),this._updateTerrain(),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,c,{pixelRatio:f=1,sdf:x=!1,stretchX:S,stretchY:T,content:I}={}){if(this._lazyInitEmptyStyle(),c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap){const{width:R,height:O,data:G}=s.exported.getImageData(c);this.style.addImage(y,{data:new s.RGBAImage({width:R,height:O},G),pixelRatio:f,stretchX:S,stretchY:T,content:I,sdf:x,version:0})}else if(c.width===void 0||c.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:R,height:O}=c,G=c;this.style.addImage(y,{data:new s.RGBAImage({width:R,height:O},new Uint8Array(G.data)),pixelRatio:f,stretchX:S,stretchY:T,content:I,sdf:x,version:0,userImage:G}),G.onAdd&&G.onAdd(this,y)}}updateImage(y,c){const f=this.style.getImage(y);if(!f)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap?s.exported.getImageData(c):c,{width:S,height:T}=x;S!==void 0&&T!==void 0?S===f.data.width&&T===f.data.height?(f.data.replace(x.data,!(c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap)),this.style.updateImage(y,f)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${T})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,c){s.getImage(this._requestManager.transformRequest(y,s.ResourceType.Image),(f,x)=>{c(f,x instanceof s.window.HTMLImageElement?s.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(y,c){return this._lazyInitEmptyStyle(),this.style.addLayer(y,c),this._update(!0)}moveLayer(y,c){return this.style.moveLayer(y,c),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,c,f){return this.style.setLayerZoomRange(y,c,f),this._update(!0)}setFilter(y,c,f={}){return this.style.setFilter(y,c,f),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,c,f,x={}){return this.style.setPaintProperty(y,c,f,x),this._update(!0)}getPaintProperty(y,c){return this.style.getPaintProperty(y,c)}setLayoutProperty(y,c,f,x={}){return this.style.setLayoutProperty(y,c,f,x),this._update(!0)}getLayoutProperty(y,c){return this.style.getLayoutProperty(y,c)}setLight(y,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(y),this.transform):0}setFeatureState(y,c){return this.style.setFeatureState(y,c),this._update()}removeFeatureState(y,c){return this.style.removeFeatureState(y,c),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let f,x,S,T=this._container;for(;T&&(!x||!S);){const I=s.window.getComputedStyle(T).transform;I&&I!=="none"&&(f=I.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(x=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(S=f[3])),T=T.parentElement}this._containerWidth=x?Math.abs(y/x):y,this._containerHeight=S?Math.abs(c/S):c}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=D("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=D("div","mapboxgl-canvas-container",y);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=D("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=D("div","mapboxgl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=D("div",`mapboxgl-ctrl-${S}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,c){const f=s.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(y),this._canvas.height=f*Math.ceil(c),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${c}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const c=this._markers.indexOf(y);c!==-1&&this._markers.splice(c,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const c=this._popups.indexOf(y);c!==-1&&this._popups.splice(c,1)}_setupPainter(){const y=s.extend({},b.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",y),f=c||this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);f?(this._useWebGL2&&!c&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(f,!0),this.painter=new zc(f,this.transform,!!c),this.on("data",x=>{x.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(f)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let c;const f=this.painter.context.extTimerQuery,x=s.exported.now();if(this.listens("gpu-timing-frame")&&(c=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const R=this.transform.zoom,O=this.transform.pitch,G=s.exported.now(),W=new s.EvaluationParameters(R,{now:G,fadeDuration:S,pitch:O,transition:this.style.getTransition()});this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const R=s.exported.now()-x;f.endQueryEXT(f.TIME_ELAPSED_EXT,c),setTimeout(()=>{const O=f.getQueryObjectEXT(c,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(c),this.fire(new s.Event("gpu-timing-frame",{cpuTime:R,gpuTime:O})),s.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:O}})},50)}if(this.listens("gpu-timing-layer")){const R=this.painter.collectGpuTimers();setTimeout(()=>{const O=this.painter.queryGpuTimers(R);this.fire(new s.Event("gpu-timing-layer",{layerTimes:O}))},50)}if(this.listens("gpu-timing-deferred-render")){const R=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const O=this.painter.queryGpuTimeDeferredRender(R);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:O}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(I||this._repaint)this.triggerRepaint();else{const R=!this.isMoving()&&this.loaded();if(R&&(T=this._updateAverageElevation(x,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),R&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const O=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:O})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const c of this._markers)y&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!y||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(y,c=!1){const f=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((c||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=y;const I=Math.abs(x-S);if(I>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(S),f(S);this._averageElevation.easeTo(S,y,300)}else if(I>1e-4)return this._averageElevation.jumpTo(S),f(S)}return!!this._averageElevation.isEasing(y)&&f(this._averageElevation.getValue(y))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===s.AUTH_ERR_MSG||y.status===401)){const c=this.painter.context.gl;s.storeAuthState(c,!1),this._logoControl instanceof ag&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const f=this.painter.context.gl,x=f.createFramebuffer();function S(T){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,T,0);const I=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,I),I}return f.bindFramebuffer(f.FRAMEBUFFER,x),this._canvasPixelComparison(S(y),c.canvasCopies.map(S),c.timeStamps)}_canvasPixelComparison(y,c,f){let x=f[1]-f[0];const S=y.length/4;for(let T=0;T<c.length;T++){const I=c[T];let R=0;for(let O=0;O<I.length;O+=4)I[O]===y[O]&&I[O+1]===y[O+1]&&I[O+2]===y[O+2]&&I[O+3]===y[O+3]&&(R+=1);x+=(f[T+2]-f[T+1])*(1-R/S)}return x}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=s.exported.frame(c=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(c)}))}_preloadTiles(y){const c=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(c,(f,x)=>f._preloadTiles(y,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,y&&this._update())}_setCacheLimits(y,c){s.setCacheLimits(y,c)}get version(){return s.version}},NavigationControl:class{constructor(y){this.options=s.extend({},Gb,y),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),D("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),D("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:c}):f.resetNorth({},{originalEvent:c}))}),this._compassIcon=D("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const c=y.getZoom(),f=c===y.getMaxZoom(),x=c===y.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hb(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,c){const f=D("button",y,this._container);return f.type="button",f.addEventListener("click",c),f}_setButtonTitle(y,c){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${c}`);y.setAttribute("aria-label",f),y.firstElementChild&&y.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends s.Evented{constructor(y){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},dg,y),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Uc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const c=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,y(f)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(f=>c(f.state!=="denied")).catch(()=>c()):c()}_isOutOfMapMaxBounds(y){const c=this._map.getMaxBounds(),f=y.coords;return!!c&&(f.longitude<c.getWest()||f.longitude>c.getEast()||f.latitude<c.getSouth()||f.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",y)),this._finish()}}_updateCamera(y){const c=new s.LngLat(y.coords.longitude,y.coords.latitude),f=y.coords.accuracy,x=this._map.getBearing(),S=s.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(f),S,{geolocateSource:!0})}_updateMarker(y){if(y){const c=new s.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,c=s.mercatorZfromAltitude(1,y._center.lat)*y.worldSize,f=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=D("button","mapboxgl-ctrl-geolocate",this._container),D("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D("div","mapboxgl-user-location"),this._dotElement.appendChild(D("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(D("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ot({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=D("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ot({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(c=>{c==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$t,ScaleControl:class{constructor(y){this.options=s.extend({},hg,y),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,c=this._map,f=c._containerHeight/2,x=c._containerWidth/2-y/2,S=c.unproject([x,f]),T=c.unproject([x+y,f]),I=S.distanceTo(T);if(this.options.unit==="imperial"){const R=3.2808*I;R>5280?this._setScale(y,R/5280,"mile"):this._setScale(y,R,"foot")}else this.options.unit==="nautical"?this._setScale(y,I/1852,"nautical-mile"):I>=1e3?this._setScale(y,I/1e3,"kilometer"):this._setScale(y,I,"meter")}_setScale(y,c,f){this._map._requestDomTask(()=>{const x=function(T){const I=Math.pow(10,`${Math.floor(T)}`.length-1);let R=T/I;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(O){const G=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*G)/G}(R),I*R}(c),S=x/c;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(x):`${x}&nbsp;${fg[f]}`,this._container.style.width=y*S+"px"})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof s.window.HTMLElement?this._container=y.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=D("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(y){super(),this.options=s.extend(Object.create(cg),y),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=s.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(s.window.document.createTextNode(y))}setHTML(y){const c=s.window.document.createDocumentFragment(),f=s.window.document.createElement("body");let x;for(f.innerHTML=y;x=f.firstChild,x;)c.appendChild(x);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=D("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(y),this.options.closeButton){const f=this._closeButton=D("button","mapboxgl-popup-close-button",c);f.type="button",f.setAttribute("aria-label","Close popup"),f.setAttribute("aria-hidden","true"),f.innerHTML="&#215;",f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let c;return this._classList.delete(y)?c=!1:(this._classList.add(y),c=!0),this._updateClassList(),c}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const c=this._map,f=this._container,x=this._pos;if(!c||!f||!x)return"bottom";const S=f.offsetWidth,T=f.offsetHeight,I=x.x<S/2,R=x.x>c.transform.width-S/2;if(x.y+y<T)return I?"top-left":R?"top-right":"top";if(x.y>c.transform.height-T){if(I)return"bottom-left";if(R)return"bottom-right"}return I?"left":R?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),y.className=c.join(" ")}_update(y){const c=this._map,f=this._content;if(!c||!this._lngLat&&!this._trackPointer||!f)return;let x=this._container;if(x||(x=this._container=D("div","mapboxgl-popup",c.getContainer()),this._tip=D("div","mapboxgl-popup-tip",x),x.appendChild(f)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wc(this._lngLat,this._pos,c.transform)),!this._trackPointer||y){const S=this._pos=this._trackPointer&&y?y:c.project(this._lngLat),T=t_(this.options.offset),I=this._anchor=this._getAnchor(T.y),R=t_(this.options.offset,I),O=S.add(R).round();c._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${Bl[I]} translate(${O.x}px,${O.y}px)`)})}if(!this._marker&&c._showingGlobe()){const S=s.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(Wb);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Ot,Style:Uo,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Bx,Evented:s.Evented,config:s.config,prewarm:function(){Mc().acquire(zo)},clearPrewarmedResources:function(){const y=Xi;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(zo),Xi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(y){s.config.ACCESS_TOKEN=y},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(y){s.config.API_URL=y},get workerCount(){return xi.workerCount},set workerCount(y){xi.workerCount=y},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){s.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){s.clearTileCache(y)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Gc});var g=u;return g})})(c6);var yae=c6.exports;const E0=PM(yae),d6=({coordinates:e,height:t="400px",zoom:r=12,onError:i})=>{const a=A.useRef(null),[u,h]=A.useState(null),[g,s]=A.useState(localStorage.getItem("user_mapbox_token")),[_,b]=A.useState(!1),[C,M]=A.useState(""),[D,N]=A.useState(null),{resolvedTheme:j}=Fv(),V=Q=>{try{const[re,oe]=Q.split(",").map(pe=>parseFloat(pe.trim()));return isNaN(re)||isNaN(oe)?null:[oe,re]}catch(re){return console.error("Failed to parse coordinates:",re),null}},B=Q=>{try{const[re,oe]=Q.split(",").map(pe=>parseFloat(pe.trim()));return isNaN(re)||isNaN(oe)?"":`https://www.google.com/maps/dir/?api=1&destination=${re},${oe}`}catch{return""}};A.useEffect(()=>{if(!a.current)return;N(null);const Q=V(e);if(!Q){const ve="Invalid coordinates format. Use latitude, longitude format (e.g., -6.9363, 107.6223)";N(ve),i&&i(ve);return}const oe=g||"pk.eyJ1IjoiZmVicmlkIiwiYSI6ImNsbDRiMzUzZDAzcTMzZW9naGdzZzU5Z2sifQ.Zng8KXmlVjv-vR-lotlxOQ",pe=j==="dark"?"mapbox://styles/mapbox/dark-v11":"mapbox://styles/mapbox/streets-v12";try{E0.accessToken=oe;const ve=new E0.Map({container:a.current,style:pe,center:Q,zoom:r,pitch:45});return ve.addControl(new E0.NavigationControl),ve.on("load",()=>{const he=document.createElement("div");he.className="mapboxgl-ctrl mapboxgl-ctrl-group",he.innerHTML=`
          <button title="Street View" class="${j!=="dark"?"active":""}">S</button>
          <button title="Satellite View">T</button>
          <button title="Toggle 3D Terrain">3D</button>
        `;const Ke=he.querySelectorAll("button"),qe=Ke[0],Ie=Ke[1],rt=Ke[2];qe.addEventListener("click",()=>{ve.setStyle("mapbox://styles/mapbox/streets-v12"),qe.classList.add("active"),Ie.classList.remove("active")}),Ie.addEventListener("click",()=>{ve.setStyle("mapbox://styles/mapbox/satellite-streets-v12"),Ie.classList.add("active"),qe.classList.remove("active")});let Pt=!0;rt.classList.add("active"),rt.addEventListener("click",()=>{Pt=!Pt,Pt?(ve.setPitch(45),rt.classList.add("active")):(ve.setPitch(0),rt.classList.remove("active"))}),ve.addControl({onAdd:()=>he,onRemove:()=>{var it;(it=he.parentNode)==null||it.removeChild(he)}}),new E0.Marker({color:"#FF0000"}).setLngLat(Q).addTo(ve)}),h(ve),()=>{ve.remove()}}catch(ve){console.error("Error initializing map:",ve);const he="Failed to initialize map. You may need to provide a valid Mapbox token.";N(he),i&&i(he),b(!0)}},[e,r,g,i,j]),A.useEffect(()=>{const Q=re=>{if(re.message&&(re.message.includes("Mapbox")||re.message.includes("mapbox")||re.message.includes("401"))){b(!0);const oe="Mapbox authentication failed. Please provide a valid Mapbox token.";N(oe),i&&i(oe)}};return window.addEventListener("error",Q),()=>window.removeEventListener("error",Q)},[i]);const z=()=>{C&&(localStorage.setItem("user_mapbox_token",C),s(C),b(!1))},U={width:"100%",height:t,borderRadius:"0.375rem"},Z=B(e);return m.jsxs("div",{children:[m.jsx("div",{ref:a,style:U,className:"relative",children:Z&&m.jsxs("a",{href:Z,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-3 right-3 z-10 flex items-center gap-1 bg-primary text-primary-foreground py-1.5 px-3 rounded-md shadow-lg hover:bg-primary/90 transition-colors",title:"Navigate using Google Maps",children:[m.jsx(OX,{className:"h-4 w-4"}),m.jsx("span",{className:"text-sm font-medium",children:"Navigate"})]})}),_&&m.jsxs("div",{className:"mt-2 p-3 bg-muted rounded-md",children:[m.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:D||"Provide a Mapbox token to display the map:"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",value:C,onChange:Q=>M(Q.target.value),placeholder:"Enter your Mapbox token",className:"flex-1 px-3 py-1 text-sm rounded-md border"}),m.jsx("button",{onClick:z,className:"px-3 py-1 bg-primary text-primary-foreground text-sm rounded-md hover:bg-primary/90",children:"Save"})]}),m.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["You can get a free Mapbox token at"," ",m.jsx("a",{href:"https://account.mapbox.com/auth/signup/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"mapbox.com"})]})]})]})};function vae(){const{settings:e}=Oh(),t=(e==null?void 0:e.openingHours)||[{day:"Monday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Tuesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Wednesday",openTime:"11:00 AM",closeTime:"10:00 PM"},{day:"Thursday",openTime:"11:00 AM",closeTime:"11:00 PM"},{day:"Friday",openTime:"11:00 AM",closeTime:"12:00 AM"},{day:"Saturday",openTime:"10:00 AM",closeTime:"12:00 AM"},{day:"Sunday",openTime:"10:00 AM",closeTime:"10:00 PM"}],i=(e==null?void 0:e.mapCoordinates)||"-6.9363, 107.6223",a=new Date().toLocaleDateString("en-US",{weekday:"long"}),u={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6}}},h={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},g={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.4}}};return m.jsx("section",{className:"py-16 md:py-24 bg-gradient-to-b from-background to-muted/30",children:m.jsxs("div",{className:"container-custom mx-auto px-4 sm:px-6",children:[m.jsxs(Qi.div,{className:"text-center mb-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[m.jsx("h2",{className:"text-3xl md:text-4xl font-display font-semibold mb-4",children:"About Us"}),m.jsx("div",{className:"w-20 h-1 bg-primary mx-auto rounded-full mb-6"}),m.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto"})]}),m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12",children:[m.jsxs(Qi.div,{className:"space-y-6",variants:u,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-100px"},children:[m.jsxs(Wi,{className:"overflow-hidden border-primary/10 shadow-lg hover:shadow-xl transition-all duration-300",children:[m.jsx(ys,{className:"bg-gradient-to-r from-primary/10 to-primary/5 pb-4",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"bg-primary/10 p-2.5 rounded-full mr-3",children:m.jsx(LX,{className:"h-6 w-6 text-primary"})}),m.jsx(vs,{className:"text-2xl",children:"Highlight Customer Benefits"})]})}),m.jsx(xs,{className:"pt-6",children:m.jsx(Qi.p,{className:"leading-relaxed text-muted-foreground",initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.2,duration:.6},children:(e==null?void 0:e.mission)||"To deliver exceptional dining experiences through quality ingredients, innovative recipes, and warm hospitality. We aim to create memorable moments for our guests while maintaining sustainable practices and supporting local farmers."})})]}),m.jsxs(Wi,{className:"overflow-hidden border-primary/10 shadow-lg hover:shadow-xl transition-all duration-300",children:[m.jsx(ys,{className:"bg-gradient-to-r from-primary/10 to-primary/5 pb-4",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"bg-primary/10 p-2.5 rounded-full mr-3",children:m.jsx(bz,{className:"h-6 w-6 text-primary"})}),m.jsx(vs,{className:"text-2xl",children:"Our Vision & Mission"})]})}),m.jsx(xs,{className:"pt-6",children:m.jsx(Qi.p,{className:"leading-relaxed text-muted-foreground",initial:{opacity:0},whileInView:{opacity:1},transition:{delay:.3,duration:.6},children:(e==null?void 0:e.vision)||"To be recognized as the premier dining destination that brings people together through a shared love of exceptional food, creating a community built on culinary excellence and authentic connections."})})]})]}),m.jsxs("div",{className:"space-y-8",children:[m.jsxs(Qi.div,{className:"bg-card rounded-xl shadow-lg overflow-hidden border border-border/50",variants:u,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-100px"},children:[m.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-6",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"bg-primary/10 p-2.5 rounded-full mr-3",children:m.jsx(zk,{className:"h-6 w-6 text-primary"})}),m.jsx("h3",{className:"text-2xl font-display font-medium",children:"Operating Hours"})]})}),m.jsx(Qi.div,{className:"p-6 pt-4",variants:h,initial:"hidden",whileInView:"visible",viewport:{once:!0},children:t.map((s,_)=>m.jsxs(Qi.div,{variants:g,className:`flex justify-between py-3 px-4 mb-2 rounded-lg ${s.day===a?"bg-primary/15 font-medium shadow-sm":"hover:bg-muted/50 transition-colors"}`,children:[m.jsx("span",{children:s.day}),m.jsxs("span",{className:"font-mono",children:[s.openTime," - ",s.closeTime]})]},s.day||`day-${_}`))})]}),m.jsxs(Qi.div,{className:"bg-card rounded-xl shadow-lg overflow-hidden border border-border/50",variants:u,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-100px"},children:[m.jsx("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-6",children:m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"bg-primary/10 p-2.5 rounded-full mr-3",children:m.jsx(Tz,{className:"h-6 w-6 text-primary"})}),m.jsx("h3",{className:"text-2xl font-display font-medium",children:"Location"})]})}),m.jsxs("div",{className:"p-6 pt-4",children:[m.jsxs(Qi.div,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},children:[m.jsx("p",{className:"font-medium mb-1",children:(e==null?void 0:e.address)||"Jl. Buah Batu No.131, Turangga, Kec. Lengkong, Kota Bandung, Jawa Barat 40262"}),m.jsx("p",{className:"mb-4 text-muted-foreground text-sm",children:(e==null?void 0:e.reservationNote)||"Reservations recommended for parties of 6 or more"})]}),m.jsx(Qi.div,{className:"rounded-xl overflow-hidden shadow-md border border-border/30",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:m.jsx(d6,{coordinates:i,height:"280px",zoom:15})})]})]})]})]})]})})}const N3="ad_cooldown",xae=6e4;function _ae(e){const[t,r]=A.useState(!1);return A.useEffect(()=>{if(!e)return;const a=localStorage.getItem(N3),u=Date.now();if(a&&u-parseInt(a,10)<xae)return;const h=setTimeout(()=>{r(!0)},500);return()=>clearTimeout(h)},[e]),{showAd:t,closeAd:()=>{r(!1),localStorage.setItem(N3,Date.now().toString())}}}function wae({ad:e,onClose:t,open:r}){if(!e)return null;const i=()=>{e.linkUrl&&window.open(e.linkUrl,"_blank")};return m.jsx(zh,{open:r,onOpenChange:a=>!a&&t(),children:m.jsxs(ed,{className:"sm:max-w-md md:max-w-lg overflow-y-auto max-h-[90vh]",children:[m.jsx(rx,{children:m.jsx(nx,{children:e.title})}),m.jsxs("div",{className:"flex flex-col space-y-4",children:[e.type==="image"&&e.imageUrl&&m.jsx("div",{className:"relative overflow-hidden rounded-lg",children:m.jsx(_c,{ratio:16/9,children:m.jsx("img",{src:e.imageUrl,alt:e.title,className:"w-full h-full object-cover"})})}),e.type==="video"&&e.videoUrl&&m.jsx("div",{className:"overflow-hidden rounded-lg",children:m.jsx(_c,{ratio:16/9,children:m.jsx("iframe",{src:e.videoUrl,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full border-0"})})}),e.type==="link"&&e.content&&m.jsx("div",{className:"text-center p-4",children:m.jsx("p",{className:"mb-4",children:e.content})}),m.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.linkUrl&&m.jsx(Et,{onClick:i,className:"flex-1",children:"View More"}),m.jsx(Et,{onClick:t,variant:"outline",className:e.linkUrl?"flex-1":"w-full",children:"Dismiss"})]})]})]})})}const bae=()=>{const{heroSlides:e,vouchers:t,getTopDishes:r,getTopDrinks:i,loading:a,refreshCategories:u,refreshHeroSlides:h}=ca(),{currentAd:g,loadAd:s}=BF(),{showAd:_,closeAd:b}=_ae(g),{settings:C,fetchSettings:M}=Oh(),D=la(),N=A.useRef(null);A.useEffect(()=>{window.scrollTo(0,0),(async()=>{await u(),await h(),await M(),s()})()},[]),A.useEffect(()=>{(D.state&&D.state.scrollToAbout||D.hash==="#about")&&N.current&&setTimeout(()=>{var z;(z=N.current)==null||z.scrollIntoView({behavior:"smooth"})},100)},[D]);const j=r(),V=i();return m.jsxs("div",{className:"min-h-screen pt-16 md:pt-20 page-transition-in",children:[e&&e.length>0&&m.jsx("div",{className:"py-4",children:m.jsx(ote,{slides:e,useVerticalMode:C==null?void 0:C.heroSliderMobileVertical})}),m.jsx("div",{className:"container-custom mx-auto px-4 sm:px-6 py-8 md:py-12",children:m.jsx(Rte,{dishes:j,loading:a})}),m.jsx("div",{className:"container-custom mx-auto px-4 sm:px-6 py-8 md:py-12",children:m.jsx(Nte,{drinks:V,loading:a})}),t.length>0&&m.jsx(gae,{}),m.jsx("div",{id:"about",ref:N,children:m.jsx(vae,{})}),m.jsx(wae,{ad:g,open:_,onClose:b})]})};var $P="Tabs",[Sae,Sfe]=Ya($P,[Kw]),h6=Kw(),[Eae,WP]=Sae($P),f6=A.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,onValueChange:a,defaultValue:u,orientation:h="horizontal",dir:g,activationMode:s="automatic",..._}=e,b=Nh(g),[C,M]=Wa({prop:i,onChange:a,defaultProp:u});return m.jsx(Eae,{scope:r,baseId:Po(),value:C,onValueChange:M,orientation:h,dir:b,activationMode:s,children:m.jsx(sr.div,{dir:b,"data-orientation":h,..._,ref:t})})});f6.displayName=$P;var p6="TabsList",m6=A.forwardRef((e,t)=>{const{__scopeTabs:r,loop:i=!0,...a}=e,u=WP(p6,r),h=h6(r);return m.jsx(d5,{asChild:!0,...h,orientation:u.orientation,dir:u.dir,loop:i,children:m.jsx(sr.div,{role:"tablist","aria-orientation":u.orientation,...a,ref:t})})});m6.displayName=p6;var g6="TabsTrigger",y6=A.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,disabled:a=!1,...u}=e,h=WP(g6,r),g=h6(r),s=_6(h.baseId,i),_=w6(h.baseId,i),b=i===h.value;return m.jsx(h5,{asChild:!0,...g,focusable:!a,active:b,children:m.jsx(sr.button,{type:"button",role:"tab","aria-selected":b,"aria-controls":_,"data-state":b?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:s,...u,ref:t,onMouseDown:kt(e.onMouseDown,C=>{!a&&C.button===0&&C.ctrlKey===!1?h.onValueChange(i):C.preventDefault()}),onKeyDown:kt(e.onKeyDown,C=>{[" ","Enter"].includes(C.key)&&h.onValueChange(i)}),onFocus:kt(e.onFocus,()=>{const C=h.activationMode!=="manual";!b&&!a&&C&&h.onValueChange(i)})})})});y6.displayName=g6;var v6="TabsContent",x6=A.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,forceMount:a,children:u,...h}=e,g=WP(v6,r),s=_6(g.baseId,i),_=w6(g.baseId,i),b=i===g.value,C=A.useRef(b);return A.useEffect(()=>{const M=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(M)},[]),m.jsx(ji,{present:a||b,children:({present:M})=>m.jsx(sr.div,{"data-state":b?"active":"inactive","data-orientation":g.orientation,role:"tabpanel","aria-labelledby":s,hidden:!M,id:_,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:C.current?"0s":void 0},children:M&&u})})});x6.displayName=v6;function _6(e,t){return`${e}-trigger-${t}`}function w6(e,t){return`${e}-content-${t}`}var Tae=f6,b6=m6,S6=y6,E6=x6;const Mh=Tae,qu=A.forwardRef(({className:e,...t},r)=>m.jsx(b6,{ref:r,className:It("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));qu.displayName=b6.displayName;const Sn=A.forwardRef(({className:e,...t},r)=>m.jsx(S6,{ref:r,className:It("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Sn.displayName=S6.displayName;const ni=A.forwardRef(({className:e,...t},r)=>m.jsx(E6,{ref:r,className:It("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ni.displayName=E6.displayName;const j3=({categories:e,activeCategory:t,setActiveCategory:r})=>m.jsxs("div",{className:"overflow-x-auto pb-2",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.jsx(Sz,{className:"h-4 w-4 text-muted-foreground"}),m.jsx("span",{className:"text-sm font-medium",children:"Filter by category:"})]}),m.jsx("div",{className:"flex gap-2 flex-wrap",children:e.map(i=>m.jsx(Et,{variant:t===i?"default":"outline",size:"sm",onClick:()=>r(i),className:It("rounded-full",t===i?"bg-primary text-primary-foreground":""),children:i},i))})]}),ur=A.forwardRef(({className:e,type:t,...r},i)=>m.jsx("input",{type:t,className:It("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...r}));ur.displayName="Input";const Cae=({searchQuery:e,handleSearchChange:t,clearSearch:r,menuType:i})=>m.jsxs("div",{className:"relative max-w-md mx-auto mb-6",children:[m.jsx(Mz,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"text",placeholder:`Search ${i==="drink"?"drinks":"dishes"}...`,value:e,onChange:t,className:"pl-10 pr-10 bg-background/60 backdrop-blur-sm border-muted"}),e&&m.jsx("button",{onClick:r,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":"Clear search",children:m.jsx(Ls,{className:"h-4 w-4"})})]}),Mae=({item:e,onClick:t,menuType:r})=>(Fv(),m.jsxs("div",{className:"glass-card rounded-xl overflow-hidden hover-card-animation cursor-pointer transition-all duration-300 hover:shadow-lg",onClick:t,children:[m.jsxs("div",{className:"aspect-video relative",children:[m.jsx("img",{src:e.images[0],alt:e.name,className:"w-full h-full object-cover"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),m.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[m.jsx("div",{className:"inline-block bg-background/80 backdrop-blur-sm text-foreground text-xs font-medium px-2 py-1 rounded mb-2",children:e.category}),m.jsx("h3",{className:"text-white font-medium text-lg md:text-xl",children:e.name})]}),e.isTopDish&&m.jsxs("div",{className:"absolute top-2 right-2 bg-primary/90 text-primary-foreground text-xs font-bold px-2 py-1 rounded",children:["Top ",r==="drink"?"Drink":"Dish"]})]}),m.jsxs("div",{className:"p-4",children:[m.jsx("p",{className:"text-muted-foreground line-clamp-2 mb-3",children:e.description}),e.ingredients&&e.ingredients.length>0&&m.jsx("div",{className:"mb-3",children:m.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.ingredients.slice(0,3).map((i,a)=>m.jsx("span",{className:It("text-xs px-2 py-0.5 rounded-full ingredient-tag"),children:i},a)),e.ingredients.length>3&&m.jsxs("span",{className:It("text-xs px-2 py-0.5 rounded-full ingredient-tag"),children:["+",e.ingredients.length-3]})]})}),m.jsxs("div",{className:"flex justify-between items-center",children:[e.promoPrice?m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("span",{className:"font-semibold text-primary",children:es(e.promoPrice)}),m.jsx("span",{className:"line-through text-xs text-muted-foreground",children:es(e.price)})]}):m.jsx("span",{className:"font-semibold",children:es(e.price)}),m.jsx(Et,{variant:"secondary",size:"sm",children:"View Details"})]})]})]})),L3=({items:e,loading:t,menuType:r,handleItemClick:i,searchQuery:a,clearSearch:u})=>t?m.jsxs("div",{className:"flex justify-center items-center py-20",children:[m.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"}),m.jsxs("span",{className:"ml-2 text-lg",children:["Loading ",r==="drink"?"drinks":"dishes","..."]})]}):e.length>0?m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:e.map(h=>m.jsx(Mae,{item:h,menuType:r,onClick:()=>i(h.id,r)},h.id))}):m.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg bg-muted/30",children:[m.jsx("h3",{className:"text-xl font-medium mb-2",children:"No items found"}),m.jsx("p",{className:"text-muted-foreground mb-4",children:a?"No items match your search criteria. Try something else.":`No ${r==="drink"?"drinks":"dishes"} available in this category yet.`}),a&&m.jsx(Et,{variant:"outline",onClick:u,children:"Clear Search"})]}),kae=()=>{const{dishes:e,drinks:t,dishCategories:r,drinkCategories:i,loading:a,refreshCategories:u}=ca(),h=Tc(),[g,s]=A.useState("dish"),[_,b]=A.useState("All"),[C,M]=A.useState("All"),[D,N]=A.useState(""),[j,V]=A.useState([...e,...t]);A.useEffect(()=>{u()},[]),A.useEffect(()=>{let Z=g==="dish"?e:t;const Q=g==="dish"?_:C;if(Q!=="All"&&(Z=Z.filter(re=>re.category===Q)),D){const re=D.toLowerCase();Z=Z.filter(oe=>oe.name.toLowerCase().includes(re)||oe.description.toLowerCase().includes(re)||oe.ingredients.some(pe=>pe.toLowerCase().includes(re)))}V(Z)},[e,t,_,C,D,g]);const B=(Z,Q)=>{h(`/menu?id=${Z}&type=${Q}`)},z=Z=>{N(Z.target.value)},U=()=>{N("")};return m.jsx("div",{className:"space-y-6",children:m.jsxs(Mh,{defaultValue:"dish",onValueChange:Z=>s(Z),className:"w-full",children:[m.jsx("div",{className:"flex justify-center mb-6",children:m.jsxs(qu,{className:"grid grid-cols-2 w-full max-w-md",children:[m.jsx(Sn,{value:"dish",className:"text-base",children:"Food Menu"}),m.jsx(Sn,{value:"drink",className:"text-base",children:"Drinks Menu"})]})}),m.jsx(Cae,{searchQuery:D,handleSearchChange:z,clearSearch:U,menuType:g}),m.jsxs(ni,{value:"dish",className:"mt-4 space-y-6",children:[m.jsx(j3,{categories:r,activeCategory:_,setActiveCategory:b}),m.jsx(L3,{items:j,loading:a,menuType:g,handleItemClick:B,searchQuery:D,clearSearch:U})]}),m.jsxs(ni,{value:"drink",className:"mt-4 space-y-6",children:[m.jsx(j3,{categories:i,activeCategory:C,setActiveCategory:M}),m.jsx(L3,{items:j,loading:a,menuType:g,handleItemClick:B,searchQuery:D,clearSearch:U})]})]})})},Pae=({title:e="YBF Resto",suffix:t="Young Brave Fearless Restaurant"})=>(A.useEffect(()=>{const r=t?`${e} - ${t}`:e;return document.title=r,()=>{document.title="YBF Resto - Young Brave Fearless Restaurant"}},[e,t]),null),Aae=()=>{const e=la(),{dishes:t,drinks:r,selectedDish:i,setSelectedDish:a,selectedDrink:u,setSelectedDrink:h,refreshCategories:g}=ca();Fv(),A.useEffect(()=>{window.scrollTo(0,0),g();const b=new URLSearchParams(e.search),C=b.get("id"),M=b.get("type");if(C)if(M==="drink"){const D=r.find(N=>N.id===C);if(D){h(D),a(null);return}}else if(M==="dish"){const D=t.find(N=>N.id===C);if(D){a(D),h(null);return}}else{const D=t.find(j=>j.id===C);if(D){a(D),h(null);return}const N=r.find(j=>j.id===C);N&&(h(N),a(null))}else i&&a(null),u&&h(null)},[e.search,t,r]);const s=i||u,_=()=>{a(null),h(null);const b=new URL(window.location.href);b.searchParams.delete("id"),b.searchParams.delete("type"),window.history.pushState({},"",b)};return m.jsxs("div",{className:"min-h-screen pt-16 md:pt-20 page-transition-in",children:[m.jsx(Pae,{title:"Menu"}),m.jsx("div",{className:"container-custom section-padding py-8 md:py-12",children:s?m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm overflow-y-auto",onClick:_,children:m.jsxs("div",{className:"relative bg-background rounded-xl shadow-xl w-full max-w-3xl mx-auto my-auto animate-fadeIn max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[m.jsx(Et,{variant:"ghost",size:"icon",onClick:_,className:"absolute right-2 top-2 z-10","aria-label":"Close detail",children:m.jsx(Ls,{className:"h-5 w-5"})}),m.jsx("div",{className:"p-2 sm:p-4",children:m.jsx(_v,{dish:s,detailed:!0})})]})}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[m.jsx("h1",{className:"text-2xl md:text-4xl font-display font-semibold mb-3 md:mb-4",children:"Our Menu"}),m.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto text-sm md:text-base",children:"Explore our carefully crafted selection of dishes and drinks, prepared with the finest ingredients and attention to detail."})]}),m.jsx(kae,{})]})})]})};var Iae="VisuallyHidden",GP=A.forwardRef((e,t)=>m.jsx(sr.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));GP.displayName=Iae;var Dae=GP,ym="NavigationMenu",[HP,T6,Rae]=dm(ym),[oM,Nae,jae]=dm(ym),[qP,Efe]=Ya(ym,[Rae,jae]),[Lae,ua]=qP(ym),[Oae,zae]=qP(ym),C6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,value:i,onValueChange:a,defaultValue:u,delayDuration:h=200,skipDelayDuration:g=300,orientation:s="horizontal",dir:_,...b}=e,[C,M]=A.useState(null),D=Cr(t,ve=>M(ve)),N=Nh(_),j=A.useRef(0),V=A.useRef(0),B=A.useRef(0),[z,U]=A.useState(!0),[Z="",Q]=Wa({prop:i,onChange:ve=>{const he=ve!=="",Ke=g>0;he?(window.clearTimeout(B.current),Ke&&U(!1)):(window.clearTimeout(B.current),B.current=window.setTimeout(()=>U(!0),g)),a==null||a(ve)},defaultProp:u}),re=A.useCallback(()=>{window.clearTimeout(V.current),V.current=window.setTimeout(()=>Q(""),150)},[Q]),oe=A.useCallback(ve=>{window.clearTimeout(V.current),Q(ve)},[Q]),pe=A.useCallback(ve=>{Z===ve?window.clearTimeout(V.current):j.current=window.setTimeout(()=>{window.clearTimeout(V.current),Q(ve)},h)},[Z,Q,h]);return A.useEffect(()=>()=>{window.clearTimeout(j.current),window.clearTimeout(V.current),window.clearTimeout(B.current)},[]),m.jsx(k6,{scope:r,isRootMenu:!0,value:Z,dir:N,orientation:s,rootNavigationMenu:C,onTriggerEnter:ve=>{window.clearTimeout(j.current),z?pe(ve):oe(ve)},onTriggerLeave:()=>{window.clearTimeout(j.current),re()},onContentEnter:()=>window.clearTimeout(V.current),onContentLeave:re,onItemSelect:ve=>{Q(he=>he===ve?"":ve)},onItemDismiss:()=>Q(""),children:m.jsx(sr.nav,{"aria-label":"Main","data-orientation":s,dir:N,...b,ref:D})})});C6.displayName=ym;var M6="NavigationMenuSub",Fae=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,value:i,onValueChange:a,defaultValue:u,orientation:h="horizontal",...g}=e,s=ua(M6,r),[_="",b]=Wa({prop:i,onChange:a,defaultProp:u});return m.jsx(k6,{scope:r,isRootMenu:!1,value:_,dir:s.dir,orientation:h,rootNavigationMenu:s.rootNavigationMenu,onTriggerEnter:C=>b(C),onItemSelect:C=>b(C),onItemDismiss:()=>b(""),children:m.jsx(sr.div,{"data-orientation":h,...g,ref:t})})});Fae.displayName=M6;var k6=e=>{const{scope:t,isRootMenu:r,rootNavigationMenu:i,dir:a,orientation:u,children:h,value:g,onItemSelect:s,onItemDismiss:_,onTriggerEnter:b,onTriggerLeave:C,onContentEnter:M,onContentLeave:D}=e,[N,j]=A.useState(null),[V,B]=A.useState(new Map),[z,U]=A.useState(null);return m.jsx(Lae,{scope:t,isRootMenu:r,rootNavigationMenu:i,value:g,previousValue:eb(g),baseId:Po(),dir:a,orientation:u,viewport:N,onViewportChange:j,indicatorTrack:z,onIndicatorTrackChange:U,onTriggerEnter:jn(b),onTriggerLeave:jn(C),onContentEnter:jn(M),onContentLeave:jn(D),onItemSelect:jn(s),onItemDismiss:jn(_),onViewportContentChange:A.useCallback((Z,Q)=>{B(re=>(re.set(Z,Q),new Map(re)))},[]),onViewportContentRemove:A.useCallback(Z=>{B(Q=>Q.has(Z)?(Q.delete(Z),new Map(Q)):Q)},[]),children:m.jsx(HP.Provider,{scope:t,children:m.jsx(Oae,{scope:t,items:V,children:h})})})},P6="NavigationMenuList",A6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,...i}=e,a=ua(P6,r),u=m.jsx(sr.ul,{"data-orientation":a.orientation,...i,ref:t});return m.jsx(sr.div,{style:{position:"relative"},ref:a.onIndicatorTrackChange,children:m.jsx(HP.Slot,{scope:r,children:a.isRootMenu?m.jsx(F6,{asChild:!0,children:u}):u})})});A6.displayName=P6;var I6="NavigationMenuItem",[Bae,D6]=qP(I6),R6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,value:i,...a}=e,u=Po(),h=i||u||"LEGACY_REACT_AUTO_VALUE",g=A.useRef(null),s=A.useRef(null),_=A.useRef(null),b=A.useRef(()=>{}),C=A.useRef(!1),M=A.useCallback((N="start")=>{if(g.current){b.current();const j=lM(g.current);j.length&&YP(N==="start"?j:j.reverse())}},[]),D=A.useCallback(()=>{if(g.current){const N=lM(g.current);N.length&&(b.current=Zae(N))}},[]);return m.jsx(Bae,{scope:r,value:h,triggerRef:s,contentRef:g,focusProxyRef:_,wasEscapeCloseRef:C,onEntryKeyDown:M,onFocusProxyEnter:M,onRootContentClose:D,onContentFocusOutside:D,children:m.jsx(sr.li,{...a,ref:t})})});R6.displayName=I6;var aM="NavigationMenuTrigger",N6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,disabled:i,...a}=e,u=ua(aM,e.__scopeNavigationMenu),h=D6(aM,e.__scopeNavigationMenu),g=A.useRef(null),s=Cr(g,h.triggerRef,t),_=U6(u.baseId,h.value),b=V6(u.baseId,h.value),C=A.useRef(!1),M=A.useRef(!1),D=h.value===u.value;return m.jsxs(m.Fragment,{children:[m.jsx(HP.ItemSlot,{scope:r,value:h.value,children:m.jsx(B6,{asChild:!0,children:m.jsx(sr.button,{id:_,disabled:i,"data-disabled":i?"":void 0,"data-state":KP(D),"aria-expanded":D,"aria-controls":b,...a,ref:s,onPointerEnter:kt(e.onPointerEnter,()=>{M.current=!1,h.wasEscapeCloseRef.current=!1}),onPointerMove:kt(e.onPointerMove,$1(()=>{i||M.current||h.wasEscapeCloseRef.current||C.current||(u.onTriggerEnter(h.value),C.current=!0)})),onPointerLeave:kt(e.onPointerLeave,$1(()=>{i||(u.onTriggerLeave(),C.current=!1)})),onClick:kt(e.onClick,()=>{u.onItemSelect(h.value),M.current=D}),onKeyDown:kt(e.onKeyDown,N=>{const V={horizontal:"ArrowDown",vertical:u.dir==="rtl"?"ArrowLeft":"ArrowRight"}[u.orientation];D&&N.key===V&&(h.onEntryKeyDown(),N.preventDefault())})})})}),D&&m.jsxs(m.Fragment,{children:[m.jsx(Dae,{"aria-hidden":!0,tabIndex:0,ref:h.focusProxyRef,onFocus:N=>{const j=h.contentRef.current,V=N.relatedTarget,B=V===g.current,z=j==null?void 0:j.contains(V);(B||!z)&&h.onFocusProxyEnter(B?"start":"end")}}),u.viewport&&m.jsx("span",{"aria-owns":b})]})]})});N6.displayName=aM;var Uae="NavigationMenuLink",O3="navigationMenu.linkSelect",Vae=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,active:i,onSelect:a,...u}=e;return m.jsx(B6,{asChild:!0,children:m.jsx(sr.a,{"data-active":i?"":void 0,"aria-current":i?"page":void 0,...u,ref:t,onClick:kt(e.onClick,h=>{const g=h.target,s=new CustomEvent(O3,{bubbles:!0,cancelable:!0});if(g.addEventListener(O3,_=>a==null?void 0:a(_),{once:!0}),T1(g,s),!s.defaultPrevented&&!h.metaKey){const _=new CustomEvent(q0,{bubbles:!0,cancelable:!0});T1(g,_)}},{checkForDefaultPrevented:!1})})})});Vae.displayName=Uae;var ZP="NavigationMenuIndicator",j6=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=ua(ZP,e.__scopeNavigationMenu),u=!!a.value;return a.indicatorTrack?Ek.createPortal(m.jsx(ji,{present:r||u,children:m.jsx($ae,{...i,ref:t})}),a.indicatorTrack):null});j6.displayName=ZP;var $ae=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,...i}=e,a=ua(ZP,r),u=T6(r),[h,g]=A.useState(null),[s,_]=A.useState(null),b=a.orientation==="horizontal",C=!!a.value;A.useEffect(()=>{var j;const N=(j=u().find(V=>V.value===a.value))==null?void 0:j.ref.current;N&&g(N)},[u,a.value]);const M=()=>{h&&_({size:b?h.offsetWidth:h.offsetHeight,offset:b?h.offsetLeft:h.offsetTop})};return cM(h,M),cM(a.indicatorTrack,M),s?m.jsx(sr.div,{"aria-hidden":!0,"data-state":C?"visible":"hidden","data-orientation":a.orientation,...i,ref:t,style:{position:"absolute",...b?{left:0,width:s.size+"px",transform:`translateX(${s.offset}px)`}:{top:0,height:s.size+"px",transform:`translateY(${s.offset}px)`},...i.style}}):null}),Vp="NavigationMenuContent",L6=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=ua(Vp,e.__scopeNavigationMenu),u=D6(Vp,e.__scopeNavigationMenu),h=Cr(u.contentRef,t),g=u.value===a.value,s={value:u.value,triggerRef:u.triggerRef,focusProxyRef:u.focusProxyRef,wasEscapeCloseRef:u.wasEscapeCloseRef,onContentFocusOutside:u.onContentFocusOutside,onRootContentClose:u.onRootContentClose,...i};return a.viewport?m.jsx(Wae,{forceMount:r,...s,ref:h}):m.jsx(ji,{present:r||g,children:m.jsx(O6,{"data-state":KP(g),...s,ref:h,onPointerEnter:kt(e.onPointerEnter,a.onContentEnter),onPointerLeave:kt(e.onPointerLeave,$1(a.onContentLeave)),style:{pointerEvents:!g&&a.isRootMenu?"none":void 0,...s.style}})})});L6.displayName=Vp;var Wae=A.forwardRef((e,t)=>{const r=ua(Vp,e.__scopeNavigationMenu),{onViewportContentChange:i,onViewportContentRemove:a}=r;return Ni(()=>{i(e.value,{ref:t,...e})},[e,t,i]),Ni(()=>()=>a(e.value),[e.value,a]),null}),q0="navigationMenu.rootContentDismiss",O6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,value:i,triggerRef:a,focusProxyRef:u,wasEscapeCloseRef:h,onRootContentClose:g,onContentFocusOutside:s,..._}=e,b=ua(Vp,r),C=A.useRef(null),M=Cr(C,t),D=U6(b.baseId,i),N=V6(b.baseId,i),j=T6(r),V=A.useRef(null),{onItemDismiss:B}=b;A.useEffect(()=>{const U=C.current;if(b.isRootMenu&&U){const Z=()=>{var Q;B(),g(),U.contains(document.activeElement)&&((Q=a.current)==null||Q.focus())};return U.addEventListener(q0,Z),()=>U.removeEventListener(q0,Z)}},[b.isRootMenu,e.value,a,B,g]);const z=A.useMemo(()=>{const Z=j().map(he=>he.value);b.dir==="rtl"&&Z.reverse();const Q=Z.indexOf(b.value),re=Z.indexOf(b.previousValue),oe=i===b.value,pe=re===Z.indexOf(i);if(!oe&&!pe)return V.current;const ve=(()=>{if(Q!==re){if(oe&&re!==-1)return Q>re?"from-end":"from-start";if(pe&&Q!==-1)return Q>re?"to-start":"to-end"}return null})();return V.current=ve,ve},[b.previousValue,b.value,b.dir,j,i]);return m.jsx(F6,{asChild:!0,children:m.jsx(lm,{id:N,"aria-labelledby":D,"data-motion":z,"data-orientation":b.orientation,..._,ref:M,disableOutsidePointerEvents:!1,onDismiss:()=>{var Z;const U=new Event(q0,{bubbles:!0,cancelable:!0});(Z=C.current)==null||Z.dispatchEvent(U)},onFocusOutside:kt(e.onFocusOutside,U=>{var Q;s();const Z=U.target;(Q=b.rootNavigationMenu)!=null&&Q.contains(Z)&&U.preventDefault()}),onPointerDownOutside:kt(e.onPointerDownOutside,U=>{var oe;const Z=U.target,Q=j().some(pe=>{var ve;return(ve=pe.ref.current)==null?void 0:ve.contains(Z)}),re=b.isRootMenu&&((oe=b.viewport)==null?void 0:oe.contains(Z));(Q||re||!b.isRootMenu)&&U.preventDefault()}),onKeyDown:kt(e.onKeyDown,U=>{var re;const Z=U.altKey||U.ctrlKey||U.metaKey;if(U.key==="Tab"&&!Z){const oe=lM(U.currentTarget),pe=document.activeElement,ve=oe.findIndex(qe=>qe===pe),Ke=U.shiftKey?oe.slice(0,ve).reverse():oe.slice(ve+1,oe.length);YP(Ke)?U.preventDefault():(re=u.current)==null||re.focus()}}),onEscapeKeyDown:kt(e.onEscapeKeyDown,U=>{h.current=!0})})})}),XP="NavigationMenuViewport",z6=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,u=!!ua(XP,e.__scopeNavigationMenu).value;return m.jsx(ji,{present:r||u,children:m.jsx(Gae,{...i,ref:t})})});z6.displayName=XP;var Gae=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,children:i,...a}=e,u=ua(XP,r),h=Cr(t,u.onViewportChange),g=zae(Vp,e.__scopeNavigationMenu),[s,_]=A.useState(null),[b,C]=A.useState(null),M=s?(s==null?void 0:s.width)+"px":void 0,D=s?(s==null?void 0:s.height)+"px":void 0,N=!!u.value,j=N?u.value:u.previousValue;return cM(b,()=>{b&&_({width:b.offsetWidth,height:b.offsetHeight})}),m.jsx(sr.div,{"data-state":KP(N),"data-orientation":u.orientation,...a,ref:h,style:{pointerEvents:!N&&u.isRootMenu?"none":void 0,"--radix-navigation-menu-viewport-width":M,"--radix-navigation-menu-viewport-height":D,...a.style},onPointerEnter:kt(e.onPointerEnter,u.onContentEnter),onPointerLeave:kt(e.onPointerLeave,$1(u.onContentLeave)),children:Array.from(g.items).map(([B,{ref:z,forceMount:U,...Z}])=>{const Q=j===B;return m.jsx(ji,{present:U||Q,children:m.jsx(O6,{...Z,ref:Vv(z,re=>{Q&&re&&C(re)})})},B)})})}),Hae="FocusGroup",F6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,...i}=e,a=ua(Hae,r);return m.jsx(oM.Provider,{scope:r,children:m.jsx(oM.Slot,{scope:r,children:m.jsx(sr.div,{dir:a.dir,...i,ref:t})})})}),z3=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],qae="FocusGroupItem",B6=A.forwardRef((e,t)=>{const{__scopeNavigationMenu:r,...i}=e,a=Nae(r),u=ua(qae,r);return m.jsx(oM.ItemSlot,{scope:r,children:m.jsx(sr.button,{...i,ref:t,onKeyDown:kt(e.onKeyDown,h=>{if(["Home","End",...z3].includes(h.key)){let s=a().map(C=>C.ref.current);if([u.dir==="rtl"?"ArrowRight":"ArrowLeft","ArrowUp","End"].includes(h.key)&&s.reverse(),z3.includes(h.key)){const C=s.indexOf(h.currentTarget);s=s.slice(C+1)}setTimeout(()=>YP(s)),h.preventDefault()}})})})});function lM(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function YP(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}function Zae(e){return e.forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")}),()=>{e.forEach(t=>{const r=t.dataset.tabindex;t.setAttribute("tabindex",r)})}}function cM(e,t){const r=jn(t);Ni(()=>{let i=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(i),a.unobserve(e)}}},[e,r])}function KP(e){return e?"open":"closed"}function U6(e,t){return`${e}-trigger-${t}`}function V6(e,t){return`${e}-content-${t}`}function $1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var $6=C6,W6=A6,Xae=R6,G6=N6,H6=j6,q6=L6,Z6=z6;const X6=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs($6,{ref:i,className:It("relative z-10 flex max-w-max flex-1 items-center justify-center",e),...r,children:[t,m.jsx(J6,{})]}));X6.displayName=$6.displayName;const Y6=A.forwardRef(({className:e,...t},r)=>m.jsx(W6,{ref:r,className:It("group flex flex-1 list-none items-center justify-center space-x-1",e),...t}));Y6.displayName=W6.displayName;const Yae=Xae,Kae=um("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),K6=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(G6,{ref:i,className:It(Kae(),"group",e),...r,children:[t," ",m.jsx(Ok,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]}));K6.displayName=G6.displayName;const Q6=A.forwardRef(({className:e,...t},r)=>m.jsx(q6,{ref:r,className:It("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",e),...t}));Q6.displayName=q6.displayName;const J6=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{className:It("absolute left-0 top-full flex justify-center"),children:m.jsx(Z6,{className:It("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",e),ref:r,...t})}));J6.displayName=Z6.displayName;const Qae=A.forwardRef(({className:e,...t},r)=>m.jsx(H6,{ref:r,className:It("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",e),...t,children:m.jsx("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})}));Qae.displayName=H6.displayName;const Jae=({defaultTab:e="dishes",children:t})=>{const r=mm(),[i,a]=A.useState(e),u=la(),h=Tc();A.useEffect(()=>{const _=new URLSearchParams(u.search).get("tab");_&&a(_)},[u]);const g=s=>{a(s),h(`/admin?tab=${s}`,{replace:!0})};return r?m.jsxs("div",{className:"space-y-4 md:space-y-6",children:[m.jsx(X6,{children:m.jsx(Y6,{children:m.jsxs(Yae,{children:[m.jsxs(K6,{children:[m.jsx(CX,{className:"h-4 w-4 mr-2"}),"Admin Sections"]}),m.jsx(Q6,{children:m.jsxs("ul",{className:"grid w-[95vw] gap-2 p-2",children:[m.jsx(Zd,{value:"dishes",activeTab:i,icon:m.jsx(KN,{className:"h-4 w-4 mr-2"}),label:"Dishes",onSelect:g}),m.jsx(Zd,{value:"drinks",activeTab:i,icon:m.jsx(hv,{className:"h-4 w-4 mr-2"}),label:"Drinks",onSelect:g}),m.jsx(Zd,{value:"categories",activeTab:i,icon:m.jsx(Fk,{className:"h-4 w-4 mr-2"}),label:"Categories",onSelect:g}),m.jsx(Zd,{value:"hero",activeTab:i,icon:m.jsx(OE,{className:"h-4 w-4 mr-2"}),label:"Hero Slides",onSelect:g}),m.jsx(Zd,{value:"qrcodes",activeTab:i,icon:m.jsx(AX,{className:"h-4 w-4 mr-2"}),label:"QR Codes",onSelect:g}),m.jsx(Zd,{value:"ads",activeTab:i,icon:m.jsx(OE,{className:"h-4 w-4 mr-2"}),label:"Ads",onSelect:g}),m.jsx(Zd,{value:"settings",activeTab:i,icon:m.jsx(AC,{className:"h-4 w-4 mr-2"}),label:"Settings",onSelect:g})]})})]})})}),m.jsxs(Mh,{value:i,onValueChange:g,className:"space-y-4 md:space-y-6",children:[m.jsxs(qu,{className:"hidden",children:[m.jsx(Sn,{value:"dishes",children:"Dishes"}),m.jsx(Sn,{value:"drinks",children:"Drinks"}),m.jsx(Sn,{value:"categories",children:"Categories"}),m.jsx(Sn,{value:"hero",children:"Hero Slides"}),m.jsx(Sn,{value:"qrcodes",children:"QR Codes"}),m.jsx(Sn,{value:"ads",children:"Ads"}),m.jsx(Sn,{value:"settings",children:"Settings"})]}),t]})]}):m.jsxs(Mh,{value:i,onValueChange:g,className:"space-y-4 md:space-y-6",children:[m.jsxs(qu,{className:"grid w-full grid-cols-7",children:[m.jsxs(Sn,{value:"dishes",className:"flex items-center gap-1",children:[m.jsx(KN,{className:"h-4 w-4"}),m.jsx("span",{className:"hidden sm:inline",children:"Manage"})," Dishes"]}),m.jsxs(Sn,{value:"drinks",className:"flex items-center gap-1",children:[m.jsx(hv,{className:"h-4 w-4"}),m.jsx("span",{className:"hidden sm:inline",children:"Manage"})," Drinks"]}),m.jsxs(Sn,{value:"categories",className:"flex items-center gap-1",children:[m.jsx("span",{className:"hidden sm:inline",children:"Manage "})," Categories"]}),m.jsxs(Sn,{value:"hero",className:"flex items-center gap-1",children:[m.jsx("span",{className:"hidden sm:inline",children:"Manage "})," Hero Slides"]}),m.jsx(Sn,{value:"qrcodes",className:"flex items-center gap-1",children:"QR Codes"}),m.jsxs(Sn,{value:"ads",className:"flex items-center gap-1",children:[m.jsx(OE,{className:"h-4 w-4"}),m.jsx("span",{className:"hidden sm:inline",children:"Manage"})," Ads"]}),m.jsxs(Sn,{value:"settings",className:"flex items-center gap-1",children:[m.jsx(AC,{className:"h-4 w-4"}),m.jsx("span",{className:"hidden sm:inline",children:"Website"})," Settings"]})]}),t]})},Zd=({value:e,activeTab:t,icon:r,label:i,onSelect:a})=>{const u=e===t;return m.jsxs("li",{onClick:()=>a(e),className:`flex items-center rounded-md p-3 cursor-pointer ${u?"bg-primary/10 text-primary":"hover:bg-muted"}`,children:[r,i]})},ele=()=>m.jsxs("div",{className:"flex justify-center items-center py-20",children:[m.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"}),m.jsx("span",{className:"ml-2 text-lg",children:"Loading items..."})]}),tle=({type:e,onAddItem:t})=>{const r=i=>{i.preventDefault(),i.stopPropagation(),console.log(`Add ${e} button clicked`),t()};return m.jsxs("div",{className:"text-center py-8 md:py-12",children:[m.jsx("p",{className:"text-muted-foreground mb-4",children:e==="drink"?"No drinks available":"No dishes available"}),m.jsxs(Et,{onClick:r,variant:"default",className:"cursor-pointer group",children:[m.jsx(El,{className:"h-4 w-4 mr-2 group-hover:scale-110 transition-transform"}),"Add Your First ",e==="drink"?"Drink":"Dish"]})]})},rle=({item:e,type:t,onEdit:r,onDelete:i,onToggleFeature:a,onToggleTopItem:u,isDeleting:h})=>{const g=h===e.id,s=N=>{N.preventDefault(),N.stopPropagation(),r(e)},_=N=>{N.preventDefault(),N.stopPropagation(),!g&&(console.log("Delete button clicked for:",e.name,e.id,t),i(e.id,e.name,t))},b=N=>{N.preventDefault(),N.stopPropagation(),!g&&a(e,t)},C=N=>{N.preventDefault(),N.stopPropagation(),!g&&u(e,t)},M="/placeholder.svg",D=e.images&&e.images.length>0&&e.images[0]||M;return m.jsxs("div",{className:`glass-card rounded-xl overflow-hidden hover-card-animation ${g?"opacity-60":""}`,children:[m.jsxs("div",{className:"relative aspect-square sm:aspect-[4/3] overflow-hidden",children:[m.jsx("img",{src:D,alt:e.name,className:"w-full h-full object-cover",onError:N=>{N.target.src=M}}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"}),m.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 md:p-4",children:[m.jsx("div",{className:"inline-block bg-secondary text-secondary-foreground text-xs font-medium px-2 py-1 rounded mb-1 md:mb-2",children:e.category}),m.jsx("h3",{className:"text-white font-medium text-base md:text-lg line-clamp-1",children:e.name})]}),m.jsx(Et,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-8 w-8 bg-black/30 text-white hover:bg-black/50",onClick:b,disabled:g,"aria-label":e.featured?"Remove from featured":"Add to featured",children:g?m.jsx(_s,{className:"h-4 w-4 animate-spin"}):e.featured?m.jsx(IC,{className:"h-4 w-4 fill-amber-400 text-amber-400"}):m.jsx(GX,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",className:`absolute top-2 right-12 h-8 w-8 bg-black/30 text-white hover:bg-black/50 ${e.isTopDish?"text-primary":""}`,onClick:C,disabled:g,"aria-label":e.isTopDish?`Remove from top ${t}s`:`Add to top ${t}s`,children:g?m.jsx(_s,{className:"h-4 w-4 animate-spin"}):t==="drink"?m.jsx(hv,{className:`h-4 w-4 ${e.isTopDish?"text-blue-400":""}`}):m.jsx(IC,{className:`h-4 w-4 ${e.isTopDish?"fill-primary text-primary":""}`})})]}),m.jsxs("div",{className:"p-3 md:p-4 flex justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:e.promoPrice?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"line-through text-muted-foreground text-sm",children:es(e.price)})," ",m.jsx("span",{className:"font-semibold text-primary",children:es(e.promoPrice)})]}):m.jsx("span",{className:"font-semibold",children:es(e.price)})}),e.isTopDish&&m.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded mt-1 inline-block",children:"Featured"})]}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(Et,{variant:"outline",size:"icon",onClick:s,"aria-label":`Edit ${e.name}`,className:"h-8 w-8",disabled:g,children:m.jsx(fv,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"destructive",size:"icon",onClick:_,"aria-label":`Delete ${e.name}`,className:"h-8 w-8",disabled:g,children:g?m.jsx(_s,{className:"h-4 w-4 animate-spin"}):m.jsx(Bu,{className:"h-4 w-4"})})]})]})]})},nle=({items:e,type:t,onEdit:r,onDelete:i,onToggleFeature:a,onToggleTopItem:u,isDeleting:h})=>m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:e.map(g=>m.jsx(rle,{item:g,type:t,onEdit:r,onDelete:i,onToggleFeature:a,onToggleTopItem:u,isDeleting:h},g.id))}),ile=({currentPage:e,totalPages:t,setCurrentPage:r})=>t<=1?null:m.jsxs("div",{className:"flex justify-center items-center space-x-2 mt-6 md:mt-8",children:[m.jsx(Et,{variant:"outline",size:"icon",onClick:()=>r(Math.max(e-1,1)),disabled:e===1,"aria-label":"Previous page",children:m.jsx(am,{className:"h-4 w-4"})}),m.jsxs("span",{className:"text-sm",children:["Page ",e," of ",t]}),m.jsx(Et,{variant:"outline",size:"icon",onClick:()=>r(Math.min(e+1,t)),disabled:e===t,"aria-label":"Next page",children:m.jsx(Fu,{className:"h-4 w-4"})})]}),sle=({items:e,currentPage:t,totalPages:r,setCurrentPage:i,type:a,onEdit:u,onDelete:h,onToggleFeature:g,onToggleTopItem:s,loading:_,isDeleting:b})=>_&&e.length===0?m.jsx(ele,{}):e.length===0?m.jsx(tle,{type:a,onAddItem:()=>u({id:"",name:"",description:"",price:0,category:"",categoryType:a,ingredients:[],images:[],featured:!1})}):m.jsxs(m.Fragment,{children:[m.jsx(nle,{items:e,type:a,onEdit:u,onDelete:h,onToggleFeature:g,onToggleTopItem:s,isDeleting:b}),r>1&&m.jsx(ile,{currentPage:t,totalPages:r,setCurrentPage:i})]}),F3=({type:e,items:t,loading:r,onAddItem:i,onEditItem:a,onDeleteItem:u,onToggleFeature:h,onToggleTopItem:g,isDeleting:s})=>{const[_,b]=A.useState(""),[C,M]=A.useState([]),[D,N]=A.useState(1),j=6;A.useEffect(()=>{if(t.length>0){if(_.trim()==="")M(t);else{const Z=_.toLowerCase(),Q=t.filter(re=>re.name.toLowerCase().includes(Z)||re.category.toLowerCase().includes(Z));M(Q)}N(1)}},[_,t]);const V=D*j,B=V-j,z=C.slice(B,V),U=Math.ceil(C.length/j);return m.jsxs("div",{className:"space-y-4 md:space-y-6",children:[m.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[m.jsxs("div",{className:"flex items-center w-full sm:w-auto flex-grow max-w-md relative",children:[m.jsx(Mz,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"text",placeholder:`Search ${e==="drink"?"drinks":"dishes"}...`,value:_,onChange:Z=>b(Z.target.value),className:"pl-10 pr-10"}),_&&m.jsx("button",{onClick:()=>b(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":"Clear search",children:m.jsx(Ls,{className:"h-4 w-4"})})]}),m.jsxs(Et,{onClick:i,className:"w-full sm:w-auto",disabled:r,children:[m.jsx(El,{className:"h-4 w-4 mr-2"}),"Add New ",e==="drink"?"Drink":"Dish"]})]}),m.jsx(sle,{items:z,currentPage:D,totalPages:U,setCurrentPage:N,type:e,onEdit:a,onDelete:u,onToggleFeature:h,onToggleTopItem:g,loading:r,isDeleting:s})]})},$p=async e=>{try{return await Cq.uploadFile(e)}catch{throw new Error("Failed to upload file")}},ole=({editingSlideId:e,onSlideAdded:t,onSlideEdited:r,addHeroSlide:i,updateHeroSlide:a,initialSlide:u})=>{const{toast:h}=Hi(),[g,s]=A.useState((u==null?void 0:u.title)||""),[_,b]=A.useState((u==null?void 0:u.description)||""),[C,M]=A.useState((u==null?void 0:u.linkUrl)||""),[D,N]=A.useState(null),[j,V]=A.useState((u==null?void 0:u.imageUrl)||""),[B,z]=A.useState(!1);A.useEffect(()=>{u?(s(u.title||""),b(u.description||""),M(u.linkUrl||""),V(u.imageUrl||""),N(null)):(s(""),b(""),M(""),V(""),N(null))},[u]);const U=re=>{var ve;const oe=(ve=re.target.files)==null?void 0:ve[0];if(!oe)return;N(oe);const pe=URL.createObjectURL(oe);V(pe)},Z=async()=>{if(!g||!_||!D&&!j){h({title:"Missing information",description:"Please provide a title, description, and upload an image.",variant:"destructive"});return}z(!0);try{let re=j;D&&(re=await $p(D)),e?(await a(e,{title:g,description:_,imageUrl:re,linkUrl:C||void 0}),await r(),h({title:"Slide updated",description:"Hero slide has been updated successfully."})):(await i({title:g,description:_,imageUrl:re,linkUrl:C||void 0}),s(""),b(""),M(""),N(null),j&&D&&(URL.revokeObjectURL(j),V("")),await t(),h({title:"Slide added",description:"New hero slide has been added successfully."}))}catch(re){console.error("Error with hero slide:",re),h({title:"Error",description:`Failed to ${e?"update":"add"} hero slide. Please try again.`,variant:"destructive"})}finally{z(!1)}},Q=()=>{s(""),b(""),M(""),N(null),j&&D&&URL.revokeObjectURL(j),V(""),r()};return m.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title*"}),m.jsx(ur,{value:g,onChange:re=>s(re.target.value),placeholder:"Slide title"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description*"}),m.jsx(ur,{value:_,onChange:re=>b(re.target.value),placeholder:"Slide description"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-1",children:"Upload Image*"}),m.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-4 text-center relative",children:[m.jsx("input",{type:"file",accept:"image/*",id:"slide-image",onChange:U,className:"hidden"}),m.jsxs("div",{className:"flex flex-col items-center",children:[j?m.jsx("div",{className:"mb-2 text-xs text-muted-foreground",children:D?"New image selected":"Using existing image"}):m.jsx(Bk,{className:"h-8 w-8 text-muted-foreground mb-2"}),m.jsx("p",{className:"text-sm mb-2",children:j?"Change image":"Click to upload an image"}),m.jsx(Et,{type:"button",variant:"outline",size:"sm",onClick:()=>{var re;return(re=document.getElementById("slide-image"))==null?void 0:re.click()},children:"Select File"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-1",children:"Link URL (optional)"}),m.jsx(ur,{value:C,onChange:re=>M(re.target.value),placeholder:"/menu"})]}),m.jsxs("div",{className:"pt-2",children:[m.jsx(Et,{onClick:Z,disabled:B,children:B?m.jsxs(m.Fragment,{children:[m.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),e?"Saving...":"Adding..."]}):e?"Save Changes":"Add Slide"}),e&&m.jsx(Et,{variant:"outline",onClick:Q,className:"ml-3",disabled:B,children:"Cancel"})]})]}),m.jsx("div",{className:"bg-secondary/50 rounded-lg p-4 flex items-center justify-center",children:j?m.jsxs("div",{className:"relative w-full aspect-video rounded-md overflow-hidden",children:[m.jsx("img",{src:j,alt:"Slide preview",className:"w-full h-full object-cover"}),m.jsxs("div",{className:"absolute inset-0 flex flex-col justify-center items-center text-center p-4 bg-black/30",children:[m.jsx("h3",{className:"text-white text-lg md:text-xl font-medium mb-2",children:g||"Slide Title"}),m.jsx("p",{className:"text-white/90 text-xs md:text-sm",children:_||"Slide Description"})]})]}):m.jsxs("div",{className:"text-center text-muted-foreground",children:[m.jsx(MX,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),m.jsx("p",{children:"Upload an image to see preview"})]})})]})},ale=({heroSlides:e,deleteHeroSlide:t,addHeroSlide:r,updateHeroSlide:i,refreshHeroSlides:a})=>{Hi();const{confirm:u,ConfirmationDialog:h}=Kv(),[g,s]=A.useState(null),[_,b]=A.useState(null),[C,M]=A.useState(void 0);A.useEffect(()=>{if(g){const j=e.find(V=>V.id===g);M(j)}else M(void 0)},[g,e]);const D=async j=>{try{const V=await u({title:"Delete Hero Slide",description:"Are you sure you want to delete this slide? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",type:"error",onConfirm:async()=>{b(j);try{await t(j),await a(),Qs.success("Hero slide has been removed.")}catch(B){console.error("Error deleting hero slide:",B),Qs.error("Failed to delete hero slide. Please try again.")}finally{b(null)}}})}catch(V){console.error("Confirmation was cancelled or failed:",V)}},N=async()=>(s(null),Promise.resolve());return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"glass-card rounded-xl p-4 md:p-6",children:[m.jsx("h2",{className:"text-lg md:text-xl font-semibold mb-4",children:g?"Edit Hero Slide":"Add New Hero Slide"}),m.jsx(ole,{editingSlideId:g,onSlideAdded:a,onSlideEdited:N,addHeroSlide:r,updateHeroSlide:i,initialSlide:C})]}),m.jsxs("h2",{className:"text-lg md:text-xl font-semibold mt-6 flex items-center",children:[m.jsx(WX,{className:"h-5 w-5 mr-2"}),"Current Hero Slides"]}),e.length>0?m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:e.map(j=>m.jsxs("div",{className:"glass-card rounded-xl overflow-hidden",children:[m.jsxs("div",{className:"relative aspect-video",children:[m.jsx("img",{src:j.imageUrl,alt:j.title,className:"w-full h-full object-cover"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"}),m.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-3 md:p-4",children:[m.jsx("h3",{className:"text-white font-medium text-base md:text-lg",children:j.title}),m.jsx("p",{className:"text-white/80 text-xs md:text-sm line-clamp-2",children:j.description})]})]}),m.jsxs("div",{className:"p-3 md:p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[j.linkUrl?m.jsxs("span",{className:"text-xs md:text-sm text-muted-foreground",children:["Link: ",j.linkUrl]}):m.jsx("span",{className:"text-xs md:text-sm text-muted-foreground",children:"No link set"}),m.jsxs("div",{className:"flex space-x-2 w-full sm:w-auto",children:[m.jsxs(Et,{variant:"outline",size:"sm",onClick:()=>s(j.id),className:"h-8 flex-1 sm:flex-initial",disabled:!!_,children:[m.jsx(fv,{className:"h-3.5 w-3.5 mr-1"}),"Edit"]}),m.jsxs(Et,{variant:"destructive",size:"sm",onClick:()=>D(j.id),className:"h-8 flex-1 sm:flex-initial",disabled:_===j.id,children:[_===j.id?m.jsx(_s,{className:"h-3.5 w-3.5 mr-1 animate-spin"}):m.jsx(Bu,{className:"h-3.5 w-3.5 mr-1"}),"Delete"]})]})]})]},j.id))}):m.jsxs("div",{className:"text-center py-8 md:py-12 bg-secondary/30 rounded-xl",children:[m.jsx("p",{className:"text-muted-foreground mb-4",children:"No hero slides available"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Add your first slide using the form above"})]}),m.jsx(h,{})]})},lle=()=>{const[e,t]=A.useState(""),[r,i]=A.useState(null),[a,u]=A.useState("dish"),[h,g]=A.useState(""),[s,_]=A.useState(!1),[b,C]=A.useState(!1),[M,D]=A.useState("dish"),[N,j]=A.useState("dish"),{categories:V,addCategory:B,deleteCategory:z,isUnusedCategory:U,refreshCategories:Z}=ca(),{toast:Q}=Hi(),re=V.filter(Ie=>Ie.type==="dish").map(Ie=>Ie.name),oe=V.filter(Ie=>Ie.type==="drink").map(Ie=>Ie.name);A.useEffect(()=>{Z()},[]);const pe=async Ie=>{if(Ie.preventDefault(),!e.trim()){Q({title:"Error",description:"Category name cannot be empty",variant:"destructive"});return}_(!0);try{await B(e.trim(),N),t("")}catch(rt){console.error("Error adding category:",rt)}finally{_(!1)}},ve=(Ie,rt)=>{i(Ie),u(rt),g(Ie),C(!0)},he=async()=>{if(!r||!h.trim()){Q({title:"Error",description:"Category name cannot be empty",variant:"destructive"});return}if(r===h){C(!1);return}_(!0);try{await z(r,a),await B(h.trim(),a),C(!1),Q({title:"Success",description:`Category renamed to "${h}"`})}catch(Ie){console.error("Error updating category:",Ie),Q({title:"Error",description:"Failed to update category. Please try again.",variant:"destructive"})}finally{_(!1)}},Ke=async(Ie,rt)=>{if(!U(Ie,rt)){Q({title:"Cannot delete category",description:"This category is being used by one or more dishes.",variant:"destructive"});return}_(!0);try{await z(Ie,rt)}catch(Pt){console.error("Error deleting category:",Pt)}finally{_(!1)}},qe=Ie=>{D(Ie),j(Ie)};return m.jsxs("div",{className:"space-y-6",children:[m.jsx("div",{className:"flex items-center justify-between mb-6",children:m.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[m.jsx(Fk,{className:"mr-2 h-5 w-5"}),"Manage Categories"]})}),m.jsxs(Mh,{value:M,onValueChange:qe,className:"w-full",children:[m.jsxs(qu,{className:"grid grid-cols-2 mb-4",children:[m.jsxs(Sn,{value:"dish",className:"flex items-center",children:[m.jsx(YX,{className:"mr-2 h-4 w-4"}),"Dish Categories"]}),m.jsxs(Sn,{value:"drink",className:"flex items-center",children:[m.jsx(gX,{className:"mr-2 h-4 w-4"}),"Drink Categories"]})]}),m.jsxs(ni,{value:"dish",className:"space-y-6",children:[m.jsxs("div",{className:"glass-card rounded-xl p-4",children:[m.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add New Dish Category"}),m.jsxs("form",{onSubmit:pe,className:"flex gap-2",children:[m.jsx(ur,{value:e,onChange:Ie=>t(Ie.target.value),placeholder:"Category name",className:"flex-1",maxLength:50}),m.jsx(Et,{type:"submit",disabled:s,children:s?m.jsxs(m.Fragment,{children:[m.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):m.jsxs(m.Fragment,{children:[m.jsx(El,{className:"mr-2 h-4 w-4"})," Add Category"]})})]})]}),m.jsxs("div",{className:"glass-card rounded-xl p-4",children:[m.jsx("h3",{className:"text-lg font-medium mb-4",children:"Current Dish Categories"}),re.length>0?m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:re.map(Ie=>m.jsxs(Wi,{className:"p-4 flex items-center justify-between",children:[m.jsx("span",{className:"font-medium",children:Ie}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(Et,{variant:"outline",size:"sm",onClick:()=>ve(Ie,"dish"),disabled:s,children:[m.jsx(fv,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Edit"})]}),m.jsxs(Et,{variant:"destructive",size:"sm",onClick:()=>Ke(Ie,"dish"),disabled:s||!U(Ie,"dish"),children:[m.jsx(Bu,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Delete"})]})]})]},Ie))}):m.jsx("div",{className:"text-center py-8 bg-secondary/30 rounded-xl",children:m.jsx("p",{className:"text-muted-foreground",children:"No dish categories available. Add your first category above."})})]})]}),m.jsxs(ni,{value:"drink",className:"space-y-6",children:[m.jsxs("div",{className:"glass-card rounded-xl p-4",children:[m.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add New Drink Category"}),m.jsxs("form",{onSubmit:pe,className:"flex gap-2",children:[m.jsx(ur,{value:e,onChange:Ie=>t(Ie.target.value),placeholder:"Category name",className:"flex-1",maxLength:50}),m.jsx(Et,{type:"submit",disabled:s,children:s?m.jsxs(m.Fragment,{children:[m.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):m.jsxs(m.Fragment,{children:[m.jsx(El,{className:"mr-2 h-4 w-4"})," Add Category"]})})]})]}),m.jsxs("div",{className:"glass-card rounded-xl p-4",children:[m.jsx("h3",{className:"text-lg font-medium mb-4",children:"Current Drink Categories"}),oe.length>0?m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:oe.map(Ie=>m.jsxs(Wi,{className:"p-4 flex items-center justify-between",children:[m.jsx("span",{className:"font-medium",children:Ie}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(Et,{variant:"outline",size:"sm",onClick:()=>ve(Ie,"drink"),disabled:s,children:[m.jsx(fv,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Edit"})]}),m.jsxs(Et,{variant:"destructive",size:"sm",onClick:()=>Ke(Ie,"drink"),disabled:s||!U(Ie,"drink"),children:[m.jsx(Bu,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Delete"})]})]})]},Ie))}):m.jsx("div",{className:"text-center py-8 bg-secondary/30 rounded-xl",children:m.jsx("p",{className:"text-muted-foreground",children:"No drink categories available. Add your first category above."})})]})]})]}),m.jsx(zh,{open:b,onOpenChange:C,children:m.jsxs(ed,{children:[m.jsxs(rx,{children:[m.jsx(nx,{children:"Edit Category"}),m.jsx(gP,{children:"Update the category name. This will update all dishes with this category."})]}),m.jsxs("div",{className:"py-4 space-y-4",children:[m.jsx(ur,{value:h,onChange:Ie=>g(Ie.target.value),placeholder:"Category name",maxLength:50}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("span",{className:"text-sm text-muted-foreground",children:"Category Type:"}),m.jsx("span",{className:"font-medium",children:a==="dish"?"Dish Category":"Drink Category"})]})]}),m.jsxs(rb,{children:[m.jsx(Et,{variant:"outline",onClick:()=>C(!1),disabled:s,children:"Cancel"}),m.jsx(Et,{onClick:he,disabled:s,children:s?m.jsxs(m.Fragment,{children:[m.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})]})};var cle=Object.defineProperty,W1=Object.getOwnPropertySymbols,eV=Object.prototype.hasOwnProperty,tV=Object.prototype.propertyIsEnumerable,B3=(e,t,r)=>t in e?cle(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Tv=(e,t)=>{for(var r in t||(t={}))eV.call(t,r)&&B3(e,r,t[r]);if(W1)for(var r of W1(t))tV.call(t,r)&&B3(e,r,t[r]);return e},QP=(e,t)=>{var r={};for(var i in e)eV.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&W1)for(var i of W1(e))t.indexOf(i)<0&&tV.call(e,i)&&(r[i]=e[i]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var kh;(e=>{const t=class{constructor(s,_,b,C){if(this.version=s,this.errorCorrectionLevel=_,this.modules=[],this.isFunction=[],s<t.MIN_VERSION||s>t.MAX_VERSION)throw new RangeError("Version value out of range");if(C<-1||C>7)throw new RangeError("Mask value out of range");this.size=s*4+17;let M=[];for(let N=0;N<this.size;N++)M.push(!1);for(let N=0;N<this.size;N++)this.modules.push(M.slice()),this.isFunction.push(M.slice());this.drawFunctionPatterns();const D=this.addEccAndInterleave(b);if(this.drawCodewords(D),C==-1){let N=1e9;for(let j=0;j<8;j++){this.applyMask(j),this.drawFormatBits(j);const V=this.getPenaltyScore();V<N&&(C=j,N=V),this.applyMask(j)}}u(0<=C&&C<=7),this.mask=C,this.applyMask(C),this.drawFormatBits(C),this.isFunction=[]}static encodeText(s,_){const b=e.QrSegment.makeSegments(s);return t.encodeSegments(b,_)}static encodeBinary(s,_){const b=e.QrSegment.makeBytes(s);return t.encodeSegments([b],_)}static encodeSegments(s,_,b=1,C=40,M=-1,D=!0){if(!(t.MIN_VERSION<=b&&b<=C&&C<=t.MAX_VERSION)||M<-1||M>7)throw new RangeError("Invalid value");let N,j;for(N=b;;N++){const U=t.getNumDataCodewords(N,_)*8,Z=g.getTotalBits(s,N);if(Z<=U){j=Z;break}if(N>=C)throw new RangeError("Data too long")}for(const U of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])D&&j<=t.getNumDataCodewords(N,U)*8&&(_=U);let V=[];for(const U of s){i(U.mode.modeBits,4,V),i(U.numChars,U.mode.numCharCountBits(N),V);for(const Z of U.getData())V.push(Z)}u(V.length==j);const B=t.getNumDataCodewords(N,_)*8;u(V.length<=B),i(0,Math.min(4,B-V.length),V),i(0,(8-V.length%8)%8,V),u(V.length%8==0);for(let U=236;V.length<B;U^=253)i(U,8,V);let z=[];for(;z.length*8<V.length;)z.push(0);return V.forEach((U,Z)=>z[Z>>>3]|=U<<7-(Z&7)),new t(N,_,z,M)}getModule(s,_){return 0<=s&&s<this.size&&0<=_&&_<this.size&&this.modules[_][s]}getModules(){return this.modules}drawFunctionPatterns(){for(let b=0;b<this.size;b++)this.setFunctionModule(6,b,b%2==0),this.setFunctionModule(b,6,b%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),_=s.length;for(let b=0;b<_;b++)for(let C=0;C<_;C++)b==0&&C==0||b==0&&C==_-1||b==_-1&&C==0||this.drawAlignmentPattern(s[b],s[C]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const _=this.errorCorrectionLevel.formatBits<<3|s;let b=_;for(let M=0;M<10;M++)b=b<<1^(b>>>9)*1335;const C=(_<<10|b)^21522;u(C>>>15==0);for(let M=0;M<=5;M++)this.setFunctionModule(8,M,a(C,M));this.setFunctionModule(8,7,a(C,6)),this.setFunctionModule(8,8,a(C,7)),this.setFunctionModule(7,8,a(C,8));for(let M=9;M<15;M++)this.setFunctionModule(14-M,8,a(C,M));for(let M=0;M<8;M++)this.setFunctionModule(this.size-1-M,8,a(C,M));for(let M=8;M<15;M++)this.setFunctionModule(8,this.size-15+M,a(C,M));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let b=0;b<12;b++)s=s<<1^(s>>>11)*7973;const _=this.version<<12|s;u(_>>>18==0);for(let b=0;b<18;b++){const C=a(_,b),M=this.size-11+b%3,D=Math.floor(b/3);this.setFunctionModule(M,D,C),this.setFunctionModule(D,M,C)}}drawFinderPattern(s,_){for(let b=-4;b<=4;b++)for(let C=-4;C<=4;C++){const M=Math.max(Math.abs(C),Math.abs(b)),D=s+C,N=_+b;0<=D&&D<this.size&&0<=N&&N<this.size&&this.setFunctionModule(D,N,M!=2&&M!=4)}}drawAlignmentPattern(s,_){for(let b=-2;b<=2;b++)for(let C=-2;C<=2;C++)this.setFunctionModule(s+C,_+b,Math.max(Math.abs(C),Math.abs(b))!=1)}setFunctionModule(s,_,b){this.modules[_][s]=b,this.isFunction[_][s]=!0}addEccAndInterleave(s){const _=this.version,b=this.errorCorrectionLevel;if(s.length!=t.getNumDataCodewords(_,b))throw new RangeError("Invalid argument");const C=t.NUM_ERROR_CORRECTION_BLOCKS[b.ordinal][_],M=t.ECC_CODEWORDS_PER_BLOCK[b.ordinal][_],D=Math.floor(t.getNumRawDataModules(_)/8),N=C-D%C,j=Math.floor(D/C);let V=[];const B=t.reedSolomonComputeDivisor(M);for(let U=0,Z=0;U<C;U++){let Q=s.slice(Z,Z+j-M+(U<N?0:1));Z+=Q.length;const re=t.reedSolomonComputeRemainder(Q,B);U<N&&Q.push(0),V.push(Q.concat(re))}let z=[];for(let U=0;U<V[0].length;U++)V.forEach((Z,Q)=>{(U!=j-M||Q>=N)&&z.push(Z[U])});return u(z.length==D),z}drawCodewords(s){if(s.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let _=0;for(let b=this.size-1;b>=1;b-=2){b==6&&(b=5);for(let C=0;C<this.size;C++)for(let M=0;M<2;M++){const D=b-M,j=(b+1&2)==0?this.size-1-C:C;!this.isFunction[j][D]&&_<s.length*8&&(this.modules[j][D]=a(s[_>>>3],7-(_&7)),_++)}}u(_==s.length*8)}applyMask(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(let _=0;_<this.size;_++)for(let b=0;b<this.size;b++){let C;switch(s){case 0:C=(b+_)%2==0;break;case 1:C=_%2==0;break;case 2:C=b%3==0;break;case 3:C=(b+_)%3==0;break;case 4:C=(Math.floor(b/3)+Math.floor(_/2))%2==0;break;case 5:C=b*_%2+b*_%3==0;break;case 6:C=(b*_%2+b*_%3)%2==0;break;case 7:C=((b+_)%2+b*_%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[_][b]&&C&&(this.modules[_][b]=!this.modules[_][b])}}getPenaltyScore(){let s=0;for(let M=0;M<this.size;M++){let D=!1,N=0,j=[0,0,0,0,0,0,0];for(let V=0;V<this.size;V++)this.modules[M][V]==D?(N++,N==5?s+=t.PENALTY_N1:N>5&&s++):(this.finderPenaltyAddHistory(N,j),D||(s+=this.finderPenaltyCountPatterns(j)*t.PENALTY_N3),D=this.modules[M][V],N=1);s+=this.finderPenaltyTerminateAndCount(D,N,j)*t.PENALTY_N3}for(let M=0;M<this.size;M++){let D=!1,N=0,j=[0,0,0,0,0,0,0];for(let V=0;V<this.size;V++)this.modules[V][M]==D?(N++,N==5?s+=t.PENALTY_N1:N>5&&s++):(this.finderPenaltyAddHistory(N,j),D||(s+=this.finderPenaltyCountPatterns(j)*t.PENALTY_N3),D=this.modules[V][M],N=1);s+=this.finderPenaltyTerminateAndCount(D,N,j)*t.PENALTY_N3}for(let M=0;M<this.size-1;M++)for(let D=0;D<this.size-1;D++){const N=this.modules[M][D];N==this.modules[M][D+1]&&N==this.modules[M+1][D]&&N==this.modules[M+1][D+1]&&(s+=t.PENALTY_N2)}let _=0;for(const M of this.modules)_=M.reduce((D,N)=>D+(N?1:0),_);const b=this.size*this.size,C=Math.ceil(Math.abs(_*20-b*10)/b)-1;return u(0<=C&&C<=9),s+=C*t.PENALTY_N4,u(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,_=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2;let b=[6];for(let C=this.size-7;b.length<s;C-=_)b.splice(1,0,C);return b}}static getNumRawDataModules(s){if(s<t.MIN_VERSION||s>t.MAX_VERSION)throw new RangeError("Version number out of range");let _=(16*s+128)*s+64;if(s>=2){const b=Math.floor(s/7)+2;_-=(25*b-10)*b-55,s>=7&&(_-=36)}return u(208<=_&&_<=29648),_}static getNumDataCodewords(s,_){return Math.floor(t.getNumRawDataModules(s)/8)-t.ECC_CODEWORDS_PER_BLOCK[_.ordinal][s]*t.NUM_ERROR_CORRECTION_BLOCKS[_.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw new RangeError("Degree out of range");let _=[];for(let C=0;C<s-1;C++)_.push(0);_.push(1);let b=1;for(let C=0;C<s;C++){for(let M=0;M<_.length;M++)_[M]=t.reedSolomonMultiply(_[M],b),M+1<_.length&&(_[M]^=_[M+1]);b=t.reedSolomonMultiply(b,2)}return _}static reedSolomonComputeRemainder(s,_){let b=_.map(C=>0);for(const C of s){const M=C^b.shift();b.push(0),_.forEach((D,N)=>b[N]^=t.reedSolomonMultiply(D,M))}return b}static reedSolomonMultiply(s,_){if(s>>>8||_>>>8)throw new RangeError("Byte out of range");let b=0;for(let C=7;C>=0;C--)b=b<<1^(b>>>7)*285,b^=(_>>>C&1)*s;return u(b>>>8==0),b}finderPenaltyCountPatterns(s){const _=s[1];u(_<=this.size*3);const b=_>0&&s[2]==_&&s[3]==_*3&&s[4]==_&&s[5]==_;return(b&&s[0]>=_*4&&s[6]>=_?1:0)+(b&&s[6]>=_*4&&s[0]>=_?1:0)}finderPenaltyTerminateAndCount(s,_,b){return s&&(this.finderPenaltyAddHistory(_,b),_=0),_+=this.size,this.finderPenaltyAddHistory(_,b),this.finderPenaltyCountPatterns(b)}finderPenaltyAddHistory(s,_){_[0]==0&&(s+=this.size),_.pop(),_.unshift(s)}};let r=t;r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=r;function i(s,_,b){if(_<0||_>31||s>>>_)throw new RangeError("Value out of range");for(let C=_-1;C>=0;C--)b.push(s>>>C&1)}function a(s,_){return(s>>>_&1)!=0}function u(s){if(!s)throw new Error("Assertion error")}const h=class{constructor(s,_,b){if(this.mode=s,this.numChars=_,this.bitData=b,_<0)throw new RangeError("Invalid argument");this.bitData=b.slice()}static makeBytes(s){let _=[];for(const b of s)i(b,8,_);return new h(h.Mode.BYTE,s.length,_)}static makeNumeric(s){if(!h.isNumeric(s))throw new RangeError("String contains non-numeric characters");let _=[];for(let b=0;b<s.length;){const C=Math.min(s.length-b,3);i(parseInt(s.substr(b,C),10),C*3+1,_),b+=C}return new h(h.Mode.NUMERIC,s.length,_)}static makeAlphanumeric(s){if(!h.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");let _=[],b;for(b=0;b+2<=s.length;b+=2){let C=h.ALPHANUMERIC_CHARSET.indexOf(s.charAt(b))*45;C+=h.ALPHANUMERIC_CHARSET.indexOf(s.charAt(b+1)),i(C,11,_)}return b<s.length&&i(h.ALPHANUMERIC_CHARSET.indexOf(s.charAt(b)),6,_),new h(h.Mode.ALPHANUMERIC,s.length,_)}static makeSegments(s){return s==""?[]:h.isNumeric(s)?[h.makeNumeric(s)]:h.isAlphanumeric(s)?[h.makeAlphanumeric(s)]:[h.makeBytes(h.toUtf8ByteArray(s))]}static makeEci(s){let _=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)i(s,8,_);else if(s<16384)i(2,2,_),i(s,14,_);else if(s<1e6)i(6,3,_),i(s,21,_);else throw new RangeError("ECI assignment value out of range");return new h(h.Mode.ECI,0,_)}static isNumeric(s){return h.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return h.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,_){let b=0;for(const C of s){const M=C.mode.numCharCountBits(_);if(C.numChars>=1<<M)return 1/0;b+=4+M+C.bitData.length}return b}static toUtf8ByteArray(s){s=encodeURI(s);let _=[];for(let b=0;b<s.length;b++)s.charAt(b)!="%"?_.push(s.charCodeAt(b)):(_.push(parseInt(s.substr(b+1,2),16)),b+=2);return _}};let g=h;g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=g})(kh||(kh={}));(e=>{(t=>{const r=class{constructor(a,u){this.ordinal=a,this.formatBits=u}};let i=r;i.LOW=new r(0,1),i.MEDIUM=new r(1,0),i.QUARTILE=new r(2,3),i.HIGH=new r(3,2),t.Ecc=i})(e.QrCode||(e.QrCode={}))})(kh||(kh={}));(e=>{(t=>{const r=class{constructor(a,u){this.modeBits=a,this.numBitsCharCount=u}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};let i=r;i.NUMERIC=new r(1,[10,12,14]),i.ALPHANUMERIC=new r(2,[9,11,13]),i.BYTE=new r(4,[8,16,16]),i.KANJI=new r(8,[8,10,12]),i.ECI=new r(7,[0,0,0]),t.Mode=i})(e.QrSegment||(e.QrSegment={}))})(kh||(kh={}));var up=kh;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var rV={L:up.QrCode.Ecc.LOW,M:up.QrCode.Ecc.MEDIUM,Q:up.QrCode.Ecc.QUARTILE,H:up.QrCode.Ecc.HIGH},nV=128,iV="L",sV="#FFFFFF",oV="#000000",aV=!1,JP=4,ule=.1;function lV(e,t=0){const r=[];return e.forEach(function(i,a){let u=null;i.forEach(function(h,g){if(!h&&u!==null){r.push(`M${u+t} ${a+t}h${g-u}v1H${u+t}z`),u=null;return}if(g===i.length-1){if(!h)return;u===null?r.push(`M${g+t},${a+t} h1v1H${g+t}z`):r.push(`M${u+t},${a+t} h${g+1-u}v1H${u+t}z`);return}h&&u===null&&(u=g)})}),r.join("")}function cV(e,t){return e.slice().map((r,i)=>i<t.y||i>=t.y+t.h?r:r.map((a,u)=>u<t.x||u>=t.x+t.w?a:!1))}function uV(e,t,r,i){if(i==null)return null;const a=r?JP:0,u=e.length+a*2,h=Math.floor(t*ule),g=u/t,s=(i.width||h)*g,_=(i.height||h)*g,b=i.x==null?e.length/2-s/2:i.x*g,C=i.y==null?e.length/2-_/2:i.y*g;let M=null;if(i.excavate){let D=Math.floor(b),N=Math.floor(C),j=Math.ceil(s+b-D),V=Math.ceil(_+C-N);M={x:D,y:N,w:j,h:V}}return{x:b,y:C,h:_,w:s,excavation:M}}var dle=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function hle(e){const t=e,{value:r,size:i=nV,level:a=iV,bgColor:u=sV,fgColor:h=oV,includeMargin:g=aV,style:s,imageSettings:_}=t,b=QP(t,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),C=_==null?void 0:_.src,M=A.useRef(null),D=A.useRef(null),[N,j]=A.useState(!1);A.useEffect(()=>{if(M.current!=null){const z=M.current,U=z.getContext("2d");if(!U)return;let Z=up.QrCode.encodeText(r,rV[a]).getModules();const Q=g?JP:0,re=Z.length+Q*2,oe=uV(Z,i,g,_),pe=D.current,ve=oe!=null&&pe!==null&&pe.complete&&pe.naturalHeight!==0&&pe.naturalWidth!==0;ve&&oe.excavation!=null&&(Z=cV(Z,oe.excavation));const he=window.devicePixelRatio||1;z.height=z.width=i*he;const Ke=i/re*he;U.scale(Ke,Ke),U.fillStyle=u,U.fillRect(0,0,re,re),U.fillStyle=h,dle?U.fill(new Path2D(lV(Z,Q))):Z.forEach(function(qe,Ie){qe.forEach(function(rt,Pt){rt&&U.fillRect(Pt+Q,Ie+Q,1,1)})}),ve&&U.drawImage(pe,oe.x+Q,oe.y+Q,oe.w,oe.h)}}),A.useEffect(()=>{j(!1)},[C]);const V=Tv({height:i,width:i},s);let B=null;return C!=null&&(B=lt.createElement("img",{src:C,key:C,style:{display:"none"},onLoad:()=>{j(!0)},ref:D})),lt.createElement(lt.Fragment,null,lt.createElement("canvas",Tv({style:V,height:i,width:i,ref:M},b)),B)}function fle(e){const t=e,{value:r,size:i=nV,level:a=iV,bgColor:u=sV,fgColor:h=oV,includeMargin:g=aV,imageSettings:s}=t,_=QP(t,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let b=up.QrCode.encodeText(r,rV[a]).getModules();const C=g?JP:0,M=b.length+C*2,D=uV(b,i,g,s);let N=null;s!=null&&D!=null&&(D.excavation!=null&&(b=cV(b,D.excavation)),N=lt.createElement("image",{xlinkHref:s.src,height:D.h,width:D.w,x:D.x+C,y:D.y+C,preserveAspectRatio:"none"}));const j=lV(b,C);return lt.createElement("svg",Tv({height:i,width:i,viewBox:`0 0 ${M} ${M}`},_),lt.createElement("path",{fill:u,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),lt.createElement("path",{fill:h,d:j,shapeRendering:"crispEdges"}),N)}var ple=e=>{const t=e,{renderAs:r}=t,i=QP(t,["renderAs"]);return r==="svg"?lt.createElement(fle,Tv({},i)):lt.createElement(hle,Tv({},i))},mle="Label",dV=A.forwardRef((e,t)=>m.jsx(sr.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));dV.displayName=mle;var hV=dV;const gle=um("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),pr=A.forwardRef(({className:e,...t},r)=>m.jsx(hV,{ref:r,className:It(gle(),e),...t}));pr.displayName=hV.displayName;const yle=({qrType:e,onChange:t})=>m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"qr-type",children:"QR Code Type"}),m.jsxs("select",{id:"qr-type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",value:e,onChange:r=>t(r.target.value),children:[m.jsx("option",{value:"text",children:"Text"}),m.jsx("option",{value:"video",children:"URL / Video Link"})]})]}),yh=A.forwardRef(({className:e,...t},r)=>m.jsx("textarea",{className:It("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));yh.displayName="Textarea";const vle=({qrType:e,qrValue:t,onChange:r})=>{const i=a=>{const u=a.target.value;r(u)};return m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"qr-value",children:"QR Code Content"}),e==="text"?m.jsx(yh,{id:"qr-value",value:t,onChange:i,placeholder:"Enter text content for the QR code",rows:3}):m.jsx(ur,{id:"qr-value",type:"text",value:t,onChange:i,placeholder:e==="url"?"Enter URL (e.g., https://example.com)":"Enter video link (e.g., https://youtube.com/watch?v=...)"})]})},xle=({selectedTemplate:e,onChange:t})=>(lt.useEffect(()=>{e!=="modern"&&t("modern")},[e,t]),m.jsx("div",{className:"hidden",children:m.jsx("input",{type:"hidden",value:"modern",onChange:()=>{}})}));var cx={},_le=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},fV={},Oo={};let eA;const wle=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Oo.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};Oo.getSymbolTotalCodewords=function(t){return wle[t]};Oo.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};Oo.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');eA=t};Oo.isKanjiModeEnabled=function(){return typeof eA<"u"};Oo.toSJIS=function(t){return eA(t)};var ub={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},e.from=function(i,a){if(e.isValid(i))return i;try{return t(i)}catch{return a}}})(ub);function pV(){this.buffer=[],this.length=0}pV.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var ble=pV;function ux(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ux.prototype.set=function(e,t,r,i){const a=e*this.size+t;this.data[a]=r,i&&(this.reservedBit[a]=!0)};ux.prototype.get=function(e,t){return this.data[e*this.size+t]};ux.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};ux.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Sle=ux,mV={};(function(e){const t=Oo.getSymbolSize;e.getRowColCoords=function(i){if(i===1)return[];const a=Math.floor(i/7)+2,u=t(i),h=u===145?26:Math.ceil((u-13)/(2*a-2))*2,g=[u-7];for(let s=1;s<a-1;s++)g[s]=g[s-1]-h;return g.push(6),g.reverse()},e.getPositions=function(i){const a=[],u=e.getRowColCoords(i),h=u.length;for(let g=0;g<h;g++)for(let s=0;s<h;s++)g===0&&s===0||g===0&&s===h-1||g===h-1&&s===0||a.push([u[g],u[s]]);return a}})(mV);var gV={};const Ele=Oo.getSymbolSize,U3=7;gV.getPositions=function(t){const r=Ele(t);return[[0,0],[r-U3,0],[0,r-U3]]};var yV={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},e.from=function(a){return e.isValid(a)?parseInt(a,10):void 0},e.getPenaltyN1=function(a){const u=a.size;let h=0,g=0,s=0,_=null,b=null;for(let C=0;C<u;C++){g=s=0,_=b=null;for(let M=0;M<u;M++){let D=a.get(C,M);D===_?g++:(g>=5&&(h+=t.N1+(g-5)),_=D,g=1),D=a.get(M,C),D===b?s++:(s>=5&&(h+=t.N1+(s-5)),b=D,s=1)}g>=5&&(h+=t.N1+(g-5)),s>=5&&(h+=t.N1+(s-5))}return h},e.getPenaltyN2=function(a){const u=a.size;let h=0;for(let g=0;g<u-1;g++)for(let s=0;s<u-1;s++){const _=a.get(g,s)+a.get(g,s+1)+a.get(g+1,s)+a.get(g+1,s+1);(_===4||_===0)&&h++}return h*t.N2},e.getPenaltyN3=function(a){const u=a.size;let h=0,g=0,s=0;for(let _=0;_<u;_++){g=s=0;for(let b=0;b<u;b++)g=g<<1&2047|a.get(_,b),b>=10&&(g===1488||g===93)&&h++,s=s<<1&2047|a.get(b,_),b>=10&&(s===1488||s===93)&&h++}return h*t.N3},e.getPenaltyN4=function(a){let u=0;const h=a.data.length;for(let s=0;s<h;s++)u+=a.data[s];return Math.abs(Math.ceil(u*100/h/5)-10)*t.N4};function r(i,a,u){switch(i){case e.Patterns.PATTERN000:return(a+u)%2===0;case e.Patterns.PATTERN001:return a%2===0;case e.Patterns.PATTERN010:return u%3===0;case e.Patterns.PATTERN011:return(a+u)%3===0;case e.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(u/3))%2===0;case e.Patterns.PATTERN101:return a*u%2+a*u%3===0;case e.Patterns.PATTERN110:return(a*u%2+a*u%3)%2===0;case e.Patterns.PATTERN111:return(a*u%3+(a+u)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}e.applyMask=function(a,u){const h=u.size;for(let g=0;g<h;g++)for(let s=0;s<h;s++)u.isReserved(s,g)||u.xor(s,g,r(a,s,g))},e.getBestMask=function(a,u){const h=Object.keys(e.Patterns).length;let g=0,s=1/0;for(let _=0;_<h;_++){u(_),e.applyMask(_,a);const b=e.getPenaltyN1(a)+e.getPenaltyN2(a)+e.getPenaltyN3(a)+e.getPenaltyN4(a);e.applyMask(_,a),b<s&&(s=b,g=_)}return g}})(yV);var db={};const Tu=ub,T0=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],C0=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];db.getBlocksCount=function(t,r){switch(r){case Tu.L:return T0[(t-1)*4+0];case Tu.M:return T0[(t-1)*4+1];case Tu.Q:return T0[(t-1)*4+2];case Tu.H:return T0[(t-1)*4+3];default:return}};db.getTotalCodewordsCount=function(t,r){switch(r){case Tu.L:return C0[(t-1)*4+0];case Tu.M:return C0[(t-1)*4+1];case Tu.Q:return C0[(t-1)*4+2];case Tu.H:return C0[(t-1)*4+3];default:return}};var vV={},hb={};const zy=new Uint8Array(512),G1=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)zy[r]=t,G1[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)zy[r]=zy[r-255]})();hb.log=function(t){if(t<1)throw new Error("log("+t+")");return G1[t]};hb.exp=function(t){return zy[t]};hb.mul=function(t,r){return t===0||r===0?0:zy[G1[t]+G1[r]]};(function(e){const t=hb;e.mul=function(i,a){const u=new Uint8Array(i.length+a.length-1);for(let h=0;h<i.length;h++)for(let g=0;g<a.length;g++)u[h+g]^=t.mul(i[h],a[g]);return u},e.mod=function(i,a){let u=new Uint8Array(i);for(;u.length-a.length>=0;){const h=u[0];for(let s=0;s<a.length;s++)u[s]^=t.mul(a[s],h);let g=0;for(;g<u.length&&u[g]===0;)g++;u=u.slice(g)}return u},e.generateECPolynomial=function(i){let a=new Uint8Array([1]);for(let u=0;u<i;u++)a=e.mul(a,new Uint8Array([1,t.exp(u)]));return a}})(vV);const xV=vV;function tA(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}tA.prototype.initialize=function(t){this.degree=t,this.genPoly=xV.generateECPolynomial(this.degree)};tA.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const i=xV.mod(r,this.genPoly),a=this.degree-i.length;if(a>0){const u=new Uint8Array(this.degree);return u.set(i,a),u}return i};var Tle=tA,_V={},rd={},rA={};rA.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Al={};const wV="[0-9]+",Cle="[A-Z $%*+\\-./:]+";let Cv="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Cv=Cv.replace(/u/g,"\\u");const Mle="(?:(?![A-Z0-9 $%*+\\-./:]|"+Cv+`)(?:.|[\r
]))+`;Al.KANJI=new RegExp(Cv,"g");Al.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Al.BYTE=new RegExp(Mle,"g");Al.NUMERIC=new RegExp(wV,"g");Al.ALPHANUMERIC=new RegExp(Cle,"g");const kle=new RegExp("^"+Cv+"$"),Ple=new RegExp("^"+wV+"$"),Ale=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Al.testKanji=function(t){return kle.test(t)};Al.testNumeric=function(t){return Ple.test(t)};Al.testAlphanumeric=function(t){return Ale.test(t)};(function(e){const t=rA,r=Al;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(u,h){if(!u.ccBits)throw new Error("Invalid mode: "+u);if(!t.isValid(h))throw new Error("Invalid version: "+h);return h>=1&&h<10?u.ccBits[0]:h<27?u.ccBits[1]:u.ccBits[2]},e.getBestModeForData=function(u){return r.testNumeric(u)?e.NUMERIC:r.testAlphanumeric(u)?e.ALPHANUMERIC:r.testKanji(u)?e.KANJI:e.BYTE},e.toString=function(u){if(u&&u.id)return u.id;throw new Error("Invalid mode")},e.isValid=function(u){return u&&u.bit&&u.ccBits};function i(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+a)}}e.from=function(u,h){if(e.isValid(u))return u;try{return i(u)}catch{return h}}})(rd);(function(e){const t=Oo,r=db,i=ub,a=rd,u=rA,h=7973,g=t.getBCHDigit(h);function s(M,D,N){for(let j=1;j<=40;j++)if(D<=e.getCapacity(j,N,M))return j}function _(M,D){return a.getCharCountIndicator(M,D)+4}function b(M,D){let N=0;return M.forEach(function(j){const V=_(j.mode,D);N+=V+j.getBitsLength()}),N}function C(M,D){for(let N=1;N<=40;N++)if(b(M,N)<=e.getCapacity(N,D,a.MIXED))return N}e.from=function(D,N){return u.isValid(D)?parseInt(D,10):N},e.getCapacity=function(D,N,j){if(!u.isValid(D))throw new Error("Invalid QR Code version");typeof j>"u"&&(j=a.BYTE);const V=t.getSymbolTotalCodewords(D),B=r.getTotalCodewordsCount(D,N),z=(V-B)*8;if(j===a.MIXED)return z;const U=z-_(j,D);switch(j){case a.NUMERIC:return Math.floor(U/10*3);case a.ALPHANUMERIC:return Math.floor(U/11*2);case a.KANJI:return Math.floor(U/13);case a.BYTE:default:return Math.floor(U/8)}},e.getBestVersionForData=function(D,N){let j;const V=i.from(N,i.M);if(Array.isArray(D)){if(D.length>1)return C(D,V);if(D.length===0)return 1;j=D[0]}else j=D;return s(j.mode,j.getLength(),V)},e.getEncodedBits=function(D){if(!u.isValid(D)||D<7)throw new Error("Invalid QR Code version");let N=D<<12;for(;t.getBCHDigit(N)-g>=0;)N^=h<<t.getBCHDigit(N)-g;return D<<12|N}})(_V);var bV={};const uM=Oo,SV=1335,Ile=21522,V3=uM.getBCHDigit(SV);bV.getEncodedBits=function(t,r){const i=t.bit<<3|r;let a=i<<10;for(;uM.getBCHDigit(a)-V3>=0;)a^=SV<<uM.getBCHDigit(a)-V3;return(i<<10|a)^Ile};var EV={};const Dle=rd;function Wp(e){this.mode=Dle.NUMERIC,this.data=e.toString()}Wp.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Wp.prototype.getLength=function(){return this.data.length};Wp.prototype.getBitsLength=function(){return Wp.getBitsLength(this.data.length)};Wp.prototype.write=function(t){let r,i,a;for(r=0;r+3<=this.data.length;r+=3)i=this.data.substr(r,3),a=parseInt(i,10),t.put(a,10);const u=this.data.length-r;u>0&&(i=this.data.substr(r),a=parseInt(i,10),t.put(a,u*3+1))};var Rle=Wp;const Nle=rd,hT=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Gp(e){this.mode=Nle.ALPHANUMERIC,this.data=e}Gp.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Gp.prototype.getLength=function(){return this.data.length};Gp.prototype.getBitsLength=function(){return Gp.getBitsLength(this.data.length)};Gp.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let i=hT.indexOf(this.data[r])*45;i+=hT.indexOf(this.data[r+1]),t.put(i,11)}this.data.length%2&&t.put(hT.indexOf(this.data[r]),6)};var jle=Gp;const Lle=rd;function Hp(e){this.mode=Lle.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}Hp.getBitsLength=function(t){return t*8};Hp.prototype.getLength=function(){return this.data.length};Hp.prototype.getBitsLength=function(){return Hp.getBitsLength(this.data.length)};Hp.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var Ole=Hp;const zle=rd,Fle=Oo;function qp(e){this.mode=zle.KANJI,this.data=e}qp.getBitsLength=function(t){return t*13};qp.prototype.getLength=function(){return this.data.length};qp.prototype.getBitsLength=function(){return qp.getBitsLength(this.data.length)};qp.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=Fle.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var Ble=qp,TV={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,i,a){var u={},h={};h[i]=0;var g=t.PriorityQueue.make();g.push(i,0);for(var s,_,b,C,M,D,N,j,V;!g.empty();){s=g.pop(),_=s.value,C=s.cost,M=r[_]||{};for(b in M)M.hasOwnProperty(b)&&(D=M[b],N=C+D,j=h[b],V=typeof h[b]>"u",(V||j>N)&&(h[b]=N,g.push(b,N),u[b]=_))}if(typeof a<"u"&&typeof h[a]>"u"){var B=["Could not find a path from ",i," to ",a,"."].join("");throw new Error(B)}return u},extract_shortest_path_from_predecessor_list:function(r,i){for(var a=[],u=i;u;)a.push(u),r[u],u=r[u];return a.reverse(),a},find_path:function(r,i,a){var u=t.single_source_shortest_paths(r,i,a);return t.extract_shortest_path_from_predecessor_list(u,a)},PriorityQueue:{make:function(r){var i=t.PriorityQueue,a={},u;r=r||{};for(u in i)i.hasOwnProperty(u)&&(a[u]=i[u]);return a.queue=[],a.sorter=r.sorter||i.default_sorter,a},default_sorter:function(r,i){return r.cost-i.cost},push:function(r,i){var a={value:r,cost:i};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(TV);var Ule=TV.exports;(function(e){const t=rd,r=Rle,i=jle,a=Ole,u=Ble,h=Al,g=Oo,s=Ule;function _(B){return unescape(encodeURIComponent(B)).length}function b(B,z,U){const Z=[];let Q;for(;(Q=B.exec(U))!==null;)Z.push({data:Q[0],index:Q.index,mode:z,length:Q[0].length});return Z}function C(B){const z=b(h.NUMERIC,t.NUMERIC,B),U=b(h.ALPHANUMERIC,t.ALPHANUMERIC,B);let Z,Q;return g.isKanjiModeEnabled()?(Z=b(h.BYTE,t.BYTE,B),Q=b(h.KANJI,t.KANJI,B)):(Z=b(h.BYTE_KANJI,t.BYTE,B),Q=[]),z.concat(U,Z,Q).sort(function(oe,pe){return oe.index-pe.index}).map(function(oe){return{data:oe.data,mode:oe.mode,length:oe.length}})}function M(B,z){switch(z){case t.NUMERIC:return r.getBitsLength(B);case t.ALPHANUMERIC:return i.getBitsLength(B);case t.KANJI:return u.getBitsLength(B);case t.BYTE:return a.getBitsLength(B)}}function D(B){return B.reduce(function(z,U){const Z=z.length-1>=0?z[z.length-1]:null;return Z&&Z.mode===U.mode?(z[z.length-1].data+=U.data,z):(z.push(U),z)},[])}function N(B){const z=[];for(let U=0;U<B.length;U++){const Z=B[U];switch(Z.mode){case t.NUMERIC:z.push([Z,{data:Z.data,mode:t.ALPHANUMERIC,length:Z.length},{data:Z.data,mode:t.BYTE,length:Z.length}]);break;case t.ALPHANUMERIC:z.push([Z,{data:Z.data,mode:t.BYTE,length:Z.length}]);break;case t.KANJI:z.push([Z,{data:Z.data,mode:t.BYTE,length:_(Z.data)}]);break;case t.BYTE:z.push([{data:Z.data,mode:t.BYTE,length:_(Z.data)}])}}return z}function j(B,z){const U={},Z={start:{}};let Q=["start"];for(let re=0;re<B.length;re++){const oe=B[re],pe=[];for(let ve=0;ve<oe.length;ve++){const he=oe[ve],Ke=""+re+ve;pe.push(Ke),U[Ke]={node:he,lastCount:0},Z[Ke]={};for(let qe=0;qe<Q.length;qe++){const Ie=Q[qe];U[Ie]&&U[Ie].node.mode===he.mode?(Z[Ie][Ke]=M(U[Ie].lastCount+he.length,he.mode)-M(U[Ie].lastCount,he.mode),U[Ie].lastCount+=he.length):(U[Ie]&&(U[Ie].lastCount=he.length),Z[Ie][Ke]=M(he.length,he.mode)+4+t.getCharCountIndicator(he.mode,z))}}Q=pe}for(let re=0;re<Q.length;re++)Z[Q[re]].end=0;return{map:Z,table:U}}function V(B,z){let U;const Z=t.getBestModeForData(B);if(U=t.from(z,Z),U!==t.BYTE&&U.bit<Z.bit)throw new Error('"'+B+'" cannot be encoded with mode '+t.toString(U)+`.
 Suggested mode is: `+t.toString(Z));switch(U===t.KANJI&&!g.isKanjiModeEnabled()&&(U=t.BYTE),U){case t.NUMERIC:return new r(B);case t.ALPHANUMERIC:return new i(B);case t.KANJI:return new u(B);case t.BYTE:return new a(B)}}e.fromArray=function(z){return z.reduce(function(U,Z){return typeof Z=="string"?U.push(V(Z,null)):Z.data&&U.push(V(Z.data,Z.mode)),U},[])},e.fromString=function(z,U){const Z=C(z,g.isKanjiModeEnabled()),Q=N(Z),re=j(Q,U),oe=s.find_path(re.map,"start","end"),pe=[];for(let ve=1;ve<oe.length-1;ve++)pe.push(re.table[oe[ve]].node);return e.fromArray(D(pe))},e.rawSplit=function(z){return e.fromArray(C(z,g.isKanjiModeEnabled()))}})(EV);const fb=Oo,fT=ub,Vle=ble,$le=Sle,Wle=mV,Gle=gV,dM=yV,hM=db,Hle=Tle,H1=_V,qle=bV,Zle=rd,pT=EV;function Xle(e,t){const r=e.size,i=Gle.getPositions(t);for(let a=0;a<i.length;a++){const u=i[a][0],h=i[a][1];for(let g=-1;g<=7;g++)if(!(u+g<=-1||r<=u+g))for(let s=-1;s<=7;s++)h+s<=-1||r<=h+s||(g>=0&&g<=6&&(s===0||s===6)||s>=0&&s<=6&&(g===0||g===6)||g>=2&&g<=4&&s>=2&&s<=4?e.set(u+g,h+s,!0,!0):e.set(u+g,h+s,!1,!0))}}function Yle(e){const t=e.size;for(let r=8;r<t-8;r++){const i=r%2===0;e.set(r,6,i,!0),e.set(6,r,i,!0)}}function Kle(e,t){const r=Wle.getPositions(t);for(let i=0;i<r.length;i++){const a=r[i][0],u=r[i][1];for(let h=-2;h<=2;h++)for(let g=-2;g<=2;g++)h===-2||h===2||g===-2||g===2||h===0&&g===0?e.set(a+h,u+g,!0,!0):e.set(a+h,u+g,!1,!0)}}function Qle(e,t){const r=e.size,i=H1.getEncodedBits(t);let a,u,h;for(let g=0;g<18;g++)a=Math.floor(g/3),u=g%3+r-8-3,h=(i>>g&1)===1,e.set(a,u,h,!0),e.set(u,a,h,!0)}function mT(e,t,r){const i=e.size,a=qle.getEncodedBits(t,r);let u,h;for(u=0;u<15;u++)h=(a>>u&1)===1,u<6?e.set(u,8,h,!0):u<8?e.set(u+1,8,h,!0):e.set(i-15+u,8,h,!0),u<8?e.set(8,i-u-1,h,!0):u<9?e.set(8,15-u-1+1,h,!0):e.set(8,15-u-1,h,!0);e.set(i-8,8,1,!0)}function Jle(e,t){const r=e.size;let i=-1,a=r-1,u=7,h=0;for(let g=r-1;g>0;g-=2)for(g===6&&g--;;){for(let s=0;s<2;s++)if(!e.isReserved(a,g-s)){let _=!1;h<t.length&&(_=(t[h]>>>u&1)===1),e.set(a,g-s,_),u--,u===-1&&(h++,u=7)}if(a+=i,a<0||r<=a){a-=i,i=-i;break}}}function ece(e,t,r){const i=new Vle;r.forEach(function(s){i.put(s.mode.bit,4),i.put(s.getLength(),Zle.getCharCountIndicator(s.mode,e)),s.write(i)});const a=fb.getSymbolTotalCodewords(e),u=hM.getTotalCodewordsCount(e,t),h=(a-u)*8;for(i.getLengthInBits()+4<=h&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);const g=(h-i.getLengthInBits())/8;for(let s=0;s<g;s++)i.put(s%2?17:236,8);return tce(i,e,t)}function tce(e,t,r){const i=fb.getSymbolTotalCodewords(t),a=hM.getTotalCodewordsCount(t,r),u=i-a,h=hM.getBlocksCount(t,r),g=i%h,s=h-g,_=Math.floor(i/h),b=Math.floor(u/h),C=b+1,M=_-b,D=new Hle(M);let N=0;const j=new Array(h),V=new Array(h);let B=0;const z=new Uint8Array(e.buffer);for(let oe=0;oe<h;oe++){const pe=oe<s?b:C;j[oe]=z.slice(N,N+pe),V[oe]=D.encode(j[oe]),N+=pe,B=Math.max(B,pe)}const U=new Uint8Array(i);let Z=0,Q,re;for(Q=0;Q<B;Q++)for(re=0;re<h;re++)Q<j[re].length&&(U[Z++]=j[re][Q]);for(Q=0;Q<M;Q++)for(re=0;re<h;re++)U[Z++]=V[re][Q];return U}function rce(e,t,r,i){let a;if(Array.isArray(e))a=pT.fromArray(e);else if(typeof e=="string"){let _=t;if(!_){const b=pT.rawSplit(e);_=H1.getBestVersionForData(b,r)}a=pT.fromString(e,_||40)}else throw new Error("Invalid data");const u=H1.getBestVersionForData(a,r);if(!u)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=u;else if(t<u)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+u+`.
`);const h=ece(t,r,a),g=fb.getSymbolSize(t),s=new $le(g);return Xle(s,t),Yle(s),Kle(s,t),mT(s,r,0),t>=7&&Qle(s,t),Jle(s,h),isNaN(i)&&(i=dM.getBestMask(s,mT.bind(null,s,r))),dM.applyMask(i,s),mT(s,r,i),{modules:s,version:t,errorCorrectionLevel:r,maskPattern:i,segments:a}}fV.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let i=fT.M,a,u;return typeof r<"u"&&(i=fT.from(r.errorCorrectionLevel,fT.M),a=H1.from(r.version),u=dM.from(r.maskPattern),r.toSJISFunc&&fb.setToSJISFunction(r.toSJISFunc)),rce(t,a,i,u)};var CV={},nA={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let i=r.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+r);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(u){return[u,u]}))),i.length===6&&i.push("F","F");const a=parseInt(i.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+i.slice(0,6).join("")}}e.getOptions=function(i){i||(i={}),i.color||(i.color={});const a=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,u=i.width&&i.width>=21?i.width:void 0,h=i.scale||4;return{width:u,scale:u?4:h,margin:a,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},e.getScale=function(i,a){return a.width&&a.width>=i+a.margin*2?a.width/(i+a.margin*2):a.scale},e.getImageWidth=function(i,a){const u=e.getScale(i,a);return Math.floor((i+a.margin*2)*u)},e.qrToImageData=function(i,a,u){const h=a.modules.size,g=a.modules.data,s=e.getScale(h,u),_=Math.floor((h+u.margin*2)*s),b=u.margin*s,C=[u.color.light,u.color.dark];for(let M=0;M<_;M++)for(let D=0;D<_;D++){let N=(M*_+D)*4,j=u.color.light;if(M>=b&&D>=b&&M<_-b&&D<_-b){const V=Math.floor((M-b)/s),B=Math.floor((D-b)/s);j=C[g[V*h+B]?1:0]}i[N++]=j.r,i[N++]=j.g,i[N++]=j.b,i[N]=j.a}}})(nA);(function(e){const t=nA;function r(a,u,h){a.clearRect(0,0,u.width,u.height),u.style||(u.style={}),u.height=h,u.width=h,u.style.height=h+"px",u.style.width=h+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(u,h,g){let s=g,_=h;typeof s>"u"&&(!h||!h.getContext)&&(s=h,h=void 0),h||(_=i()),s=t.getOptions(s);const b=t.getImageWidth(u.modules.size,s),C=_.getContext("2d"),M=C.createImageData(b,b);return t.qrToImageData(M.data,u,s),r(C,_,b),C.putImageData(M,0,0),_},e.renderToDataURL=function(u,h,g){let s=g;typeof s>"u"&&(!h||!h.getContext)&&(s=h,h=void 0),s||(s={});const _=e.render(u,h,s),b=s.type||"image/png",C=s.rendererOpts||{};return _.toDataURL(b,C.quality)}})(CV);var MV={};const nce=nA;function $3(e,t){const r=e.a/255,i=t+'="'+e.hex+'"';return r<1?i+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':i}function gT(e,t,r){let i=e+t;return typeof r<"u"&&(i+=" "+r),i}function ice(e,t,r){let i="",a=0,u=!1,h=0;for(let g=0;g<e.length;g++){const s=Math.floor(g%t),_=Math.floor(g/t);!s&&!u&&(u=!0),e[g]?(h++,g>0&&s>0&&e[g-1]||(i+=u?gT("M",s+r,.5+_+r):gT("m",a,0),a=0,u=!1),s+1<t&&e[g+1]||(i+=gT("h",h),h=0)):a++}return i}MV.render=function(t,r,i){const a=nce.getOptions(r),u=t.modules.size,h=t.modules.data,g=u+a.margin*2,s=a.color.light.a?"<path "+$3(a.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",_="<path "+$3(a.color.dark,"stroke")+' d="'+ice(h,u,a.margin)+'"/>',b='viewBox="0 0 '+g+" "+g+'"',M='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+b+' shape-rendering="crispEdges">'+s+_+`</svg>
`;return typeof i=="function"&&i(null,M),M};const sce=_le,fM=fV,kV=CV,oce=MV;function iA(e,t,r,i,a){const u=[].slice.call(arguments,1),h=u.length,g=typeof u[h-1]=="function";if(!g&&!sce())throw new Error("Callback required as last argument");if(g){if(h<2)throw new Error("Too few arguments provided");h===2?(a=r,r=t,t=i=void 0):h===3&&(t.getContext&&typeof a>"u"?(a=i,i=void 0):(a=i,i=r,r=t,t=void 0))}else{if(h<1)throw new Error("Too few arguments provided");return h===1?(r=t,t=i=void 0):h===2&&!t.getContext&&(i=r,r=t,t=void 0),new Promise(function(s,_){try{const b=fM.create(r,i);s(e(b,t,i))}catch(b){_(b)}})}try{const s=fM.create(r,i);a(null,e(s,t,i))}catch(s){a(s)}}cx.create=fM.create;cx.toCanvas=iA.bind(null,kV.render);cx.toDataURL=iA.bind(null,kV.renderToDataURL);cx.toString=iA.bind(null,function(e,t,r){return oce.render(e,r)});const PV=async(e,t,r,i,a="")=>new Promise(async(u,h)=>{try{console.log("Starting QR template rendering with dynamic website logo"),e.clearRect(0,0,e.canvas.width,e.canvas.height);let g="/images/ybf-logo.png";try{const M=await SC.getSettings();M.logoUrl?(g=M.logoUrl,console.log("Using website logo for QR code:",g)):console.log("No website logo found, using default YBF logo")}catch{console.log("Failed to fetch website settings, using default logo")}const s=e.createLinearGradient(0,0,e.canvas.width,e.canvas.height);s.addColorStop(0,"#000000"),s.addColorStop(1,"#333333"),e.fillStyle=s,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="rgba(255, 255, 255, 0.1)",e.beginPath(),e.arc(150,150,120,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(450,650,100,0,2*Math.PI),e.fill(),e.fillStyle="#ffffff",e.font="bold 36px SF Pro Display, Inter, sans-serif",e.textAlign="center",e.fillText("Young Brave Fearless",e.canvas.width/2,100),e.font="italic 20px SF Pro Display, Inter, sans-serif",e.fillText("Scan to explore our menu",e.canvas.width/2,140),e.font="bold 24px SF Pro Display, Inter, sans-serif",e.fillText(a||`Table ${r}`,e.canvas.width/2,190);const _=300,b=(e.canvas.width-_)/2,C=230;e.fillStyle="#ffffff",e.fillRect(b-20,C-20,_+40,_+40),e.strokeStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=2,e.strokeRect(b-10,C-10,_+20,_+20),cx.toCanvas(t,{width:_,margin:0,errorCorrectionLevel:"M"},(M,D)=>{if(M){console.error("Error generating QR code:",M),h(M);return}e.drawImage(D,b,C,_,_);const N=_/5,j=b+(_-N)/2,V=C+(_-N)/2;e.fillStyle="#ffffff",e.fillRect(j,V,N,N),console.log("Loading website logo:",g);const B=new Image;B.crossOrigin="anonymous",B.onload=()=>{console.log("Website logo loaded successfully"),e.drawImage(B,j,V,N,N),U(),u()},B.onerror=Z=>{console.error("Failed to load website logo:",Z),z(),U(),u()},B.src=g,B.complete&&(console.log("Website logo was already loaded from cache"),e.drawImage(B,j,V,N,N),U(),u());function z(){console.log("Falling back to YBF text logo"),e.fillStyle="#000000",e.font="bold 20px SF Pro Display, Inter, sans-serif",e.textAlign="center",e.fillText("YBF",b+_/2,C+_/2+7)}function U(){e.fillStyle="#ffffff",e.font="18px SF Pro Display, Inter, sans-serif",e.fillText("www.ybfresto.id",e.canvas.width/2,C+_+60),e.font="16px SF Pro Display, Inter, sans-serif",e.fillText("Scan the QR code with your phone camera",e.canvas.width/2,C+_+90),e.fillText("to access our menu and special offers",e.canvas.width/2,C+_+120)}})}catch(g){console.error("Error in renderQRTemplate:",g),h(g)}}),AV=async(e,t,r,i="")=>{try{console.log(`Rendering preview for QR with template: ${r}`);const a=document.createElement("canvas");a.width=300,a.height=400;const u=a.getContext("2d");return u?(await PV(u,e,t,r,i),a.toDataURL("image/png")):null}catch(a){return console.error("Error rendering QR preview:",a),null}};var IV={exports:{}};(function(e,t){(function(r,i){i()})(Gf,function(){function r(_,b){return typeof b>"u"?b={autoBom:!1}:typeof b!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(_.type)?new Blob(["\uFEFF",_],{type:_.type}):_}function i(_,b,C){var M=new XMLHttpRequest;M.open("GET",_),M.responseType="blob",M.onload=function(){s(M.response,b,C)},M.onerror=function(){console.error("could not download file")},M.send()}function a(_){var b=new XMLHttpRequest;b.open("HEAD",_,!1);try{b.send()}catch{}return 200<=b.status&&299>=b.status}function u(_){try{_.dispatchEvent(new MouseEvent("click"))}catch{var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),_.dispatchEvent(b)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Gf=="object"&&Gf.global===Gf?Gf:void 0,g=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!g?function(_,b,C){var M=h.URL||h.webkitURL,D=document.createElement("a");b=b||_.name||"download",D.download=b,D.rel="noopener",typeof _=="string"?(D.href=_,D.origin===location.origin?u(D):a(D.href)?i(_,b,C):u(D,D.target="_blank")):(D.href=M.createObjectURL(_),setTimeout(function(){M.revokeObjectURL(D.href)},4e4),setTimeout(function(){u(D)},0))}:"msSaveOrOpenBlob"in navigator?function(_,b,C){if(b=b||_.name||"download",typeof _!="string")navigator.msSaveOrOpenBlob(r(_,C),b);else if(a(_))i(_,b,C);else{var M=document.createElement("a");M.href=_,M.target="_blank",setTimeout(function(){u(M)})}}:function(_,b,C,M){if(M=M||open("","_blank"),M&&(M.document.title=M.document.body.innerText="downloading..."),typeof _=="string")return i(_,b,C);var D=_.type==="application/octet-stream",N=/constructor/i.test(h.HTMLElement)||h.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||D&&N||g)&&typeof FileReader<"u"){var V=new FileReader;V.onloadend=function(){var U=V.result;U=j?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),M?M.location.href=U:location=U,M=null},V.readAsDataURL(_)}else{var B=h.URL||h.webkitURL,z=B.createObjectURL(_);M?M.location=z:location.href=z,M=null,setTimeout(function(){B.revokeObjectURL(z)},4e4)}});h.saveAs=s.saveAs=s,e.exports=s})})(IV);var ace=IV.exports;const lce=async(e,t,r,i="")=>{try{console.log("Downloading QR code with default YBF logo");const a=document.createElement("canvas");a.width=600,a.height=800;const u=a.getContext("2d");if(!u)throw new Error("Could not get canvas context");await PV(u,e,t,r,i),a.toBlob(h=>{if(h)ace.saveAs(h,`qr-code-${i||t}.png`);else throw new Error("Could not convert canvas to blob")})}catch(a){throw console.error("Error downloading QR code:",a),a}};async function cce(e,t,r,i,a,u){const h=[];try{console.log(`Generating ${t} QR codes with type ${r} and template ${a}`);let g="";r==="text"?g=i:r==="menu"?g=`${window.location.origin}/menu${i?`?id=${i}`:""}`:r==="location"?g=`https://maps.google.com/?q=${i||hce}`:r==="website"?g=i.startsWith("http")?i:`https://${i}`:r==="video"&&(g=i);for(let s=0;s<t;s++){const _=Math.floor(Math.random()*50)+1,b=await AV(g,_,a,u),C={name:t>1?`${u} (${s+1})`:u,url:g,description:`QR code for ${r}: ${i}`,templateId:a,tableNumber:_,qrCodeDataURL:b||void 0,logoURL:"/images/ybf-logo.png"};console.log("Creating QR code with value:",g);const M=await Ik.create(C);h.push(M)}return h}catch(g){throw console.error("Error generating QR codes:",g),g}}const uce=async e=>{try{console.log(`Fetching QR codes for restaurant ${e}`);const t=await Ik.getAll();return console.log(`Retrieved ${t.length} QR codes`),t}catch(t){throw console.error("Error fetching QR codes:",t),t}},dce=async e=>{try{console.log(`Deleting QR code with ID ${e}`),await Ik.delete(e),console.log(`QR code ${e} deleted`)}catch(t){throw console.error(`Error deleting QR code ${e}:`,t),t}},hce="-6.9364094016395414, 107.62240830824433",fce=({restaurantId:e,onGenerate:t})=>{const[r,i]=A.useState(""),[a,u]=A.useState("text"),[h,g]=A.useState(1),[s,_]=A.useState(!1),[b,C]=A.useState("modern"),[M,D]=A.useState(""),{toast:N}=Hi(),j=async()=>{_(!0);try{if(!e){N({title:"Error",description:"Please ensure your restaurant ID is available.",variant:"destructive"});return}if(!M){N({title:"Error",description:"Please enter a title for your QR code.",variant:"destructive"});return}if(!r){N({title:"Error",description:"Please enter a value for your QR code.",variant:"destructive"});return}let B=r;a==="url"&&!r.startsWith("http")&&(B=`https://${r}`),console.log(`Generating QR code with type: ${a}, value: ${B}`),await cce(e,h,a,B,b,M),N({title:"Success",description:`Successfully generated ${h} QR code(s).`}),t(),i(""),D("")}catch(B){console.error("Error generating QR codes:",B),N({title:"Error",description:"Failed to generate QR codes. Please try again.",variant:"destructive"})}finally{_(!1)}},V=a==="url"&&!r.startsWith("http")?`https://${r}`:r;return m.jsxs(Wi,{className:"glass-card",children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Generate QR Codes"}),m.jsx(Co,{children:"Generate QR codes for your restaurant menu."})]}),m.jsxs(xs,{className:"space-y-4",children:[m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsx(yle,{qrType:a,onChange:u}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"qrTitle",className:"block text-gray-700",children:"QR Code Title"}),m.jsx(ur,{id:"qrTitle",value:M,onChange:B=>D(B.target.value),placeholder:"Enter QR code title"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{htmlFor:"count",className:"block text-gray-700",children:"Number of Codes"}),m.jsx(ur,{id:"count",type:"number",min:"1",value:h,onChange:B=>g(Number(B.target.value)),placeholder:"Enter number of codes"})]}),m.jsx(vle,{qrType:a,qrValue:r,onChange:i}),m.jsx("div",{className:"hidden",children:m.jsx(xle,{selectedTemplate:b,onChange:C})}),m.jsxs("div",{className:"flex items-center gap-4",children:[r&&m.jsx("div",{className:"bg-white p-2 rounded-md flex-shrink-0",children:m.jsx(ple,{value:V,size:100})}),m.jsx(Et,{onClick:j,disabled:s,className:"flex-1",children:s?m.jsxs(m.Fragment,{children:[m.jsx(BX,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):m.jsxs(m.Fragment,{children:[m.jsx(El,{className:"mr-2 h-4 w-4"}),"Generate QR Codes"]})})]})]})]})},pce=e=>{if(!e)return"";const t=e instanceof Date?e:new Date(e);return isNaN(t.getTime())?"Invalid date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(t)},mce=({item:e,onDelete:t})=>{const[r,i]=A.useState(!1),[a,u]=A.useState(null),{toast:h}=Hi(),[g]=A.useState(e.templateId||"modern");A.useEffect(()=>{(async()=>{try{if(e.qrCodeDataURL){u(e.qrCodeDataURL);return}const b=e.name||"",C=await AV(e.url,e.tableNumber||0,g,b);u(C)}catch(b){console.error("Error generating preview:",b),u(null)}})()},[e,g]);const s=async()=>{i(!0);try{const _=e.name||"";await lce(e.url,e.tableNumber||0,g,_),h({title:"Success",description:"QR code downloaded successfully"})}catch(_){console.error("Error downloading QR code:",_),h({title:"Error",description:"Failed to download QR code",variant:"destructive"})}finally{i(!1)}};return m.jsxs(Wi,{className:"h-full flex flex-col",children:[m.jsxs(ys,{className:"pb-3",children:[m.jsxs(vs,{className:"flex justify-between items-start",children:[m.jsx("span",{children:e.name}),m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/90 hover:bg-destructive/10",onClick:()=>t(e.id),"aria-label":"Delete QR code",children:m.jsx(Bu,{className:"h-4 w-4"})})]}),m.jsxs(Co,{children:["Created: ",pce(e.createdAt)]})]}),m.jsxs(xs,{className:"flex-grow",children:[m.jsx("div",{className:"aspect-square w-full bg-secondary/20 rounded-md overflow-hidden flex items-center justify-center",children:a?m.jsx("img",{src:a,alt:e.name,className:"w-full h-full object-contain"}):m.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading preview..."})}),m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsxs("div",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Description:"})," ",e.description]}),m.jsxs("div",{className:"text-sm flex items-start",children:[m.jsx(IX,{className:"h-4 w-4 mr-1 mt-1 shrink-0"}),m.jsx("span",{className:"break-all",children:e.url})]}),m.jsxs("div",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:"Template:"})," ",g]})]})]}),m.jsx(ju,{className:"pt-0",children:m.jsxs(Et,{className:"w-full",onClick:s,disabled:r,children:[m.jsx(bX,{className:"mr-2 h-4 w-4"}),r?"Downloading...":"Download QR Code"]})})]})},gce=({qrCodes:e,onDelete:t})=>e.length===0?m.jsx("div",{className:"text-center py-12 bg-secondary/20 rounded-lg",children:m.jsx("p",{className:"text-muted-foreground",children:"No QR codes generated yet"})}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(r=>m.jsx(mce,{item:r,onDelete:t},r.id))}),yce=()=>{const[e,t]=A.useState([]),[r,i]=A.useState("ybf-restaurant"),[a,u]=A.useState(!1),[h,g]=A.useState(null),{toast:s}=Hi(),_=async()=>{u(!0),g(null);try{console.log("Fetching QR codes...");const C=await uce(r);console.log("Retrieved QR codes:",C);const M=C.map(D=>({...D,logoURL:D.logoURL||void 0}));t(M||[]),(C==null?void 0:C.length)===0?console.log("No QR codes found. The table might be empty."):(C==null?void 0:C.length)>0&&console.log("First QR code logo URL:",C[0].logoURL)}catch(C){console.error("Error fetching QR codes:",C),g("Failed to load QR codes. Please try again."),s({title:"Error",description:"Failed to load QR codes. Please try again.",variant:"destructive"})}finally{u(!1)}};A.useEffect(()=>{console.log("QRCodeManager component mounted"),_()},[]);const b=async C=>{u(!0);try{await dce(C),s({title:"Success",description:"QR code deleted successfully"}),await _()}catch(M){console.error("Error deleting QR code:",M),s({title:"Error",description:"Failed to delete QR code. Please try again.",variant:"destructive"})}finally{u(!1)}};return h?m.jsxs("div",{className:"text-center py-8 bg-background text-foreground",children:[m.jsx("p",{className:"text-red-500 mb-4",children:h}),m.jsx(Et,{onClick:_,children:"Retry"})]}):m.jsxs("div",{className:"space-y-4 bg-background text-foreground p-4",children:[m.jsxs("h1",{className:"text-2xl font-bold mb-6 flex items-center",children:[m.jsx(FX,{className:"mr-2 h-6 w-6"}),"QR Code Manager"]}),m.jsx(fce,{restaurantId:r,onGenerate:_}),a?m.jsxs("div",{className:"flex justify-center items-center py-12",children:[m.jsx(_s,{className:"h-8 w-8 animate-spin text-primary mr-2"}),m.jsx("p",{children:"Loading QR codes..."})]}):m.jsx(gce,{qrCodes:e,onDelete:b})]})};function vce({ad:e,onEdit:t,onDelete:r,onToggleActive:i}){const a=h=>{h.preventDefault(),h.stopPropagation(),console.log("Delete button clicked for ad:",e.id),r(e.id)},u=h=>{h.preventDefault(),h.stopPropagation(),console.log("Toggle active clicked for ad:",e.id,"Current status:",e.isActive),i(e.id,e.isActive)};return m.jsxs(Wi,{className:e.isActive?void 0:"opacity-70",children:[m.jsx(ys,{className:"pb-2",children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx(vs,{className:"text-lg",children:e.title}),m.jsxs("span",{className:"text-xs text-muted-foreground capitalize",children:[e.type," Ad"]})]}),m.jsxs("div",{className:"flex space-x-1",children:[m.jsx(Et,{variant:"ghost",size:"icon",onClick:u,title:e.isActive?"Disable":"Enable",children:e.isActive?m.jsx(bz,{className:"h-4 w-4"}):m.jsx(SX,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",onClick:()=>t(e),title:"Edit",children:m.jsx(fv,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",onClick:a,title:"Delete",children:m.jsx(Bu,{className:"h-4 w-4"})})]})]})}),m.jsxs(xs,{children:[e.type==="image"&&e.imageUrl&&m.jsx(_c,{ratio:16/9,className:"bg-muted mb-2 overflow-hidden rounded-md",children:m.jsx("img",{src:e.imageUrl,alt:e.title,className:"object-cover w-full h-full"})}),e.type==="video"&&e.videoUrl&&m.jsx(_c,{ratio:16/9,className:"mb-2 overflow-hidden rounded-md",children:m.jsx("iframe",{src:e.videoUrl,title:e.title,className:"w-full h-full",allowFullScreen:!0,loading:"lazy"})}),e.type==="link"&&m.jsx("div",{className:"h-20 mb-2 border rounded-md flex items-center justify-center",children:m.jsx("span",{className:"text-blue-500 underline",children:e.linkUrl})})]}),m.jsx(ju,{children:m.jsx("span",{className:`text-xs px-2 py-1 rounded ${e.isActive?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:e.isActive?"Active":"Inactive"})})]},e.id)}function xce({ads:e,onAddNew:t,onEdit:r,onDelete:i,onToggleActive:a,loading:u}){return u?m.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(h=>m.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx(fi,{className:"h-6 w-24"}),m.jsx(fi,{className:"h-6 w-20"})]}),m.jsx(fi,{className:"h-40 w-full"}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx(fi,{className:"h-8 w-20"}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsx(fi,{className:"h-8 w-8"}),m.jsx(fi,{className:"h-8 w-8"})]})]})]},h))}):e.length===0?m.jsxs("div",{className:"text-center py-12 border rounded-md bg-muted/20",children:[m.jsx("p",{className:"text-muted-foreground",children:"No advertisements created yet."}),m.jsxs(Et,{variant:"outline",className:"mt-4",onClick:t,children:[m.jsx(El,{className:"mr-2 h-4 w-4"})," Create your first ad"]})]}):m.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(h=>m.jsx(vce,{ad:h,onEdit:r,onDelete:i,onToggleActive:a},h.id))})}function _ce(e,t){return A.useReducer((r,i)=>t[r][i]??r,e)}var sA="ScrollArea",[DV,Tfe]=Ya(sA),[wce,da]=DV(sA),RV=A.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:i="hover",dir:a,scrollHideDelay:u=600,...h}=e,[g,s]=A.useState(null),[_,b]=A.useState(null),[C,M]=A.useState(null),[D,N]=A.useState(null),[j,V]=A.useState(null),[B,z]=A.useState(0),[U,Z]=A.useState(0),[Q,re]=A.useState(!1),[oe,pe]=A.useState(!1),ve=Cr(t,Ke=>s(Ke)),he=Nh(a);return m.jsx(wce,{scope:r,type:i,dir:he,scrollHideDelay:u,scrollArea:g,viewport:_,onViewportChange:b,content:C,onContentChange:M,scrollbarX:D,onScrollbarXChange:N,scrollbarXEnabled:Q,onScrollbarXEnabledChange:re,scrollbarY:j,onScrollbarYChange:V,scrollbarYEnabled:oe,onScrollbarYEnabledChange:pe,onCornerWidthChange:z,onCornerHeightChange:Z,children:m.jsx(sr.div,{dir:he,...h,ref:ve,style:{position:"relative","--radix-scroll-area-corner-width":B+"px","--radix-scroll-area-corner-height":U+"px",...e.style}})})});RV.displayName=sA;var NV="ScrollAreaViewport",jV=A.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:i,asChild:a,nonce:u,...h}=e,g=da(NV,r),s=A.useRef(null),_=Cr(t,s,g.onViewportChange);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:u}),m.jsx(sr.div,{"data-radix-scroll-area-viewport":"",...h,asChild:a,ref:_,style:{overflowX:g.scrollbarXEnabled?"scroll":"hidden",overflowY:g.scrollbarYEnabled?"scroll":"hidden",...e.style},children:Ice({asChild:a,children:i},b=>m.jsx("div",{"data-radix-scroll-area-content":"",ref:g.onContentChange,style:{minWidth:g.scrollbarXEnabled?"fit-content":void 0},children:b}))})]})});jV.displayName=NV;var Il="ScrollAreaScrollbar",oA=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=da(Il,e.__scopeScrollArea),{onScrollbarXEnabledChange:u,onScrollbarYEnabledChange:h}=a,g=e.orientation==="horizontal";return A.useEffect(()=>(g?u(!0):h(!0),()=>{g?u(!1):h(!1)}),[g,u,h]),a.type==="hover"?m.jsx(bce,{...i,ref:t,forceMount:r}):a.type==="scroll"?m.jsx(Sce,{...i,ref:t,forceMount:r}):a.type==="auto"?m.jsx(LV,{...i,ref:t,forceMount:r}):a.type==="always"?m.jsx(aA,{...i,ref:t}):null});oA.displayName=Il;var bce=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=da(Il,e.__scopeScrollArea),[u,h]=A.useState(!1);return A.useEffect(()=>{const g=a.scrollArea;let s=0;if(g){const _=()=>{window.clearTimeout(s),h(!0)},b=()=>{s=window.setTimeout(()=>h(!1),a.scrollHideDelay)};return g.addEventListener("pointerenter",_),g.addEventListener("pointerleave",b),()=>{window.clearTimeout(s),g.removeEventListener("pointerenter",_),g.removeEventListener("pointerleave",b)}}},[a.scrollArea,a.scrollHideDelay]),m.jsx(ji,{present:r||u,children:m.jsx(LV,{"data-state":u?"visible":"hidden",...i,ref:t})})}),Sce=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=da(Il,e.__scopeScrollArea),u=e.orientation==="horizontal",h=mb(()=>s("SCROLL_END"),100),[g,s]=_ce("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return A.useEffect(()=>{if(g==="idle"){const _=window.setTimeout(()=>s("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(_)}},[g,a.scrollHideDelay,s]),A.useEffect(()=>{const _=a.viewport,b=u?"scrollLeft":"scrollTop";if(_){let C=_[b];const M=()=>{const D=_[b];C!==D&&(s("SCROLL"),h()),C=D};return _.addEventListener("scroll",M),()=>_.removeEventListener("scroll",M)}},[a.viewport,u,s,h]),m.jsx(ji,{present:r||g!=="hidden",children:m.jsx(aA,{"data-state":g==="hidden"?"hidden":"visible",...i,ref:t,onPointerEnter:kt(e.onPointerEnter,()=>s("POINTER_ENTER")),onPointerLeave:kt(e.onPointerLeave,()=>s("POINTER_LEAVE"))})})}),LV=A.forwardRef((e,t)=>{const r=da(Il,e.__scopeScrollArea),{forceMount:i,...a}=e,[u,h]=A.useState(!1),g=e.orientation==="horizontal",s=mb(()=>{if(r.viewport){const _=r.viewport.offsetWidth<r.viewport.scrollWidth,b=r.viewport.offsetHeight<r.viewport.scrollHeight;h(g?_:b)}},10);return Zp(r.viewport,s),Zp(r.content,s),m.jsx(ji,{present:i||u,children:m.jsx(aA,{"data-state":u?"visible":"hidden",...a,ref:t})})}),aA=A.forwardRef((e,t)=>{const{orientation:r="vertical",...i}=e,a=da(Il,e.__scopeScrollArea),u=A.useRef(null),h=A.useRef(0),[g,s]=A.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),_=UV(g.viewport,g.content),b={...i,sizes:g,onSizesChange:s,hasThumb:_>0&&_<1,onThumbChange:M=>u.current=M,onThumbPointerUp:()=>h.current=0,onThumbPointerDown:M=>h.current=M};function C(M,D){return Pce(M,h.current,g,D)}return r==="horizontal"?m.jsx(Ece,{...b,ref:t,onThumbPositionChange:()=>{if(a.viewport&&u.current){const M=a.viewport.scrollLeft,D=W3(M,g,a.dir);u.current.style.transform=`translate3d(${D}px, 0, 0)`}},onWheelScroll:M=>{a.viewport&&(a.viewport.scrollLeft=M)},onDragScroll:M=>{a.viewport&&(a.viewport.scrollLeft=C(M,a.dir))}}):r==="vertical"?m.jsx(Tce,{...b,ref:t,onThumbPositionChange:()=>{if(a.viewport&&u.current){const M=a.viewport.scrollTop,D=W3(M,g);u.current.style.transform=`translate3d(0, ${D}px, 0)`}},onWheelScroll:M=>{a.viewport&&(a.viewport.scrollTop=M)},onDragScroll:M=>{a.viewport&&(a.viewport.scrollTop=C(M))}}):null}),Ece=A.forwardRef((e,t)=>{const{sizes:r,onSizesChange:i,...a}=e,u=da(Il,e.__scopeScrollArea),[h,g]=A.useState(),s=A.useRef(null),_=Cr(t,s,u.onScrollbarXChange);return A.useEffect(()=>{s.current&&g(getComputedStyle(s.current))},[s]),m.jsx(zV,{"data-orientation":"horizontal",...a,ref:_,sizes:r,style:{bottom:0,left:u.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:u.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":pb(r)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.x),onDragScroll:b=>e.onDragScroll(b.x),onWheelScroll:(b,C)=>{if(u.viewport){const M=u.viewport.scrollLeft+b.deltaX;e.onWheelScroll(M),$V(M,C)&&b.preventDefault()}},onResize:()=>{s.current&&u.viewport&&h&&i({content:u.viewport.scrollWidth,viewport:u.viewport.offsetWidth,scrollbar:{size:s.current.clientWidth,paddingStart:Z1(h.paddingLeft),paddingEnd:Z1(h.paddingRight)}})}})}),Tce=A.forwardRef((e,t)=>{const{sizes:r,onSizesChange:i,...a}=e,u=da(Il,e.__scopeScrollArea),[h,g]=A.useState(),s=A.useRef(null),_=Cr(t,s,u.onScrollbarYChange);return A.useEffect(()=>{s.current&&g(getComputedStyle(s.current))},[s]),m.jsx(zV,{"data-orientation":"vertical",...a,ref:_,sizes:r,style:{top:0,right:u.dir==="ltr"?0:void 0,left:u.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":pb(r)+"px",...e.style},onThumbPointerDown:b=>e.onThumbPointerDown(b.y),onDragScroll:b=>e.onDragScroll(b.y),onWheelScroll:(b,C)=>{if(u.viewport){const M=u.viewport.scrollTop+b.deltaY;e.onWheelScroll(M),$V(M,C)&&b.preventDefault()}},onResize:()=>{s.current&&u.viewport&&h&&i({content:u.viewport.scrollHeight,viewport:u.viewport.offsetHeight,scrollbar:{size:s.current.clientHeight,paddingStart:Z1(h.paddingTop),paddingEnd:Z1(h.paddingBottom)}})}})}),[Cce,OV]=DV(Il),zV=A.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:i,hasThumb:a,onThumbChange:u,onThumbPointerUp:h,onThumbPointerDown:g,onThumbPositionChange:s,onDragScroll:_,onWheelScroll:b,onResize:C,...M}=e,D=da(Il,r),[N,j]=A.useState(null),V=Cr(t,ve=>j(ve)),B=A.useRef(null),z=A.useRef(""),U=D.viewport,Z=i.content-i.viewport,Q=jn(b),re=jn(s),oe=mb(C,10);function pe(ve){if(B.current){const he=ve.clientX-B.current.left,Ke=ve.clientY-B.current.top;_({x:he,y:Ke})}}return A.useEffect(()=>{const ve=he=>{const Ke=he.target;(N==null?void 0:N.contains(Ke))&&Q(he,Z)};return document.addEventListener("wheel",ve,{passive:!1}),()=>document.removeEventListener("wheel",ve,{passive:!1})},[U,N,Z,Q]),A.useEffect(re,[i,re]),Zp(N,oe),Zp(D.content,oe),m.jsx(Cce,{scope:r,scrollbar:N,hasThumb:a,onThumbChange:jn(u),onThumbPointerUp:jn(h),onThumbPositionChange:re,onThumbPointerDown:jn(g),children:m.jsx(sr.div,{...M,ref:V,style:{position:"absolute",...M.style},onPointerDown:kt(e.onPointerDown,ve=>{ve.button===0&&(ve.target.setPointerCapture(ve.pointerId),B.current=N.getBoundingClientRect(),z.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",D.viewport&&(D.viewport.style.scrollBehavior="auto"),pe(ve))}),onPointerMove:kt(e.onPointerMove,pe),onPointerUp:kt(e.onPointerUp,ve=>{const he=ve.target;he.hasPointerCapture(ve.pointerId)&&he.releasePointerCapture(ve.pointerId),document.body.style.webkitUserSelect=z.current,D.viewport&&(D.viewport.style.scrollBehavior=""),B.current=null})})})}),q1="ScrollAreaThumb",FV=A.forwardRef((e,t)=>{const{forceMount:r,...i}=e,a=OV(q1,e.__scopeScrollArea);return m.jsx(ji,{present:r||a.hasThumb,children:m.jsx(Mce,{ref:t,...i})})}),Mce=A.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:i,...a}=e,u=da(q1,r),h=OV(q1,r),{onThumbPositionChange:g}=h,s=Cr(t,C=>h.onThumbChange(C)),_=A.useRef(),b=mb(()=>{_.current&&(_.current(),_.current=void 0)},100);return A.useEffect(()=>{const C=u.viewport;if(C){const M=()=>{if(b(),!_.current){const D=Ace(C,g);_.current=D,g()}};return g(),C.addEventListener("scroll",M),()=>C.removeEventListener("scroll",M)}},[u.viewport,b,g]),m.jsx(sr.div,{"data-state":h.hasThumb?"visible":"hidden",...a,ref:s,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:kt(e.onPointerDownCapture,C=>{const D=C.target.getBoundingClientRect(),N=C.clientX-D.left,j=C.clientY-D.top;h.onThumbPointerDown({x:N,y:j})}),onPointerUp:kt(e.onPointerUp,h.onThumbPointerUp)})});FV.displayName=q1;var lA="ScrollAreaCorner",BV=A.forwardRef((e,t)=>{const r=da(lA,e.__scopeScrollArea),i=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&i?m.jsx(kce,{...e,ref:t}):null});BV.displayName=lA;var kce=A.forwardRef((e,t)=>{const{__scopeScrollArea:r,...i}=e,a=da(lA,r),[u,h]=A.useState(0),[g,s]=A.useState(0),_=!!(u&&g);return Zp(a.scrollbarX,()=>{var C;const b=((C=a.scrollbarX)==null?void 0:C.offsetHeight)||0;a.onCornerHeightChange(b),s(b)}),Zp(a.scrollbarY,()=>{var C;const b=((C=a.scrollbarY)==null?void 0:C.offsetWidth)||0;a.onCornerWidthChange(b),h(b)}),_?m.jsx(sr.div,{...i,ref:t,style:{width:u,height:g,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Z1(e){return e?parseInt(e,10):0}function UV(e,t){const r=e/t;return isNaN(r)?0:r}function pb(e){const t=UV(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=(e.scrollbar.size-r)*t;return Math.max(i,18)}function Pce(e,t,r,i="ltr"){const a=pb(r),u=a/2,h=t||u,g=a-h,s=r.scrollbar.paddingStart+h,_=r.scrollbar.size-r.scrollbar.paddingEnd-g,b=r.content-r.viewport,C=i==="ltr"?[0,b]:[b*-1,0];return VV([s,_],C)(e)}function W3(e,t,r="ltr"){const i=pb(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,u=t.scrollbar.size-a,h=t.content-t.viewport,g=u-i,s=r==="ltr"?[0,h]:[h*-1,0],_=xv(e,s);return VV([0,h],[0,g])(_)}function VV(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(r-e[0])}}function $V(e,t){return e>0&&e<t}var Ace=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},i=0;return function a(){const u={left:e.scrollLeft,top:e.scrollTop},h=r.left!==u.left,g=r.top!==u.top;(h||g)&&t(),r=u,i=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(i)};function mb(e,t){const r=jn(e),i=A.useRef(0);return A.useEffect(()=>()=>window.clearTimeout(i.current),[]),A.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(r,t)},[r,t])}function Zp(e,t){const r=jn(t);Ni(()=>{let i=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(i),a.unobserve(e)}}},[e,r])}function Ice(e,t){const{asChild:r,children:i}=e;if(!r)return typeof t=="function"?t(i):t;const a=A.Children.only(i);return A.cloneElement(a,{children:typeof t=="function"?t(a.props.children):t})}var WV=RV,Dce=jV,Rce=BV;const GV=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(WV,{ref:i,className:It("relative overflow-hidden",e),...r,children:[m.jsx(Dce,{className:"h-full w-full rounded-[inherit]",children:t}),m.jsx(HV,{}),m.jsx(Rce,{})]}));GV.displayName=WV.displayName;const HV=A.forwardRef(({className:e,orientation:t="vertical",...r},i)=>m.jsx(oA,{ref:i,orientation:t,className:It("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:m.jsx(FV,{className:"relative flex-1 rounded-full bg-border"})}));HV.displayName=oA.displayName;var Nce=[" ","Enter","ArrowUp","ArrowDown"],jce=[" ","Enter"],dx="Select",[gb,yb,Lce]=dm(dx),[vm,Cfe]=Ya(dx,[Lce,pm]),vb=pm(),[Oce,nd]=vm(dx),[zce,Fce]=vm(dx),qV=e=>{const{__scopeSelect:t,children:r,open:i,defaultOpen:a,onOpenChange:u,value:h,defaultValue:g,onValueChange:s,dir:_,name:b,autoComplete:C,disabled:M,required:D,form:N}=e,j=vb(t),[V,B]=A.useState(null),[z,U]=A.useState(null),[Z,Q]=A.useState(!1),re=Nh(_),[oe=!1,pe]=Wa({prop:i,defaultProp:a,onChange:u}),[ve,he]=Wa({prop:h,defaultProp:g,onChange:s}),Ke=A.useRef(null),qe=V?N||!!V.closest("form"):!0,[Ie,rt]=A.useState(new Set),Pt=Array.from(Ie).map(it=>it.props.value).join(";");return m.jsx(nP,{...j,children:m.jsxs(Oce,{required:D,scope:t,trigger:V,onTriggerChange:B,valueNode:z,onValueNodeChange:U,valueNodeHasChildren:Z,onValueNodeHasChildrenChange:Q,contentId:Po(),value:ve,onValueChange:he,open:oe,onOpenChange:pe,dir:re,triggerPointerDownPosRef:Ke,disabled:M,children:[m.jsx(gb.Provider,{scope:t,children:m.jsx(zce,{scope:e.__scopeSelect,onNativeOptionAdd:A.useCallback(it=>{rt(Je=>new Set(Je).add(it))},[]),onNativeOptionRemove:A.useCallback(it=>{rt(Je=>{const Te=new Set(Je);return Te.delete(it),Te})},[]),children:r})}),qe?m.jsxs(v8,{"aria-hidden":!0,required:D,tabIndex:-1,name:b,autoComplete:C,value:ve,onChange:it=>he(it.target.value),disabled:M,form:N,children:[ve===void 0?m.jsx("option",{value:""}):null,Array.from(Ie)]},Pt):null]})})};qV.displayName=dx;var ZV="SelectTrigger",XV=A.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:i=!1,...a}=e,u=vb(r),h=nd(ZV,r),g=h.disabled||i,s=Cr(t,h.onTriggerChange),_=yb(r),b=A.useRef("touch"),[C,M,D]=x8(j=>{const V=_().filter(U=>!U.disabled),B=V.find(U=>U.value===h.value),z=_8(V,j,B);z!==void 0&&h.onValueChange(z.value)}),N=j=>{g||(h.onOpenChange(!0),D()),j&&(h.triggerPointerDownPosRef.current={x:Math.round(j.pageX),y:Math.round(j.pageY)})};return m.jsx(Xw,{asChild:!0,...u,children:m.jsx(sr.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:g,"data-disabled":g?"":void 0,"data-placeholder":y8(h.value)?"":void 0,...a,ref:s,onClick:kt(a.onClick,j=>{j.currentTarget.focus(),b.current!=="mouse"&&N(j)}),onPointerDown:kt(a.onPointerDown,j=>{b.current=j.pointerType;const V=j.target;V.hasPointerCapture(j.pointerId)&&V.releasePointerCapture(j.pointerId),j.button===0&&j.ctrlKey===!1&&j.pointerType==="mouse"&&(N(j),j.preventDefault())}),onKeyDown:kt(a.onKeyDown,j=>{const V=C.current!=="";!(j.ctrlKey||j.altKey||j.metaKey)&&j.key.length===1&&M(j.key),!(V&&j.key===" ")&&Nce.includes(j.key)&&(N(),j.preventDefault())})})})});XV.displayName=ZV;var YV="SelectValue",KV=A.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:a,children:u,placeholder:h="",...g}=e,s=nd(YV,r),{onValueNodeHasChildrenChange:_}=s,b=u!==void 0,C=Cr(t,s.onValueNodeChange);return Ni(()=>{_(b)},[_,b]),m.jsx(sr.span,{...g,ref:C,style:{pointerEvents:"none"},children:y8(s.value)?m.jsx(m.Fragment,{children:h}):u})});KV.displayName=YV;var Bce="SelectIcon",QV=A.forwardRef((e,t)=>{const{__scopeSelect:r,children:i,...a}=e;return m.jsx(sr.span,{"aria-hidden":!0,...a,ref:t,children:i||""})});QV.displayName=Bce;var Uce="SelectPortal",JV=e=>m.jsx(Wv,{asChild:!0,...e});JV.displayName=Uce;var Ph="SelectContent",e8=A.forwardRef((e,t)=>{const r=nd(Ph,e.__scopeSelect),[i,a]=A.useState();if(Ni(()=>{a(new DocumentFragment)},[]),!r.open){const u=i;return u?rm.createPortal(m.jsx(t8,{scope:e.__scopeSelect,children:m.jsx(gb.Slot,{scope:e.__scopeSelect,children:m.jsx("div",{children:e.children})})}),u):null}return m.jsx(r8,{...e,ref:t})});e8.displayName=Ph;var Na=10,[t8,id]=vm(Ph),Vce="SelectContentImpl",r8=A.forwardRef((e,t)=>{const{__scopeSelect:r,position:i="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:u,onPointerDownOutside:h,side:g,sideOffset:s,align:_,alignOffset:b,arrowPadding:C,collisionBoundary:M,collisionPadding:D,sticky:N,hideWhenDetached:j,avoidCollisions:V,...B}=e,z=nd(Ph,r),[U,Z]=A.useState(null),[Q,re]=A.useState(null),oe=Cr(t,St=>Z(St)),[pe,ve]=A.useState(null),[he,Ke]=A.useState(null),qe=yb(r),[Ie,rt]=A.useState(!1),Pt=A.useRef(!1);A.useEffect(()=>{if(U)return Gw(U)},[U]),$w();const it=A.useCallback(St=>{const[nr,...cr]=qe().map(Ut=>Ut.ref.current),[lr]=cr.slice(-1),dr=document.activeElement;for(const Ut of St)if(Ut===dr||(Ut==null||Ut.scrollIntoView({block:"nearest"}),Ut===nr&&Q&&(Q.scrollTop=0),Ut===lr&&Q&&(Q.scrollTop=Q.scrollHeight),Ut==null||Ut.focus(),document.activeElement!==dr))return},[qe,Q]),Je=A.useCallback(()=>it([pe,U]),[it,pe,U]);A.useEffect(()=>{Ie&&Je()},[Ie,Je]);const{onOpenChange:Te,triggerPointerDownPosRef:Re}=z;A.useEffect(()=>{if(U){let St={x:0,y:0};const nr=lr=>{var dr,Ut;St={x:Math.abs(Math.round(lr.pageX)-(((dr=Re.current)==null?void 0:dr.x)??0)),y:Math.abs(Math.round(lr.pageY)-(((Ut=Re.current)==null?void 0:Ut.y)??0))}},cr=lr=>{St.x<=10&&St.y<=10?lr.preventDefault():U.contains(lr.target)||Te(!1),document.removeEventListener("pointermove",nr),Re.current=null};return Re.current!==null&&(document.addEventListener("pointermove",nr),document.addEventListener("pointerup",cr,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",nr),document.removeEventListener("pointerup",cr,{capture:!0})}}},[U,Te,Re]),A.useEffect(()=>{const St=()=>Te(!1);return window.addEventListener("blur",St),window.addEventListener("resize",St),()=>{window.removeEventListener("blur",St),window.removeEventListener("resize",St)}},[Te]);const[Tt,Ge]=x8(St=>{const nr=qe().filter(dr=>!dr.disabled),cr=nr.find(dr=>dr.ref.current===document.activeElement),lr=_8(nr,St,cr);lr&&setTimeout(()=>lr.ref.current.focus())}),wt=A.useCallback((St,nr,cr)=>{const lr=!Pt.current&&!cr;(z.value!==void 0&&z.value===nr||lr)&&(ve(St),lr&&(Pt.current=!0))},[z.value]),ct=A.useCallback(()=>U==null?void 0:U.focus(),[U]),dt=A.useCallback((St,nr,cr)=>{const lr=!Pt.current&&!cr;(z.value!==void 0&&z.value===nr||lr)&&Ke(St)},[z.value]),tr=i==="popper"?pM:n8,Bt=tr===pM?{side:g,sideOffset:s,align:_,alignOffset:b,arrowPadding:C,collisionBoundary:M,collisionPadding:D,sticky:N,hideWhenDetached:j,avoidCollisions:V}:{};return m.jsx(t8,{scope:r,content:U,viewport:Q,onViewportChange:re,itemRefCallback:wt,selectedItem:pe,onItemLeave:ct,itemTextRefCallback:dt,focusSelectedItem:Je,selectedItemText:he,position:i,isPositioned:Ie,searchRef:Tt,children:m.jsx(Gv,{as:Tl,allowPinchZoom:!0,children:m.jsx($v,{asChild:!0,trapped:z.open,onMountAutoFocus:St=>{St.preventDefault()},onUnmountAutoFocus:kt(a,St=>{var nr;(nr=z.trigger)==null||nr.focus({preventScroll:!0}),St.preventDefault()}),children:m.jsx(lm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:u,onPointerDownOutside:h,onFocusOutside:St=>St.preventDefault(),onDismiss:()=>z.onOpenChange(!1),children:m.jsx(tr,{role:"listbox",id:z.contentId,"data-state":z.open?"open":"closed",dir:z.dir,onContextMenu:St=>St.preventDefault(),...B,...Bt,onPlaced:()=>rt(!0),ref:oe,style:{display:"flex",flexDirection:"column",outline:"none",...B.style},onKeyDown:kt(B.onKeyDown,St=>{const nr=St.ctrlKey||St.altKey||St.metaKey;if(St.key==="Tab"&&St.preventDefault(),!nr&&St.key.length===1&&Ge(St.key),["ArrowUp","ArrowDown","Home","End"].includes(St.key)){let lr=qe().filter(dr=>!dr.disabled).map(dr=>dr.ref.current);if(["ArrowUp","End"].includes(St.key)&&(lr=lr.slice().reverse()),["ArrowUp","ArrowDown"].includes(St.key)){const dr=St.target,Ut=lr.indexOf(dr);lr=lr.slice(Ut+1)}setTimeout(()=>it(lr)),St.preventDefault()}})})})})})})});r8.displayName=Vce;var $ce="SelectItemAlignedPosition",n8=A.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:i,...a}=e,u=nd(Ph,r),h=id(Ph,r),[g,s]=A.useState(null),[_,b]=A.useState(null),C=Cr(t,oe=>b(oe)),M=yb(r),D=A.useRef(!1),N=A.useRef(!0),{viewport:j,selectedItem:V,selectedItemText:B,focusSelectedItem:z}=h,U=A.useCallback(()=>{if(u.trigger&&u.valueNode&&g&&_&&j&&V&&B){const oe=u.trigger.getBoundingClientRect(),pe=_.getBoundingClientRect(),ve=u.valueNode.getBoundingClientRect(),he=B.getBoundingClientRect();if(u.dir!=="rtl"){const dr=he.left-pe.left,Ut=ve.left-dr,Kr=oe.left-Ut,Zr=oe.width+Kr,vi=Math.max(Zr,pe.width),Ir=window.innerWidth-Na,Rn=xv(Ut,[Na,Math.max(Na,Ir-vi)]);g.style.minWidth=Zr+"px",g.style.left=Rn+"px"}else{const dr=pe.right-he.right,Ut=window.innerWidth-ve.right-dr,Kr=window.innerWidth-oe.right-Ut,Zr=oe.width+Kr,vi=Math.max(Zr,pe.width),Ir=window.innerWidth-Na,Rn=xv(Ut,[Na,Math.max(Na,Ir-vi)]);g.style.minWidth=Zr+"px",g.style.right=Rn+"px"}const Ke=M(),qe=window.innerHeight-Na*2,Ie=j.scrollHeight,rt=window.getComputedStyle(_),Pt=parseInt(rt.borderTopWidth,10),it=parseInt(rt.paddingTop,10),Je=parseInt(rt.borderBottomWidth,10),Te=parseInt(rt.paddingBottom,10),Re=Pt+it+Ie+Te+Je,Tt=Math.min(V.offsetHeight*5,Re),Ge=window.getComputedStyle(j),wt=parseInt(Ge.paddingTop,10),ct=parseInt(Ge.paddingBottom,10),dt=oe.top+oe.height/2-Na,tr=qe-dt,Bt=V.offsetHeight/2,St=V.offsetTop+Bt,nr=Pt+it+St,cr=Re-nr;if(nr<=dt){const dr=Ke.length>0&&V===Ke[Ke.length-1].ref.current;g.style.bottom="0px";const Ut=_.clientHeight-j.offsetTop-j.offsetHeight,Kr=Math.max(tr,Bt+(dr?ct:0)+Ut+Je),Zr=nr+Kr;g.style.height=Zr+"px"}else{const dr=Ke.length>0&&V===Ke[0].ref.current;g.style.top="0px";const Kr=Math.max(dt,Pt+j.offsetTop+(dr?wt:0)+Bt)+cr;g.style.height=Kr+"px",j.scrollTop=nr-dt+j.offsetTop}g.style.margin=`${Na}px 0`,g.style.minHeight=Tt+"px",g.style.maxHeight=qe+"px",i==null||i(),requestAnimationFrame(()=>D.current=!0)}},[M,u.trigger,u.valueNode,g,_,j,V,B,u.dir,i]);Ni(()=>U(),[U]);const[Z,Q]=A.useState();Ni(()=>{_&&Q(window.getComputedStyle(_).zIndex)},[_]);const re=A.useCallback(oe=>{oe&&N.current===!0&&(U(),z==null||z(),N.current=!1)},[U,z]);return m.jsx(Gce,{scope:r,contentWrapper:g,shouldExpandOnScrollRef:D,onScrollButtonChange:re,children:m.jsx("div",{ref:s,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:Z},children:m.jsx(sr.div,{...a,ref:C,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});n8.displayName=$ce;var Wce="SelectPopperPosition",pM=A.forwardRef((e,t)=>{const{__scopeSelect:r,align:i="start",collisionPadding:a=Na,...u}=e,h=vb(r);return m.jsx(iP,{...h,...u,ref:t,align:i,collisionPadding:a,style:{boxSizing:"border-box",...u.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});pM.displayName=Wce;var[Gce,cA]=vm(Ph,{}),mM="SelectViewport",i8=A.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:i,...a}=e,u=id(mM,r),h=cA(mM,r),g=Cr(t,u.onViewportChange),s=A.useRef(0);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),m.jsx(gb.Slot,{scope:r,children:m.jsx(sr.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:g,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:kt(a.onScroll,_=>{const b=_.currentTarget,{contentWrapper:C,shouldExpandOnScrollRef:M}=h;if(M!=null&&M.current&&C){const D=Math.abs(s.current-b.scrollTop);if(D>0){const N=window.innerHeight-Na*2,j=parseFloat(C.style.minHeight),V=parseFloat(C.style.height),B=Math.max(j,V);if(B<N){const z=B+D,U=Math.min(N,z),Z=z-U;C.style.height=U+"px",C.style.bottom==="0px"&&(b.scrollTop=Z>0?Z:0,C.style.justifyContent="flex-end")}}}s.current=b.scrollTop})})})]})});i8.displayName=mM;var s8="SelectGroup",[Hce,qce]=vm(s8),Zce=A.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=Po();return m.jsx(Hce,{scope:r,id:a,children:m.jsx(sr.div,{role:"group","aria-labelledby":a,...i,ref:t})})});Zce.displayName=s8;var o8="SelectLabel",a8=A.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=qce(o8,r);return m.jsx(sr.div,{id:a.id,...i,ref:t})});a8.displayName=o8;var X1="SelectItem",[Xce,l8]=vm(X1),c8=A.forwardRef((e,t)=>{const{__scopeSelect:r,value:i,disabled:a=!1,textValue:u,...h}=e,g=nd(X1,r),s=id(X1,r),_=g.value===i,[b,C]=A.useState(u??""),[M,D]=A.useState(!1),N=Cr(t,z=>{var U;return(U=s.itemRefCallback)==null?void 0:U.call(s,z,i,a)}),j=Po(),V=A.useRef("touch"),B=()=>{a||(g.onValueChange(i),g.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return m.jsx(Xce,{scope:r,value:i,disabled:a,textId:j,isSelected:_,onItemTextChange:A.useCallback(z=>{C(U=>U||((z==null?void 0:z.textContent)??"").trim())},[]),children:m.jsx(gb.ItemSlot,{scope:r,value:i,disabled:a,textValue:b,children:m.jsx(sr.div,{role:"option","aria-labelledby":j,"data-highlighted":M?"":void 0,"aria-selected":_&&M,"data-state":_?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...h,ref:N,onFocus:kt(h.onFocus,()=>D(!0)),onBlur:kt(h.onBlur,()=>D(!1)),onClick:kt(h.onClick,()=>{V.current!=="mouse"&&B()}),onPointerUp:kt(h.onPointerUp,()=>{V.current==="mouse"&&B()}),onPointerDown:kt(h.onPointerDown,z=>{V.current=z.pointerType}),onPointerMove:kt(h.onPointerMove,z=>{var U;V.current=z.pointerType,a?(U=s.onItemLeave)==null||U.call(s):V.current==="mouse"&&z.currentTarget.focus({preventScroll:!0})}),onPointerLeave:kt(h.onPointerLeave,z=>{var U;z.currentTarget===document.activeElement&&((U=s.onItemLeave)==null||U.call(s))}),onKeyDown:kt(h.onKeyDown,z=>{var Z;((Z=s.searchRef)==null?void 0:Z.current)!==""&&z.key===" "||(jce.includes(z.key)&&B(),z.key===" "&&z.preventDefault())})})})})});c8.displayName=X1;var wy="SelectItemText",u8=A.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:a,...u}=e,h=nd(wy,r),g=id(wy,r),s=l8(wy,r),_=Fce(wy,r),[b,C]=A.useState(null),M=Cr(t,B=>C(B),s.onItemTextChange,B=>{var z;return(z=g.itemTextRefCallback)==null?void 0:z.call(g,B,s.value,s.disabled)}),D=b==null?void 0:b.textContent,N=A.useMemo(()=>m.jsx("option",{value:s.value,disabled:s.disabled,children:D},s.value),[s.disabled,s.value,D]),{onNativeOptionAdd:j,onNativeOptionRemove:V}=_;return Ni(()=>(j(N),()=>V(N)),[j,V,N]),m.jsxs(m.Fragment,{children:[m.jsx(sr.span,{id:s.textId,...u,ref:M}),s.isSelected&&h.valueNode&&!h.valueNodeHasChildren?rm.createPortal(u.children,h.valueNode):null]})});u8.displayName=wy;var d8="SelectItemIndicator",h8=A.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return l8(d8,r).isSelected?m.jsx(sr.span,{"aria-hidden":!0,...i,ref:t}):null});h8.displayName=d8;var gM="SelectScrollUpButton",f8=A.forwardRef((e,t)=>{const r=id(gM,e.__scopeSelect),i=cA(gM,e.__scopeSelect),[a,u]=A.useState(!1),h=Cr(t,i.onScrollButtonChange);return Ni(()=>{if(r.viewport&&r.isPositioned){let g=function(){const _=s.scrollTop>0;u(_)};const s=r.viewport;return g(),s.addEventListener("scroll",g),()=>s.removeEventListener("scroll",g)}},[r.viewport,r.isPositioned]),a?m.jsx(m8,{...e,ref:h,onAutoScroll:()=>{const{viewport:g,selectedItem:s}=r;g&&s&&(g.scrollTop=g.scrollTop-s.offsetHeight)}}):null});f8.displayName=gM;var yM="SelectScrollDownButton",p8=A.forwardRef((e,t)=>{const r=id(yM,e.__scopeSelect),i=cA(yM,e.__scopeSelect),[a,u]=A.useState(!1),h=Cr(t,i.onScrollButtonChange);return Ni(()=>{if(r.viewport&&r.isPositioned){let g=function(){const _=s.scrollHeight-s.clientHeight,b=Math.ceil(s.scrollTop)<_;u(b)};const s=r.viewport;return g(),s.addEventListener("scroll",g),()=>s.removeEventListener("scroll",g)}},[r.viewport,r.isPositioned]),a?m.jsx(m8,{...e,ref:h,onAutoScroll:()=>{const{viewport:g,selectedItem:s}=r;g&&s&&(g.scrollTop=g.scrollTop+s.offsetHeight)}}):null});p8.displayName=yM;var m8=A.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:i,...a}=e,u=id("SelectScrollButton",r),h=A.useRef(null),g=yb(r),s=A.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return A.useEffect(()=>()=>s(),[s]),Ni(()=>{var b;const _=g().find(C=>C.ref.current===document.activeElement);(b=_==null?void 0:_.ref.current)==null||b.scrollIntoView({block:"nearest"})},[g]),m.jsx(sr.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:kt(a.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(i,50))}),onPointerMove:kt(a.onPointerMove,()=>{var _;(_=u.onItemLeave)==null||_.call(u),h.current===null&&(h.current=window.setInterval(i,50))}),onPointerLeave:kt(a.onPointerLeave,()=>{s()})})}),Yce="SelectSeparator",g8=A.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return m.jsx(sr.div,{"aria-hidden":!0,...i,ref:t})});g8.displayName=Yce;var vM="SelectArrow",Kce=A.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,a=vb(r),u=nd(vM,r),h=id(vM,r);return u.open&&h.position==="popper"?m.jsx(sP,{...a,...i,ref:t}):null});Kce.displayName=vM;function y8(e){return e===""||e===void 0}var v8=A.forwardRef((e,t)=>{const{value:r,...i}=e,a=A.useRef(null),u=Cr(t,a),h=eb(r);return A.useEffect(()=>{const g=a.current,s=window.HTMLSelectElement.prototype,b=Object.getOwnPropertyDescriptor(s,"value").set;if(h!==r&&b){const C=new Event("change",{bubbles:!0});b.call(g,r),g.dispatchEvent(C)}},[h,r]),m.jsx(GP,{asChild:!0,children:m.jsx("select",{...i,ref:u,defaultValue:r})})});v8.displayName="BubbleSelect";function x8(e){const t=jn(e),r=A.useRef(""),i=A.useRef(0),a=A.useCallback(h=>{const g=r.current+h;t(g),function s(_){r.current=_,window.clearTimeout(i.current),_!==""&&(i.current=window.setTimeout(()=>s(""),1e3))}(g)},[t]),u=A.useCallback(()=>{r.current="",window.clearTimeout(i.current)},[]);return A.useEffect(()=>()=>window.clearTimeout(i.current),[]),[r,a,u]}function _8(e,t,r){const a=t.length>1&&Array.from(t).every(_=>_===t[0])?t[0]:t,u=r?e.indexOf(r):-1;let h=Qce(e,Math.max(u,0));a.length===1&&(h=h.filter(_=>_!==r));const s=h.find(_=>_.textValue.toLowerCase().startsWith(a.toLowerCase()));return s!==r?s:void 0}function Qce(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var Jce=qV,w8=XV,eue=KV,tue=QV,rue=JV,b8=e8,nue=i8,S8=a8,E8=c8,iue=u8,sue=h8,T8=f8,C8=p8,M8=g8;const k8=Jce,P8=eue,uA=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(w8,{ref:i,className:It("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,m.jsx(tue,{asChild:!0,children:m.jsx(Ok,{className:"h-4 w-4 opacity-50"})})]}));uA.displayName=w8.displayName;const A8=A.forwardRef(({className:e,...t},r)=>m.jsx(T8,{ref:r,className:It("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(yX,{className:"h-4 w-4"})}));A8.displayName=T8.displayName;const I8=A.forwardRef(({className:e,...t},r)=>m.jsx(C8,{ref:r,className:It("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(Ok,{className:"h-4 w-4"})}));I8.displayName=C8.displayName;const dA=A.forwardRef(({className:e,children:t,position:r="popper",...i},a)=>m.jsx(rue,{children:m.jsxs(b8,{ref:a,className:It("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...i,children:[m.jsx(A8,{}),m.jsx(nue,{className:It("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),m.jsx(I8,{})]})}));dA.displayName=b8.displayName;const oue=A.forwardRef(({className:e,...t},r)=>m.jsx(S8,{ref:r,className:It("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));oue.displayName=S8.displayName;const Fy=A.forwardRef(({className:e,children:t,...r},i)=>m.jsxs(E8,{ref:i,className:It("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[m.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsx(sue,{children:m.jsx(Lk,{className:"h-4 w-4"})})}),m.jsx(iue,{children:t})]}));Fy.displayName=E8.displayName;const aue=A.forwardRef(({className:e,...t},r)=>m.jsx(M8,{ref:r,className:It("-mx-1 my-1 h-px bg-muted",e),...t}));aue.displayName=M8.displayName;function lue({currentAd:e,setCurrentAd:t,onSave:r,onCancel:i,isUploading:a,setIsUploading:u}){const h=async _=>{var C;const b=(C=_.target.files)==null?void 0:C[0];if(b){u(!0);try{const M=await $p(b);t(D=>({...D,imageUrl:M})),Qs.success("File uploaded successfully")}catch(M){console.error("Upload error:",M),Qs.error("Failed to upload file")}finally{u(!1)}}},g=_=>{var b,C;if(!_)return _;if(_.includes("youtube.com/watch")){const M=new URL(_).searchParams.get("v");if(M)return`https://www.youtube.com/embed/${M}`}if(_.includes("youtu.be/")){const M=(b=_.split("youtu.be/")[1])==null?void 0:b.split("?")[0];if(M)return`https://www.youtube.com/embed/${M}`}if(_.includes("drive.google.com/file/d")){const M=(C=_.match(/\/d\/([^\/]+)/))==null?void 0:C[1];if(M)return`https://drive.google.com/file/d/${M}/preview`}return _},s=_=>{const b=_.target.value,C=g(b);t(M=>({...M,videoUrl:C,content:b!==C?b:M==null?void 0:M.content}))};return m.jsxs(ed,{className:"sm:max-w-md overflow-hidden",children:[m.jsxs(rx,{children:[m.jsxs(nx,{children:[e!=null&&e.id?"Edit":"Create"," Advertisement"]}),m.jsx(gP,{children:"Configure your advertisement to display on the home page."})]}),m.jsx(GV,{className:"max-h-[60vh] pr-4",children:m.jsxs("div",{className:"grid gap-4 py-4",children:[m.jsxs("div",{className:"grid gap-2",children:[m.jsx(pr,{htmlFor:"ad-title",children:"Title"}),m.jsx(ur,{id:"ad-title",value:(e==null?void 0:e.title)||"",onChange:_=>t(b=>({...b,title:_.target.value})),placeholder:"Advertisement Title"})]}),m.jsxs("div",{className:"grid gap-2",children:[m.jsx(pr,{htmlFor:"ad-type",children:"Type"}),m.jsxs(k8,{value:e==null?void 0:e.type,onValueChange:_=>t(b=>({...b,type:_})),children:[m.jsx(uA,{id:"ad-type",children:m.jsx(P8,{placeholder:"Select type"})}),m.jsxs(dA,{children:[m.jsx(Fy,{value:"image",children:"Image"}),m.jsx(Fy,{value:"video",children:"Video"}),m.jsx(Fy,{value:"link",children:"Link"})]})]})]}),(e==null?void 0:e.type)==="image"&&m.jsxs("div",{className:"grid gap-2",children:[m.jsx(pr,{children:"Image"}),e.imageUrl&&m.jsx("div",{className:"relative mb-2 overflow-hidden rounded-md",children:m.jsx(_c,{ratio:16/9,children:m.jsx("img",{src:e.imageUrl,alt:"Ad Preview",className:"object-cover w-full h-full"})})}),m.jsx(ur,{type:"file",accept:"image/*",onChange:h,disabled:a})]}),(e==null?void 0:e.type)==="video"&&m.jsxs("div",{className:"grid gap-2",children:[m.jsx(pr,{htmlFor:"ad-video-url",children:"Video URL"}),m.jsx(ur,{id:"ad-video-url",value:e.content||e.videoUrl||"",onChange:s,placeholder:"Enter YouTube or Google Drive video URL"}),e.videoUrl&&m.jsx("div",{className:"relative mb-2 overflow-hidden rounded-md",children:m.jsx(_c,{ratio:16/9,children:m.jsx("iframe",{src:e.videoUrl,className:"w-full h-full",title:"Video preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})}),m.jsxs("p",{className:"text-sm text-muted-foreground",children:["For YouTube: paste the standard watch URL (https://www.youtube.com/watch?v=VIDEO_ID)",m.jsx("br",{}),'For Google Drive: make sure the file is set to "Anyone with the link can view"']})]}),m.jsxs("div",{className:"grid gap-2",children:[m.jsx(pr,{htmlFor:"ad-link",children:(e==null?void 0:e.type)==="link"?"Link URL":"Redirect Link (Optional)"}),m.jsx(ur,{id:"ad-link",value:(e==null?void 0:e.linkUrl)||"",onChange:_=>t(b=>({...b,linkUrl:_.target.value})),placeholder:"https://example.com"}),(e==null?void 0:e.type)!=="link"&&m.jsx("p",{className:"text-sm text-muted-foreground",children:"Where users will go when clicking on your ad (optional)"})]})]})}),m.jsxs(rb,{className:"sm:justify-between pt-2",children:[m.jsx(Et,{variant:"outline",onClick:i,children:"Cancel"}),m.jsx(Et,{onClick:r,disabled:a,children:a?"Uploading...":e!=null&&e.id?"Save Changes":"Create Ad"})]})]})}const cue=()=>{const[e,t]=A.useState([]),[r,i]=A.useState(!1),{toast:a}=Hi();return{ads:e,loading:r,fetchAds:async()=>{i(!0);try{console.log("Fetching ads from API...");const b=await Hf.getAll();console.log("Fetched ads:",b),t(Array.isArray(b)?b:[])}catch(b){console.error("Error fetching ads:",b),a({title:"Error",description:"Failed to load ads. Please try again later.",variant:"destructive"}),t([])}finally{i(!1)}},addAd:async b=>{try{i(!0),console.log("Adding new ad:",b);const C=await Hf.create(b);return t(M=>[...M,C]),a({title:"Success",description:"Ad has been added successfully."}),C}catch(C){throw console.error("Error adding ad:",C),a({title:"Error",description:"Failed to add ad. Please try again.",variant:"destructive"}),C}finally{i(!1)}},updateAd:async(b,C)=>{try{i(!0),console.log("Updating ad:",b,C);const M={...C},D=await Hf.update(b,M);return console.log("Ad updated successfully:",D),t(N=>N.map(j=>j.id===b?{...j,...D}:j)),a({title:"Success",description:"Ad updated successfully."}),D}catch(M){throw console.error("Error updating ad:",M),a({title:"Error",description:"Failed to update ad. Please try again.",variant:"destructive"}),M}finally{i(!1)}},toggleAdActive:async(b,C)=>{try{i(!0),console.log(`Toggling ad ${b} from ${C?"active":"inactive"} to ${C?"inactive":"active"}`);const M=await Hf.toggleActive(b);return console.log("Toggle result:",M),t(D=>D.map(N=>N.id===b?{...N,isActive:!C}:N)),a({title:"Success",description:`Ad ${C?"deactivated":"activated"} successfully.`}),M}catch(M){throw console.error("Error toggling ad:",M),a({title:"Error",description:"Failed to toggle ad status. Please try again.",variant:"destructive"}),M}finally{i(!1)}},deleteAd:async b=>{try{i(!0),console.log("Starting deletion process for ad:",b);const C=await Hf.delete(b);console.log("Ad deleted successfully:",C),t(M=>M.filter(D=>D.id!==b)),a({title:"Success",description:"Ad has been deleted successfully."})}catch(C){throw console.error("Error deleting ad:",C),a({title:"Error",description:"Failed to delete ad. Please try again.",variant:"destructive"}),C}finally{i(!1)}}}};function uue(){const{ads:e,loading:t,fetchAds:r,addAd:i,updateAd:a,toggleAdActive:u,deleteAd:h}=cue(),g=BF(),[s,_]=A.useState(!1),[b,C]=A.useState(null),[M,D]=A.useState(!1),{confirm:N,ConfirmationDialog:j}=Kv();A.useEffect(()=>{console.log("AdManager: Initial fetch of ads"),r()},[]);const V=async()=>{if(!b||!b.title||!b.type){Qs.error("Please fill all required fields");return}if(b.type==="image"&&!b.imageUrl||b.type==="video"&&!b.videoUrl||b.type==="link"&&!b.linkUrl){Qs.error(`Please provide a valid ${b.type} URL`);return}try{if(!b.id&&e.length>=1){Qs.error("Maximum of 1 ad allowed. Edit the existing ad instead.");return}b.id?await a(b.id,b):await i({...b,isActive:!0}),await g.loadAd(),_(!1),C(null)}catch(re){console.error("Error saving ad:",re),Qs.error("Failed to save ad")}},B=async re=>{if(console.log("HandleDeleteAd called with id:",re),!re){console.error("Invalid ad ID for deletion");return}try{const oe=await N({title:"Delete Advertisement",description:"Are you sure you want to delete this ad? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",type:"error",onConfirm:async()=>{console.log("Delete confirmed for ad:",re),await h(re),await g.loadAd(),await r()}})}catch(oe){console.error("Error in confirmation dialog:",oe)}},z=async(re,oe)=>{try{console.log(`Toggling ad ${re} active status from ${oe} to ${!oe}`),await u(re,oe),await r(),await g.loadAd(),Qs.success(`Ad ${oe?"disabled":"enabled"}`)}catch(pe){console.error("Error toggling ad:",pe),Qs.error("Failed to toggle ad status")}},U=()=>{if(e.length>=1){Qs.error("Maximum of 1 ad allowed. Edit the existing ad instead.");return}C({type:"image",title:"",isActive:!0}),_(!0)},Z=re=>{C(re),_(!0)},Q=()=>{_(!1),C(null)};return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h2",{className:"text-2xl font-semibold",children:"Advertisement Manager"}),m.jsxs(Et,{onClick:U,disabled:t,children:[m.jsx(El,{className:"mr-2 h-4 w-4"})," Add New Ad"]})]}),m.jsx(xce,{ads:e,onAddNew:U,onEdit:Z,onDelete:B,onToggleActive:z,loading:t}),m.jsx(zh,{open:s,onOpenChange:_,children:b&&m.jsx(lue,{currentAd:b,setCurrentAd:C,onSave:V,onCancel:Q,isUploading:M,setIsUploading:D})}),m.jsx(j,{})]})}var hx=e=>e.type==="checkbox",lh=e=>e instanceof Date,As=e=>e==null;const D8=e=>typeof e=="object";var yi=e=>!As(e)&&!Array.isArray(e)&&D8(e)&&!lh(e),R8=e=>yi(e)&&e.target?hx(e.target)?e.target.checked:e.target.value:e,due=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,N8=(e,t)=>e.has(due(t)),hue=e=>{const t=e.constructor&&e.constructor.prototype;return yi(t)&&t.hasOwnProperty("isPrototypeOf")},hA=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ys(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(hA&&(e instanceof Blob||e instanceof FileList))&&(r||yi(e)))if(t=r?[]:{},!r&&!hue(e))t=e;else for(const i in e)e.hasOwnProperty(i)&&(t[i]=Ys(e[i]));else return e;return t}var xb=e=>Array.isArray(e)?e.filter(Boolean):[],hi=e=>e===void 0,Wt=(e,t,r)=>{if(!t||!yi(e))return r;const i=xb(t.split(/[,[\].]+?/)).reduce((a,u)=>As(a)?a:a[u],e);return hi(i)||i===e?hi(e[t])?r:e[t]:i},Qo=e=>typeof e=="boolean",fA=e=>/^\w*$/.test(e),j8=e=>xb(e.replace(/["|']|\]/g,"").split(/\.|\[/)),bn=(e,t,r)=>{let i=-1;const a=fA(t)?[t]:j8(t),u=a.length,h=u-1;for(;++i<u;){const g=a[i];let s=r;if(i!==h){const _=e[g];s=yi(_)||Array.isArray(_)?_:isNaN(+a[i+1])?{}:[]}if(g==="__proto__")return;e[g]=s,e=e[g]}return e};const Y1={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ba={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Kl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},L8=lt.createContext(null),_b=()=>lt.useContext(L8),fue=e=>{const{children:t,...r}=e;return lt.createElement(L8.Provider,{value:r},t)};var O8=(e,t,r,i=!0)=>{const a={defaultValues:t._defaultValues};for(const u in e)Object.defineProperty(a,u,{get:()=>{const h=u;return t._proxyFormState[h]!==Ba.all&&(t._proxyFormState[h]=!i||Ba.all),r&&(r[h]=!0),e[h]}});return a},Ks=e=>yi(e)&&!Object.keys(e).length,z8=(e,t,r,i)=>{r(e);const{name:a,...u}=e;return Ks(u)||Object.keys(u).length>=Object.keys(t).length||Object.keys(u).find(h=>t[h]===(!i||Ba.all))},By=e=>Array.isArray(e)?e:[e],F8=(e,t,r)=>!e||!t||e===t||By(e).some(i=>i&&(r?i===t:i.startsWith(t)||t.startsWith(i)));function pA(e){const t=lt.useRef(e);t.current=e,lt.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function pue(e){const t=_b(),{control:r=t.control,disabled:i,name:a,exact:u}=e||{},[h,g]=lt.useState(r._formState),s=lt.useRef(!0),_=lt.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),b=lt.useRef(a);return b.current=a,pA({disabled:i,next:C=>s.current&&F8(b.current,C.name,u)&&z8(C,_.current,r._updateFormState)&&g({...r._formState,...C}),subject:r._subjects.state}),lt.useEffect(()=>(s.current=!0,_.current.isValid&&r._updateValid(!0),()=>{s.current=!1}),[r]),O8(h,r,_.current,!1)}var xl=e=>typeof e=="string",B8=(e,t,r,i,a)=>xl(e)?(i&&t.watch.add(e),Wt(r,e,a)):Array.isArray(e)?e.map(u=>(i&&t.watch.add(u),Wt(r,u))):(i&&(t.watchAll=!0),r);function mue(e){const t=_b(),{control:r=t.control,name:i,defaultValue:a,disabled:u,exact:h}=e||{},g=lt.useRef(i);g.current=i,pA({disabled:u,subject:r._subjects.values,next:b=>{F8(g.current,b.name,h)&&_(Ys(B8(g.current,r._names,b.values||r._formValues,!1,a)))}});const[s,_]=lt.useState(r._getWatch(i,a));return lt.useEffect(()=>r._removeUnmounted()),s}function gue(e){const t=_b(),{name:r,disabled:i,control:a=t.control,shouldUnregister:u}=e,h=N8(a._names.array,r),g=mue({control:a,name:r,defaultValue:Wt(a._formValues,r,Wt(a._defaultValues,r,e.defaultValue)),exact:!0}),s=pue({control:a,name:r,exact:!0}),_=lt.useRef(a.register(r,{...e.rules,value:g,...Qo(e.disabled)?{disabled:e.disabled}:{}}));return lt.useEffect(()=>{const b=a._options.shouldUnregister||u,C=(M,D)=>{const N=Wt(a._fields,M);N&&N._f&&(N._f.mount=D)};if(C(r,!0),b){const M=Ys(Wt(a._options.defaultValues,r));bn(a._defaultValues,r,M),hi(Wt(a._formValues,r))&&bn(a._formValues,r,M)}return()=>{(h?b&&!a._state.action:b)?a.unregister(r):C(r,!1)}},[r,a,h,u]),lt.useEffect(()=>{Wt(a._fields,r)&&a._updateDisabledField({disabled:i,fields:a._fields,name:r,value:Wt(a._fields,r)._f.value})},[i,r,a]),{field:{name:r,value:g,...Qo(i)||s.disabled?{disabled:s.disabled||i}:{},onChange:lt.useCallback(b=>_.current.onChange({target:{value:R8(b),name:r},type:Y1.CHANGE}),[r]),onBlur:lt.useCallback(()=>_.current.onBlur({target:{value:Wt(a._formValues,r),name:r},type:Y1.BLUR}),[r,a]),ref:lt.useCallback(b=>{const C=Wt(a._fields,r);C&&b&&(C._f.ref={focus:()=>b.focus(),select:()=>b.select(),setCustomValidity:M=>b.setCustomValidity(M),reportValidity:()=>b.reportValidity()})},[a._fields,r])},formState:s,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Wt(s.errors,r)},isDirty:{enumerable:!0,get:()=>!!Wt(s.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Wt(s.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Wt(s.validatingFields,r)},error:{enumerable:!0,get:()=>Wt(s.errors,r)}})}}const yue=e=>e.render(gue(e));var U8=(e,t,r,i,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[i]:a||!0}}:{},G3=e=>({isOnSubmit:!e||e===Ba.onSubmit,isOnBlur:e===Ba.onBlur,isOnChange:e===Ba.onChange,isOnAll:e===Ba.all,isOnTouch:e===Ba.onTouched}),H3=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const Uy=(e,t,r,i)=>{for(const a of r||Object.keys(e)){const u=Wt(e,a);if(u){const{_f:h,...g}=u;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],a)&&!i)return!0;if(h.ref&&t(h.ref,h.name)&&!i)return!0;if(Uy(g,t))break}else if(yi(g)&&Uy(g,t))break}}};var vue=(e,t,r)=>{const i=By(Wt(e,r));return bn(i,"root",t[r]),bn(e,r,i),e},mA=e=>e.type==="file",ac=e=>typeof e=="function",K1=e=>{if(!hA)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Z0=e=>xl(e),gA=e=>e.type==="radio",Q1=e=>e instanceof RegExp;const q3={value:!1,isValid:!1},Z3={value:!0,isValid:!0};var V8=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!hi(e[0].attributes.value)?hi(e[0].value)||e[0].value===""?Z3:{value:e[0].value,isValid:!0}:Z3:q3}return q3};const X3={isValid:!1,value:null};var $8=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,X3):X3;function Y3(e,t,r="validate"){if(Z0(e)||Array.isArray(e)&&e.every(Z0)||Qo(e)&&!e)return{type:r,message:Z0(e)?e:"",ref:t}}var Wf=e=>yi(e)&&!Q1(e)?e:{value:e,message:""},K3=async(e,t,r,i,a)=>{const{ref:u,refs:h,required:g,maxLength:s,minLength:_,min:b,max:C,pattern:M,validate:D,name:N,valueAsNumber:j,mount:V,disabled:B}=e._f,z=Wt(t,N);if(!V||B)return{};const U=h?h[0]:u,Z=qe=>{i&&U.reportValidity&&(U.setCustomValidity(Qo(qe)?"":qe||""),U.reportValidity())},Q={},re=gA(u),oe=hx(u),pe=re||oe,ve=(j||mA(u))&&hi(u.value)&&hi(z)||K1(u)&&u.value===""||z===""||Array.isArray(z)&&!z.length,he=U8.bind(null,N,r,Q),Ke=(qe,Ie,rt,Pt=Kl.maxLength,it=Kl.minLength)=>{const Je=qe?Ie:rt;Q[N]={type:qe?Pt:it,message:Je,ref:u,...he(qe?Pt:it,Je)}};if(a?!Array.isArray(z)||!z.length:g&&(!pe&&(ve||As(z))||Qo(z)&&!z||oe&&!V8(h).isValid||re&&!$8(h).isValid)){const{value:qe,message:Ie}=Z0(g)?{value:!!g,message:g}:Wf(g);if(qe&&(Q[N]={type:Kl.required,message:Ie,ref:U,...he(Kl.required,Ie)},!r))return Z(Ie),Q}if(!ve&&(!As(b)||!As(C))){let qe,Ie;const rt=Wf(C),Pt=Wf(b);if(!As(z)&&!isNaN(z)){const it=u.valueAsNumber||z&&+z;As(rt.value)||(qe=it>rt.value),As(Pt.value)||(Ie=it<Pt.value)}else{const it=u.valueAsDate||new Date(z),Je=Tt=>new Date(new Date().toDateString()+" "+Tt),Te=u.type=="time",Re=u.type=="week";xl(rt.value)&&z&&(qe=Te?Je(z)>Je(rt.value):Re?z>rt.value:it>new Date(rt.value)),xl(Pt.value)&&z&&(Ie=Te?Je(z)<Je(Pt.value):Re?z<Pt.value:it<new Date(Pt.value))}if((qe||Ie)&&(Ke(!!qe,rt.message,Pt.message,Kl.max,Kl.min),!r))return Z(Q[N].message),Q}if((s||_)&&!ve&&(xl(z)||a&&Array.isArray(z))){const qe=Wf(s),Ie=Wf(_),rt=!As(qe.value)&&z.length>+qe.value,Pt=!As(Ie.value)&&z.length<+Ie.value;if((rt||Pt)&&(Ke(rt,qe.message,Ie.message),!r))return Z(Q[N].message),Q}if(M&&!ve&&xl(z)){const{value:qe,message:Ie}=Wf(M);if(Q1(qe)&&!z.match(qe)&&(Q[N]={type:Kl.pattern,message:Ie,ref:u,...he(Kl.pattern,Ie)},!r))return Z(Ie),Q}if(D){if(ac(D)){const qe=await D(z,t),Ie=Y3(qe,U);if(Ie&&(Q[N]={...Ie,...he(Kl.validate,Ie.message)},!r))return Z(Ie.message),Q}else if(yi(D)){let qe={};for(const Ie in D){if(!Ks(qe)&&!r)break;const rt=Y3(await D[Ie](z,t),U,Ie);rt&&(qe={...rt,...he(Ie,rt.message)},Z(rt.message),r&&(Q[N]=qe))}if(!Ks(qe)&&(Q[N]={ref:U,...qe},!r))return Q}}return Z(!0),Q};function xue(e,t){const r=t.slice(0,-1).length;let i=0;for(;i<r;)e=hi(e)?i++:e[t[i++]];return e}function _ue(e){for(const t in e)if(e.hasOwnProperty(t)&&!hi(e[t]))return!1;return!0}function Ii(e,t){const r=Array.isArray(t)?t:fA(t)?[t]:j8(t),i=r.length===1?e:xue(e,r),a=r.length-1,u=r[a];return i&&delete i[u],a!==0&&(yi(i)&&Ks(i)||Array.isArray(i)&&_ue(i))&&Ii(e,r.slice(0,-1)),e}var yT=()=>{let e=[];return{get observers(){return e},next:a=>{for(const u of e)u.next&&u.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(u=>u!==a)}}),unsubscribe:()=>{e=[]}}},xM=e=>As(e)||!D8(e);function mu(e,t){if(xM(e)||xM(t))return e===t;if(lh(e)&&lh(t))return e.getTime()===t.getTime();const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const a of r){const u=e[a];if(!i.includes(a))return!1;if(a!=="ref"){const h=t[a];if(lh(u)&&lh(h)||yi(u)&&yi(h)||Array.isArray(u)&&Array.isArray(h)?!mu(u,h):u!==h)return!1}}return!0}var W8=e=>e.type==="select-multiple",wue=e=>gA(e)||hx(e),vT=e=>K1(e)&&e.isConnected,G8=e=>{for(const t in e)if(ac(e[t]))return!0;return!1};function J1(e,t={}){const r=Array.isArray(e);if(yi(e)||r)for(const i in e)Array.isArray(e[i])||yi(e[i])&&!G8(e[i])?(t[i]=Array.isArray(e[i])?[]:{},J1(e[i],t[i])):As(e[i])||(t[i]=!0);return t}function H8(e,t,r){const i=Array.isArray(e);if(yi(e)||i)for(const a in e)Array.isArray(e[a])||yi(e[a])&&!G8(e[a])?hi(t)||xM(r[a])?r[a]=Array.isArray(e[a])?J1(e[a],[]):{...J1(e[a])}:H8(e[a],As(t)?{}:t[a],r[a]):r[a]=!mu(e[a],t[a]);return r}var hy=(e,t)=>H8(e,t,J1(t)),q8=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:i})=>hi(e)?e:t?e===""?NaN:e&&+e:r&&xl(e)?new Date(e):i?i(e):e;function xT(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return mA(t)?t.files:gA(t)?$8(e.refs).value:W8(t)?[...t.selectedOptions].map(({value:r})=>r):hx(t)?V8(e.refs).value:q8(hi(t.value)?e.ref.value:t.value,e)}var bue=(e,t,r,i)=>{const a={};for(const u of e){const h=Wt(t,u);h&&bn(a,u,h._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:i}},fy=e=>hi(e)?e:Q1(e)?e.source:yi(e)?Q1(e.value)?e.value.source:e.value:e;const Q3="AsyncFunction";var Sue=e=>(!e||!e.validate)&&!!(ac(e.validate)&&e.validate.constructor.name===Q3||yi(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===Q3)),Eue=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function J3(e,t,r){const i=Wt(e,r);if(i||fA(r))return{error:i,name:r};const a=r.split(".");for(;a.length;){const u=a.join("."),h=Wt(t,u),g=Wt(e,u);if(h&&!Array.isArray(h)&&r!==u)return{name:r};if(g&&g.type)return{name:u,error:g};a.pop()}return{name:r}}var Tue=(e,t,r,i,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?i.isOnBlur:a.isOnBlur)?!e:(r?i.isOnChange:a.isOnChange)?e:!0,Cue=(e,t)=>!xb(Wt(e,t)).length&&Ii(e,t);const Mue={mode:Ba.onSubmit,reValidateMode:Ba.onChange,shouldFocusError:!0};function kue(e={}){let t={...Mue,...e},r={submitCount:0,isDirty:!1,isLoading:ac(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},a=yi(t.defaultValues)||yi(t.values)?Ys(t.defaultValues||t.values)||{}:{},u=t.shouldUnregister?{}:Ys(a),h={action:!1,mount:!1,watch:!1},g={mount:new Set,unMount:new Set,array:new Set,watch:new Set},s,_=0;const b={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},C={values:yT(),array:yT(),state:yT()},M=G3(t.mode),D=G3(t.reValidateMode),N=t.criteriaMode===Ba.all,j=ke=>Oe=>{clearTimeout(_),_=setTimeout(ke,Oe)},V=async ke=>{if(!e.disabled&&(b.isValid||ke)){const Oe=t.resolver?Ks((await pe()).errors):await he(i,!0);Oe!==r.isValid&&C.state.next({isValid:Oe})}},B=(ke,Oe)=>{!e.disabled&&(b.isValidating||b.validatingFields)&&((ke||Array.from(g.mount)).forEach(Ze=>{Ze&&(Oe?bn(r.validatingFields,Ze,Oe):Ii(r.validatingFields,Ze))}),C.state.next({validatingFields:r.validatingFields,isValidating:!Ks(r.validatingFields)}))},z=(ke,Oe=[],Ze,Vt,jt=!0,Ct=!0)=>{if(Vt&&Ze&&!e.disabled){if(h.action=!0,Ct&&Array.isArray(Wt(i,ke))){const Qt=Ze(Wt(i,ke),Vt.argA,Vt.argB);jt&&bn(i,ke,Qt)}if(Ct&&Array.isArray(Wt(r.errors,ke))){const Qt=Ze(Wt(r.errors,ke),Vt.argA,Vt.argB);jt&&bn(r.errors,ke,Qt),Cue(r.errors,ke)}if(b.touchedFields&&Ct&&Array.isArray(Wt(r.touchedFields,ke))){const Qt=Ze(Wt(r.touchedFields,ke),Vt.argA,Vt.argB);jt&&bn(r.touchedFields,ke,Qt)}b.dirtyFields&&(r.dirtyFields=hy(a,u)),C.state.next({name:ke,isDirty:qe(ke,Oe),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else bn(u,ke,Oe)},U=(ke,Oe)=>{bn(r.errors,ke,Oe),C.state.next({errors:r.errors})},Z=ke=>{r.errors=ke,C.state.next({errors:r.errors,isValid:!1})},Q=(ke,Oe,Ze,Vt)=>{const jt=Wt(i,ke);if(jt){const Ct=Wt(u,ke,hi(Ze)?Wt(a,ke):Ze);hi(Ct)||Vt&&Vt.defaultChecked||Oe?bn(u,ke,Oe?Ct:xT(jt._f)):Pt(ke,Ct),h.mount&&V()}},re=(ke,Oe,Ze,Vt,jt)=>{let Ct=!1,Qt=!1;const fr={name:ke};if(!e.disabled){const mn=!!(Wt(i,ke)&&Wt(i,ke)._f&&Wt(i,ke)._f.disabled);if(!Ze||Vt){b.isDirty&&(Qt=r.isDirty,r.isDirty=fr.isDirty=qe(),Ct=Qt!==fr.isDirty);const At=mn||mu(Wt(a,ke),Oe);Qt=!!(!mn&&Wt(r.dirtyFields,ke)),At||mn?Ii(r.dirtyFields,ke):bn(r.dirtyFields,ke,!0),fr.dirtyFields=r.dirtyFields,Ct=Ct||b.dirtyFields&&Qt!==!At}if(Ze){const At=Wt(r.touchedFields,ke);At||(bn(r.touchedFields,ke,Ze),fr.touchedFields=r.touchedFields,Ct=Ct||b.touchedFields&&At!==Ze)}Ct&&jt&&C.state.next(fr)}return Ct?fr:{}},oe=(ke,Oe,Ze,Vt)=>{const jt=Wt(r.errors,ke),Ct=b.isValid&&Qo(Oe)&&r.isValid!==Oe;if(e.delayError&&Ze?(s=j(()=>U(ke,Ze)),s(e.delayError)):(clearTimeout(_),s=null,Ze?bn(r.errors,ke,Ze):Ii(r.errors,ke)),(Ze?!mu(jt,Ze):jt)||!Ks(Vt)||Ct){const Qt={...Vt,...Ct&&Qo(Oe)?{isValid:Oe}:{},errors:r.errors,name:ke};r={...r,...Qt},C.state.next(Qt)}},pe=async ke=>{B(ke,!0);const Oe=await t.resolver(u,t.context,bue(ke||g.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return B(ke),Oe},ve=async ke=>{const{errors:Oe}=await pe(ke);if(ke)for(const Ze of ke){const Vt=Wt(Oe,Ze);Vt?bn(r.errors,Ze,Vt):Ii(r.errors,Ze)}else r.errors=Oe;return Oe},he=async(ke,Oe,Ze={valid:!0})=>{for(const Vt in ke){const jt=ke[Vt];if(jt){const{_f:Ct,...Qt}=jt;if(Ct){const fr=g.array.has(Ct.name),mn=jt._f&&Sue(jt._f);mn&&b.validatingFields&&B([Vt],!0);const At=await K3(jt,u,N,t.shouldUseNativeValidation&&!Oe,fr);if(mn&&b.validatingFields&&B([Vt]),At[Ct.name]&&(Ze.valid=!1,Oe))break;!Oe&&(Wt(At,Ct.name)?fr?vue(r.errors,At,Ct.name):bn(r.errors,Ct.name,At[Ct.name]):Ii(r.errors,Ct.name))}!Ks(Qt)&&await he(Qt,Oe,Ze)}}return Ze.valid},Ke=()=>{for(const ke of g.unMount){const Oe=Wt(i,ke);Oe&&(Oe._f.refs?Oe._f.refs.every(Ze=>!vT(Ze)):!vT(Oe._f.ref))&&Bt(ke)}g.unMount=new Set},qe=(ke,Oe)=>!e.disabled&&(ke&&Oe&&bn(u,ke,Oe),!mu(Ge(),a)),Ie=(ke,Oe,Ze)=>B8(ke,g,{...h.mount?u:hi(Oe)?a:xl(ke)?{[ke]:Oe}:Oe},Ze,Oe),rt=ke=>xb(Wt(h.mount?u:a,ke,e.shouldUnregister?Wt(a,ke,[]):[])),Pt=(ke,Oe,Ze={})=>{const Vt=Wt(i,ke);let jt=Oe;if(Vt){const Ct=Vt._f;Ct&&(!Ct.disabled&&bn(u,ke,q8(Oe,Ct)),jt=K1(Ct.ref)&&As(Oe)?"":Oe,W8(Ct.ref)?[...Ct.ref.options].forEach(Qt=>Qt.selected=jt.includes(Qt.value)):Ct.refs?hx(Ct.ref)?Ct.refs.length>1?Ct.refs.forEach(Qt=>(!Qt.defaultChecked||!Qt.disabled)&&(Qt.checked=Array.isArray(jt)?!!jt.find(fr=>fr===Qt.value):jt===Qt.value)):Ct.refs[0]&&(Ct.refs[0].checked=!!jt):Ct.refs.forEach(Qt=>Qt.checked=Qt.value===jt):mA(Ct.ref)?Ct.ref.value="":(Ct.ref.value=jt,Ct.ref.type||C.values.next({name:ke,values:{...u}})))}(Ze.shouldDirty||Ze.shouldTouch)&&re(ke,jt,Ze.shouldTouch,Ze.shouldDirty,!0),Ze.shouldValidate&&Tt(ke)},it=(ke,Oe,Ze)=>{for(const Vt in Oe){const jt=Oe[Vt],Ct=`${ke}.${Vt}`,Qt=Wt(i,Ct);(g.array.has(ke)||yi(jt)||Qt&&!Qt._f)&&!lh(jt)?it(Ct,jt,Ze):Pt(Ct,jt,Ze)}},Je=(ke,Oe,Ze={})=>{const Vt=Wt(i,ke),jt=g.array.has(ke),Ct=Ys(Oe);bn(u,ke,Ct),jt?(C.array.next({name:ke,values:{...u}}),(b.isDirty||b.dirtyFields)&&Ze.shouldDirty&&C.state.next({name:ke,dirtyFields:hy(a,u),isDirty:qe(ke,Ct)})):Vt&&!Vt._f&&!As(Ct)?it(ke,Ct,Ze):Pt(ke,Ct,Ze),H3(ke,g)&&C.state.next({...r}),C.values.next({name:h.mount?ke:void 0,values:{...u}})},Te=async ke=>{h.mount=!0;const Oe=ke.target;let Ze=Oe.name,Vt=!0;const jt=Wt(i,Ze),Ct=()=>Oe.type?xT(jt._f):R8(ke),Qt=fr=>{Vt=Number.isNaN(fr)||lh(fr)&&isNaN(fr.getTime())||mu(fr,Wt(u,Ze,fr))};if(jt){let fr,mn;const At=Ct(),nn=ke.type===Y1.BLUR||ke.type===Y1.FOCUS_OUT,Mn=!Eue(jt._f)&&!t.resolver&&!Wt(r.errors,Ze)&&!jt._f.deps||Tue(nn,Wt(r.touchedFields,Ze),r.isSubmitted,D,M),qi=H3(Ze,g,nn);bn(u,Ze,At),nn?(jt._f.onBlur&&jt._f.onBlur(ke),s&&s(0)):jt._f.onChange&&jt._f.onChange(ke);const bs=re(Ze,At,nn,!1),ho=!Ks(bs)||qi;if(!nn&&C.values.next({name:Ze,type:ke.type,values:{...u}}),Mn)return b.isValid&&(e.mode==="onBlur"?nn&&V():V()),ho&&C.state.next({name:Ze,...qi?{}:bs});if(!nn&&qi&&C.state.next({...r}),t.resolver){const{errors:fo}=await pe([Ze]);if(Qt(At),Vt){const po=J3(r.errors,i,Ze),Zi=J3(fo,i,po.name||Ze);fr=Zi.error,Ze=Zi.name,mn=Ks(fo)}}else B([Ze],!0),fr=(await K3(jt,u,N,t.shouldUseNativeValidation))[Ze],B([Ze]),Qt(At),Vt&&(fr?mn=!1:b.isValid&&(mn=await he(i,!0)));Vt&&(jt._f.deps&&Tt(jt._f.deps),oe(Ze,mn,fr,bs))}},Re=(ke,Oe)=>{if(Wt(r.errors,Oe)&&ke.focus)return ke.focus(),1},Tt=async(ke,Oe={})=>{let Ze,Vt;const jt=By(ke);if(t.resolver){const Ct=await ve(hi(ke)?ke:jt);Ze=Ks(Ct),Vt=ke?!jt.some(Qt=>Wt(Ct,Qt)):Ze}else ke?(Vt=(await Promise.all(jt.map(async Ct=>{const Qt=Wt(i,Ct);return await he(Qt&&Qt._f?{[Ct]:Qt}:Qt)}))).every(Boolean),!(!Vt&&!r.isValid)&&V()):Vt=Ze=await he(i);return C.state.next({...!xl(ke)||b.isValid&&Ze!==r.isValid?{}:{name:ke},...t.resolver||!ke?{isValid:Ze}:{},errors:r.errors}),Oe.shouldFocus&&!Vt&&Uy(i,Re,ke?jt:g.mount),Vt},Ge=ke=>{const Oe={...h.mount?u:a};return hi(ke)?Oe:xl(ke)?Wt(Oe,ke):ke.map(Ze=>Wt(Oe,Ze))},wt=(ke,Oe)=>({invalid:!!Wt((Oe||r).errors,ke),isDirty:!!Wt((Oe||r).dirtyFields,ke),error:Wt((Oe||r).errors,ke),isValidating:!!Wt(r.validatingFields,ke),isTouched:!!Wt((Oe||r).touchedFields,ke)}),ct=ke=>{ke&&By(ke).forEach(Oe=>Ii(r.errors,Oe)),C.state.next({errors:ke?r.errors:{}})},dt=(ke,Oe,Ze)=>{const Vt=(Wt(i,ke,{_f:{}})._f||{}).ref,jt=Wt(r.errors,ke)||{},{ref:Ct,message:Qt,type:fr,...mn}=jt;bn(r.errors,ke,{...mn,...Oe,ref:Vt}),C.state.next({name:ke,errors:r.errors,isValid:!1}),Ze&&Ze.shouldFocus&&Vt&&Vt.focus&&Vt.focus()},tr=(ke,Oe)=>ac(ke)?C.values.subscribe({next:Ze=>ke(Ie(void 0,Oe),Ze)}):Ie(ke,Oe,!0),Bt=(ke,Oe={})=>{for(const Ze of ke?By(ke):g.mount)g.mount.delete(Ze),g.array.delete(Ze),Oe.keepValue||(Ii(i,Ze),Ii(u,Ze)),!Oe.keepError&&Ii(r.errors,Ze),!Oe.keepDirty&&Ii(r.dirtyFields,Ze),!Oe.keepTouched&&Ii(r.touchedFields,Ze),!Oe.keepIsValidating&&Ii(r.validatingFields,Ze),!t.shouldUnregister&&!Oe.keepDefaultValue&&Ii(a,Ze);C.values.next({values:{...u}}),C.state.next({...r,...Oe.keepDirty?{isDirty:qe()}:{}}),!Oe.keepIsValid&&V()},St=({disabled:ke,name:Oe,field:Ze,fields:Vt,value:jt})=>{if(Qo(ke)&&h.mount||ke){const Ct=ke?void 0:hi(jt)?xT(Ze?Ze._f:Wt(Vt,Oe)._f):jt;bn(u,Oe,Ct),re(Oe,Ct,!1,!1,!0)}},nr=(ke,Oe={})=>{let Ze=Wt(i,ke);const Vt=Qo(Oe.disabled)||Qo(e.disabled);return bn(i,ke,{...Ze||{},_f:{...Ze&&Ze._f?Ze._f:{ref:{name:ke}},name:ke,mount:!0,...Oe}}),g.mount.add(ke),Ze?St({field:Ze,disabled:Qo(Oe.disabled)?Oe.disabled:e.disabled,name:ke,value:Oe.value}):Q(ke,!0,Oe.value),{...Vt?{disabled:Oe.disabled||e.disabled}:{},...t.progressive?{required:!!Oe.required,min:fy(Oe.min),max:fy(Oe.max),minLength:fy(Oe.minLength),maxLength:fy(Oe.maxLength),pattern:fy(Oe.pattern)}:{},name:ke,onChange:Te,onBlur:Te,ref:jt=>{if(jt){nr(ke,Oe),Ze=Wt(i,ke);const Ct=hi(jt.value)&&jt.querySelectorAll&&jt.querySelectorAll("input,select,textarea")[0]||jt,Qt=wue(Ct),fr=Ze._f.refs||[];if(Qt?fr.find(mn=>mn===Ct):Ct===Ze._f.ref)return;bn(i,ke,{_f:{...Ze._f,...Qt?{refs:[...fr.filter(vT),Ct,...Array.isArray(Wt(a,ke))?[{}]:[]],ref:{type:Ct.type,name:ke}}:{ref:Ct}}}),Q(ke,!1,void 0,Ct)}else Ze=Wt(i,ke,{}),Ze._f&&(Ze._f.mount=!1),(t.shouldUnregister||Oe.shouldUnregister)&&!(N8(g.array,ke)&&h.action)&&g.unMount.add(ke)}}},cr=()=>t.shouldFocusError&&Uy(i,Re,g.mount),lr=ke=>{Qo(ke)&&(C.state.next({disabled:ke}),Uy(i,(Oe,Ze)=>{const Vt=Wt(i,Ze);Vt&&(Oe.disabled=Vt._f.disabled||ke,Array.isArray(Vt._f.refs)&&Vt._f.refs.forEach(jt=>{jt.disabled=Vt._f.disabled||ke}))},0,!1))},dr=(ke,Oe)=>async Ze=>{let Vt;Ze&&(Ze.preventDefault&&Ze.preventDefault(),Ze.persist&&Ze.persist());let jt=Ys(u);if(C.state.next({isSubmitting:!0}),t.resolver){const{errors:Ct,values:Qt}=await pe();r.errors=Ct,jt=Qt}else await he(i);if(Ii(r.errors,"root"),Ks(r.errors)){C.state.next({errors:{}});try{await ke(jt,Ze)}catch(Ct){Vt=Ct}}else Oe&&await Oe({...r.errors},Ze),cr(),setTimeout(cr);if(C.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ks(r.errors)&&!Vt,submitCount:r.submitCount+1,errors:r.errors}),Vt)throw Vt},Ut=(ke,Oe={})=>{Wt(i,ke)&&(hi(Oe.defaultValue)?Je(ke,Ys(Wt(a,ke))):(Je(ke,Oe.defaultValue),bn(a,ke,Ys(Oe.defaultValue))),Oe.keepTouched||Ii(r.touchedFields,ke),Oe.keepDirty||(Ii(r.dirtyFields,ke),r.isDirty=Oe.defaultValue?qe(ke,Ys(Wt(a,ke))):qe()),Oe.keepError||(Ii(r.errors,ke),b.isValid&&V()),C.state.next({...r}))},Kr=(ke,Oe={})=>{const Ze=ke?Ys(ke):a,Vt=Ys(Ze),jt=Ks(ke),Ct=jt?a:Vt;if(Oe.keepDefaultValues||(a=Ze),!Oe.keepValues){if(Oe.keepDirtyValues){const Qt=new Set([...g.mount,...Object.keys(hy(a,u))]);for(const fr of Array.from(Qt))Wt(r.dirtyFields,fr)?bn(Ct,fr,Wt(u,fr)):Je(fr,Wt(Ct,fr))}else{if(hA&&hi(ke))for(const Qt of g.mount){const fr=Wt(i,Qt);if(fr&&fr._f){const mn=Array.isArray(fr._f.refs)?fr._f.refs[0]:fr._f.ref;if(K1(mn)){const At=mn.closest("form");if(At){At.reset();break}}}}i={}}u=e.shouldUnregister?Oe.keepDefaultValues?Ys(a):{}:Ys(Ct),C.array.next({values:{...Ct}}),C.values.next({values:{...Ct}})}g={mount:Oe.keepDirtyValues?g.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!b.isValid||!!Oe.keepIsValid||!!Oe.keepDirtyValues,h.watch=!!e.shouldUnregister,C.state.next({submitCount:Oe.keepSubmitCount?r.submitCount:0,isDirty:jt?!1:Oe.keepDirty?r.isDirty:!!(Oe.keepDefaultValues&&!mu(ke,a)),isSubmitted:Oe.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:jt?{}:Oe.keepDirtyValues?Oe.keepDefaultValues&&u?hy(a,u):r.dirtyFields:Oe.keepDefaultValues&&ke?hy(a,ke):Oe.keepDirty?r.dirtyFields:{},touchedFields:Oe.keepTouched?r.touchedFields:{},errors:Oe.keepErrors?r.errors:{},isSubmitSuccessful:Oe.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Zr=(ke,Oe)=>Kr(ac(ke)?ke(u):ke,Oe);return{control:{register:nr,unregister:Bt,getFieldState:wt,handleSubmit:dr,setError:dt,_executeSchema:pe,_getWatch:Ie,_getDirty:qe,_updateValid:V,_removeUnmounted:Ke,_updateFieldArray:z,_updateDisabledField:St,_getFieldArray:rt,_reset:Kr,_resetDefaultValues:()=>ac(t.defaultValues)&&t.defaultValues().then(ke=>{Zr(ke,t.resetOptions),C.state.next({isLoading:!1})}),_updateFormState:ke=>{r={...r,...ke}},_disableForm:lr,_subjects:C,_proxyFormState:b,_setErrors:Z,get _fields(){return i},get _formValues(){return u},get _state(){return h},set _state(ke){h=ke},get _defaultValues(){return a},get _names(){return g},set _names(ke){g=ke},get _formState(){return r},set _formState(ke){r=ke},get _options(){return t},set _options(ke){t={...t,...ke}}},trigger:Tt,register:nr,handleSubmit:dr,watch:tr,setValue:Je,getValues:Ge,reset:Zr,resetField:Ut,clearErrors:ct,unregister:Bt,setError:dt,setFocus:(ke,Oe={})=>{const Ze=Wt(i,ke),Vt=Ze&&Ze._f;if(Vt){const jt=Vt.refs?Vt.refs[0]:Vt.ref;jt.focus&&(jt.focus(),Oe.shouldSelect&&jt.select())}},getFieldState:wt}}function Pue(e={}){const t=lt.useRef(),r=lt.useRef(),[i,a]=lt.useState({isDirty:!1,isValidating:!1,isLoading:ac(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:ac(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...kue(e),formState:i});const u=t.current.control;return u._options=e,pA({subject:u._subjects.state,next:h=>{z8(h,u._proxyFormState,u._updateFormState,!0)&&a({...u._formState})}}),lt.useEffect(()=>u._disableForm(e.disabled),[u,e.disabled]),lt.useEffect(()=>{if(u._proxyFormState.isDirty){const h=u._getDirty();h!==i.isDirty&&u._subjects.state.next({isDirty:h})}},[u,i.isDirty]),lt.useEffect(()=>{e.values&&!mu(e.values,r.current)?(u._reset(e.values,u._options.resetOptions),r.current=e.values,a(h=>({...h}))):u._resetDefaultValues()},[e.values,u]),lt.useEffect(()=>{e.errors&&u._setErrors(e.errors)},[e.errors,u]),lt.useEffect(()=>{u._state.mount||(u._updateValid(),u._state.mount=!0),u._state.watch&&(u._state.watch=!1,u._subjects.state.next({...u._formState})),u._removeUnmounted()}),lt.useEffect(()=>{e.shouldUnregister&&u._subjects.values.next({values:u._getWatch()})},[e.shouldUnregister,u]),lt.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[i]),t.current.formState=O8(i,u),t.current}const Aue=fue,Z8=A.createContext({}),ro=({...e})=>m.jsx(Z8.Provider,{value:{name:e.name},children:m.jsx(yue,{...e})}),wb=()=>{const e=A.useContext(Z8),t=A.useContext(X8),{getFieldState:r,formState:i}=_b(),a=r(e.name,i);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:u}=t;return{id:u,name:e.name,formItemId:`${u}-form-item`,formDescriptionId:`${u}-form-item-description`,formMessageId:`${u}-form-item-message`,...a}},X8=A.createContext({}),Ds=A.forwardRef(({className:e,...t},r)=>{const i=A.useId();return m.jsx(X8.Provider,{value:{id:i},children:m.jsx("div",{ref:r,className:It("space-y-2",e),...t})})});Ds.displayName="FormItem";const Rs=A.forwardRef(({className:e,...t},r)=>{const{error:i,formItemId:a}=wb();return m.jsx(pr,{ref:r,className:It(i&&"text-destructive",e),htmlFor:a,...t})});Rs.displayName="FormLabel";const Ns=A.forwardRef(({...e},t)=>{const{error:r,formItemId:i,formDescriptionId:a,formMessageId:u}=wb();return m.jsx(Tl,{ref:t,id:i,"aria-describedby":r?`${a} ${u}`:`${a}`,"aria-invalid":!!r,...e})});Ns.displayName="FormControl";const lc=A.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:i}=wb();return m.jsx("p",{ref:r,id:i,className:It("text-sm text-muted-foreground",e),...t})});lc.displayName="FormDescription";const no=A.forwardRef(({className:e,children:t,...r},i)=>{const{error:a,formMessageId:u}=wb(),h=a?String(a==null?void 0:a.message):t;return h?m.jsx("p",{ref:i,id:u,className:It("text-sm font-medium text-destructive",e),...r,children:h}):null});no.displayName="FormMessage";const eL=(e,t,r)=>{if(e&&"reportValidity"in e){const i=Wt(r,t);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},Y8=(e,t)=>{for(const r in t.fields){const i=t.fields[r];i&&i.ref&&"reportValidity"in i.ref?eL(i.ref,r,e):i.refs&&i.refs.forEach(a=>eL(a,r,e))}},Iue=(e,t)=>{t.shouldUseNativeValidation&&Y8(e,t);const r={};for(const i in e){const a=Wt(t.fields,i),u=Object.assign(e[i]||{},{ref:a&&a.ref});if(Due(t.names||Object.keys(e),i)){const h=Object.assign({},Wt(r,i));bn(h,"root",u),bn(r,i,h)}else bn(r,i,u)}return r},Due=(e,t)=>e.some(r=>r.startsWith(t+"."));var Rue=function(e,t){for(var r={};e.length;){var i=e[0],a=i.code,u=i.message,h=i.path.join(".");if(!r[h])if("unionErrors"in i){var g=i.unionErrors[0].errors[0];r[h]={message:g.message,type:g.code}}else r[h]={message:u,type:a};if("unionErrors"in i&&i.unionErrors.forEach(function(b){return b.errors.forEach(function(C){return e.push(C)})}),t){var s=r[h].types,_=s&&s[i.code];r[h]=U8(h,t,r,a,_?[].concat(_,i.message):i.message)}e.shift()}return r},Nue=function(e,t,r){return r===void 0&&(r={}),function(i,a,u){try{return Promise.resolve(function(h,g){try{var s=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](i,t)).then(function(_){return u.shouldUseNativeValidation&&Y8({},u),{errors:{},values:r.raw?i:_}})}catch(_){return g(_)}return s&&s.then?s.then(void 0,g):s}(0,function(h){if(function(g){return Array.isArray(g==null?void 0:g.errors)}(h))return{values:{},errors:Iue(Rue(h.errors,!u.shouldUseNativeValidation&&u.criteriaMode==="all"),u)};throw h}))}catch(h){return Promise.reject(h)}}},en;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const u={};for(const h of a)u[h]=h;return u},e.getValidEnumValues=a=>{const u=e.objectKeys(a).filter(g=>typeof a[a[g]]!="number"),h={};for(const g of u)h[g]=a[g];return e.objectValues(h)},e.objectValues=a=>e.objectKeys(a).map(function(u){return a[u]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const u=[];for(const h in a)Object.prototype.hasOwnProperty.call(a,h)&&u.push(h);return u},e.find=(a,u)=>{for(const h of a)if(u(h))return h},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function i(a,u=" | "){return a.map(h=>typeof h=="string"?`'${h}'`:h).join(u)}e.joinValues=i,e.jsonStringifyReplacer=(a,u)=>typeof u=="bigint"?u.toString():u})(en||(en={}));var tL;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(tL||(tL={}));const Kt=en.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),th=e=>{switch(typeof e){case"undefined":return Kt.undefined;case"string":return Kt.string;case"number":return isNaN(e)?Kt.nan:Kt.number;case"boolean":return Kt.boolean;case"function":return Kt.function;case"bigint":return Kt.bigint;case"symbol":return Kt.symbol;case"object":return Array.isArray(e)?Kt.array:e===null?Kt.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Kt.promise:typeof Map<"u"&&e instanceof Map?Kt.map:typeof Set<"u"&&e instanceof Set?Kt.set:typeof Date<"u"&&e instanceof Date?Kt.date:Kt.object;default:return Kt.unknown}},Nt=en.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class sa extends Error{constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const r=t||function(u){return u.message},i={_errors:[]},a=u=>{for(const h of u.issues)if(h.code==="invalid_union")h.unionErrors.map(a);else if(h.code==="invalid_return_type")a(h.returnTypeError);else if(h.code==="invalid_arguments")a(h.argumentsError);else if(h.path.length===0)i._errors.push(r(h));else{let g=i,s=0;for(;s<h.path.length;){const _=h.path[s];s===h.path.length-1?(g[_]=g[_]||{_errors:[]},g[_]._errors.push(r(h))):g[_]=g[_]||{_errors:[]},g=g[_],s++}}};return a(this),i}static assert(t){if(!(t instanceof sa))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,en.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},i=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):i.push(t(a));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}sa.create=e=>new sa(e);const Mv=(e,t)=>{let r;switch(e.code){case Nt.invalid_type:e.received===Kt.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Nt.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,en.jsonStringifyReplacer)}`;break;case Nt.unrecognized_keys:r=`Unrecognized key(s) in object: ${en.joinValues(e.keys,", ")}`;break;case Nt.invalid_union:r="Invalid input";break;case Nt.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${en.joinValues(e.options)}`;break;case Nt.invalid_enum_value:r=`Invalid enum value. Expected ${en.joinValues(e.options)}, received '${e.received}'`;break;case Nt.invalid_arguments:r="Invalid function arguments";break;case Nt.invalid_return_type:r="Invalid function return type";break;case Nt.invalid_date:r="Invalid date";break;case Nt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:en.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Nt.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Nt.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Nt.custom:r="Invalid input";break;case Nt.invalid_intersection_types:r="Intersection results could not be merged";break;case Nt.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Nt.not_finite:r="Number must be finite";break;default:r=t.defaultError,en.assertNever(e)}return{message:r}};let jue=Mv;function _M(){return jue}const wM=e=>{const{data:t,path:r,errorMaps:i,issueData:a}=e,u=[...r,...a.path||[]],h={...a,path:u};if(a.message!==void 0)return{...a,path:u,message:a.message};let g="";const s=i.filter(_=>!!_).slice().reverse();for(const _ of s)g=_(h,{data:t,defaultError:g}).message;return{...a,path:u,message:g}};function Zt(e,t){const r=_M(),i=wM({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Mv?void 0:Mv].filter(a=>!!a)});e.common.issues.push(i)}class Os{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const i=[];for(const a of r){if(a.status==="aborted")return Ar;a.status==="dirty"&&t.dirty(),i.push(a.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,r){const i=[];for(const a of r){const u=await a.key,h=await a.value;i.push({key:u,value:h})}return Os.mergeObjectSync(t,i)}static mergeObjectSync(t,r){const i={};for(const a of r){const{key:u,value:h}=a;if(u.status==="aborted"||h.status==="aborted")return Ar;u.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),u.value!=="__proto__"&&(typeof h.value<"u"||a.alwaysSet)&&(i[u.value]=h.value)}return{status:t.value,value:i}}}const Ar=Object.freeze({status:"aborted"}),by=e=>({status:"dirty",value:e}),uo=e=>({status:"valid",value:e}),rL=e=>e.status==="aborted",nL=e=>e.status==="dirty",ew=e=>e.status==="valid",tw=e=>typeof Promise<"u"&&e instanceof Promise;function rw(e,t,r,i){if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function K8(e,t,r,i,a){if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var ar;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ar||(ar={}));var Sy,Ey;class kl{constructor(t,r,i,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=i,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const iL=(e,t)=>{if(ew(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new sa(e.common.issues);return this._error=r,this._error}}};function zr(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:i,description:a}=e;if(t&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(h,g)=>{var s,_;const{message:b}=e;return h.code==="invalid_enum_value"?{message:b??g.defaultError}:typeof g.data>"u"?{message:(s=b??i)!==null&&s!==void 0?s:g.defaultError}:h.code!=="invalid_type"?{message:g.defaultError}:{message:(_=b??r)!==null&&_!==void 0?_:g.defaultError}},description:a}}class Hr{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return th(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:th(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Os,ctx:{common:t.parent.common,data:t.data,parsedType:th(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(tw(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const i=this.safeParse(t,r);if(i.success)return i.data;throw i.error}safeParse(t,r){var i;const a={common:{issues:[],async:(i=r==null?void 0:r.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:th(t)},u=this._parseSync({data:t,path:a.path,parent:a});return iL(a,u)}async parseAsync(t,r){const i=await this.safeParseAsync(t,r);if(i.success)return i.data;throw i.error}async safeParseAsync(t,r){const i={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:th(t)},a=this._parse({data:t,path:i.path,parent:i}),u=await(tw(a)?a:Promise.resolve(a));return iL(i,u)}refine(t,r){const i=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,u)=>{const h=t(a),g=()=>u.addIssue({code:Nt.custom,...i(a)});return typeof Promise<"u"&&h instanceof Promise?h.then(s=>s?!0:(g(),!1)):h?!0:(g(),!1)})}refinement(t,r){return this._refinement((i,a)=>t(i)?!0:(a.addIssue(typeof r=="function"?r(i,a):r),!1))}_refinement(t){return new Sc({schema:this,typeName:Tr.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return fc.create(this,this._def)}nullable(){return Ih.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Sl.create(this,this._def)}promise(){return Pv.create(this,this._def)}or(t){return sw.create([this,t],this._def)}and(t){return ow.create(this,t,this._def)}transform(t){return new Sc({...zr(this._def),schema:this,typeName:Tr.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new dw({...zr(this._def),innerType:this,defaultValue:r,typeName:Tr.ZodDefault})}brand(){return new t$({typeName:Tr.ZodBranded,type:this,...zr(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new hw({...zr(this._def),innerType:this,catchValue:r,typeName:Tr.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return bb.create(this,t)}readonly(){return fw.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Lue=/^c[^\s-]{8,}$/i,Oue=/^[0-9a-z]+$/,zue=/^[0-9A-HJKMNP-TV-Z]{26}$/,Fue=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Bue=/^[a-z0-9_-]{21}$/i,Uue=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Vue=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$ue="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let _T;const Wue=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Gue=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Hue=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Q8="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",que=new RegExp(`^${Q8}$`);function J8(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function Zue(e){return new RegExp(`^${J8(e)}$`)}function Xue(e){let t=`${Q8}T${J8(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Yue(e,t){return!!((t==="v4"||!t)&&Wue.test(e)||(t==="v6"||!t)&&Gue.test(e))}class cc extends Hr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Kt.string){const u=this._getOrReturnCtx(t);return Zt(u,{code:Nt.invalid_type,expected:Kt.string,received:u.parsedType}),Ar}const i=new Os;let a;for(const u of this._def.checks)if(u.kind==="min")t.data.length<u.value&&(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="max")t.data.length>u.value&&(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),i.dirty());else if(u.kind==="length"){const h=t.data.length>u.value,g=t.data.length<u.value;(h||g)&&(a=this._getOrReturnCtx(t,a),h?Zt(a,{code:Nt.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):g&&Zt(a,{code:Nt.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),i.dirty())}else if(u.kind==="email")Vue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"email",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="emoji")_T||(_T=new RegExp($ue,"u")),_T.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"emoji",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="uuid")Fue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"uuid",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="nanoid")Bue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"nanoid",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid")Lue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"cuid",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="cuid2")Oue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"cuid2",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="ulid")zue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"ulid",code:Nt.invalid_string,message:u.message}),i.dirty());else if(u.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Zt(a,{validation:"url",code:Nt.invalid_string,message:u.message}),i.dirty()}else u.kind==="regex"?(u.regex.lastIndex=0,u.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"regex",code:Nt.invalid_string,message:u.message}),i.dirty())):u.kind==="trim"?t.data=t.data.trim():u.kind==="includes"?t.data.includes(u.value,u.position)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),i.dirty()):u.kind==="toLowerCase"?t.data=t.data.toLowerCase():u.kind==="toUpperCase"?t.data=t.data.toUpperCase():u.kind==="startsWith"?t.data.startsWith(u.value)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:{startsWith:u.value},message:u.message}),i.dirty()):u.kind==="endsWith"?t.data.endsWith(u.value)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:{endsWith:u.value},message:u.message}),i.dirty()):u.kind==="datetime"?Xue(u).test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:"datetime",message:u.message}),i.dirty()):u.kind==="date"?que.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:"date",message:u.message}),i.dirty()):u.kind==="time"?Zue(u).test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.invalid_string,validation:"time",message:u.message}),i.dirty()):u.kind==="duration"?Uue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"duration",code:Nt.invalid_string,message:u.message}),i.dirty()):u.kind==="ip"?Yue(t.data,u.version)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"ip",code:Nt.invalid_string,message:u.message}),i.dirty()):u.kind==="base64"?Hue.test(t.data)||(a=this._getOrReturnCtx(t,a),Zt(a,{validation:"base64",code:Nt.invalid_string,message:u.message}),i.dirty()):en.assertNever(u);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(a=>t.test(a),{validation:r,code:Nt.invalid_string,...ar.errToObj(i)})}_addCheck(t){return new cc({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ar.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ar.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ar.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ar.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ar.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ar.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ar.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ar.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ar.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ar.errToObj(t)})}datetime(t){var r,i;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(i=t==null?void 0:t.local)!==null&&i!==void 0?i:!1,...ar.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ar.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ar.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ar.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ar.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ar.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ar.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ar.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ar.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ar.errToObj(r)})}nonempty(t){return this.min(1,ar.errToObj(t))}trim(){return new cc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new cc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new cc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}cc.create=e=>{var t;return new cc({checks:[],typeName:Tr.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...zr(e)})};function Kue(e,t){const r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,a=r>i?r:i,u=parseInt(e.toFixed(a).replace(".","")),h=parseInt(t.toFixed(a).replace(".",""));return u%h/Math.pow(10,a)}class Xp extends Hr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Kt.number){const u=this._getOrReturnCtx(t);return Zt(u,{code:Nt.invalid_type,expected:Kt.number,received:u.parsedType}),Ar}let i;const a=new Os;for(const u of this._def.checks)u.kind==="int"?en.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.invalid_type,expected:"integer",received:"float",message:u.message}),a.dirty()):u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.too_small,minimum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),a.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.too_big,maximum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),a.dirty()):u.kind==="multipleOf"?Kue(t.data,u.value)!==0&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.not_multiple_of,multipleOf:u.value,message:u.message}),a.dirty()):u.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.not_finite,message:u.message}),a.dirty()):en.assertNever(u);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ar.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ar.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ar.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ar.toString(r))}setLimit(t,r,i,a){return new Xp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ar.toString(a)}]})}_addCheck(t){return new Xp({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ar.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ar.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ar.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ar.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ar.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ar.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ar.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ar.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ar.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&en.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Xp.create=e=>new Xp({checks:[],typeName:Tr.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...zr(e)});class Yp extends Hr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==Kt.bigint){const u=this._getOrReturnCtx(t);return Zt(u,{code:Nt.invalid_type,expected:Kt.bigint,received:u.parsedType}),Ar}let i;const a=new Os;for(const u of this._def.checks)u.kind==="min"?(u.inclusive?t.data<u.value:t.data<=u.value)&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.too_small,type:"bigint",minimum:u.value,inclusive:u.inclusive,message:u.message}),a.dirty()):u.kind==="max"?(u.inclusive?t.data>u.value:t.data>=u.value)&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.too_big,type:"bigint",maximum:u.value,inclusive:u.inclusive,message:u.message}),a.dirty()):u.kind==="multipleOf"?t.data%u.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Zt(i,{code:Nt.not_multiple_of,multipleOf:u.value,message:u.message}),a.dirty()):en.assertNever(u);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ar.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ar.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ar.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ar.toString(r))}setLimit(t,r,i,a){return new Yp({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ar.toString(a)}]})}_addCheck(t){return new Yp({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ar.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ar.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ar.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ar.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ar.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Yp.create=e=>{var t;return new Yp({checks:[],typeName:Tr.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...zr(e)})};class bM extends Hr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Kt.boolean){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.boolean,received:i.parsedType}),Ar}return uo(t.data)}}bM.create=e=>new bM({typeName:Tr.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...zr(e)});class kv extends Hr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Kt.date){const u=this._getOrReturnCtx(t);return Zt(u,{code:Nt.invalid_type,expected:Kt.date,received:u.parsedType}),Ar}if(isNaN(t.data.getTime())){const u=this._getOrReturnCtx(t);return Zt(u,{code:Nt.invalid_date}),Ar}const i=new Os;let a;for(const u of this._def.checks)u.kind==="min"?t.data.getTime()<u.value&&(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.too_small,message:u.message,inclusive:!0,exact:!1,minimum:u.value,type:"date"}),i.dirty()):u.kind==="max"?t.data.getTime()>u.value&&(a=this._getOrReturnCtx(t,a),Zt(a,{code:Nt.too_big,message:u.message,inclusive:!0,exact:!1,maximum:u.value,type:"date"}),i.dirty()):en.assertNever(u);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new kv({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ar.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ar.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}kv.create=e=>new kv({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Tr.ZodDate,...zr(e)});class SM extends Hr{_parse(t){if(this._getType(t)!==Kt.symbol){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.symbol,received:i.parsedType}),Ar}return uo(t.data)}}SM.create=e=>new SM({typeName:Tr.ZodSymbol,...zr(e)});class nw extends Hr{_parse(t){if(this._getType(t)!==Kt.undefined){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.undefined,received:i.parsedType}),Ar}return uo(t.data)}}nw.create=e=>new nw({typeName:Tr.ZodUndefined,...zr(e)});class iw extends Hr{_parse(t){if(this._getType(t)!==Kt.null){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.null,received:i.parsedType}),Ar}return uo(t.data)}}iw.create=e=>new iw({typeName:Tr.ZodNull,...zr(e)});class EM extends Hr{constructor(){super(...arguments),this._any=!0}_parse(t){return uo(t.data)}}EM.create=e=>new EM({typeName:Tr.ZodAny,...zr(e)});class wp extends Hr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return uo(t.data)}}wp.create=e=>new wp({typeName:Tr.ZodUnknown,...zr(e)});class Zu extends Hr{_parse(t){const r=this._getOrReturnCtx(t);return Zt(r,{code:Nt.invalid_type,expected:Kt.never,received:r.parsedType}),Ar}}Zu.create=e=>new Zu({typeName:Tr.ZodNever,...zr(e)});class TM extends Hr{_parse(t){if(this._getType(t)!==Kt.undefined){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.void,received:i.parsedType}),Ar}return uo(t.data)}}TM.create=e=>new TM({typeName:Tr.ZodVoid,...zr(e)});class Sl extends Hr{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),a=this._def;if(r.parsedType!==Kt.array)return Zt(r,{code:Nt.invalid_type,expected:Kt.array,received:r.parsedType}),Ar;if(a.exactLength!==null){const h=r.data.length>a.exactLength.value,g=r.data.length<a.exactLength.value;(h||g)&&(Zt(r,{code:h?Nt.too_big:Nt.too_small,minimum:g?a.exactLength.value:void 0,maximum:h?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),i.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Zt(r,{code:Nt.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),i.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Zt(r,{code:Nt.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((h,g)=>a.type._parseAsync(new kl(r,h,r.path,g)))).then(h=>Os.mergeArray(i,h));const u=[...r.data].map((h,g)=>a.type._parseSync(new kl(r,h,r.path,g)));return Os.mergeArray(i,u)}get element(){return this._def.type}min(t,r){return new Sl({...this._def,minLength:{value:t,message:ar.toString(r)}})}max(t,r){return new Sl({...this._def,maxLength:{value:t,message:ar.toString(r)}})}length(t,r){return new Sl({...this._def,exactLength:{value:t,message:ar.toString(r)}})}nonempty(t){return this.min(1,t)}}Sl.create=(e,t)=>new Sl({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Tr.ZodArray,...zr(t)});function qf(e){if(e instanceof ui){const t={};for(const r in e.shape){const i=e.shape[r];t[r]=fc.create(qf(i))}return new ui({...e._def,shape:()=>t})}else return e instanceof Sl?new Sl({...e._def,type:qf(e.element)}):e instanceof fc?fc.create(qf(e.unwrap())):e instanceof Ih?Ih.create(qf(e.unwrap())):e instanceof bc?bc.create(e.items.map(t=>qf(t))):e}class ui extends Hr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=en.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==Kt.object){const _=this._getOrReturnCtx(t);return Zt(_,{code:Nt.invalid_type,expected:Kt.object,received:_.parsedType}),Ar}const{status:i,ctx:a}=this._processInputParams(t),{shape:u,keys:h}=this._getCached(),g=[];if(!(this._def.catchall instanceof Zu&&this._def.unknownKeys==="strip"))for(const _ in a.data)h.includes(_)||g.push(_);const s=[];for(const _ of h){const b=u[_],C=a.data[_];s.push({key:{status:"valid",value:_},value:b._parse(new kl(a,C,a.path,_)),alwaysSet:_ in a.data})}if(this._def.catchall instanceof Zu){const _=this._def.unknownKeys;if(_==="passthrough")for(const b of g)s.push({key:{status:"valid",value:b},value:{status:"valid",value:a.data[b]}});else if(_==="strict")g.length>0&&(Zt(a,{code:Nt.unrecognized_keys,keys:g}),i.dirty());else if(_!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const _=this._def.catchall;for(const b of g){const C=a.data[b];s.push({key:{status:"valid",value:b},value:_._parse(new kl(a,C,a.path,b)),alwaysSet:b in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const _=[];for(const b of s){const C=await b.key,M=await b.value;_.push({key:C,value:M,alwaysSet:b.alwaysSet})}return _}).then(_=>Os.mergeObjectSync(i,_)):Os.mergeObjectSync(i,s)}get shape(){return this._def.shape()}strict(t){return ar.errToObj,new ui({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,i)=>{var a,u,h,g;const s=(h=(u=(a=this._def).errorMap)===null||u===void 0?void 0:u.call(a,r,i).message)!==null&&h!==void 0?h:i.defaultError;return r.code==="unrecognized_keys"?{message:(g=ar.errToObj(t).message)!==null&&g!==void 0?g:s}:{message:s}}}:{}})}strip(){return new ui({...this._def,unknownKeys:"strip"})}passthrough(){return new ui({...this._def,unknownKeys:"passthrough"})}extend(t){return new ui({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ui({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Tr.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new ui({...this._def,catchall:t})}pick(t){const r={};return en.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(r[i]=this.shape[i])}),new ui({...this._def,shape:()=>r})}omit(t){const r={};return en.objectKeys(this.shape).forEach(i=>{t[i]||(r[i]=this.shape[i])}),new ui({...this._def,shape:()=>r})}deepPartial(){return qf(this)}partial(t){const r={};return en.objectKeys(this.shape).forEach(i=>{const a=this.shape[i];t&&!t[i]?r[i]=a:r[i]=a.optional()}),new ui({...this._def,shape:()=>r})}required(t){const r={};return en.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])r[i]=this.shape[i];else{let u=this.shape[i];for(;u instanceof fc;)u=u._def.innerType;r[i]=u}}),new ui({...this._def,shape:()=>r})}keyof(){return e$(en.objectKeys(this.shape))}}ui.create=(e,t)=>new ui({shape:()=>e,unknownKeys:"strip",catchall:Zu.create(),typeName:Tr.ZodObject,...zr(t)});ui.strictCreate=(e,t)=>new ui({shape:()=>e,unknownKeys:"strict",catchall:Zu.create(),typeName:Tr.ZodObject,...zr(t)});ui.lazycreate=(e,t)=>new ui({shape:e,unknownKeys:"strip",catchall:Zu.create(),typeName:Tr.ZodObject,...zr(t)});class sw extends Hr{_parse(t){const{ctx:r}=this._processInputParams(t),i=this._def.options;function a(u){for(const g of u)if(g.result.status==="valid")return g.result;for(const g of u)if(g.result.status==="dirty")return r.common.issues.push(...g.ctx.common.issues),g.result;const h=u.map(g=>new sa(g.ctx.common.issues));return Zt(r,{code:Nt.invalid_union,unionErrors:h}),Ar}if(r.common.async)return Promise.all(i.map(async u=>{const h={...r,common:{...r.common,issues:[]},parent:null};return{result:await u._parseAsync({data:r.data,path:r.path,parent:h}),ctx:h}})).then(a);{let u;const h=[];for(const s of i){const _={...r,common:{...r.common,issues:[]},parent:null},b=s._parseSync({data:r.data,path:r.path,parent:_});if(b.status==="valid")return b;b.status==="dirty"&&!u&&(u={result:b,ctx:_}),_.common.issues.length&&h.push(_.common.issues)}if(u)return r.common.issues.push(...u.ctx.common.issues),u.result;const g=h.map(s=>new sa(s));return Zt(r,{code:Nt.invalid_union,unionErrors:g}),Ar}}get options(){return this._def.options}}sw.create=(e,t)=>new sw({options:e,typeName:Tr.ZodUnion,...zr(t)});const tc=e=>e instanceof lw?tc(e.schema):e instanceof Sc?tc(e.innerType()):e instanceof cw?[e.value]:e instanceof Ah?e.options:e instanceof uw?en.objectValues(e.enum):e instanceof dw?tc(e._def.innerType):e instanceof nw?[void 0]:e instanceof iw?[null]:e instanceof fc?[void 0,...tc(e.unwrap())]:e instanceof Ih?[null,...tc(e.unwrap())]:e instanceof t$||e instanceof fw?tc(e.unwrap()):e instanceof hw?tc(e._def.innerType):[];class yA extends Hr{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Kt.object)return Zt(r,{code:Nt.invalid_type,expected:Kt.object,received:r.parsedType}),Ar;const i=this.discriminator,a=r.data[i],u=this.optionsMap.get(a);return u?r.common.async?u._parseAsync({data:r.data,path:r.path,parent:r}):u._parseSync({data:r.data,path:r.path,parent:r}):(Zt(r,{code:Nt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),Ar)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,i){const a=new Map;for(const u of r){const h=tc(u.shape[t]);if(!h.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const g of h){if(a.has(g))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(g)}`);a.set(g,u)}}return new yA({typeName:Tr.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...zr(i)})}}function CM(e,t){const r=th(e),i=th(t);if(e===t)return{valid:!0,data:e};if(r===Kt.object&&i===Kt.object){const a=en.objectKeys(t),u=en.objectKeys(e).filter(g=>a.indexOf(g)!==-1),h={...e,...t};for(const g of u){const s=CM(e[g],t[g]);if(!s.valid)return{valid:!1};h[g]=s.data}return{valid:!0,data:h}}else if(r===Kt.array&&i===Kt.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let u=0;u<e.length;u++){const h=e[u],g=t[u],s=CM(h,g);if(!s.valid)return{valid:!1};a.push(s.data)}return{valid:!0,data:a}}else return r===Kt.date&&i===Kt.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ow extends Hr{_parse(t){const{status:r,ctx:i}=this._processInputParams(t),a=(u,h)=>{if(rL(u)||rL(h))return Ar;const g=CM(u.value,h.value);return g.valid?((nL(u)||nL(h))&&r.dirty(),{status:r.value,value:g.data}):(Zt(i,{code:Nt.invalid_intersection_types}),Ar)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([u,h])=>a(u,h)):a(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}ow.create=(e,t,r)=>new ow({left:e,right:t,typeName:Tr.ZodIntersection,...zr(r)});class bc extends Hr{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Kt.array)return Zt(i,{code:Nt.invalid_type,expected:Kt.array,received:i.parsedType}),Ar;if(i.data.length<this._def.items.length)return Zt(i,{code:Nt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ar;!this._def.rest&&i.data.length>this._def.items.length&&(Zt(i,{code:Nt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const u=[...i.data].map((h,g)=>{const s=this._def.items[g]||this._def.rest;return s?s._parse(new kl(i,h,i.path,g)):null}).filter(h=>!!h);return i.common.async?Promise.all(u).then(h=>Os.mergeArray(r,h)):Os.mergeArray(r,u)}get items(){return this._def.items}rest(t){return new bc({...this._def,rest:t})}}bc.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new bc({items:e,typeName:Tr.ZodTuple,rest:null,...zr(t)})};class aw extends Hr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Kt.object)return Zt(i,{code:Nt.invalid_type,expected:Kt.object,received:i.parsedType}),Ar;const a=[],u=this._def.keyType,h=this._def.valueType;for(const g in i.data)a.push({key:u._parse(new kl(i,g,i.path,g)),value:h._parse(new kl(i,i.data[g],i.path,g)),alwaysSet:g in i.data});return i.common.async?Os.mergeObjectAsync(r,a):Os.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,i){return r instanceof Hr?new aw({keyType:t,valueType:r,typeName:Tr.ZodRecord,...zr(i)}):new aw({keyType:cc.create(),valueType:t,typeName:Tr.ZodRecord,...zr(r)})}}class MM extends Hr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Kt.map)return Zt(i,{code:Nt.invalid_type,expected:Kt.map,received:i.parsedType}),Ar;const a=this._def.keyType,u=this._def.valueType,h=[...i.data.entries()].map(([g,s],_)=>({key:a._parse(new kl(i,g,i.path,[_,"key"])),value:u._parse(new kl(i,s,i.path,[_,"value"]))}));if(i.common.async){const g=new Map;return Promise.resolve().then(async()=>{for(const s of h){const _=await s.key,b=await s.value;if(_.status==="aborted"||b.status==="aborted")return Ar;(_.status==="dirty"||b.status==="dirty")&&r.dirty(),g.set(_.value,b.value)}return{status:r.value,value:g}})}else{const g=new Map;for(const s of h){const _=s.key,b=s.value;if(_.status==="aborted"||b.status==="aborted")return Ar;(_.status==="dirty"||b.status==="dirty")&&r.dirty(),g.set(_.value,b.value)}return{status:r.value,value:g}}}}MM.create=(e,t,r)=>new MM({valueType:t,keyType:e,typeName:Tr.ZodMap,...zr(r)});class Kp extends Hr{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Kt.set)return Zt(i,{code:Nt.invalid_type,expected:Kt.set,received:i.parsedType}),Ar;const a=this._def;a.minSize!==null&&i.data.size<a.minSize.value&&(Zt(i,{code:Nt.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&i.data.size>a.maxSize.value&&(Zt(i,{code:Nt.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const u=this._def.valueType;function h(s){const _=new Set;for(const b of s){if(b.status==="aborted")return Ar;b.status==="dirty"&&r.dirty(),_.add(b.value)}return{status:r.value,value:_}}const g=[...i.data.values()].map((s,_)=>u._parse(new kl(i,s,i.path,_)));return i.common.async?Promise.all(g).then(s=>h(s)):h(g)}min(t,r){return new Kp({...this._def,minSize:{value:t,message:ar.toString(r)}})}max(t,r){return new Kp({...this._def,maxSize:{value:t,message:ar.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Kp.create=(e,t)=>new Kp({valueType:e,minSize:null,maxSize:null,typeName:Tr.ZodSet,...zr(t)});class Vy extends Hr{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Kt.function)return Zt(r,{code:Nt.invalid_type,expected:Kt.function,received:r.parsedType}),Ar;function i(g,s){return wM({data:g,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,_M(),Mv].filter(_=>!!_),issueData:{code:Nt.invalid_arguments,argumentsError:s}})}function a(g,s){return wM({data:g,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,_M(),Mv].filter(_=>!!_),issueData:{code:Nt.invalid_return_type,returnTypeError:s}})}const u={errorMap:r.common.contextualErrorMap},h=r.data;if(this._def.returns instanceof Pv){const g=this;return uo(async function(...s){const _=new sa([]),b=await g._def.args.parseAsync(s,u).catch(D=>{throw _.addIssue(i(s,D)),_}),C=await Reflect.apply(h,this,b);return await g._def.returns._def.type.parseAsync(C,u).catch(D=>{throw _.addIssue(a(C,D)),_})})}else{const g=this;return uo(function(...s){const _=g._def.args.safeParse(s,u);if(!_.success)throw new sa([i(s,_.error)]);const b=Reflect.apply(h,this,_.data),C=g._def.returns.safeParse(b,u);if(!C.success)throw new sa([a(b,C.error)]);return C.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Vy({...this._def,args:bc.create(t).rest(wp.create())})}returns(t){return new Vy({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,i){return new Vy({args:t||bc.create([]).rest(wp.create()),returns:r||wp.create(),typeName:Tr.ZodFunction,...zr(i)})}}class lw extends Hr{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}lw.create=(e,t)=>new lw({getter:e,typeName:Tr.ZodLazy,...zr(t)});class cw extends Hr{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Zt(r,{received:r.data,code:Nt.invalid_literal,expected:this._def.value}),Ar}return{status:"valid",value:t.data}}get value(){return this._def.value}}cw.create=(e,t)=>new cw({value:e,typeName:Tr.ZodLiteral,...zr(t)});function e$(e,t){return new Ah({values:e,typeName:Tr.ZodEnum,...zr(t)})}class Ah extends Hr{constructor(){super(...arguments),Sy.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),i=this._def.values;return Zt(r,{expected:en.joinValues(i),received:r.parsedType,code:Nt.invalid_type}),Ar}if(rw(this,Sy)||K8(this,Sy,new Set(this._def.values)),!rw(this,Sy).has(t.data)){const r=this._getOrReturnCtx(t),i=this._def.values;return Zt(r,{received:r.data,code:Nt.invalid_enum_value,options:i}),Ar}return uo(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Ah.create(t,{...this._def,...r})}exclude(t,r=this._def){return Ah.create(this.options.filter(i=>!t.includes(i)),{...this._def,...r})}}Sy=new WeakMap;Ah.create=e$;class uw extends Hr{constructor(){super(...arguments),Ey.set(this,void 0)}_parse(t){const r=en.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==Kt.string&&i.parsedType!==Kt.number){const a=en.objectValues(r);return Zt(i,{expected:en.joinValues(a),received:i.parsedType,code:Nt.invalid_type}),Ar}if(rw(this,Ey)||K8(this,Ey,new Set(en.getValidEnumValues(this._def.values))),!rw(this,Ey).has(t.data)){const a=en.objectValues(r);return Zt(i,{received:i.data,code:Nt.invalid_enum_value,options:a}),Ar}return uo(t.data)}get enum(){return this._def.values}}Ey=new WeakMap;uw.create=(e,t)=>new uw({values:e,typeName:Tr.ZodNativeEnum,...zr(t)});class Pv extends Hr{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Kt.promise&&r.common.async===!1)return Zt(r,{code:Nt.invalid_type,expected:Kt.promise,received:r.parsedType}),Ar;const i=r.parsedType===Kt.promise?r.data:Promise.resolve(r.data);return uo(i.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Pv.create=(e,t)=>new Pv({type:e,typeName:Tr.ZodPromise,...zr(t)});class Sc extends Hr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Tr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:i}=this._processInputParams(t),a=this._def.effect||null,u={addIssue:h=>{Zt(i,h),h.fatal?r.abort():r.dirty()},get path(){return i.path}};if(u.addIssue=u.addIssue.bind(u),a.type==="preprocess"){const h=a.transform(i.data,u);if(i.common.async)return Promise.resolve(h).then(async g=>{if(r.value==="aborted")return Ar;const s=await this._def.schema._parseAsync({data:g,path:i.path,parent:i});return s.status==="aborted"?Ar:s.status==="dirty"||r.value==="dirty"?by(s.value):s});{if(r.value==="aborted")return Ar;const g=this._def.schema._parseSync({data:h,path:i.path,parent:i});return g.status==="aborted"?Ar:g.status==="dirty"||r.value==="dirty"?by(g.value):g}}if(a.type==="refinement"){const h=g=>{const s=a.refinement(g,u);if(i.common.async)return Promise.resolve(s);if(s instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return g};if(i.common.async===!1){const g=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return g.status==="aborted"?Ar:(g.status==="dirty"&&r.dirty(),h(g.value),{status:r.value,value:g.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(g=>g.status==="aborted"?Ar:(g.status==="dirty"&&r.dirty(),h(g.value).then(()=>({status:r.value,value:g.value}))))}if(a.type==="transform")if(i.common.async===!1){const h=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ew(h))return h;const g=a.transform(h.value,u);if(g instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:g}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(h=>ew(h)?Promise.resolve(a.transform(h.value,u)).then(g=>({status:r.value,value:g})):h);en.assertNever(a)}}Sc.create=(e,t,r)=>new Sc({schema:e,typeName:Tr.ZodEffects,effect:t,...zr(r)});Sc.createWithPreprocess=(e,t,r)=>new Sc({schema:t,effect:{type:"preprocess",transform:e},typeName:Tr.ZodEffects,...zr(r)});class fc extends Hr{_parse(t){return this._getType(t)===Kt.undefined?uo(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}fc.create=(e,t)=>new fc({innerType:e,typeName:Tr.ZodOptional,...zr(t)});class Ih extends Hr{_parse(t){return this._getType(t)===Kt.null?uo(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ih.create=(e,t)=>new Ih({innerType:e,typeName:Tr.ZodNullable,...zr(t)});class dw extends Hr{_parse(t){const{ctx:r}=this._processInputParams(t);let i=r.data;return r.parsedType===Kt.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}dw.create=(e,t)=>new dw({innerType:e,typeName:Tr.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...zr(t)});class hw extends Hr{_parse(t){const{ctx:r}=this._processInputParams(t),i={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return tw(a)?a.then(u=>({status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new sa(i.common.issues)},input:i.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new sa(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}hw.create=(e,t)=>new hw({innerType:e,typeName:Tr.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...zr(t)});class kM extends Hr{_parse(t){if(this._getType(t)!==Kt.nan){const i=this._getOrReturnCtx(t);return Zt(i,{code:Nt.invalid_type,expected:Kt.nan,received:i.parsedType}),Ar}return{status:"valid",value:t.data}}}kM.create=e=>new kM({typeName:Tr.ZodNaN,...zr(e)});class t$ extends Hr{_parse(t){const{ctx:r}=this._processInputParams(t),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}}class bb extends Hr{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const u=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?Ar:u.status==="dirty"?(r.dirty(),by(u.value)):this._def.out._parseAsync({data:u.value,path:i.path,parent:i})})();{const a=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?Ar:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:i.path,parent:i})}}static create(t,r){return new bb({in:t,out:r,typeName:Tr.ZodPipeline})}}class fw extends Hr{_parse(t){const r=this._def.innerType._parse(t),i=a=>(ew(a)&&(a.value=Object.freeze(a.value)),a);return tw(r)?r.then(a=>i(a)):i(r)}unwrap(){return this._def.innerType}}fw.create=(e,t)=>new fw({innerType:e,typeName:Tr.ZodReadonly,...zr(t)});ui.lazycreate;var Tr;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Tr||(Tr={}));const Vi=cc.create;Xp.create;kM.create;Yp.create;const Que=bM.create;kv.create;SM.create;nw.create;iw.create;EM.create;wp.create;Zu.create;TM.create;const Jue=Sl.create,r$=ui.create;ui.strictCreate;sw.create;yA.create;ow.create;bc.create;aw.create;MM.create;Kp.create;Vy.create;lw.create;const py=cw.create;Ah.create;uw.create;Pv.create;Sc.create;fc.create;Ih.create;Sc.createWithPreprocess;bb.create;var vA="Switch",[ede,Mfe]=Ya(vA),[tde,rde]=ede(vA),n$=A.forwardRef((e,t)=>{const{__scopeSwitch:r,name:i,checked:a,defaultChecked:u,required:h,disabled:g,value:s="on",onCheckedChange:_,form:b,...C}=e,[M,D]=A.useState(null),N=Cr(t,U=>D(U)),j=A.useRef(!1),V=M?b||!!M.closest("form"):!0,[B=!1,z]=Wa({prop:a,defaultProp:u,onChange:_});return m.jsxs(tde,{scope:r,checked:B,disabled:g,children:[m.jsx(sr.button,{type:"button",role:"switch","aria-checked":B,"aria-required":h,"data-state":o$(B),"data-disabled":g?"":void 0,disabled:g,value:s,...C,ref:N,onClick:kt(e.onClick,U=>{z(Z=>!Z),V&&(j.current=U.isPropagationStopped(),j.current||U.stopPropagation())})}),V&&m.jsx(nde,{control:M,bubbles:!j.current,name:i,value:s,checked:B,required:h,disabled:g,form:b,style:{transform:"translateX(-100%)"}})]})});n$.displayName=vA;var i$="SwitchThumb",s$=A.forwardRef((e,t)=>{const{__scopeSwitch:r,...i}=e,a=rde(i$,r);return m.jsx(sr.span,{"data-state":o$(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t})});s$.displayName=i$;var nde=e=>{const{control:t,checked:r,bubbles:i=!0,...a}=e,u=A.useRef(null),h=eb(r),g=eP(t);return A.useEffect(()=>{const s=u.current,_=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(_,"checked").set;if(h!==r&&C){const M=new Event("click",{bubbles:i});C.call(s,r),s.dispatchEvent(M)}},[h,r,i]),m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:u,style:{...e.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function o$(e){return e?"checked":"unchecked"}var a$=n$,ide=s$;const Av=A.forwardRef(({className:e,...t},r)=>m.jsx(a$,{className:It("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:m.jsx(ide,{className:It("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Av.displayName=a$.displayName;function sde({form:e,logoPreview:t,faviconPreview:r,handleLogoChange:i,handleFaviconChange:a}){return m.jsxs(Wi,{children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"General Settings"}),m.jsx(Co,{children:"Manage your website's basic information, logo and favicon"})]}),m.jsx(xs,{className:"space-y-6",children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsx(ro,{control:e.control,name:"siteName",render:({field:u})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Restaurant Name"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"Young Brave Fearless",...u})}),m.jsx(lc,{children:"This appears in the header and various parts of the site"}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"siteTitle",render:({field:u})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Website Title (Browser Tab)"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"YBF Resto - Young Brave Fearless Restaurant",...u})}),m.jsx(lc,{children:"This appears in the browser tab"}),m.jsx(no,{})]})})]}),m.jsx(ro,{control:e.control,name:"heroSliderMobileVertical",render:({field:u})=>m.jsxs(Ds,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Rs,{className:"text-base",children:"Hero Slider Mobile Vertical"}),m.jsx(lc,{children:"Use a vertical aspect ratio for hero slides on mobile devices to better support portrait images"})]}),m.jsx(Ns,{children:m.jsx(Av,{checked:u.value!==!1,onCheckedChange:h=>{console.log("Switch changed to:",h),u.onChange(h)}})})]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"logo-upload",children:"Website Logo"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"h-20 w-40 bg-muted rounded-md flex items-center justify-center overflow-hidden border",children:t?m.jsx("img",{src:t,alt:"Logo Preview",className:"max-h-full max-w-full object-contain"}):m.jsx("div",{className:"text-center text-muted-foreground p-2",children:"No logo uploaded"})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(ur,{id:"logo-upload",type:"file",accept:"image/*",onChange:i,className:"w-full max-w-xs"}),m.jsxs("p",{className:"text-sm text-muted-foreground",children:["Recommended size: 240x80px, PNG or SVG with transparent background.",m.jsx("strong",{className:"block mt-1",children:"Used for website header."})]})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"favicon-upload",children:"Website Favicon"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"h-16 w-16 bg-muted rounded-md flex items-center justify-center overflow-hidden border",children:r?m.jsx("img",{src:r,alt:"Favicon Preview",className:"max-h-full max-w-full object-contain"}):m.jsx(TX,{className:"h-8 w-8 text-muted-foreground"})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(ur,{id:"favicon-upload",type:"file",accept:"image/png,image/jpeg,image/svg+xml",onChange:a,className:"w-full max-w-xs"}),m.jsxs("p",{className:"text-sm text-muted-foreground",children:["Recommended size: 32x32px or 64x64px, PNG format.",m.jsx("strong",{className:"block mt-1",children:"Used for the browser tab icon."})]})]})]})]})]})})]})}function ode({form:e}){return m.jsxs("div",{className:"space-y-8",children:[m.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[m.jsx(ro,{control:e.control,name:"mission",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Highlight Customer Benefits"}),m.jsx(Ns,{children:m.jsx(yh,{placeholder:"Our mission is to...",className:"min-h-[120px]",...t})}),m.jsx(lc,{children:"Your Highlight Customer Benefits statement."}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"vision",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Our Vision & Mission"}),m.jsx(Ns,{children:m.jsx(yh,{placeholder:"We envision...",className:"min-h-[120px]",...t})}),m.jsx(lc,{children:"Your restaurant's vision & mission statement."}),m.jsx(no,{})]})})]}),m.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[m.jsx(ro,{control:e.control,name:"whatsappNumber",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"WhatsApp Number"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"628123456789",...t,value:t.value||""})}),m.jsx(lc,{children:"Enter your WhatsApp number with country code (e.g., 628123456789 for Indonesia)"}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"whatsappMessage",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Default WhatsApp Message"}),m.jsx(Ns,{children:m.jsx(yh,{placeholder:"Hello! I'd like to make a reservation...",className:"min-h-[120px]",...t,value:t.value||""})}),m.jsx(lc,{children:"Default message customers will send when they click on WhatsApp button"}),m.jsx(no,{})]})})]})]})}var xA="Popover",[l$,kfe]=Ya(xA,[pm]),fx=pm(),[ade,sd]=l$(xA),c$=e=>{const{__scopePopover:t,children:r,open:i,defaultOpen:a,onOpenChange:u,modal:h=!1}=e,g=fx(t),s=A.useRef(null),[_,b]=A.useState(!1),[C=!1,M]=Wa({prop:i,defaultProp:a,onChange:u});return m.jsx(nP,{...g,children:m.jsx(ade,{scope:t,contentId:Po(),triggerRef:s,open:C,onOpenChange:M,onOpenToggle:A.useCallback(()=>M(D=>!D),[M]),hasCustomAnchor:_,onCustomAnchorAdd:A.useCallback(()=>b(!0),[]),onCustomAnchorRemove:A.useCallback(()=>b(!1),[]),modal:h,children:r})})};c$.displayName=xA;var u$="PopoverAnchor",lde=A.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=sd(u$,r),u=fx(r),{onCustomAnchorAdd:h,onCustomAnchorRemove:g}=a;return A.useEffect(()=>(h(),()=>g()),[h,g]),m.jsx(Xw,{...u,...i,ref:t})});lde.displayName=u$;var d$="PopoverTrigger",h$=A.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=sd(d$,r),u=fx(r),h=Cr(t,a.triggerRef),g=m.jsx(sr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":y$(a.open),...i,ref:h,onClick:kt(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?g:m.jsx(Xw,{asChild:!0,...u,children:g})});h$.displayName=d$;var _A="PopoverPortal",[cde,ude]=l$(_A,{forceMount:void 0}),f$=e=>{const{__scopePopover:t,forceMount:r,children:i,container:a}=e,u=sd(_A,t);return m.jsx(cde,{scope:t,forceMount:r,children:m.jsx(ji,{present:r||u.open,children:m.jsx(Wv,{asChild:!0,container:a,children:i})})})};f$.displayName=_A;var Qp="PopoverContent",p$=A.forwardRef((e,t)=>{const r=ude(Qp,e.__scopePopover),{forceMount:i=r.forceMount,...a}=e,u=sd(Qp,e.__scopePopover);return m.jsx(ji,{present:i||u.open,children:u.modal?m.jsx(dde,{...a,ref:t}):m.jsx(hde,{...a,ref:t})})});p$.displayName=Qp;var dde=A.forwardRef((e,t)=>{const r=sd(Qp,e.__scopePopover),i=A.useRef(null),a=Cr(t,i),u=A.useRef(!1);return A.useEffect(()=>{const h=i.current;if(h)return Gw(h)},[]),m.jsx(Gv,{as:Tl,allowPinchZoom:!0,children:m.jsx(m$,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(e.onCloseAutoFocus,h=>{var g;h.preventDefault(),u.current||(g=r.triggerRef.current)==null||g.focus()}),onPointerDownOutside:kt(e.onPointerDownOutside,h=>{const g=h.detail.originalEvent,s=g.button===0&&g.ctrlKey===!0,_=g.button===2||s;u.current=_},{checkForDefaultPrevented:!1}),onFocusOutside:kt(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),hde=A.forwardRef((e,t)=>{const r=sd(Qp,e.__scopePopover),i=A.useRef(!1),a=A.useRef(!1);return m.jsx(m$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var h,g;(h=e.onCloseAutoFocus)==null||h.call(e,u),u.defaultPrevented||(i.current||(g=r.triggerRef.current)==null||g.focus(),u.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:u=>{var s,_;(s=e.onInteractOutside)==null||s.call(e,u),u.defaultPrevented||(i.current=!0,u.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=u.target;((_=r.triggerRef.current)==null?void 0:_.contains(h))&&u.preventDefault(),u.detail.originalEvent.type==="focusin"&&a.current&&u.preventDefault()}})}),m$=A.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:u,disableOutsidePointerEvents:h,onEscapeKeyDown:g,onPointerDownOutside:s,onFocusOutside:_,onInteractOutside:b,...C}=e,M=sd(Qp,r),D=fx(r);return $w(),m.jsx($v,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:u,children:m.jsx(lm,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:b,onEscapeKeyDown:g,onPointerDownOutside:s,onFocusOutside:_,onDismiss:()=>M.onOpenChange(!1),children:m.jsx(iP,{"data-state":y$(M.open),role:"dialog",id:M.contentId,...D,...C,ref:t,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),g$="PopoverClose",fde=A.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=sd(g$,r);return m.jsx(sr.button,{type:"button",...i,ref:t,onClick:kt(e.onClick,()=>a.onOpenChange(!1))})});fde.displayName=g$;var pde="PopoverArrow",mde=A.forwardRef((e,t)=>{const{__scopePopover:r,...i}=e,a=fx(r);return m.jsx(sP,{...a,...i,ref:t})});mde.displayName=pde;function y$(e){return e?"open":"closed"}var gde=c$,yde=h$,vde=f$,v$=p$;const pw=gde,mw=yde,Iv=A.forwardRef(({className:e,align:t="center",sideOffset:r=4,...i},a)=>m.jsx(vde,{children:m.jsx(v$,{ref:a,align:t,sideOffset:r,className:It("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i})}));Iv.displayName=v$.displayName;function sL({value:e="",onChange:t,className:r,placeholder:i="Select time",...a}){const[u,h]=A.useState(!1),[g,s]=A.useState(e);lt.useEffect(()=>{s(e)},[e]);const _=Array.from({length:12},(z,U)=>(U+1).toString().padStart(1,"0")),b=["00","15","30","45"],C=["AM","PM"],M=(z,U,Z)=>{const Q=`${z}:${U} ${Z}`;s(Q),t==null||t(Q),h(!1)},D=z=>{const U=z.target.value;s(U),t==null||t(U)},N=()=>{if(!g)return{hour:"12",minute:"00",period:"AM"};const z=g.match(/(\d+):(\d+)\s?(AM|PM)?/i);if(!z)return{hour:"12",minute:"00",period:"AM"};let[U,Z,Q,re]=z;return re||(re="AM"),{hour:Z||"12",minute:Q||"00",period:re.toUpperCase()||"AM"}},{hour:j,minute:V,period:B}=N();return m.jsxs(pw,{open:u,onOpenChange:h,children:[m.jsx(mw,{asChild:!0,children:m.jsxs("div",{className:"relative",children:[m.jsx(ur,{...a,value:g,onChange:D,placeholder:i,className:It("pr-10",r)}),m.jsx(Et,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 text-muted-foreground",onClick:()=>h(!0),children:m.jsx(zk,{className:"h-4 w-4"})})]})}),m.jsx(Iv,{className:"w-64 p-2",children:m.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[m.jsx("div",{className:"col-span-4 mb-2 text-center text-sm font-medium",children:"Hours"}),_.map(z=>m.jsx(Et,{variant:z===j?"default":"outline",size:"sm",onClick:()=>{M(z,V,B)},className:"text-center",children:z},z)),m.jsx("div",{className:"col-span-4 mt-2 mb-2 text-center text-sm font-medium",children:"Minutes"}),b.map(z=>m.jsx(Et,{variant:z===V?"default":"outline",size:"sm",onClick:()=>{M(j,z,B)},className:"text-center",children:z},z)),m.jsx("div",{className:"col-span-4 mt-2 mb-2 text-center text-sm font-medium",children:"AM/PM"}),C.map(z=>m.jsx(Et,{variant:z===B?"default":"outline",size:"sm",onClick:()=>{M(j,V,z)},className:"col-span-2 text-center",children:z},z))]})})]})}function xde({form:e}){const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r=(a,u,h)=>{const g=[...e.getValues().openingHours];g[a]={...g[a],[u]:h},e.setValue("openingHours",g,{shouldDirty:!0})},i=a=>{const u=[...e.getValues().openingHours];u[a]={...u[a],openTime:"",closeTime:""},e.setValue("openingHours",u,{shouldDirty:!0})};return m.jsxs(Wi,{children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Operating Hours"}),m.jsx(Co,{children:"Set your restaurant's operating hours for each day of the week"})]}),m.jsx(xs,{children:m.jsx("div",{className:"space-y-4",children:e.getValues().openingHours.map((a,u)=>{var h,g;return m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b pb-4 mb-4 last:border-0 last:pb-0 last:mb-0",children:[m.jsxs("div",{className:"font-medium flex items-center",children:[m.jsx(zk,{className:"h-4 w-4 mr-2 text-muted-foreground"}),a.day||t[u]]}),m.jsxs("div",{children:[m.jsx(pr,{htmlFor:`open-${a.day||u}`,children:"Opening Time"}),m.jsx(sL,{id:`open-${a.day||u}`,value:((h=e.getValues().openingHours[u])==null?void 0:h.openTime)||"",onChange:s=>r(u,"openTime",s),placeholder:"9:00 AM",className:"w-full"})]}),m.jsxs("div",{className:"flex items-end gap-2",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx(pr,{htmlFor:`close-${a.day||u}`,children:"Closing Time"}),m.jsx(sL,{id:`close-${a.day||u}`,value:((g=e.getValues().openingHours[u])==null?void 0:g.closeTime)||"",onChange:s=>r(u,"closeTime",s),placeholder:"5:00 PM",className:"w-full"})]}),m.jsx(Et,{type:"button",variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full hover:bg-destructive/10",onClick:()=>i(u),title:"Clear hours",children:m.jsx(Ls,{className:"h-4 w-4"})})]})]},a.day||`day-${u}`)})})})]})}const _de=um("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),x$=A.forwardRef(({className:e,variant:t,...r},i)=>m.jsx("div",{ref:i,role:"alert",className:It(_de({variant:t}),e),...r}));x$.displayName="Alert";const _$=A.forwardRef(({className:e,...t},r)=>m.jsx("h5",{ref:r,className:It("mb-1 font-medium leading-none tracking-tight",e),...t}));_$.displayName="AlertTitle";const w$=A.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:It("text-sm [&_p]:leading-relaxed",e),...t}));w$.displayName="AlertDescription";function wde({form:e}){const[t,r]=A.useState(""),[i,a]=A.useState(null);A.useEffect(()=>{const h=e.watch("mapCoordinates");r(h||"-6.9363, 107.6223")},[e.watch("mapCoordinates")]);const u=h=>{a(h)};return m.jsxs(Wi,{children:[m.jsxs(ys,{children:[m.jsxs(vs,{className:"flex items-center",children:[m.jsx(Tz,{className:"h-5 w-5 mr-2 text-primary"}),"Location Information"]}),m.jsx(Co,{children:"Update your restaurant's address and map coordinates to show a 3D terrain view"})]}),m.jsxs(xs,{className:"space-y-6",children:[m.jsx(ro,{control:e.control,name:"address",render:({field:h})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Street Address"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"123 Restaurant Street",...h})}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"mapCoordinates",render:({field:h})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Map Coordinates"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"-6.9363, 107.6223",...h,onChange:g=>{h.onChange(g),r(g.target.value)}})}),m.jsx(lc,{children:`Enter latitude and longitude coordinates in this format: latitude, longitude (e.g., -6.9363, 107.6223). You can find coordinates by right-clicking on a location in Google Maps and selecting "What's here?".`}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"reservationNote",render:({field:h})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Reservation Information"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"Reservations recommended for...",...h})}),m.jsx(no,{})]})}),m.jsxs("div",{className:"mt-6",children:[m.jsx("h3",{className:"text-sm font-medium mb-2",children:"Map Preview"}),i&&m.jsxs(x$,{variant:"destructive",className:"mb-4",children:[m.jsx(_$,{children:"Map Error"}),m.jsx(w$,{children:i})]}),m.jsx("div",{className:"rounded-md overflow-hidden",children:t?m.jsx(d6,{coordinates:t,height:"300px",zoom:14,onError:u}):m.jsx("div",{className:"h-[300px] flex items-center justify-center bg-muted",children:m.jsx("p",{className:"text-muted-foreground",children:"Enter coordinates above to preview map"})})}),m.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"This is how your map will appear on the website. Use the controls to toggle between 2D/3D and different map styles."})]})]})]})}function bde({form:e}){return m.jsxs(Wi,{children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Footer Settings"}),m.jsx(Co,{children:"Customize your website's footer information and social links"})]}),m.jsxs(xs,{className:"space-y-6",children:[m.jsx(ro,{control:e.control,name:"footerText",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Footer Copyright Text"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:" 2023 Your Restaurant. All rights reserved.",...t})}),m.jsx(no,{})]})}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Social Media Links"}),m.jsx(ro,{control:e.control,name:"instagramUrl",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Instagram URL"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"https://instagram.com/yourrestaurant",...t})}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"facebookUrl",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Facebook URL"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"https://facebook.com/yourrestaurant",...t})}),m.jsx(no,{})]})}),m.jsx(ro,{control:e.control,name:"twitterUrl",render:({field:t})=>m.jsxs(Ds,{children:[m.jsx(Rs,{children:"Twitter URL"}),m.jsx(Ns,{children:m.jsx(ur,{placeholder:"https://twitter.com/yourrestaurant",...t})}),m.jsx(no,{})]})})]})]})]})}const Sde=r$({day:Vi(),openTime:Vi(),closeTime:Vi()}),Ede=r$({siteName:Vi().min(2,"Site name must be at least 2 characters"),siteTitle:Vi().min(2,"Site title must be at least 2 characters"),logoUrl:Vi().optional(),faviconUrl:Vi().optional(),mission:Vi().min(10,"Mission statement must be at least 10 characters"),vision:Vi().min(10,"Vision statement must be at least 10 characters"),address:Vi().min(5,"Address must be at least 5 characters"),mapCoordinates:Vi().optional(),reservationNote:Vi().optional(),instagramUrl:Vi().url("Please enter a valid URL").optional().or(py("")),facebookUrl:Vi().url("Please enter a valid URL").optional().or(py("")),twitterUrl:Vi().url("Please enter a valid URL").optional().or(py("")),footerText:Vi().optional(),whatsappNumber:Vi().optional().or(py("")),whatsappMessage:Vi().optional().or(py("")),heroSliderMobileVertical:Que(),openingHours:Jue(Sde)});function Tde(){const[e,t]=A.useState(null),[r,i]=A.useState(null),[a,u]=A.useState(null),[h,g]=A.useState(null),[s,_]=A.useState(!1),{toast:b}=Hi(),{settings:C,saveSettings:M,isLoading:D,getDefaultSettings:N}=Oh(),j=Pue({resolver:Nue(Ede),defaultValues:N()});A.useEffect(()=>{if(C){const U={...C,heroSliderMobileVertical:C.heroSliderMobileVertical!==!1};console.log("Resetting form with heroSliderMobileVertical:",U.heroSliderMobileVertical),j.reset(U),C.logoUrl&&i(C.logoUrl),C.faviconUrl&&g(C.faviconUrl)}},[C,j]);const V=U=>{if(U.target.files&&U.target.files[0]){const Z=U.target.files[0];t(Z),i(URL.createObjectURL(Z))}},B=U=>{if(U.target.files&&U.target.files[0]){const Z=U.target.files[0];u(Z),g(URL.createObjectURL(Z))}},z=async U=>{try{if(_(!0),e){const oe=await $p(e);U.logoUrl=oe}if(a){const oe=await $p(a);U.faviconUrl=oe}const Z=U.openingHours.map(oe=>({day:oe.day||"",openTime:oe.openTime||"",closeTime:oe.closeTime||""}));console.log("Submitting with heroSliderMobileVertical:",U.heroSliderMobileVertical);const Q={...U,heroSliderMobileVertical:U.heroSliderMobileVertical,openingHours:Z},re=await M(Q);U.siteTitle&&(document.title=U.siteTitle),b({title:"Settings saved",description:"Your website settings have been updated successfully."})}catch(Z){console.error("Error saving settings:",Z),b({title:"Error saving settings",description:"An error occurred while saving your settings. Please try again.",variant:"destructive"})}finally{_(!1)}};return A.useEffect(()=>{const U=j.watch((Z,{name:Q})=>{Q==="heroSliderMobileVertical"&&console.log("heroSliderMobileVertical changed to:",Z.heroSliderMobileVertical)});return()=>U.unsubscribe()},[j]),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Website Settings"}),m.jsxs(Et,{onClick:j.handleSubmit(z),disabled:s,className:"flex items-center gap-2",children:[m.jsx(Cz,{className:"h-4 w-4"}),s?"Saving...":"Save All Settings"]})]}),m.jsx(Aue,{...j,children:m.jsxs(Mh,{defaultValue:"general",className:"w-full",children:[m.jsxs(qu,{className:"grid grid-cols-5 mb-4",children:[m.jsx(Sn,{value:"general",children:"General"}),m.jsx(Sn,{value:"content",children:"Content"}),m.jsx(Sn,{value:"hours",children:"Hours"}),m.jsx(Sn,{value:"location",children:"Location"}),m.jsx(Sn,{value:"footer",children:"Footer"})]}),m.jsx(ni,{value:"general",children:m.jsx(sde,{form:j,logoPreview:r,faviconPreview:h,handleLogoChange:V,handleFaviconChange:B})}),m.jsx(ni,{value:"content",children:m.jsx(ode,{form:j})}),m.jsx(ni,{value:"hours",children:m.jsx(xde,{form:j})}),m.jsx(ni,{value:"location",children:m.jsx(wde,{form:j})}),m.jsx(ni,{value:"footer",children:m.jsx(bde,{form:j})})]})})]})}const Cde=()=>{const{deleteDish:e,deleteDrink:t,refreshDishes:r,refreshDrinks:i,updateDish:a,updateDrink:u,categories:h}=ca(),{toast:g}=Hi(),[s,_]=A.useState(!1),[b,C]=A.useState(null),[M,D]=A.useState(null),[N,j]=A.useState("dish"),V=oe=>{C(null),j(oe),_(!0)},B=oe=>{C(oe),j(z(oe)),_(!0)},z=oe=>{if(oe.categoryType==="drink")return"drink";const pe=oe.category||"";return h.filter(Ke=>Ke.type==="drink").map(Ke=>Ke.name).some(Ke=>pe===Ke||pe.toLowerCase().includes(Ke.toLowerCase()))?"drink":"dish"};return{isAddDishOpen:s,editDish:b,isDeleting:M,itemType:N,openAddItem:V,openEditItem:B,closeForm:()=>{_(!1),C(null)},handleDeleteItem:async(oe,pe,ve)=>{if(console.log("handleDeleteItem called with:",oe,pe,ve),!oe){console.error("Invalid item ID for deletion"),g({title:"Error",description:"Invalid item ID. Cannot delete.",variant:"destructive"});return}try{D(oe),console.log(`Performing deletion for ${ve} with ID:`,oe),ve==="dish"?(await e(oe),await r()):(await t(oe),await i()),g({title:"Success",description:`${pe} has been deleted successfully.`})}catch(he){console.error(`Error during ${ve} deletion:`,he),g({title:"Error",description:`Failed to delete ${pe}. Please try again.`,variant:"destructive"})}finally{D(null)}},handleToggleFeature:async(oe,pe)=>{try{const ve=!oe.featured;D(oe.id);const he={featured:ve};console.log(`Updating ${pe} ${oe.id} featured status to:`,ve),pe==="dish"?await a(oe.id,he):await u(oe.id,he),g({title:"Success",description:ve?`"${oe.name}" is now featured on the home page.`:`"${oe.name}" has been removed from featured items.`})}catch(ve){console.error("Error updating feature status:",ve),g({title:"Error",description:"Failed to update feature status. Please try again.",variant:"destructive"})}finally{D(null)}},handleToggleTopItem:async(oe,pe)=>{try{const ve=!oe.isTopDish;D(oe.id);const he={isTopDish:ve};console.log(`Updating ${pe} ${oe.id} top status to:`,ve),pe==="dish"?await a(oe.id,he):await u(oe.id,he),g({title:"Success",description:ve?`"${oe.name}" is now a top ${pe}.`:`"${oe.name}" has been removed from top ${pe}s.`})}catch(ve){console.error(`Error updating top ${pe} status:`,ve),g({title:"Error",description:"Failed to update status. Please try again.",variant:"destructive"})}finally{D(null)}}}};var Er=function(){return Er=Object.assign||function(t){for(var r,i=1,a=arguments.length;i<a;i++){r=arguments[i];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},Er.apply(this,arguments)};function Mde(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r}function b$(e,t,r){for(var i=0,a=t.length,u;i<a;i++)(u||!(i in t))&&(u||(u=Array.prototype.slice.call(t,0,i)),u[i]=t[i]);return e.concat(u||Array.prototype.slice.call(t))}function px(e){return e.mode==="multiple"}function mx(e){return e.mode==="range"}function Sb(e){return e.mode==="single"}var kde={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Pde(e,t){return Ro(e,"LLLL y",t)}function Ade(e,t){return Ro(e,"d",t)}function Ide(e,t){return Ro(e,"LLLL",t)}function Dde(e){return"".concat(e)}function Rde(e,t){return Ro(e,"cccccc",t)}function Nde(e,t){return Ro(e,"yyyy",t)}var jde=Object.freeze({__proto__:null,formatCaption:Pde,formatDay:Ade,formatMonthCaption:Ide,formatWeekNumber:Dde,formatWeekdayName:Rde,formatYearCaption:Nde}),Lde=function(e,t,r){return Ro(e,"do MMMM (EEEE)",r)},Ode=function(){return"Month: "},zde=function(){return"Go to next month"},Fde=function(){return"Go to previous month"},Bde=function(e,t){return Ro(e,"cccc",t)},Ude=function(e){return"Week n. ".concat(e)},Vde=function(){return"Year: "},$de=Object.freeze({__proto__:null,labelDay:Lde,labelMonthDropdown:Ode,labelNext:zde,labelPrevious:Fde,labelWeekNumber:Ude,labelWeekday:Bde,labelYearDropdown:Vde});function Wde(){var e="buttons",t=kde,r=NB,i={},a={},u=1,h={},g=new Date;return{captionLayout:e,classNames:t,formatters:jde,labels:$de,locale:r,modifiersClassNames:i,modifiers:a,numberOfMonths:u,styles:h,today:g,mode:"default"}}function Gde(e){var t=e.fromYear,r=e.toYear,i=e.fromMonth,a=e.toMonth,u=e.fromDate,h=e.toDate;return i?u=lo(i):t&&(u=new Date(t,0,1)),a?h=_P(a):r&&(h=new Date(r,11,31)),{fromDate:u?Fp(u):void 0,toDate:h?Fp(h):void 0}}var S$=A.createContext(void 0);function Hde(e){var t,r=e.initialProps,i=Wde(),a=Gde(r),u=a.fromDate,h=a.toDate,g=(t=r.captionLayout)!==null&&t!==void 0?t:i.captionLayout;g!=="buttons"&&(!u||!h)&&(g="buttons");var s;(Sb(r)||px(r)||mx(r))&&(s=r.onSelect);var _=Er(Er(Er({},i),r),{captionLayout:g,classNames:Er(Er({},i.classNames),r.classNames),components:Er({},r.components),formatters:Er(Er({},i.formatters),r.formatters),fromDate:u,labels:Er(Er({},i.labels),r.labels),mode:r.mode||i.mode,modifiers:Er(Er({},i.modifiers),r.modifiers),modifiersClassNames:Er(Er({},i.modifiersClassNames),r.modifiersClassNames),onSelect:s,styles:Er(Er({},i.styles),r.styles),toDate:h});return m.jsx(S$.Provider,{value:_,children:e.children})}function On(){var e=A.useContext(S$);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function E$(e){var t=On(),r=t.locale,i=t.classNames,a=t.styles,u=t.formatters.formatCaption;return m.jsx("div",{className:i.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:u(e.displayMonth,{locale:r})})}function qde(e){return m.jsx("svg",Er({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:m.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function T$(e){var t,r,i=e.onChange,a=e.value,u=e.children,h=e.caption,g=e.className,s=e.style,_=On(),b=(r=(t=_.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:qde;return m.jsxs("div",{className:g,style:s,children:[m.jsx("span",{className:_.classNames.vhidden,children:e["aria-label"]}),m.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:_.classNames.dropdown,style:_.styles.dropdown,value:a,onChange:i,children:u}),m.jsxs("div",{className:_.classNames.caption_label,style:_.styles.caption_label,"aria-hidden":"true",children:[h,m.jsx(b,{className:_.classNames.dropdown_icon,style:_.styles.dropdown_icon})]})]})}function Zde(e){var t,r=On(),i=r.fromDate,a=r.toDate,u=r.styles,h=r.locale,g=r.formatters.formatMonthCaption,s=r.classNames,_=r.components,b=r.labels.labelMonthDropdown;if(!i)return m.jsx(m.Fragment,{});if(!a)return m.jsx(m.Fragment,{});var C=[];if(Ure(i,a))for(var M=lo(i),D=i.getMonth();D<=a.getMonth();D++)C.push(JE(M,D));else for(var M=lo(new Date),D=0;D<=11;D++)C.push(JE(M,D));var N=function(V){var B=Number(V.target.value),z=JE(lo(e.displayMonth),B);e.onChange(z)},j=(t=_==null?void 0:_.Dropdown)!==null&&t!==void 0?t:T$;return m.jsx(j,{name:"months","aria-label":b(),className:s.dropdown_month,style:u.dropdown_month,onChange:N,value:e.displayMonth.getMonth(),caption:g(e.displayMonth,{locale:h}),children:C.map(function(V){return m.jsx("option",{value:V.getMonth(),children:g(V,{locale:h})},V.getMonth())})})}function Xde(e){var t,r=e.displayMonth,i=On(),a=i.fromDate,u=i.toDate,h=i.locale,g=i.styles,s=i.classNames,_=i.components,b=i.formatters.formatYearCaption,C=i.labels.labelYearDropdown,M=[];if(!a)return m.jsx(m.Fragment,{});if(!u)return m.jsx(m.Fragment,{});for(var D=a.getFullYear(),N=u.getFullYear(),j=D;j<=N;j++)M.push(Pj(DB(new Date),j));var V=function(z){var U=Pj(lo(r),Number(z.target.value));e.onChange(U)},B=(t=_==null?void 0:_.Dropdown)!==null&&t!==void 0?t:T$;return m.jsx(B,{name:"years","aria-label":C(),className:s.dropdown_year,style:g.dropdown_year,onChange:V,value:r.getFullYear(),caption:b(r,{locale:h}),children:M.map(function(z){return m.jsx("option",{value:z.getFullYear(),children:b(z,{locale:h})},z.getFullYear())})})}function Yde(e,t){var r=A.useState(e),i=r[0],a=r[1],u=t===void 0?i:t;return[u,a]}function Kde(e){var t=e.month,r=e.defaultMonth,i=e.today,a=t||r||i||new Date,u=e.toDate,h=e.fromDate,g=e.numberOfMonths,s=g===void 0?1:g;if(u&&wv(u,a)<0){var _=-1*(s-1);a=qa(u,_)}return h&&wv(a,h)<0&&(a=h),lo(a)}function Qde(){var e=On(),t=Kde(e),r=Yde(t,e.month),i=r[0],a=r[1],u=function(h){var g;if(!e.disableNavigation){var s=lo(h);a(s),(g=e.onMonthChange)===null||g===void 0||g.call(e,s)}};return[i,u]}function Jde(e,t){for(var r=t.reverseMonths,i=t.numberOfMonths,a=lo(e),u=lo(qa(a,i)),h=wv(u,a),g=[],s=0;s<h;s++){var _=qa(a,s);g.push(_)}return r&&(g=g.reverse()),g}function ehe(e,t){if(!t.disableNavigation){var r=t.toDate,i=t.pagedNavigation,a=t.numberOfMonths,u=a===void 0?1:a,h=i?u:1,g=lo(e);if(!r)return qa(g,h);var s=wv(r,e);if(!(s<u))return qa(g,h)}}function the(e,t){if(!t.disableNavigation){var r=t.fromDate,i=t.pagedNavigation,a=t.numberOfMonths,u=a===void 0?1:a,h=i?u:1,g=lo(e);if(!r)return qa(g,-h);var s=wv(g,r);if(!(s<=0))return qa(g,-h)}}var C$=A.createContext(void 0);function rhe(e){var t=On(),r=Qde(),i=r[0],a=r[1],u=Jde(i,t),h=ehe(i,t),g=the(i,t),s=function(C){return u.some(function(M){return bP(C,M)})},_=function(C,M){s(C)||(M&&FB(C,M)?a(qa(C,1+t.numberOfMonths*-1)):a(C))},b={currentMonth:i,displayMonths:u,goToMonth:a,goToDate:_,previousMonth:g,nextMonth:h,isDateDisplayed:s};return m.jsx(C$.Provider,{value:b,children:e.children})}function gx(){var e=A.useContext(C$);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function oL(e){var t,r=On(),i=r.classNames,a=r.styles,u=r.components,h=gx().goToMonth,g=function(b){h(qa(b,e.displayIndex?-e.displayIndex:0))},s=(t=u==null?void 0:u.CaptionLabel)!==null&&t!==void 0?t:E$,_=m.jsx(s,{id:e.id,displayMonth:e.displayMonth});return m.jsxs("div",{className:i.caption_dropdowns,style:a.caption_dropdowns,children:[m.jsx("div",{className:i.vhidden,children:_}),m.jsx(Zde,{onChange:g,displayMonth:e.displayMonth}),m.jsx(Xde,{onChange:g,displayMonth:e.displayMonth})]})}function nhe(e){return m.jsx("svg",Er({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:m.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function ihe(e){return m.jsx("svg",Er({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:m.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var gw=A.forwardRef(function(e,t){var r=On(),i=r.classNames,a=r.styles,u=[i.button_reset,i.button];e.className&&u.push(e.className);var h=u.join(" "),g=Er(Er({},a.button_reset),a.button);return e.style&&Object.assign(g,e.style),m.jsx("button",Er({},e,{ref:t,type:"button",className:h,style:g}))});function she(e){var t,r,i=On(),a=i.dir,u=i.locale,h=i.classNames,g=i.styles,s=i.labels,_=s.labelPrevious,b=s.labelNext,C=i.components;if(!e.nextMonth&&!e.previousMonth)return m.jsx(m.Fragment,{});var M=_(e.previousMonth,{locale:u}),D=[h.nav_button,h.nav_button_previous].join(" "),N=b(e.nextMonth,{locale:u}),j=[h.nav_button,h.nav_button_next].join(" "),V=(t=C==null?void 0:C.IconRight)!==null&&t!==void 0?t:ihe,B=(r=C==null?void 0:C.IconLeft)!==null&&r!==void 0?r:nhe;return m.jsxs("div",{className:h.nav,style:g.nav,children:[!e.hidePrevious&&m.jsx(gw,{name:"previous-month","aria-label":M,className:D,style:g.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?m.jsx(V,{className:h.nav_icon,style:g.nav_icon}):m.jsx(B,{className:h.nav_icon,style:g.nav_icon})}),!e.hideNext&&m.jsx(gw,{name:"next-month","aria-label":N,className:j,style:g.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?m.jsx(B,{className:h.nav_icon,style:g.nav_icon}):m.jsx(V,{className:h.nav_icon,style:g.nav_icon})})]})}function aL(e){var t=On().numberOfMonths,r=gx(),i=r.previousMonth,a=r.nextMonth,u=r.goToMonth,h=r.displayMonths,g=h.findIndex(function(N){return bP(e.displayMonth,N)}),s=g===0,_=g===h.length-1,b=t>1&&(s||!_),C=t>1&&(_||!s),M=function(){i&&u(i)},D=function(){a&&u(a)};return m.jsx(she,{displayMonth:e.displayMonth,hideNext:b,hidePrevious:C,nextMonth:a,previousMonth:i,onPreviousClick:M,onNextClick:D})}function ohe(e){var t,r=On(),i=r.classNames,a=r.disableNavigation,u=r.styles,h=r.captionLayout,g=r.components,s=(t=g==null?void 0:g.CaptionLabel)!==null&&t!==void 0?t:E$,_;return a?_=m.jsx(s,{id:e.id,displayMonth:e.displayMonth}):h==="dropdown"?_=m.jsx(oL,{displayMonth:e.displayMonth,id:e.id}):h==="dropdown-buttons"?_=m.jsxs(m.Fragment,{children:[m.jsx(oL,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),m.jsx(aL,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):_=m.jsxs(m.Fragment,{children:[m.jsx(s,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),m.jsx(aL,{displayMonth:e.displayMonth,id:e.id})]}),m.jsx("div",{className:i.caption,style:u.caption,children:_})}function ahe(e){var t=On(),r=t.footer,i=t.styles,a=t.classNames.tfoot;return r?m.jsx("tfoot",{className:a,style:i.tfoot,children:m.jsx("tr",{children:m.jsx("td",{colSpan:8,children:r})})}):m.jsx(m.Fragment,{})}function lhe(e,t,r){for(var i=r?Ch(new Date):Ml(new Date,{locale:e,weekStartsOn:t}),a=[],u=0;u<7;u++){var h=Ps(i,u);a.push(h)}return a}function che(){var e=On(),t=e.classNames,r=e.styles,i=e.showWeekNumber,a=e.locale,u=e.weekStartsOn,h=e.ISOWeek,g=e.formatters.formatWeekdayName,s=e.labels.labelWeekday,_=lhe(a,u,h);return m.jsxs("tr",{style:r.head_row,className:t.head_row,children:[i&&m.jsx("td",{style:r.head_cell,className:t.head_cell}),_.map(function(b,C){return m.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":s(b,{locale:a}),children:g(b,{locale:a})},C)})]})}function uhe(){var e,t=On(),r=t.classNames,i=t.styles,a=t.components,u=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:che;return m.jsx("thead",{style:i.head,className:r.head,children:m.jsx(u,{})})}function dhe(e){var t=On(),r=t.locale,i=t.formatters.formatDay;return m.jsx(m.Fragment,{children:i(e.date,{locale:r})})}var wA=A.createContext(void 0);function hhe(e){if(!px(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return m.jsx(wA.Provider,{value:t,children:e.children})}return m.jsx(fhe,{initialProps:e.initialProps,children:e.children})}function fhe(e){var t=e.initialProps,r=e.children,i=t.selected,a=t.min,u=t.max,h=function(_,b,C){var M,D;(M=t.onDayClick)===null||M===void 0||M.call(t,_,b,C);var N=!!(b.selected&&a&&(i==null?void 0:i.length)===a);if(!N){var j=!!(!b.selected&&u&&(i==null?void 0:i.length)===u);if(!j){var V=i?b$([],i):[];if(b.selected){var B=V.findIndex(function(z){return to(_,z)});V.splice(B,1)}else V.push(_);(D=t.onSelect)===null||D===void 0||D.call(t,V,_,b,C)}}},g={disabled:[]};i&&g.disabled.push(function(_){var b=u&&i.length>u-1,C=i.some(function(M){return to(M,_)});return!!(b&&!C)});var s={selected:i,onDayClick:h,modifiers:g};return m.jsx(wA.Provider,{value:s,children:r})}function bA(){var e=A.useContext(wA);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function phe(e,t){var r=t||{},i=r.from,a=r.to;return i&&a?to(a,e)&&to(i,e)?void 0:to(a,e)?{from:a,to:void 0}:to(i,e)?void 0:HC(i,e)?{from:e,to:a}:{from:i,to:e}:a?HC(e,a)?{from:a,to:e}:{from:e,to:a}:i?FB(e,i)?{from:e,to:i}:{from:i,to:e}:{from:e,to:void 0}}var SA=A.createContext(void 0);function mhe(e){if(!mx(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return m.jsx(SA.Provider,{value:t,children:e.children})}return m.jsx(ghe,{initialProps:e.initialProps,children:e.children})}function ghe(e){var t=e.initialProps,r=e.children,i=t.selected,a=i||{},u=a.from,h=a.to,g=t.min,s=t.max,_=function(D,N,j){var V,B;(V=t.onDayClick)===null||V===void 0||V.call(t,D,N,j);var z=phe(D,i);(B=t.onSelect)===null||B===void 0||B.call(t,z,D,N,j)},b={range_start:[],range_end:[],range_middle:[],disabled:[]};if(u?(b.range_start=[u],h?(b.range_end=[h],to(u,h)||(b.range_middle=[{after:u,before:h}])):b.range_end=[u]):h&&(b.range_start=[h],b.range_end=[h]),g&&(u&&!h&&b.disabled.push({after:KE(u,g-1),before:Ps(u,g-1)}),u&&h&&b.disabled.push({after:u,before:Ps(u,g-1)}),!u&&h&&b.disabled.push({after:KE(h,g-1),before:Ps(h,g-1)})),s){if(u&&!h&&(b.disabled.push({before:Ps(u,-s+1)}),b.disabled.push({after:Ps(u,s-1)})),u&&h){var C=vl(h,u)+1,M=s-C;b.disabled.push({before:KE(u,M)}),b.disabled.push({after:Ps(h,M)})}!u&&h&&(b.disabled.push({before:Ps(h,-s+1)}),b.disabled.push({after:Ps(h,s-1)}))}return m.jsx(SA.Provider,{value:{selected:i,onDayClick:_,modifiers:b},children:r})}function EA(){var e=A.useContext(SA);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function X0(e){return Array.isArray(e)?b$([],e):e!==void 0?[e]:[]}function yhe(e){var t={};return Object.entries(e).forEach(function(r){var i=r[0],a=r[1];t[i]=X0(a)}),t}var Za;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Za||(Za={}));var vhe=Za.Selected,Ql=Za.Disabled,xhe=Za.Hidden,_he=Za.Today,wT=Za.RangeEnd,bT=Za.RangeMiddle,ST=Za.RangeStart,whe=Za.Outside;function bhe(e,t,r){var i,a=(i={},i[vhe]=X0(e.selected),i[Ql]=X0(e.disabled),i[xhe]=X0(e.hidden),i[_he]=[e.today],i[wT]=[],i[bT]=[],i[ST]=[],i[whe]=[],i);return e.fromDate&&a[Ql].push({before:e.fromDate}),e.toDate&&a[Ql].push({after:e.toDate}),px(e)?a[Ql]=a[Ql].concat(t.modifiers[Ql]):mx(e)&&(a[Ql]=a[Ql].concat(r.modifiers[Ql]),a[ST]=r.modifiers[ST],a[bT]=r.modifiers[bT],a[wT]=r.modifiers[wT]),a}var M$=A.createContext(void 0);function She(e){var t=On(),r=bA(),i=EA(),a=bhe(t,r,i),u=yhe(t.modifiers),h=Er(Er({},a),u);return m.jsx(M$.Provider,{value:h,children:e.children})}function k$(){var e=A.useContext(M$);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Ehe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function The(e){return!!(e&&typeof e=="object"&&"from"in e)}function Che(e){return!!(e&&typeof e=="object"&&"after"in e)}function Mhe(e){return!!(e&&typeof e=="object"&&"before"in e)}function khe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Phe(e,t){var r,i=t.from,a=t.to;if(i&&a){var u=vl(a,i)<0;u&&(r=[a,i],i=r[0],a=r[1]);var h=vl(e,i)>=0&&vl(a,e)>=0;return h}return a?to(a,e):i?to(i,e):!1}function Ahe(e){return xP(e)}function Ihe(e){return Array.isArray(e)&&e.every(xP)}function Dhe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Ahe(r))return to(e,r);if(Ihe(r))return r.includes(e);if(The(r))return Phe(e,r);if(khe(r))return r.dayOfWeek.includes(e.getDay());if(Ehe(r)){var i=vl(r.before,e),a=vl(r.after,e),u=i>0,h=a<0,g=HC(r.before,r.after);return g?h&&u:u||h}return Che(r)?vl(e,r.after)>0:Mhe(r)?vl(r.before,e)>0:typeof r=="function"?r(e):!1})}function TA(e,t,r){var i=Object.keys(t).reduce(function(u,h){var g=t[h];return Dhe(e,g)&&u.push(h),u},[]),a={};return i.forEach(function(u){return a[u]=!0}),r&&!bP(e,r)&&(a.outside=!0),a}function Rhe(e,t){for(var r=lo(e[0]),i=_P(e[e.length-1]),a,u,h=r;h<=i;){var g=TA(h,t),s=!g.disabled&&!g.hidden;if(!s){h=Ps(h,1);continue}if(g.selected)return h;g.today&&!u&&(u=h),a||(a=h),h=Ps(h,1)}return u||a}var Nhe=365;function P$(e,t){var r=t.moveBy,i=t.direction,a=t.context,u=t.modifiers,h=t.retry,g=h===void 0?{count:0,lastFocused:e}:h,s=a.weekStartsOn,_=a.fromDate,b=a.toDate,C=a.locale,M={day:Ps,week:GC,month:qa,year:zte,startOfWeek:function(V){return a.ISOWeek?Ch(V):Ml(V,{locale:C,weekStartsOn:s})},endOfWeek:function(V){return a.ISOWeek?RB(V):wP(V,{locale:C,weekStartsOn:s})}},D=M[r](e,i==="after"?1:-1);i==="before"&&_?D=Fte([_,D]):i==="after"&&b&&(D=Bte([b,D]));var N=!0;if(u){var j=TA(D,u);N=!j.disabled&&!j.hidden}return N?D:g.count>Nhe?g.lastFocused:P$(D,{moveBy:r,direction:i,context:a,modifiers:u,retry:Er(Er({},g),{count:g.count+1})})}var A$=A.createContext(void 0);function jhe(e){var t=gx(),r=k$(),i=A.useState(),a=i[0],u=i[1],h=A.useState(),g=h[0],s=h[1],_=Rhe(t.displayMonths,r),b=a??(g&&t.isDateDisplayed(g))?g:_,C=function(){s(a),u(void 0)},M=function(V){u(V)},D=On(),N=function(V,B){if(a){var z=P$(a,{moveBy:V,direction:B,context:D,modifiers:r});to(a,z)||(t.goToDate(z,a),M(z))}},j={focusedDay:a,focusTarget:b,blur:C,focus:M,focusDayAfter:function(){return N("day","after")},focusDayBefore:function(){return N("day","before")},focusWeekAfter:function(){return N("week","after")},focusWeekBefore:function(){return N("week","before")},focusMonthBefore:function(){return N("month","before")},focusMonthAfter:function(){return N("month","after")},focusYearBefore:function(){return N("year","before")},focusYearAfter:function(){return N("year","after")},focusStartOfWeek:function(){return N("startOfWeek","before")},focusEndOfWeek:function(){return N("endOfWeek","after")}};return m.jsx(A$.Provider,{value:j,children:e.children})}function CA(){var e=A.useContext(A$);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Lhe(e,t){var r=k$(),i=TA(e,r,t);return i}var MA=A.createContext(void 0);function Ohe(e){if(!Sb(e.initialProps)){var t={selected:void 0};return m.jsx(MA.Provider,{value:t,children:e.children})}return m.jsx(zhe,{initialProps:e.initialProps,children:e.children})}function zhe(e){var t=e.initialProps,r=e.children,i=function(u,h,g){var s,_,b;if((s=t.onDayClick)===null||s===void 0||s.call(t,u,h,g),h.selected&&!t.required){(_=t.onSelect)===null||_===void 0||_.call(t,void 0,u,h,g);return}(b=t.onSelect)===null||b===void 0||b.call(t,u,u,h,g)},a={selected:t.selected,onDayClick:i};return m.jsx(MA.Provider,{value:a,children:r})}function I$(){var e=A.useContext(MA);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Fhe(e,t){var r=On(),i=I$(),a=bA(),u=EA(),h=CA(),g=h.focusDayAfter,s=h.focusDayBefore,_=h.focusWeekAfter,b=h.focusWeekBefore,C=h.blur,M=h.focus,D=h.focusMonthBefore,N=h.focusMonthAfter,j=h.focusYearBefore,V=h.focusYearAfter,B=h.focusStartOfWeek,z=h.focusEndOfWeek,U=function(Je){var Te,Re,Tt,Ge;Sb(r)?(Te=i.onDayClick)===null||Te===void 0||Te.call(i,e,t,Je):px(r)?(Re=a.onDayClick)===null||Re===void 0||Re.call(a,e,t,Je):mx(r)?(Tt=u.onDayClick)===null||Tt===void 0||Tt.call(u,e,t,Je):(Ge=r.onDayClick)===null||Ge===void 0||Ge.call(r,e,t,Je)},Z=function(Je){var Te;M(e),(Te=r.onDayFocus)===null||Te===void 0||Te.call(r,e,t,Je)},Q=function(Je){var Te;C(),(Te=r.onDayBlur)===null||Te===void 0||Te.call(r,e,t,Je)},re=function(Je){var Te;(Te=r.onDayMouseEnter)===null||Te===void 0||Te.call(r,e,t,Je)},oe=function(Je){var Te;(Te=r.onDayMouseLeave)===null||Te===void 0||Te.call(r,e,t,Je)},pe=function(Je){var Te;(Te=r.onDayPointerEnter)===null||Te===void 0||Te.call(r,e,t,Je)},ve=function(Je){var Te;(Te=r.onDayPointerLeave)===null||Te===void 0||Te.call(r,e,t,Je)},he=function(Je){var Te;(Te=r.onDayTouchCancel)===null||Te===void 0||Te.call(r,e,t,Je)},Ke=function(Je){var Te;(Te=r.onDayTouchEnd)===null||Te===void 0||Te.call(r,e,t,Je)},qe=function(Je){var Te;(Te=r.onDayTouchMove)===null||Te===void 0||Te.call(r,e,t,Je)},Ie=function(Je){var Te;(Te=r.onDayTouchStart)===null||Te===void 0||Te.call(r,e,t,Je)},rt=function(Je){var Te;(Te=r.onDayKeyUp)===null||Te===void 0||Te.call(r,e,t,Je)},Pt=function(Je){var Te;switch(Je.key){case"ArrowLeft":Je.preventDefault(),Je.stopPropagation(),r.dir==="rtl"?g():s();break;case"ArrowRight":Je.preventDefault(),Je.stopPropagation(),r.dir==="rtl"?s():g();break;case"ArrowDown":Je.preventDefault(),Je.stopPropagation(),_();break;case"ArrowUp":Je.preventDefault(),Je.stopPropagation(),b();break;case"PageUp":Je.preventDefault(),Je.stopPropagation(),Je.shiftKey?j():D();break;case"PageDown":Je.preventDefault(),Je.stopPropagation(),Je.shiftKey?V():N();break;case"Home":Je.preventDefault(),Je.stopPropagation(),B();break;case"End":Je.preventDefault(),Je.stopPropagation(),z();break}(Te=r.onDayKeyDown)===null||Te===void 0||Te.call(r,e,t,Je)},it={onClick:U,onFocus:Z,onBlur:Q,onKeyDown:Pt,onKeyUp:rt,onMouseEnter:re,onMouseLeave:oe,onPointerEnter:pe,onPointerLeave:ve,onTouchCancel:he,onTouchEnd:Ke,onTouchMove:qe,onTouchStart:Ie};return it}function Bhe(){var e=On(),t=I$(),r=bA(),i=EA(),a=Sb(e)?t.selected:px(e)?r.selected:mx(e)?i.selected:void 0;return a}function Uhe(e){return Object.values(Za).includes(e)}function Vhe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(i){var a=e.modifiersClassNames[i];if(a)r.push(a);else if(Uhe(i)){var u=e.classNames["day_".concat(i)];u&&r.push(u)}}),r}function $he(e,t){var r=Er({},e.styles.day);return Object.keys(t).forEach(function(i){var a;r=Er(Er({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[i])}),r}function Whe(e,t,r){var i,a,u,h=On(),g=CA(),s=Lhe(e,t),_=Fhe(e,s),b=Bhe(),C=!!(h.onDayClick||h.mode!=="default");A.useEffect(function(){var re;s.outside||g.focusedDay&&C&&to(g.focusedDay,e)&&((re=r.current)===null||re===void 0||re.focus())},[g.focusedDay,e,r,C,s.outside]);var M=Vhe(h,s).join(" "),D=$he(h,s),N=!!(s.outside&&!h.showOutsideDays||s.hidden),j=(u=(a=h.components)===null||a===void 0?void 0:a.DayContent)!==null&&u!==void 0?u:dhe,V=m.jsx(j,{date:e,displayMonth:t,activeModifiers:s}),B={style:D,className:M,children:V,role:"gridcell"},z=g.focusTarget&&to(g.focusTarget,e)&&!s.outside,U=g.focusedDay&&to(g.focusedDay,e),Z=Er(Er(Er({},B),(i={disabled:s.disabled,role:"gridcell"},i["aria-selected"]=s.selected,i.tabIndex=U||z?0:-1,i)),_),Q={isButton:C,isHidden:N,activeModifiers:s,selectedDays:b,buttonProps:Z,divProps:B};return Q}function Ghe(e){var t=A.useRef(null),r=Whe(e.date,e.displayMonth,t);return r.isHidden?m.jsx("div",{role:"gridcell"}):r.isButton?m.jsx(gw,Er({name:"day",ref:t},r.buttonProps)):m.jsx("div",Er({},r.divProps))}function Hhe(e){var t=e.number,r=e.dates,i=On(),a=i.onWeekNumberClick,u=i.styles,h=i.classNames,g=i.locale,s=i.labels.labelWeekNumber,_=i.formatters.formatWeekNumber,b=_(Number(t),{locale:g});if(!a)return m.jsx("span",{className:h.weeknumber,style:u.weeknumber,children:b});var C=s(Number(t),{locale:g}),M=function(D){a(t,r,D)};return m.jsx(gw,{name:"week-number","aria-label":C,className:h.weeknumber,style:u.weeknumber,onClick:M,children:b})}function qhe(e){var t,r,i=On(),a=i.styles,u=i.classNames,h=i.showWeekNumber,g=i.components,s=(t=g==null?void 0:g.Day)!==null&&t!==void 0?t:Ghe,_=(r=g==null?void 0:g.WeekNumber)!==null&&r!==void 0?r:Hhe,b;return h&&(b=m.jsx("td",{className:u.cell,style:a.cell,children:m.jsx(_,{number:e.weekNumber,dates:e.dates})})),m.jsxs("tr",{className:u.row,style:a.row,children:[b,e.dates.map(function(C){return m.jsx("td",{className:u.cell,style:a.cell,role:"presentation",children:m.jsx(s,{displayMonth:e.displayMonth,date:C})},zre(C))})]})}function lL(e,t,r){for(var i=r!=null&&r.ISOWeek?RB(t):wP(t,r),a=r!=null&&r.ISOWeek?Ch(e):Ml(e,r),u=vl(i,a),h=[],g=0;g<=u;g++)h.push(Ps(a,g));var s=h.reduce(function(_,b){var C=r!=null&&r.ISOWeek?jB(b):OB(b,r),M=_.find(function(D){return D.weekNumber===C});return M?(M.dates.push(b),_):(_.push({weekNumber:C,dates:[b]}),_)},[]);return s}function Zhe(e,t){var r=lL(lo(e),_P(e),t);if(t!=null&&t.useFixedWeeks){var i=Bre(e,t);if(i<6){var a=r[r.length-1],u=a.dates[a.dates.length-1],h=GC(u,6-i),g=lL(GC(u,1),h,t);r.push.apply(r,g)}}return r}function Xhe(e){var t,r,i,a=On(),u=a.locale,h=a.classNames,g=a.styles,s=a.hideHead,_=a.fixedWeeks,b=a.components,C=a.weekStartsOn,M=a.firstWeekContainsDate,D=a.ISOWeek,N=Zhe(e.displayMonth,{useFixedWeeks:!!_,ISOWeek:D,locale:u,weekStartsOn:C,firstWeekContainsDate:M}),j=(t=b==null?void 0:b.Head)!==null&&t!==void 0?t:uhe,V=(r=b==null?void 0:b.Row)!==null&&r!==void 0?r:qhe,B=(i=b==null?void 0:b.Footer)!==null&&i!==void 0?i:ahe;return m.jsxs("table",{id:e.id,className:h.table,style:g.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!s&&m.jsx(j,{}),m.jsx("tbody",{className:h.tbody,style:g.tbody,children:N.map(function(z){return m.jsx(V,{displayMonth:e.displayMonth,dates:z.dates,weekNumber:z.weekNumber},z.weekNumber)})}),m.jsx(B,{displayMonth:e.displayMonth})]})}function Yhe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Khe=Yhe()?A.useLayoutEffect:A.useEffect,ET=!1,Qhe=0;function cL(){return"react-day-picker-".concat(++Qhe)}function Jhe(e){var t,r=e??(ET?cL():null),i=A.useState(r),a=i[0],u=i[1];return Khe(function(){a===null&&u(cL())},[]),A.useEffect(function(){ET===!1&&(ET=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function efe(e){var t,r,i=On(),a=i.dir,u=i.classNames,h=i.styles,g=i.components,s=gx().displayMonths,_=Jhe(i.id?"".concat(i.id,"-").concat(e.displayIndex):void 0),b=i.id?"".concat(i.id,"-grid-").concat(e.displayIndex):void 0,C=[u.month],M=h.month,D=e.displayIndex===0,N=e.displayIndex===s.length-1,j=!D&&!N;a==="rtl"&&(t=[D,N],N=t[0],D=t[1]),D&&(C.push(u.caption_start),M=Er(Er({},M),h.caption_start)),N&&(C.push(u.caption_end),M=Er(Er({},M),h.caption_end)),j&&(C.push(u.caption_between),M=Er(Er({},M),h.caption_between));var V=(r=g==null?void 0:g.Caption)!==null&&r!==void 0?r:ohe;return m.jsxs("div",{className:C.join(" "),style:M,children:[m.jsx(V,{id:_,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),m.jsx(Xhe,{id:b,"aria-labelledby":_,displayMonth:e.displayMonth})]},e.displayIndex)}function tfe(e){var t=On(),r=t.classNames,i=t.styles;return m.jsx("div",{className:r.months,style:i.months,children:e.children})}function rfe(e){var t,r,i=e.initialProps,a=On(),u=CA(),h=gx(),g=A.useState(!1),s=g[0],_=g[1];A.useEffect(function(){a.initialFocus&&u.focusTarget&&(s||(u.focus(u.focusTarget),_(!0)))},[a.initialFocus,s,u.focus,u.focusTarget,u]);var b=[a.classNames.root,a.className];a.numberOfMonths>1&&b.push(a.classNames.multiple_months),a.showWeekNumber&&b.push(a.classNames.with_weeknumber);var C=Er(Er({},a.styles.root),a.style),M=Object.keys(i).filter(function(N){return N.startsWith("data-")}).reduce(function(N,j){var V;return Er(Er({},N),(V={},V[j]=i[j],V))},{}),D=(r=(t=i.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:tfe;return m.jsx("div",Er({className:b.join(" "),style:C,dir:a.dir,id:a.id,nonce:i.nonce,title:i.title,lang:i.lang},M,{children:m.jsx(D,{children:h.displayMonths.map(function(N,j){return m.jsx(efe,{displayIndex:j,displayMonth:N},j)})})}))}function nfe(e){var t=e.children,r=Mde(e,["children"]);return m.jsx(Hde,{initialProps:r,children:m.jsx(rhe,{children:m.jsx(Ohe,{initialProps:r,children:m.jsx(hhe,{initialProps:r,children:m.jsx(mhe,{initialProps:r,children:m.jsx(She,{children:m.jsx(jhe,{children:t})})})})})})})}function ife(e){return m.jsx(nfe,Er({},e,{children:m.jsx(rfe,{initialProps:e})}))}function yw({className:e,classNames:t,showOutsideDays:r=!0,...i}){return m.jsx(ife,{showOutsideDays:r,className:It("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:It(pv({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:It(pv({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>m.jsx(am,{className:"h-4 w-4"}),IconRight:({...a})=>m.jsx(Fu,{className:"h-4 w-4"})},...i})}yw.displayName="Calendar";const sfe=({onClose:e,editDish:t,itemType:r="dish"})=>{const{addDish:i,updateDish:a,dishCategories:u,drinkCategories:h,refreshDishes:g,addDrink:s,updateDrink:_,refreshDrinks:b}=ca(),C={name:"",description:"",price:0,promoPrice:void 0,promoEndDate:void 0,category:"",categoryType:r,ingredients:[],images:[],videoUrl:"",featured:!1,isTopDish:!1},[M,D]=A.useState(C),[N,j]=A.useState(""),[V,B]=A.useState([]),[z,U]=A.useState([]),[Z,Q]=A.useState(!1),[re,oe]=A.useState({}),[pe,ve]=A.useState(!1),he=r==="dish"?u:h;A.useEffect(()=>{t||D({...C,categoryType:r})},[r]),A.useEffect(()=>{if(t!=null&&t.id){const ct=t.categoryType||r;let dt=t.promoEndDate;if(typeof dt=="string"&&dt)try{const tr=Vre(dt);IB(tr)&&(dt=tr)}catch(tr){console.error("Invalid date format:",tr),dt=void 0}D({name:t.name||"",description:t.description||"",price:t.price||0,promoPrice:t.promoPrice,promoEndDate:dt,category:t.category||"",categoryType:ct,ingredients:t.ingredients||[],images:t.images||[],videoUrl:t.videoUrl||"",featured:t.featured||!1,isTopDish:t.isTopDish||!1}),U(t.images||[]),B([])}else D({...C,categoryType:r}),U([]),B([])},[t,r]);const Ke=ct=>{const{name:dt,value:tr}=ct.target;D(dt==="price"||dt==="promoPrice"?Bt=>({...Bt,[dt]:tr===""?void 0:parseFloat(tr)}):Bt=>({...Bt,[dt]:tr})),re[dt]&&oe(Bt=>{const St={...Bt};return delete St[dt],St})},qe=ct=>{D(dt=>({...dt,category:ct})),re.category&&oe(dt=>{const tr={...dt};return delete tr.category,tr})},Ie=ct=>{D(dt=>({...dt,promoEndDate:ct})),ve(!1)},rt=()=>{D(ct=>({...ct,promoEndDate:void 0}))},Pt=()=>{N.trim()&&(D(ct=>({...ct,ingredients:[...ct.ingredients,N.trim()]})),j(""))},it=ct=>{D(dt=>({...dt,ingredients:dt.ingredients.filter((tr,Bt)=>Bt!==ct)}))},Je=ct=>{const dt=ct.target.files;if(!dt||dt.length===0)return;const tr=[...V],Bt=[...z];Array.from(dt).forEach(St=>{tr.push(St);const nr=URL.createObjectURL(St);Bt.push(nr)}),B(tr),U(Bt),re.images&&oe(St=>{const nr={...St};return delete nr.images,nr}),ct.target.value=""},Te=ct=>{const dt=(M.images||[]).length;if(ct<dt){const tr=[...M.images];tr.splice(ct,1),D(Bt=>({...Bt,images:tr})),U(Bt=>{const St=[...Bt];return St.splice(ct,1),St})}else{const tr=ct-dt;URL.revokeObjectURL(z[ct]),B(Bt=>{const St=[...Bt];return St.splice(tr,1),St}),U(Bt=>{const St=[...Bt];return St.splice(ct,1),St})}},Re=ct=>{D(dt=>({...dt,featured:ct}))},Tt=ct=>{D(dt=>({...dt,isTopDish:ct}))},Ge=()=>{const ct={};return M.name.trim()||(ct.name="Name is required"),M.description.trim()||(ct.description="Description is required"),(!M.price||M.price<=0)&&(ct.price="Valid price is required"),M.promoPrice&&M.promoPrice>=M.price&&(ct.promoPrice="Promo price must be less than regular price"),M.promoPrice&&!M.promoEndDate&&(ct.promoEndDate="Please set an end date for the promotion"),M.category||(ct.category="Category is required"),M.images.length===0&&V.length===0&&(ct.images="At least one image is required"),oe(ct),Object.keys(ct).length===0},wt=async ct=>{if(ct.preventDefault(),!!Ge()){Q(!0);try{const dt=[];for(const nr of V)try{const cr=await $p(nr);cr&&dt.push(cr)}catch(cr){console.error("Error uploading image:",cr)}const tr=[...M.images,...dt];let Bt={...M};M.promoEndDate instanceof Date&&(Bt.promoEndDate=M.promoEndDate.toISOString());const St={...Bt,images:tr,categoryType:r};console.log("Saving item with data:",St),r==="drink"?(t!=null&&t.id?await _(t.id,St):await s(St),await b()):(t!=null&&t.id?await a(t.id,St):await i(St),await g()),e()}catch(dt){console.error(`Error saving ${r}:`,dt),oe({submit:`Failed to save ${r}. Please try again.`})}finally{Q(!1)}}};return m.jsxs("div",{className:"bg-background rounded-lg shadow-lg overflow-hidden max-w-3xl mx-auto w-full",children:[m.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[m.jsx("h2",{className:"text-xl font-semibold",children:t!=null&&t.id?`Edit ${r==="drink"?"Drink":"Dish"}`:`Add New ${r==="drink"?"Drink":"Dish"}`}),m.jsx(Et,{variant:"ghost",size:"icon",onClick:e,children:m.jsx(Ls,{className:"h-5 w-5"})})]}),m.jsxs("form",{onSubmit:wt,className:"p-4 space-y-4 max-h-[calc(90vh-6rem)] overflow-y-auto",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"name",children:"Name*"}),m.jsx(ur,{id:"name",name:"name",value:M.name,onChange:Ke,placeholder:`${r==="drink"?"Drink":"Dish"} name`}),re.name&&m.jsx("p",{className:"text-red-500 text-sm",children:re.name})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"description",children:"Description*"}),m.jsx(yh,{id:"description",name:"description",value:M.description,onChange:Ke,placeholder:"Description",rows:3}),re.description&&m.jsx("p",{className:"text-red-500 text-sm",children:re.description})]}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"price",children:"Price (IDR)*"}),m.jsx(ur,{id:"price",name:"price",type:"number",value:M.price||"",onChange:Ke,placeholder:"Regular price",min:0,step:"any",inputMode:"decimal"}),re.price&&m.jsx("p",{className:"text-red-500 text-sm",children:re.price})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"promoPrice",children:"Promo Price (IDR)"}),m.jsx(ur,{id:"promoPrice",name:"promoPrice",type:"number",value:M.promoPrice||"",onChange:Ke,placeholder:"Promo price (optional)",min:0,step:"any",inputMode:"decimal"}),re.promoPrice&&m.jsx("p",{className:"text-red-500 text-sm",children:re.promoPrice})]})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"category",children:"Category*"}),m.jsxs(k8,{value:M.category,onValueChange:qe,children:[m.jsx(uA,{children:m.jsx(P8,{placeholder:`Select ${r} category`})}),m.jsx(dA,{children:he.filter(ct=>ct!=="All").map(ct=>m.jsx(Fy,{value:ct,children:ct},ct))})]}),re.category&&m.jsx("p",{className:"text-red-500 text-sm",children:re.category})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{children:"Ingredients"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(ur,{value:N,onChange:ct=>j(ct.target.value),placeholder:"Add ingredient",className:"flex-1"}),m.jsxs(Et,{type:"button",onClick:Pt,variant:"secondary",children:[m.jsx(El,{className:"h-4 w-4 mr-1"}),"Add"]})]}),M.ingredients.length>0?m.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:M.ingredients.map((ct,dt)=>m.jsxs("div",{className:"bg-secondary px-3 py-1 rounded-full flex items-center text-sm",children:[m.jsx("span",{children:ct}),m.jsx("button",{type:"button",onClick:()=>it(dt),className:"ml-2 text-muted-foreground hover:text-destructive",children:m.jsx(Ls,{className:"h-3 w-3"})})]},dt))}):m.jsx("p",{className:"text-sm text-muted-foreground",children:"No ingredients added yet"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{children:"Images*"}),m.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-4 text-center",children:[m.jsx("input",{type:"file",accept:"image/*",id:"dish-images",multiple:!0,onChange:Je,className:"hidden"}),m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx(Bk,{className:"h-8 w-8 text-muted-foreground mb-2"}),m.jsx("p",{className:"text-sm mb-2",children:"Click to upload images"}),m.jsx(Et,{type:"button",variant:"outline",size:"sm",onClick:()=>{var ct;return(ct=document.getElementById("dish-images"))==null?void 0:ct.click()},children:"Select Files"})]})]}),re.images&&m.jsx("p",{className:"text-red-500 text-sm",children:re.images}),z.length>0&&m.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mt-4",children:z.map((ct,dt)=>m.jsxs("div",{className:"relative aspect-square group",children:[m.jsx("img",{src:ct,alt:`Preview ${dt+1}`,className:"w-full h-full object-cover rounded-md",onError:tr=>{tr.target.src="/placeholder.svg"}}),m.jsx(Et,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity h-8 w-8",onClick:()=>Te(dt),children:m.jsx(Bu,{className:"h-4 w-4"})})]},dt))})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"videoUrl",children:"Video URL (optional)"}),m.jsx(ur,{id:"videoUrl",name:"videoUrl",value:M.videoUrl||"",onChange:Ke,placeholder:"YouTube or video URL"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx(pr,{htmlFor:"promoEndDate",children:"Promo End Date"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(pw,{open:pe,onOpenChange:ve,children:[m.jsx(mw,{asChild:!0,children:m.jsxs(Et,{variant:"outline",className:"flex justify-start items-center w-full text-left font-normal",id:"promoEndDate",children:[m.jsx(dv,{className:"mr-2 h-4 w-4"}),M.promoEndDate instanceof Date?Ro(M.promoEndDate,"PPP"):M.promoEndDate?Ro(new Date(M.promoEndDate),"PPP"):"Select end date for promo"]})}),m.jsx(Iv,{className:"w-auto p-0",children:m.jsx(yw,{mode:"single",selected:M.promoEndDate instanceof Date?M.promoEndDate:M.promoEndDate?new Date(M.promoEndDate):void 0,onSelect:Ie,disabled:ct=>ct<new Date,initialFocus:!0})})]}),M.promoEndDate&&m.jsx(Et,{type:"button",variant:"ghost",size:"icon",onClick:rt,title:"Clear date",children:m.jsx(Ls,{className:"h-4 w-4"})})]}),re.promoEndDate&&m.jsx("p",{className:"text-red-500 text-sm",children:re.promoEndDate}),M.promoPrice&&!M.promoEndDate&&m.jsx("p",{className:"text-amber-500 text-sm",children:"Promotion will be active indefinitely without an end date."})]}),m.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 pt-2",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Av,{id:"featured",checked:M.featured||!1,onCheckedChange:Re}),m.jsxs(pr,{htmlFor:"featured",children:["Featured ",r==="drink"?"Drink":"Dish"]})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Av,{id:"isTopDish",checked:M.isTopDish||!1,onCheckedChange:Tt}),m.jsxs(pr,{htmlFor:"isTopDish",children:["Top ",r==="drink"?"Drink":"Dish"]})]})]}),re.submit&&m.jsx("p",{className:"text-red-500 text-sm mt-2",children:re.submit}),m.jsxs("div",{className:"pt-4 flex gap-3 justify-end",children:[m.jsx(Et,{variant:"outline",type:"button",onClick:e,disabled:Z,children:"Cancel"}),m.jsx(Et,{type:"submit",disabled:Z,children:Z?m.jsxs(m.Fragment,{children:[m.jsx(_s,{className:"mr-2 h-4 w-4 animate-spin"}),t!=null&&t.id?"Updating...":"Creating..."]}):m.jsxs(m.Fragment,{children:[t!=null&&t.id?"Update":"Create"," ",r==="drink"?"Drink":"Dish"]})})]})]})]})},ofe=({isOpen:e,editDish:t,itemType:r,onClose:i})=>e?m.jsx("div",{className:"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm flex items-center justify-center p-2 sm:p-4 overflow-y-auto",children:m.jsx("div",{className:"w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:m.jsx(sfe,{editDish:t||void 0,itemType:r,onClose:i})})}):null,afe=()=>{const e=la(),r=new URLSearchParams(e.search).get("tab")||"dishes",{dishes:i,drinks:a,heroSlides:u,addHeroSlide:h,updateHeroSlide:g,deleteHeroSlide:s,loading:_,refreshDishes:b,refreshDrinks:C,refreshHeroSlides:M,refreshCategories:D}=ca(),{isAddDishOpen:N,editDish:j,isDeleting:V,itemType:B,openAddItem:z,openEditItem:U,closeForm:Z,handleDeleteItem:Q,handleToggleFeature:re,handleToggleTopItem:oe}=Cde();return A.useEffect(()=>{b(),C(),M(),D()},[]),m.jsxs("div",{className:"min-h-screen pt-16 md:pt-20 page-transition-in",children:[m.jsxs("div",{className:"container-custom section-padding",children:[m.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-display font-semibold mb-4 md:mb-6",children:"Admin Dashboard"}),m.jsxs(Jae,{defaultTab:r,children:[m.jsx(ni,{value:"dishes",children:m.jsx(F3,{type:"dish",items:i,loading:_,onAddItem:()=>z("dish"),onEditItem:U,onDeleteItem:Q,onToggleFeature:re,onToggleTopItem:oe,isDeleting:V})}),m.jsx(ni,{value:"drinks",children:m.jsx(F3,{type:"drink",items:a,loading:_,onAddItem:()=>z("drink"),onEditItem:U,onDeleteItem:Q,onToggleFeature:re,onToggleTopItem:oe,isDeleting:V})}),m.jsx(ni,{value:"categories",className:"space-y-4 md:space-y-6",children:m.jsx(lle,{})}),m.jsx(ni,{value:"hero",className:"space-y-6",children:m.jsx(ale,{heroSlides:u,deleteHeroSlide:s,addHeroSlide:h,updateHeroSlide:g,refreshHeroSlides:M})}),m.jsx(ni,{value:"qrcodes",className:"space-y-6",children:m.jsx(yce,{})}),m.jsx(ni,{value:"ads",className:"space-y-6",children:m.jsx(uue,{})}),m.jsx(ni,{value:"settings",className:"space-y-6",children:m.jsx(Tde,{})})]})]}),m.jsx(ofe,{isOpen:N,editDish:j||void 0,itemType:B,onClose:Z})]})},lfe=()=>{const[e,t]=A.useState(""),[r,i]=A.useState(""),[a,u]=A.useState(!1),[h,g]=A.useState(0),[s,_]=A.useState(!1),[b,C]=A.useState(""),[M,D]=A.useState(""),[N,j]=A.useState(!1),[V,B]=A.useState(0),{login:z,isAuthenticated:U}=Qv(),Z=Tc(),Q=()=>{const ve="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789";let he="";const Ke=ve.length;for(let qe=0;qe<6;qe++)he+=ve.charAt(Math.floor(Math.random()*Ke));return C(he),he};A.useEffect(()=>{Q();const ve=localStorage.getItem("loginBlockedUntil");if(ve){const he=parseInt(ve);he>Date.now()?(j(!0),re(he)):localStorage.removeItem("loginBlockedUntil")}},[]),A.useEffect(()=>{let ve;return N&&V>0&&(ve=window.setInterval(()=>{re(parseInt(localStorage.getItem("loginBlockedUntil")||"0")),V<=0&&(j(!1),localStorage.removeItem("loginBlockedUntil"),clearInterval(ve))},1e3)),()=>{ve&&clearInterval(ve)}},[N,V]);const re=ve=>{const he=Math.max(0,Math.floor((ve-Date.now())/1e3));B(he)},oe=()=>{const he=Date.now()+3e4;localStorage.setItem("loginBlockedUntil",he.toString()),j(!0),re(he),g(0)};if(U)return Z("/admin"),null;const pe=async ve=>{if(ve.preventDefault(),N){Dn(`Too many failed attempts. Try again in ${V} seconds.`);return}if(s&&M.toLowerCase()!==b.toLowerCase()){Dn("Incorrect captcha. Please try again."),Q(),D("");return}u(!0);try{if(await z(e,r))Kd("Welcome back!"),Z("/admin"),g(0),_(!1);else{const Ke=h+1;g(Ke),Ke>=3&&(_(!0),Q()),Ke>=5&&oe(),Dn("Invalid email or password")}}catch(he){Dn(he instanceof Error?he.message:"An unexpected error occurred")}finally{u(!1)}};return m.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-background via-background to-background/95 page-transition-in",children:m.jsx(Qi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:m.jsxs(Wi,{className:"w-full backdrop-blur-sm bg-card/90 border-primary/10 shadow-xl",children:[m.jsxs(ys,{className:"space-y-1 pb-4",children:[m.jsx("div",{className:"mx-auto bg-primary/10 p-2 rounded-full w-14 h-14 flex items-center justify-center mb-3",children:m.jsx(DX,{className:"h-7 w-7 text-primary"})}),m.jsx(vs,{className:"text-2xl font-bold text-center",children:"Admin Login"}),m.jsx(Co,{className:"text-center",children:"Enter your credentials to access the admin dashboard"})]}),m.jsxs("form",{onSubmit:pe,children:[m.jsxs(xs,{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"email",children:"Email"}),m.jsxs("div",{className:"relative",children:[m.jsx(ur,{id:"email",type:"email",placeholder:"your@email.com",value:e,onChange:ve=>t(ve.target.value),required:!0,autoComplete:"email",disabled:N,className:"pl-10"}),m.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-mail",children:[m.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),m.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]})})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"flex items-center justify-between",children:m.jsx(pr,{htmlFor:"password",children:"Password"})}),m.jsxs("div",{className:"relative",children:[m.jsx(ur,{id:"password",type:"password",value:r,onChange:ve=>i(ve.target.value),required:!0,autoComplete:"current-password",disabled:N,className:"pl-10"}),m.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-key",children:[m.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),m.jsx("path",{d:"m21 2-9.6 9.6"}),m.jsx("path",{d:"m15.5 7.5 3 3L22 7l-3-3"})]})})]})]}),s&&m.jsxs(Qi.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},className:"space-y-2 pt-2",children:[m.jsxs(pr,{htmlFor:"captcha",className:"flex items-center",children:[m.jsx(VX,{className:"h-4 w-4 mr-2"}),"Security Verification"]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsxs("div",{className:"flex-1 bg-gradient-to-r from-primary/5 to-primary/10 p-3 rounded-md relative overflow-hidden",children:[m.jsx("div",{className:"select-none font-mono tracking-wider text-base relative z-10",style:{color:"#333",textShadow:"1px 1px 1px rgba(0,0,0,0.2)",letterSpacing:"0.1em",fontVariationSettings:'"wght" 800',userSelect:"none"},children:b.split("").map((ve,he)=>m.jsx("span",{style:{display:"inline-block",transform:`rotate(${Math.random()*10-5}deg)`,marginRight:"2px"},children:ve},he))}),m.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 bg-grid opacity-10",style:{backgroundImage:"linear-gradient(45deg, #888 25%, transparent 25%, transparent 75%, #888 75%, #888), linear-gradient(45deg, #888 25%, transparent 25%, transparent 75%, #888 75%, #888)",backgroundSize:"6px 6px",backgroundPosition:"0 0, 3px 3px"}}),Array(5).fill(0).map((ve,he)=>m.jsx("div",{className:"absolute bg-primary/10",style:{height:"2px",width:"100%",top:`${Math.random()*100}%`,left:0,transform:`rotate(${Math.random()*5-2.5}deg)`}},he))]}),m.jsx(Et,{type:"button",variant:"outline",size:"icon",onClick:()=>Q(),disabled:N,className:"hover:text-primary hover:border-primary",children:m.jsx(XN,{className:"h-4 w-4"})})]}),m.jsxs("div",{className:"relative",children:[m.jsx(ur,{id:"captcha",type:"text",placeholder:"Enter the code above",value:M,onChange:ve=>D(ve.target.value),required:!0,autoComplete:"off",spellCheck:"false",disabled:N,className:"pl-10"}),m.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-shield-check",children:[m.jsx("path",{d:"M20 13c0 5-3.5 7.5-8 8.5-4.5-1-8-3.5-8-8.5V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7Z"}),m.jsx("path",{d:"m9 12 2 2 4-4"})]})})]})]}),N&&m.jsxs(Qi.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-destructive/10 text-destructive p-3 rounded-md text-center",children:[m.jsx("p",{className:"font-medium",children:"Too many failed login attempts"}),m.jsxs("p",{className:"text-sm",children:["Please try again in ",V," seconds"]})]})]}),m.jsxs(ju,{className:"flex flex-col space-y-4",children:[m.jsxs(Et,{type:"submit",className:"w-full relative overflow-hidden transition-all group",disabled:a||N,children:[m.jsx("span",{className:"relative z-10 flex items-center justify-center gap-2",children:a?m.jsxs(m.Fragment,{children:[m.jsx(XN,{className:"h-4 w-4 animate-spin"}),"Logging in..."]}):m.jsxs(m.Fragment,{children:[m.jsx(RX,{className:"h-4 w-4 group-hover:translate-x-1 transition-transform"}),"Login"]})}),m.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-primary/80 to-primary opacity-0 group-hover:opacity-100 transition-opacity"})]}),m.jsxs(Et,{variant:"outline",className:"w-full",onClick:()=>Z("/"),children:["Back to Website",m.jsx(wz,{className:"ml-2 h-4 w-4"})]})]})]})]})})})},cfe=()=>{const{user:e,isAuthenticated:t,isLoading:r,updateProfile:i,updatePassword:a,getAllUsers:u,register:h,deleteUser:g,updateUser:s}=Qv(),_=Tc(),{toast:b}=Hi(),[C,M]=A.useState(""),[D,N]=A.useState(!1),[j,V]=A.useState(""),[B,z]=A.useState(""),[U,Z]=A.useState(""),[Q,re]=A.useState(!1),[oe,pe]=A.useState([]),[ve,he]=A.useState(!1),[Ke,qe]=A.useState(""),[Ie,rt]=A.useState(""),[Pt,it]=A.useState(""),[Je,Te]=A.useState(""),[Re,Tt]=A.useState("user"),[Ge,wt]=A.useState(!1),[ct,dt]=A.useState(!1),[tr,Bt]=A.useState(null),[St,nr]=A.useState(""),[cr,lr]=A.useState(""),[dr,Ut]=A.useState("user"),[Kr,Zr]=A.useState(""),[vi,Ir]=A.useState(""),[Rn,ke]=A.useState(!1);A.useEffect(()=>{e&&M(e.name)},[e]),A.useEffect(()=>{t&&!r&&(async()=>{if((e==null?void 0:e.role)==="developer"){he(!0);const nn=await u();pe(nn),he(!1)}})()},[e,t,r,u]),A.useEffect(()=>{!r&&!t&&_("/login")},[t,r,_]);const Oe=async At=>{At.preventDefault(),N(!0);try{await i({name:C})}finally{N(!1)}},Ze=async At=>{if(At.preventDefault(),B!==U){b({title:"Passwords Don't Match",description:"New password and confirmation must match",variant:"destructive"});return}if(B.length<6){b({title:"Password Too Short",description:"Password must be at least 6 characters long",variant:"destructive"});return}re(!0);try{await a(j,B)&&(V(""),z(""),Z(""))}finally{re(!1)}},Vt=async At=>{if(At.preventDefault(),!Ke||!Ie||!Pt){b({title:"Missing Information",description:"Please fill all fields",variant:"destructive"});return}if(Pt!==Je){b({title:"Passwords Don't Match",description:"Password and confirmation must match",variant:"destructive"});return}if(Pt.length<6){b({title:"Password Too Short",description:"Password must be at least 6 characters long",variant:"destructive"});return}if((e==null?void 0:e.role)!=="developer"){b({title:"Permission Denied",description:"Only developers can create users",variant:"destructive"});return}wt(!0);try{if(await h(Ke,Ie,Pt,Re)){const Mn=await u();pe(Mn),qe(""),rt(""),it(""),Te(""),Tt("user")}}finally{wt(!1)}},jt=async(At,nn)=>{if(console.log(`Delete button clicked for user ${At} (${nn})`),(e==null?void 0:e.role)!=="developer"){b({title:"Permission Denied",description:"Only developers can delete users",variant:"destructive"});return}try{const Mn=await g(At);if(console.log(`Delete result for user ${At}:`,Mn),Mn){console.log("Refreshing users list after successful delete");const qi=await u();pe(qi),console.log("Users list refreshed, new count:",qi.length)}}catch(Mn){console.error("Error in handleDeleteUser:",Mn),b({title:"Delete Failed",description:"Failed to delete user. Please try again.",variant:"destructive"})}},Ct=At=>{Bt(At.id),nr(At.name),lr(At.email),Ut(At.role),Zr(""),Ir(""),dt(!0)},Qt=()=>{dt(!1),Bt(null),nr(""),lr(""),Ut("user"),Zr(""),Ir("")},fr=async()=>{if(tr){if((e==null?void 0:e.role)!=="developer"){b({title:"Permission Denied",description:"Only developers can update users",variant:"destructive"});return}if(!St||!cr){b({title:"Missing Information",description:"Please fill all required fields",variant:"destructive"});return}if(Kr&&Kr!==vi){b({title:"Passwords Don't Match",description:"Password and confirmation must match",variant:"destructive"});return}if(Kr&&Kr.length<6){b({title:"Password Too Short",description:"Password must be at least 6 characters long",variant:"destructive"});return}ke(!0);try{const At={name:St,email:cr,role:dr};if(Kr&&(At.password=Kr),await s(tr,At)){const Mn=await u();pe(Mn),Qt(),b({title:"User Updated",description:"User information has been updated successfully"})}}catch(At){console.error("Error updating user:",At),b({title:"Update Failed",description:"Failed to update user information",variant:"destructive"})}finally{ke(!1)}}},mn=At=>e&&e.role==="developer"?At.role!=="developer":!1;return r||!e?m.jsx("div",{className:"min-h-screen flex items-center justify-center",children:m.jsx("div",{className:"animate-spin h-8 w-8 border-t-2 border-b-2 border-primary rounded-full"})}):m.jsxs("div",{className:"pt-16 md:pt-20 min-h-screen page-transition-in",children:[m.jsxs("div",{className:"container-custom section-padding",children:[m.jsxs("div",{className:"mb-6 flex items-center",children:[m.jsxs(Et,{variant:"outline",size:"sm",onClick:()=>_("/admin"),className:"mr-4",children:[m.jsx(_z,{className:"h-4 w-4 mr-1"}),"Back to Admin"]}),m.jsx("h1",{className:"text-2xl md:text-3xl font-display font-semibold",children:"Profile Settings"})]}),m.jsxs(Mh,{defaultValue:"profile",className:"space-y-6",children:[m.jsxs(qu,{children:[m.jsxs(Sn,{value:"profile",className:"flex items-center",children:[m.jsx(Pz,{className:"h-4 w-4 mr-2"}),"My Profile"]}),e.role==="developer"&&m.jsxs(Sn,{value:"users",className:"flex items-center",children:[m.jsx(XX,{className:"h-4 w-4 mr-2"}),"Manage Users"]})]}),m.jsx(ni,{value:"profile",children:m.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[m.jsxs(Wi,{className:"glass-card",children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Personal Information"}),m.jsx(Co,{children:"Update your account details"})]}),m.jsxs("form",{onSubmit:Oe,children:[m.jsxs(xs,{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"email",children:"Email"}),m.jsx(ur,{id:"email",value:e.email,disabled:!0,className:"bg-secondary/50"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"name",children:"Name"}),m.jsx(ur,{id:"name",value:C,onChange:At=>M(At.target.value),placeholder:"Your name"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"role",children:"Role"}),m.jsx(ur,{id:"role",value:e.role,disabled:!0,className:"bg-secondary/50"})]})]}),m.jsx(ju,{children:m.jsx(Et,{type:"submit",disabled:D,children:D?m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-t-2 border-b-2 border-current rounded-full"}),"Saving..."]}):m.jsxs(m.Fragment,{children:[m.jsx(Cz,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})]}),m.jsxs(Wi,{className:"glass-card",children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Change Password"}),m.jsx(Co,{children:"Update your account password"})]}),m.jsxs("form",{onSubmit:Ze,children:[m.jsxs(xs,{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"currentPassword",children:"Current Password"}),m.jsx(ur,{id:"currentPassword",type:"password",value:j,onChange:At=>V(At.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newPassword",children:"New Password"}),m.jsx(ur,{id:"newPassword",type:"password",value:B,onChange:At=>z(At.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"confirmPassword",children:"Confirm New Password"}),m.jsx(ur,{id:"confirmPassword",type:"password",value:U,onChange:At=>Z(At.target.value),required:!0})]})]}),m.jsx(ju,{children:m.jsx(Et,{type:"submit",disabled:Q,children:Q?m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-t-2 border-b-2 border-current rounded-full"}),"Changing..."]}):"Change Password"})})]})]})]})}),e.role==="developer"&&m.jsx(ni,{value:"users",children:m.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[m.jsxs(Wi,{className:"glass-card",children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Create New User"}),m.jsx(Co,{children:"Add a new user account with secure password"})]}),m.jsxs("form",{onSubmit:Vt,children:[m.jsxs(xs,{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newUserName",children:"Name"}),m.jsx(ur,{id:"newUserName",value:Ke,onChange:At=>qe(At.target.value),placeholder:"User name",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newUserEmail",children:"Email"}),m.jsx(ur,{id:"newUserEmail",type:"email",value:Ie,onChange:At=>rt(At.target.value),placeholder:"user@example.com",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newUserPassword",children:"Password"}),m.jsx(ur,{id:"newUserPassword",type:"password",value:Pt,onChange:At=>it(At.target.value),placeholder:"Create a strong password (min 6 chars)",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newUserConfirmPassword",children:"Confirm Password"}),m.jsx(ur,{id:"newUserConfirmPassword",type:"password",value:Je,onChange:At=>Te(At.target.value),placeholder:"Confirm the password",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"newUserRole",children:"Role"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(Et,{type:"button",variant:Re==="admin"?"default":"outline",size:"sm",className:"flex-1",onClick:()=>Tt("admin"),children:"Admin"}),m.jsx(Et,{type:"button",variant:Re==="user"?"default":"outline",size:"sm",className:"flex-1",onClick:()=>Tt("user"),children:"User"})]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"As a developer, you can create admin or user accounts"})]})]}),m.jsx(ju,{children:m.jsx(Et,{type:"submit",disabled:Ge,children:Ge?m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-t-2 border-b-2 border-current rounded-full"}),"Creating..."]}):m.jsxs(m.Fragment,{children:[m.jsx(ZX,{className:"mr-2 h-4 w-4"}),"Create User"]})})})]})]}),m.jsxs(Wi,{className:"glass-card",children:[m.jsxs(ys,{children:[m.jsx(vs,{children:"Manage Users"}),m.jsx(Co,{children:"All registered users in the system"})]}),m.jsx(xs,{children:ve?m.jsx("div",{className:"flex justify-center py-6",children:m.jsx("div",{className:"animate-spin h-6 w-6 border-t-2 border-b-2 border-primary rounded-full"})}):oe.length===0?m.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No users found"}):m.jsx("div",{className:"space-y-4",children:oe.map(At=>m.jsxs("div",{className:"flex justify-between items-center p-3 border border-border rounded-lg",children:[m.jsxs("div",{children:[m.jsx("p",{className:"font-medium",children:At.name}),m.jsx("p",{className:"text-sm text-muted-foreground",children:At.email}),m.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${At.role==="developer"?"bg-blue-500/20 text-blue-500":At.role==="admin"?"bg-green-500/20 text-green-500":"bg-orange-500/20 text-orange-500"}`,children:At.role})]}),m.jsxs("div",{className:"flex space-x-2",children:[mn(At)&&m.jsx(Et,{variant:"outline",size:"sm",onClick:()=>Ct(At),className:"h-8",children:m.jsx(zX,{className:"h-4 w-4"})}),At.role!=="developer"&&m.jsx(Et,{variant:"destructive",size:"sm",onClick:()=>{console.log(`Delete button clicked for user ${At.id} (${At.name})`),jt(At.id,At.name)},className:"h-8",children:m.jsx(Bu,{className:"h-4 w-4"})})]})]},At.id))})})]})]})})]})]}),m.jsx(zh,{open:ct,onOpenChange:dt,children:m.jsxs(ed,{className:"sm:max-w-md",children:[m.jsx(rx,{children:m.jsx(nx,{children:"Edit User"})}),m.jsxs("div",{className:"space-y-4 py-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"editUserName",children:"Name"}),m.jsx(ur,{id:"editUserName",value:St,onChange:At=>nr(At.target.value),placeholder:"User name"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"editUserEmail",children:"Email"}),m.jsx(ur,{id:"editUserEmail",type:"email",value:cr,onChange:At=>lr(At.target.value),placeholder:"user@example.com"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"editUserPassword",children:"New Password (optional)"}),m.jsx(ur,{id:"editUserPassword",type:"password",value:Kr,onChange:At=>Zr(At.target.value),placeholder:"Leave empty to keep current password"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"editUserConfirmPassword",children:"Confirm New Password"}),m.jsx(ur,{id:"editUserConfirmPassword",type:"password",value:vi,onChange:At=>Ir(At.target.value),placeholder:"Confirm new password"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"editUserRole",children:"Role"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(Et,{type:"button",variant:dr==="admin"?"default":"outline",size:"sm",className:"flex-1",onClick:()=>Ut("admin"),children:"Admin"}),m.jsx(Et,{type:"button",variant:dr==="user"?"default":"outline",size:"sm",className:"flex-1",onClick:()=>Ut("user"),children:"User"})]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Developers can change user role between admin and user"})]}),m.jsxs("div",{className:"flex items-center p-3 bg-muted/50 rounded-lg mt-4",children:[m.jsx(vX,{className:"h-4 w-4 text-muted-foreground mr-2"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Only developers can manage users. Admins can only edit their own profile."})]})]}),m.jsxs(rb,{children:[m.jsxs(Et,{variant:"outline",onClick:Qt,children:[m.jsx(Ls,{className:"h-4 w-4 mr-2"}),"Cancel"]}),m.jsx(Et,{onClick:fr,disabled:Rn,children:Rn?m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-t-2 border-b-2 border-current rounded-full"}),"Saving..."]}):m.jsxs(m.Fragment,{children:[m.jsx(Lk,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})})]})},ufe=()=>{const e=la();return A.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-secondary/30 px-4 page-transition-in",children:m.jsxs("div",{className:"text-center glass-card p-8 rounded-xl max-w-md",children:[m.jsx("h1",{className:"text-7xl font-display font-bold mb-6",children:"404"}),m.jsx("p",{className:"text-xl text-muted-foreground mb-8",children:"We couldn't find the page you're looking for"}),m.jsx(Et,{asChild:!0,children:m.jsxs(ta,{to:"/",children:[m.jsx(Ez,{className:"h-4 w-4 mr-2"}),"Return to Home"]})})]})})},dfe=()=>{const e=Tc();return A.useEffect(()=>{document.title="Access Denied | YBF Restaurant"},[]),m.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-background page-transition-in",children:m.jsxs("div",{className:"max-w-md w-full text-center",children:[m.jsx(UX,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),m.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Access Denied"}),m.jsx("p",{className:"text-muted-foreground mb-6",children:"You don't have permission to access this page. Please contact a developer if you believe this is an error."}),m.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[m.jsxs(Et,{onClick:()=>e(-1),children:[m.jsx(_z,{className:"h-4 w-4 mr-2"}),"Go Back"]}),m.jsx(Et,{variant:"outline",asChild:!0,children:m.jsxs(ta,{to:"/",children:[m.jsx(Ez,{className:"h-4 w-4 mr-2"}),"Home Page"]})})]})]})})},uL=({children:e,requiredRole:t,requiredRoles:r})=>{const{isAuthenticated:i,isLoading:a,user:u}=Qv();return a?m.jsx("div",{className:"min-h-screen flex items-center justify-center",children:m.jsx("div",{className:"animate-spin h-8 w-8 border-t-2 border-b-2 border-primary rounded-full"})}):i?r&&r.length>0&&(!u||!r.includes(u.role)&&u.role!=="developer")?m.jsx(IE,{to:"/unauthorized"}):t?(u==null?void 0:u.role)==="developer"?m.jsx(m.Fragment,{children:e}):(u==null?void 0:u.role)==="admin"&&(t==="admin"||t==="user")?m.jsx(m.Fragment,{children:e}):(u==null?void 0:u.role)==="user"&&t==="user"?m.jsx(m.Fragment,{children:e}):m.jsx(IE,{to:"/unauthorized"}):m.jsx(m.Fragment,{children:e}):m.jsx(IE,{to:"/login"})};function hfe({editVoucher:e,onClose:t}){const{addVoucher:r,updateVoucher:i,deleteVoucher:a,refreshVouchers:u}=ca(),{toast:h}=Hi(),{confirm:g,ConfirmationDialog:s}=Kv(),_=!!e,[b,C]=A.useState(""),[M,D]=A.useState(""),[N,j]=A.useState(""),[V,B]=A.useState(""),[z,U]=A.useState(""),[Z,Q]=A.useState(new Date),[re,oe]=A.useState(new Date(new Date().setMonth(new Date().getMonth()+1))),[pe,ve]=A.useState(!0),[he,Ke]=A.useState(""),[qe,Ie]=A.useState(null),[rt,Pt]=A.useState(""),[it,Je]=A.useState(!1);A.useEffect(()=>{var Ge,wt;if(e){C(e.code),D(e.description),j(e.discount.toString()),B(((Ge=e.minPurchase)==null?void 0:Ge.toString())||""),U(((wt=e.maxDiscount)==null?void 0:wt.toString())||"");const ct=new Date(e.startDate),dt=new Date(e.endDate);isNaN(ct.getTime())||Q(ct),isNaN(dt.getTime())||oe(dt),ve(e.isActive),Ke(e.imageUrl||""),Pt(e.imageUrl||"")}},[e]);const Te=Ge=>{const wt=Ge.target.files;if(!wt||wt.length===0)return;const ct=wt[0];Ie(ct);const dt=URL.createObjectURL(ct);rt&&!he&&URL.revokeObjectURL(rt),Pt(dt)},Re=async Ge=>{if(Ge.preventDefault(),!b||!M||!N||!Z||!re){h({title:"Missing information",description:"Please fill all required fields.",variant:"destructive"});return}if(Z>re){h({title:"Invalid date range",description:"Start date must be before end date.",variant:"destructive"});return}Je(!0);try{let wt=he;if(qe)try{wt=await $p(qe)}catch(dt){console.error("Error uploading image:",dt),h({title:"Upload Error",description:"Failed to upload image. Please try again.",variant:"destructive"}),Je(!1);return}const ct={code:b,description:M,discount:parseFloat(N),minPurchase:V?parseFloat(V):0,maxDiscount:z?parseFloat(z):0,startDate:Z,endDate:re,isActive:pe,imageUrl:wt||void 0};_&&e?(await i(e.id,ct),h({title:"Voucher updated",description:`Voucher ${b} has been successfully updated.`})):(await r(ct),h({title:"Voucher added",description:`Voucher ${b} has been successfully created.`})),await u(),t()}catch(wt){console.error("Error saving voucher:",wt),h({title:"Error",description:"There was a problem saving the voucher. Please try again.",variant:"destructive"})}finally{Je(!1)}},Tt=async()=>{e&&await g({title:"Delete Voucher?",description:`Are you sure you want to delete the voucher ${e.code}?`,type:"error",confirmText:"Delete",onConfirm:async()=>{Je(!0);try{await a(e.id),await u(),h({title:"Voucher deleted",description:`Voucher ${e.code} has been deleted.`}),t()}catch(Ge){console.error("Error deleting voucher:",Ge),h({title:"Error",description:"There was a problem deleting the voucher. Please try again.",variant:"destructive"})}finally{Je(!1)}}})};return m.jsxs("div",{className:"glass-card rounded-xl p-4 md:p-6 max-w-3xl mx-auto",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsx("h2",{className:"text-xl md:text-2xl font-display font-semibold",children:_?"Edit Voucher":"Add New Voucher"}),m.jsx(Et,{variant:"ghost",size:"icon",onClick:t,"aria-label":"Close",disabled:it,children:m.jsx(Ls,{className:"h-5 w-5"})})]}),m.jsxs("form",{onSubmit:Re,className:"space-y-6",children:[m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"code",children:"Voucher Code *"}),m.jsx(ur,{id:"code",value:b,onChange:Ge=>C(Ge.target.value.toUpperCase()),placeholder:"e.g., WELCOME20",required:!0,disabled:it,className:"uppercase"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"discount",children:"Discount Percentage *"}),m.jsxs("div",{className:"relative",children:[m.jsx(ur,{id:"discount",type:"number",min:"1",max:"100",value:N,onChange:Ge=>j(Ge.target.value),placeholder:"e.g., 20",required:!0,disabled:it}),m.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center text-sm text-muted-foreground pointer-events-none",children:"%"})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"description",children:"Description *"}),m.jsx(yh,{id:"description",value:M,onChange:Ge=>D(Ge.target.value),placeholder:"Describe the voucher...",required:!0,rows:2,disabled:it})]}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"minPurchase",children:"Minimum Purchase (IDR)"}),m.jsx(ur,{id:"minPurchase",type:"number",min:"0",step:"500",value:V,onChange:Ge=>B(Ge.target.value),placeholder:"0 = No minimum",disabled:it})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"maxDiscount",children:"Maximum Discount (IDR)"}),m.jsx(ur,{id:"maxDiscount",type:"number",min:"0",step:"500",value:z,onChange:Ge=>U(Ge.target.value),placeholder:"0 = No maximum",disabled:it})]})]}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"startDate",children:"Start Date *"}),m.jsxs(pw,{children:[m.jsx(mw,{asChild:!0,children:m.jsxs(Et,{id:"startDate",variant:"outline",className:It("w-full justify-start text-left font-normal",!Z&&"text-muted-foreground"),disabled:it,children:[m.jsx(dv,{className:"mr-2 h-4 w-4"}),Z?Ro(Z,"PPP"):m.jsx("span",{children:"Pick a date"})]})}),m.jsx(Iv,{className:"w-auto p-0",align:"start",children:m.jsx(yw,{mode:"single",selected:Z,onSelect:Q,initialFocus:!0,className:It("p-3 pointer-events-auto")})})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{htmlFor:"endDate",children:"End Date *"}),m.jsxs(pw,{children:[m.jsx(mw,{asChild:!0,children:m.jsxs(Et,{id:"endDate",variant:"outline",className:It("w-full justify-start text-left font-normal",!re&&"text-muted-foreground"),disabled:it,children:[m.jsx(dv,{className:"mr-2 h-4 w-4"}),re?Ro(re,"PPP"):m.jsx("span",{children:"Pick a date"})]})}),m.jsx(Iv,{className:"w-auto p-0",align:"start",children:m.jsx(yw,{mode:"single",selected:re,onSelect:oe,initialFocus:!0,disabled:Ge=>Z?Ge<new Date(Z.setHours(0,0,0,0)):!1,className:It("p-3 pointer-events-auto")})})]})]})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Av,{id:"isActive",checked:pe,onCheckedChange:ve,disabled:it}),m.jsx(pr,{htmlFor:"isActive",className:"text-base cursor-pointer",children:"Voucher is active and can be redeemed"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(pr,{children:"Voucher Image (optional)"}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-4 text-center",children:[m.jsx("input",{type:"file",accept:"image/*",id:"voucher-image",onChange:Te,className:"hidden",disabled:it}),m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx(Bk,{className:"h-8 w-8 text-muted-foreground mb-2"}),m.jsx("p",{className:"text-sm mb-2",children:"Click to upload an image"}),m.jsx(Et,{type:"button",variant:"outline",size:"sm",onClick:()=>{var Ge;return(Ge=document.getElementById("voucher-image"))==null?void 0:Ge.click()},disabled:it,children:"Select File"})]})]}),m.jsx("div",{className:"bg-secondary/30 rounded-lg overflow-hidden flex items-center justify-center",children:rt?m.jsx("img",{src:rt,alt:"Voucher preview",className:"w-full h-full object-cover"}):m.jsx("p",{className:"text-sm text-muted-foreground p-4 text-center",children:"No image uploaded yet"})})]})]}),m.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[_&&m.jsx(Et,{type:"button",variant:"destructive",onClick:Tt,disabled:it,children:"Delete Voucher"}),m.jsx(Et,{type:"button",variant:"outline",onClick:t,disabled:it,children:"Cancel"}),m.jsx(Et,{type:"submit",disabled:it,children:it?"Saving...":_?"Update Voucher":"Add Voucher"})]})]}),m.jsx(s,{})]})}const ffe=()=>{const{vouchers:e,refreshVouchers:t,loading:r,deleteVoucher:i}=ca(),{toast:a}=Hi(),{confirm:u,ConfirmationDialog:h}=Kv(),{user:g}=Qv(),s=g&&(g.role==="admin"||g.role==="developer"),[_,b]=A.useState("active"),[C,M]=A.useState([]),[D,N]=A.useState(!1),[j,V]=A.useState(void 0),[B,z]=A.useState(null);A.useEffect(()=>{const pe=new Date;let ve;switch(_){case"active":ve=e.filter(he=>he.isActive&&new Date(he.startDate)<=pe&&new Date(he.endDate)>=pe);break;case"upcoming":ve=e.filter(he=>new Date(he.startDate)>pe);break;case"expired":ve=e.filter(he=>new Date(he.endDate)<pe);break;case"all":default:ve=[...e];break}M(ve)},[e,_]),A.useEffect(()=>{(async()=>{await t()})()},[]);const U=pe=>{a({title:"Voucher Redeemed",description:`You can use "${pe.code}" at our restaurant checkout to receive ${pe.discount}% off.`})},Z=async(pe,ve)=>{if(s)try{const he=await u({title:"Delete Voucher",description:`Are you sure you want to delete voucher "${ve}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",type:"error",onConfirm:async()=>{z(pe),await i(pe),await t(),a({title:"Voucher Deleted",description:`Voucher "${ve}" has been deleted successfully.`})}})}catch(he){console.error("Error deleting voucher:",he),a({title:"Error",description:"Failed to delete voucher. Please try again.",variant:"destructive"})}finally{z(null)}},Q=pe=>{V(pe),N(!0)},re=()=>{V(void 0),N(!0)};return m.jsxs("div",{className:"min-h-screen pt-16 md:pt-20 page-transition-in",children:[m.jsxs("div",{className:"container-custom section-padding",children:[m.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-display font-semibold",children:"Vouchers & Offers"}),m.jsx("p",{className:"text-muted-foreground mt-1",children:"Redeem these vouchers for special discounts at our restaurant"})]}),s&&m.jsxs(Et,{onClick:re,children:[m.jsx(El,{className:"h-4 w-4 mr-2"}),"Add New Voucher"]})]}),m.jsxs(Mh,{defaultValue:"active",value:_,onValueChange:b,children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs(qu,{children:[m.jsx(Sn,{value:"active",children:"Active"}),m.jsx(Sn,{value:"upcoming",children:"Upcoming"}),m.jsx(Sn,{value:"expired",children:"Expired"}),m.jsx(Sn,{value:"all",children:"All"})]}),m.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[m.jsx(Sz,{className:"h-4 w-4 mr-1"}),"Showing ",C.length," vouchers"]})]}),m.jsx(ni,{value:"active",className:"mt-2",children:oe("active")}),m.jsx(ni,{value:"upcoming",className:"mt-2",children:oe("upcoming")}),m.jsx(ni,{value:"expired",className:"mt-2",children:oe("expired")}),m.jsx(ni,{value:"all",className:"mt-2",children:oe("all")})]})]}),D&&m.jsx("div",{className:"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm flex items-center justify-center p-2 sm:p-4 overflow-y-auto",children:m.jsx("div",{className:"w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:m.jsx(hfe,{editVoucher:j,onClose:()=>{N(!1),V(void 0)}})})}),m.jsx(h,{})]});function oe(pe){return r?m.jsxs("div",{className:"flex justify-center items-center py-16",children:[m.jsx(_s,{className:"h-8 w-8 animate-spin text-primary"}),m.jsx("span",{className:"ml-2 text-lg",children:"Loading vouchers..."})]}):C.length===0?m.jsxs("div",{className:"py-10 text-center glass-card rounded-xl",children:[m.jsxs("p",{className:"text-muted-foreground mb-4",children:[pe==="active"&&"No active vouchers available right now.",pe==="upcoming"&&"No upcoming vouchers to show.",pe==="expired"&&"No expired vouchers in the system.",pe==="all"&&"No vouchers have been created yet."]}),s&&m.jsxs(Et,{onClick:re,children:[m.jsx(El,{className:"h-4 w-4 mr-2"}),"Create First Voucher"]})]}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(ve=>m.jsx(UB,{voucher:ve,onRedeem:()=>U(ve),isAdmin:s,onEdit:()=>Q(ve),onDelete:()=>Z(ve.id,ve.code),isProcessing:B===ve.id},ve.id))})}},pfe=()=>{const e=la(),{settings:t,fetchSettings:r}=Oh(),i=e.pathname.includes("/admin")||e.pathname.includes("/login")||e.pathname.includes("/profile");A.useEffect(()=>{r()},[r]),A.useEffect(()=>{const h=(t==null?void 0:t.siteTitle)||"YBF Resto - Young Brave Fearless Restaurant",g={"/login":"Login","/admin":"Admin Dashboard","/profile":"My Profile","/vouchers":"Vouchers","/unauthorized":"Unauthorized Access"},s=e.pathname;if(g[s]){const _=g[s],b=(t==null?void 0:t.siteName)||"YBF Resto";document.title=`${_} - ${b}`}else document.title=h;t!=null&&t.faviconUrl&&a(t.faviconUrl)},[e,t]);const a=h=>{let g=document.querySelector('link[rel="icon"]');g||(g=document.createElement("link"),g.rel="icon",document.head.appendChild(g)),g.href=h,g.type=u(h)},u=h=>h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".ico")?"image/x-icon":"image/png";return m.jsxs("div",{className:"flex flex-col min-h-screen bg-background text-foreground",children:[m.jsx(tte,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs(xH,{children:[m.jsx(Jl,{path:"/",element:m.jsx(bae,{})}),m.jsx(Jl,{path:"/menu",element:m.jsx(Aae,{})}),m.jsx(Jl,{path:"/vouchers",element:m.jsx(ffe,{})}),m.jsx(Jl,{path:"/login",element:m.jsx(lfe,{})}),m.jsx(Jl,{path:"/admin",element:m.jsx(uL,{requiredRole:"admin",children:m.jsx(afe,{})})}),m.jsx(Jl,{path:"/profile",element:m.jsx(uL,{requiredRole:"user",children:m.jsx(cfe,{})})}),m.jsx(Jl,{path:"/unauthorized",element:m.jsx(dfe,{})}),m.jsx(Jl,{path:"*",element:m.jsx(ufe,{})})]})}),m.jsx(rte,{}),!i&&m.jsx(nte,{}),m.jsx(UF,{})]})},mfe=()=>m.jsx(eq,{children:m.jsx(fQ,{children:m.jsx(jq,{children:m.jsx(pQ,{children:m.jsx(pfe,{})})})})}),gfe=new KH({defaultOptions:{queries:{retry:!1,refetchOnWindowFocus:!1},mutations:{retry:!1}}});TT.createRoot(document.getElementById("root")).render(m.jsx(lt.StrictMode,{children:m.jsx(JH,{client:gfe,children:m.jsxs(CH,{children:[m.jsx(mfe,{}),m.jsx(UF,{})]})})}));
